<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Transitions API æµ‹è¯•</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 40px;
            background: var(--td-bg-color-page, #f5f5f5);
            color: var(--td-text-color-primary, #333);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .theme-colors {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .color-block {
            height: 100px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .color-block:hover {
            transform: scale(1.05);
        }
        
        .brand-1 { background: var(--td-brand-color-1, #f2f3ff); color: #333; }
        .brand-2 { background: var(--td-brand-color-2, #d9e1ff); color: #333; }
        .brand-3 { background: var(--td-brand-color-3, #b3c5ff); }
        .brand-4 { background: var(--td-brand-color-4, #8cabff); }
        .brand-5 { background: var(--td-brand-color-5, #618dff); }
        .brand-6 { background: var(--td-brand-color-6, #366ef4); }
        .brand-7 { background: var(--td-brand-color-7, #0052d9); }
        .brand-8 { background: var(--td-brand-color-8, #003cab); }
        .brand-9 { background: var(--td-brand-color-9, #002a7c); }
        .brand-10 { background: var(--td-brand-color-10, #001a57); }
        
        .control-panel {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 40px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: var(--td-brand-color, #0052d9);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--td-brand-color-8, #003cab);
        }
        
        .btn-secondary {
            background: #e5e5e5;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #d0d0d0;
        }
        
        .status {
            padding: 15px;
            background: #f0f9ff;
            border-left: 4px solid #0052d9;
            border-radius: 4px;
            margin-top: 20px;
        }
        
        .status.error {
            background: #fff0f0;
            border-color: #e34d59;
        }
        
        .status.success {
            background: #f0fff4;
            border-color: #00a870;
        }
        
        h1 {
            color: var(--td-text-color-primary, #333);
            margin-bottom: 30px;
        }
        
        .test-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .info-card {
            padding: 15px;
            background: #f8f8f8;
            border-radius: 8px;
        }
        
        .info-card h3 {
            margin: 0 0 10px 0;
            color: var(--td-brand-color, #0052d9);
        }
        
        .info-card p {
            margin: 5px 0;
            font-size: 14px;
        }
        
        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ ä¸»é¢˜åˆ‡æ¢åŠ¨ç”»æµ‹è¯•</h1>
        
        <div class="control-panel">
            <h2>æ§åˆ¶é¢æ¿</h2>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="testDefaultAnimation()">
                    é»˜è®¤åŠ¨ç”»ï¼ˆView Transitionsï¼‰
                </button>
                <button class="btn btn-primary" onclick="testCascadeAnimation()">
                    çº§è”åŠ¨ç”»ï¼ˆCascadeï¼‰
                </button>
                <button class="btn btn-primary" onclick="testSmoothAnimation()">
                    å¹³æ»‘åŠ¨ç”»ï¼ˆSmoothï¼‰
                </button>
                <button class="btn btn-primary" onclick="testFadeAnimation()">
                    æ·¡å…¥æ·¡å‡ºï¼ˆFadeï¼‰
                </button>
                <button class="btn btn-primary" onclick="testNoAnimation()">
                    æ— åŠ¨ç”»ï¼ˆInstantï¼‰
                </button>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" onclick="switchTheme('default')">é»˜è®¤è“</button>
                <button class="btn btn-secondary" onclick="switchTheme('techBlue')">ç§‘æŠ€è“</button>
                <button class="btn btn-secondary" onclick="switchTheme('mintGreen')">è–„è·ç»¿</button>
                <button class="btn btn-secondary" onclick="switchTheme('coralOrange')">çŠç‘šæ©™</button>
                <button class="btn btn-secondary" onclick="switchTheme('purpleViolet')">ç´«ç½—å…°</button>
                <button class="btn btn-secondary" onclick="switchTheme('chinaRed')">ä¸­å›½çº¢</button>
            </div>
            
            <div id="status" class="status">
                å‡†å¤‡å°±ç»ªï¼Œè¯·é€‰æ‹©åŠ¨ç”»ç±»å‹å¹¶åˆ‡æ¢ä¸»é¢˜
            </div>
            
            <div class="test-info">
                <div class="info-card">
                    <h3>å½“å‰è®¾ç½®</h3>
                    <p>åŠ¨ç”»ç±»å‹: <code id="currentAnimation">é»˜è®¤</code></p>
                    <p>å½“å‰ä¸»é¢˜: <code id="currentTheme">default</code></p>
                    <p>æµè§ˆå™¨æ”¯æŒ: <code id="browserSupport">æ£€æµ‹ä¸­...</code></p>
                </div>
                <div class="info-card">
                    <h3>è¯´æ˜</h3>
                    <p>â€¢ é»˜è®¤ä½¿ç”¨ View Transitions API</p>
                    <p>â€¢ çº§è”åŠ¨ç”»é€‚åˆåˆ—è¡¨åœºæ™¯</p>
                    <p>â€¢ å¹³æ»‘åŠ¨ç”»é€‚åˆå¤§å¹…åº¦å˜åŒ–</p>
                    <p>â€¢ æ·¡å…¥æ·¡å‡ºæœ‰ç™½è‰²é®ç½©æ•ˆæœ</p>
                </div>
            </div>
        </div>
        
        <div class="theme-colors">
            <div class="color-block brand-1">Brand 1</div>
            <div class="color-block brand-2">Brand 2</div>
            <div class="color-block brand-3">Brand 3</div>
            <div class="color-block brand-4">Brand 4</div>
            <div class="color-block brand-5">Brand 5</div>
            <div class="color-block brand-6">Brand 6</div>
            <div class="color-block brand-7">Brand 7</div>
            <div class="color-block brand-8">Brand 8</div>
            <div class="color-block brand-9">Brand 9</div>
            <div class="color-block brand-10">Brand 10</div>
        </div>
    </div>
    
    <script type="module">
        import { setTheme, getCurrentTheme } from '../ldesign-all/packages/shared/color-generate/es/simple.js';
        
        let currentAnimationType = 'default';
        
        // æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
        const supportsViewTransitions = 'startViewTransition' in document;
        document.getElementById('browserSupport').textContent = 
            supportsViewTransitions ? 'âœ… æ”¯æŒ View Transitions' : 'âŒ ä¸æ”¯æŒ View Transitions';
        
        // åˆå§‹åŒ–ä¸»é¢˜
        setTheme('default');
        
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = 'status ' + type;
            console.log(`[${type}] ${message}`);
        }
        
        // æµ‹è¯•é»˜è®¤åŠ¨ç”»ï¼ˆView Transitions APIï¼‰
        window.testDefaultAnimation = function() {
            currentAnimationType = 'default';
            document.getElementById('currentAnimation').textContent = 'é»˜è®¤ (View Transitions)';
            updateStatus('å·²åˆ‡æ¢åˆ°é»˜è®¤åŠ¨ç”»æ¨¡å¼ï¼ˆView Transitions APIï¼‰ï¼Œç°åœ¨åˆ‡æ¢ä¸»é¢˜è¯•è¯•', 'success');
        }
        
        // æµ‹è¯•çº§è”åŠ¨ç”»
        window.testCascadeAnimation = function() {
            currentAnimationType = 'cascade';
            document.getElementById('currentAnimation').textContent = 'çº§è” (Cascade)';
            updateStatus('å·²åˆ‡æ¢åˆ°çº§è”åŠ¨ç”»æ¨¡å¼ï¼Œå…ƒç´ å°†é€ä¸ªå˜åŒ–', 'success');
        }
        
        // æµ‹è¯•å¹³æ»‘åŠ¨ç”»
        window.testSmoothAnimation = function() {
            currentAnimationType = 'smooth';
            document.getElementById('currentAnimation').textContent = 'å¹³æ»‘ (Smooth)';
            updateStatus('å·²åˆ‡æ¢åˆ°å¹³æ»‘åŠ¨ç”»æ¨¡å¼ï¼Œé€‚åˆå¤§å¹…åº¦é¢œè‰²å˜åŒ–', 'success');
        }
        
        // æµ‹è¯•æ·¡å…¥æ·¡å‡ºåŠ¨ç”»
        window.testFadeAnimation = function() {
            currentAnimationType = 'fade';
            document.getElementById('currentAnimation').textContent = 'æ·¡å…¥æ·¡å‡º (Fade)';
            updateStatus('å·²åˆ‡æ¢åˆ°æ·¡å…¥æ·¡å‡ºæ¨¡å¼ï¼Œä¼šæœ‰ç™½è‰²é®ç½©æ•ˆæœ', 'success');
        }
        
        // æµ‹è¯•æ— åŠ¨ç”»
        window.testNoAnimation = function() {
            currentAnimationType = 'instant';
            document.getElementById('currentAnimation').textContent = 'æ— åŠ¨ç”» (Instant)';
            updateStatus('å·²å…³é—­åŠ¨ç”»ï¼Œä¸»é¢˜å°†ç«‹å³åˆ‡æ¢', 'success');
        }
        
        // åˆ‡æ¢ä¸»é¢˜
        window.switchTheme = function(themeName) {
            document.getElementById('currentTheme').textContent = themeName;
            
            let options = {};
            
            // æ ¹æ®å½“å‰åŠ¨ç”»ç±»å‹è®¾ç½®é€‰é¡¹
            if (currentAnimationType === 'default') {
                // é»˜è®¤æ¨¡å¼ï¼šä¸è®¾ç½® transition å­—æ®µï¼Œè®©å…¶ä½¿ç”¨ View Transitions API
                updateStatus(`åˆ‡æ¢åˆ° ${themeName} ä¸»é¢˜ï¼ˆä½¿ç”¨ View Transitions APIï¼‰`);
            } else {
                // å…¶ä»–æ¨¡å¼ï¼šè®¾ç½® transition å­—æ®µ
                options = {
                    transition: currentAnimationType,
                    duration: 500,
                    cascadeDelay: 50
                };
                updateStatus(`åˆ‡æ¢åˆ° ${themeName} ä¸»é¢˜ï¼ˆä½¿ç”¨ ${currentAnimationType} åŠ¨ç”»ï¼‰`);
            }
            
            // è®°å½•åŠ¨ç”»å¼€å§‹æ—¶é—´
            const startTime = performance.now();
            
            // æ‰§è¡Œä¸»é¢˜åˆ‡æ¢
            try {
                const result = setTheme(themeName, options);
                
                // æ£€æŸ¥å®ä¾‹çŠ¶æ€
                if (result && result.options) {
                    console.log('ä¸»é¢˜å®ä¾‹é€‰é¡¹:', result.options);
                }
                
                // ç›‘å¬åŠ¨ç”»å®Œæˆ
                requestAnimationFrame(() => {
                    const endTime = performance.now();
                    const duration = Math.round(endTime - startTime);
                    console.log(`åŠ¨ç”»æ‰§è¡Œæ—¶é—´: ${duration}ms`);
                });
                
            } catch (error) {
                updateStatus(`åˆ‡æ¢å¤±è´¥: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // æ£€æŸ¥ View Transitions API æ˜¯å¦åœ¨å·¥ä½œ
        if (supportsViewTransitions) {
            // ç›‘å¬ View Transition
            const originalStartViewTransition = document.startViewTransition;
            document.startViewTransition = function(...args) {
                console.log('View Transition è¢«è°ƒç”¨äº†ï¼');
                updateStatus('View Transition API æ­£åœ¨æ‰§è¡Œ...', 'info');
                return originalStartViewTransition.apply(this, args);
            };
        }
        
        // åˆå§‹çŠ¶æ€
        testDefaultAnimation();
    </script>
</body>
</html>