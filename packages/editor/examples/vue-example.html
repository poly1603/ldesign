<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LDesign Editor - Vue é›†æˆç¤ºä¾‹</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    /* åŸºç¡€æ ·å¼ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .app-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: #722ED1;
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .main-content {
      padding: 30px;
    }

    .demo-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    .demo-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      border: 1px solid #e9ecef;
    }

    .demo-section h3 {
      margin-bottom: 15px;
      color: #333;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .editor-container {
      border: 1px solid #d9d9d9;
      border-radius: 6px;
      min-height: 200px;
      margin-bottom: 15px;
      background: white;
    }

    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }

    .btn {
      padding: 8px 16px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.9rem;
    }

    .btn:hover {
      background: #f0f0f0;
      border-color: #722ED1;
    }

    .btn.primary {
      background: #722ED1;
      color: white;
      border-color: #722ED1;
    }

    .btn.primary:hover {
      background: #5e2aa7;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }

    .form-control {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .output {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 4px;
      padding: 15px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 0.85rem;
      max-height: 200px;
      overflow-y: auto;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: white;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #e9ecef;
      text-align: center;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #722ED1;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.85rem;
      color: #666;
    }

    .vue-features {
      background: #e8f5e8;
      border: 1px solid #c3e6c3;
      border-radius: 6px;
      padding: 15px;
      margin-bottom: 20px;
    }

    .vue-features h4 {
      color: #2d5a2d;
      margin-bottom: 10px;
    }

    .vue-features ul {
      margin: 0;
      padding-left: 20px;
    }

    .vue-features li {
      color: #2d5a2d;
      margin-bottom: 5px;
    }

    @media (max-width: 768px) {
      .demo-grid {
        grid-template-columns: 1fr;
      }
      
      .main-content {
        padding: 20px;
      }
      
      .header {
        padding: 20px;
      }
      
      .header h1 {
        font-size: 2rem;
      }
    }

    /* Vue è¿‡æ¸¡åŠ¨ç”» */
    .fade-enter-active, .fade-leave-active {
      transition: opacity 0.3s ease;
    }
    .fade-enter-from, .fade-leave-to {
      opacity: 0;
    }

    .slide-enter-active, .slide-leave-active {
      transition: all 0.3s ease;
    }
    .slide-enter-from {
      transform: translateX(-20px);
      opacity: 0;
    }
    .slide-leave-to {
      transform: translateX(20px);
      opacity: 0;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="app-container">
      <div class="header">
        <h1>LDesign Editor</h1>
        <p>Vue 3 é›†æˆç¤ºä¾‹ - å“åº”å¼æ•°æ®ç»‘å®šä¸ç»„ä»¶åŒ–</p>
      </div>

      <div class="main-content">
        <!-- Vue ç‰¹æ€§è¯´æ˜ -->
        <div class="vue-features">
          <h4>ğŸ¯ Vue é›†æˆç‰¹æ€§</h4>
          <ul>
            <li>å“åº”å¼æ•°æ®ç»‘å®š - ç¼–è¾‘å™¨å†…å®¹ä¸ Vue æ•°æ®åŒå‘åŒæ­¥</li>
            <li>ç»„ä»¶åŒ–å°è£… - å¯å¤ç”¨çš„ç¼–è¾‘å™¨ç»„ä»¶</li>
            <li>ç”Ÿå‘½å‘¨æœŸç®¡ç† - è‡ªåŠ¨å¤„ç†ç»„ä»¶æŒ‚è½½å’Œé”€æ¯</li>
            <li>äº‹ä»¶å¤„ç† - Vue é£æ ¼çš„äº‹ä»¶ç›‘å¬å’Œå¤„ç†</li>
            <li>è®¡ç®—å±æ€§ - å®æ—¶ç»Ÿè®¡å’ŒçŠ¶æ€è®¡ç®—</li>
          </ul>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value">{{ stats.charCount }}</div>
            <div class="stat-label">å­—ç¬¦æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">{{ stats.wordCount }}</div>
            <div class="stat-label">å•è¯æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">{{ stats.paragraphCount }}</div>
            <div class="stat-label">æ®µè½æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">{{ currentTheme }}</div>
            <div class="stat-label">å½“å‰ä¸»é¢˜</div>
          </div>
        </div>

        <div class="demo-grid">
          <!-- ä¸»ç¼–è¾‘å™¨ -->
          <div class="demo-section">
            <h3>ğŸ“ ä¸»ç¼–è¾‘å™¨</h3>
            
            <div class="controls">
              <button class="btn" @click="executeCommand('bold')">åŠ ç²—</button>
              <button class="btn" @click="executeCommand('italic')">æ–œä½“</button>
              <button class="btn" @click="executeCommand('underline')">ä¸‹åˆ’çº¿</button>
              <button class="btn" @click="executeCommand('heading1')">H1</button>
              <button class="btn" @click="executeCommand('heading2')">H2</button>
              <button class="btn" @click="executeCommand('bulletList')">åˆ—è¡¨</button>
            </div>

            <div ref="mainEditor" class="editor-container"></div>

            <div class="controls">
              <button class="btn primary" @click="saveContent">ä¿å­˜å†…å®¹</button>
              <button class="btn" @click="clearContent">æ¸…ç©º</button>
              <button class="btn" @click="toggleReadonly">
                {{ isReadonly ? 'å–æ¶ˆåªè¯»' : 'è®¾ä¸ºåªè¯»' }}
              </button>
            </div>
          </div>

          <!-- è®¾ç½®é¢æ¿ -->
          <div class="demo-section">
            <h3>âš™ï¸ è®¾ç½®é¢æ¿</h3>
            
            <div class="form-group">
              <label>ä¸»é¢˜é€‰æ‹©</label>
              <select v-model="currentTheme" @change="changeTheme" class="form-control">
                <option value="default">é»˜è®¤ä¸»é¢˜</option>
                <option value="dark">æš—è‰²ä¸»é¢˜</option>
                <option value="minimal">ç®€æ´ä¸»é¢˜</option>
              </select>
            </div>

            <div class="form-group">
              <label>å ä½ç¬¦æ–‡æœ¬</label>
              <input 
                v-model="placeholder" 
                @input="updatePlaceholder"
                class="form-control" 
                placeholder="è¾“å…¥å ä½ç¬¦æ–‡æœ¬"
              >
            </div>

            <div class="form-group">
              <label>è‡ªåŠ¨ä¿å­˜</label>
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" v-model="autoSave" @change="toggleAutoSave">
                å¯ç”¨è‡ªåŠ¨ä¿å­˜ ({{ autoSaveInterval }}ç§’)
              </label>
            </div>

            <div class="form-group" v-if="autoSave">
              <label>ä¿å­˜é—´éš” (ç§’)</label>
              <input 
                type="range" 
                min="5" 
                max="60" 
                v-model="autoSaveInterval"
                class="form-control"
              >
            </div>
          </div>
        </div>

        <!-- å®æ—¶é¢„è§ˆ -->
        <div class="demo-section">
          <h3>ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</h3>
          
          <transition name="fade">
            <div v-if="content" class="output">
              {{ content }}
            </div>
            <div v-else class="output" style="color: #999; font-style: italic;">
              ç¼–è¾‘å™¨å†…å®¹ä¸ºç©º...
            </div>
          </transition>
        </div>

        <!-- å†å²è®°å½• -->
        <div class="demo-section" v-if="history.length > 0">
          <h3>ğŸ“š ç¼–è¾‘å†å²</h3>
          
          <div style="max-height: 200px; overflow-y: auto;">
            <transition-group name="slide" tag="div">
              <div 
                v-for="(item, index) in history.slice(-10)" 
                :key="item.id"
                style="padding: 8px; border-bottom: 1px solid #eee; font-size: 0.85rem;"
              >
                <strong>{{ item.timestamp }}</strong>: {{ item.action }}
                <button 
                  class="btn" 
                  style="float: right; padding: 2px 8px; font-size: 0.8rem;"
                  @click="restoreFromHistory(item)"
                >
                  æ¢å¤
                </button>
              </div>
            </transition-group>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, computed, onMounted, onUnmounted, watch, nextTick } = Vue

    // æ¨¡æ‹Ÿ LDesign Editor
    class VueLDesignEditor {
      constructor(options) {
        this.container = options.container
        this.content = options.content || ''
        this.readonly = options.readonly || false
        this.theme = options.theme || 'default'
        this.placeholder = options.placeholder || ''
        this.onChange = options.onChange
        this.onSelectionChange = options.onSelectionChange
        this.initialized = false
      }
      
      init() {
        if (this.initialized) return
        
        this.container.contentEditable = !this.readonly
        this.container.innerHTML = this.content || this.getDefaultContent()
        this.container.style.padding = '15px'
        this.container.style.outline = 'none'
        this.container.style.minHeight = '150px'
        
        this.bindEvents()
        this.updateTheme()
        this.initialized = true
      }
      
      getDefaultContent() {
        return `
          <h2>Vue é›†æˆç¤ºä¾‹</h2>
          <p>è¿™æ˜¯ä¸€ä¸ªä¸ Vue 3 é›†æˆçš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç¤ºä¾‹ã€‚</p>
          <ul>
            <li>æ”¯æŒå“åº”å¼æ•°æ®ç»‘å®š</li>
            <li>è‡ªåŠ¨åŒæ­¥ç¼–è¾‘å™¨çŠ¶æ€</li>
            <li>ç»„ä»¶åŒ–å°è£…</li>
          </ul>
          <p>å¼€å§‹ç¼–è¾‘å†…å®¹ï¼Œä½“éªŒ Vue çš„å“åº”å¼ç‰¹æ€§ï¼</p>
        `.trim()
      }
      
      bindEvents() {
        this.container.addEventListener('input', () => {
          this.content = this.container.innerHTML
          if (this.onChange) {
            this.onChange(this.content)
          }
        })
        
        this.container.addEventListener('selectionchange', () => {
          if (this.onSelectionChange) {
            this.onSelectionChange(window.getSelection())
          }
        })
      }
      
      updateTheme() {
        this.container.className = `editor-container ldesign-editor-theme-${this.theme}`
        
        if (this.theme === 'dark') {
          this.container.style.background = '#1a1a1a'
          this.container.style.color = 'white'
        } else if (this.theme === 'minimal') {
          this.container.style.background = '#fafafa'
          this.container.style.color = '#333'
        } else {
          this.container.style.background = 'white'
          this.container.style.color = '#333'
        }
      }
      
      setContent(content) {
        this.container.innerHTML = content
        this.content = content
        if (this.onChange) {
          this.onChange(content)
        }
      }
      
      getContent() {
        return this.container.innerHTML
      }
      
      setReadonly(readonly) {
        this.readonly = readonly
        this.container.contentEditable = !readonly
        this.container.style.backgroundColor = readonly ? '#f5f5f5' : 'white'
      }
      
      setTheme(theme) {
        this.theme = theme
        this.updateTheme()
      }
      
      executeCommand(command) {
        document.execCommand(command, false, null)
        if (this.onChange) {
          this.onChange(this.container.innerHTML)
        }
      }
      
      clear() {
        this.setContent('')
      }
      
      destroy() {
        if (this.container) {
          this.container.contentEditable = false
          this.container.innerHTML = ''
        }
      }
    }

    createApp({
      setup() {
        // å“åº”å¼æ•°æ®
        const content = ref('')
        const currentTheme = ref('default')
        const placeholder = ref('è¯·è¾“å…¥å†…å®¹...')
        const isReadonly = ref(false)
        const autoSave = ref(false)
        const autoSaveInterval = ref(10)
        const history = ref([])
        
        // ç¼–è¾‘å™¨å®ä¾‹
        const mainEditor = ref(null)
        let editorInstance = null
        let autoSaveTimer = null
        
        // è®¡ç®—å±æ€§
        const stats = computed(() => {
          const text = content.value.replace(/<[^>]*>/g, '') // ç§»é™¤HTMLæ ‡ç­¾
          const words = text.trim().split(/\s+/).filter(word => word.length > 0)
          const paragraphs = content.value.split(/<\/p>|<\/h[1-6]>|<\/li>/).filter(p => p.trim().length > 0)
          
          return {
            charCount: text.length,
            wordCount: words.length,
            paragraphCount: paragraphs.length
          }
        })
        
        // æ–¹æ³•
        const initEditor = () => {
          if (mainEditor.value) {
            editorInstance = new VueLDesignEditor({
              container: mainEditor.value,
              content: content.value,
              theme: currentTheme.value,
              placeholder: placeholder.value,
              readonly: isReadonly.value,
              onChange: (newContent) => {
                content.value = newContent
                addToHistory('å†…å®¹å˜æ›´')
              },
              onSelectionChange: (selection) => {
                // å¤„ç†é€‰åŒºå˜æ›´
              }
            })
            
            editorInstance.init()
          }
        }
        
        const executeCommand = (command) => {
          if (editorInstance) {
            editorInstance.executeCommand(command)
            addToHistory(`æ‰§è¡Œå‘½ä»¤: ${command}`)
          }
        }
        
        const changeTheme = () => {
          if (editorInstance) {
            editorInstance.setTheme(currentTheme.value)
            addToHistory(`åˆ‡æ¢ä¸»é¢˜: ${currentTheme.value}`)
          }
        }
        
        const updatePlaceholder = () => {
          addToHistory(`æ›´æ–°å ä½ç¬¦: ${placeholder.value}`)
        }
        
        const toggleReadonly = () => {
          isReadonly.value = !isReadonly.value
          if (editorInstance) {
            editorInstance.setReadonly(isReadonly.value)
            addToHistory(isReadonly.value ? 'è®¾ä¸ºåªè¯»' : 'å–æ¶ˆåªè¯»')
          }
        }
        
        const saveContent = () => {
          // æ¨¡æ‹Ÿä¿å­˜åˆ°æœåŠ¡å™¨
          console.log('ä¿å­˜å†…å®¹:', content.value)
          addToHistory('æ‰‹åŠ¨ä¿å­˜å†…å®¹')
          alert('å†…å®¹å·²ä¿å­˜ï¼')
        }
        
        const clearContent = () => {
          if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†…å®¹å—ï¼Ÿ')) {
            if (editorInstance) {
              editorInstance.clear()
              addToHistory('æ¸…ç©ºå†…å®¹')
            }
          }
        }
        
        const toggleAutoSave = () => {
          if (autoSave.value) {
            startAutoSave()
            addToHistory('å¯ç”¨è‡ªåŠ¨ä¿å­˜')
          } else {
            stopAutoSave()
            addToHistory('ç¦ç”¨è‡ªåŠ¨ä¿å­˜')
          }
        }
        
        const startAutoSave = () => {
          stopAutoSave() // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
          autoSaveTimer = setInterval(() => {
            if (content.value.trim()) {
              console.log('è‡ªåŠ¨ä¿å­˜:', content.value)
              addToHistory('è‡ªåŠ¨ä¿å­˜')
            }
          }, autoSaveInterval.value * 1000)
        }
        
        const stopAutoSave = () => {
          if (autoSaveTimer) {
            clearInterval(autoSaveTimer)
            autoSaveTimer = null
          }
        }
        
        const addToHistory = (action) => {
          const now = new Date()
          history.value.push({
            id: Date.now(),
            timestamp: now.toLocaleTimeString(),
            action: action,
            content: content.value
          })
          
          // é™åˆ¶å†å²è®°å½•æ•°é‡
          if (history.value.length > 50) {
            history.value = history.value.slice(-50)
          }
        }
        
        const restoreFromHistory = (item) => {
          if (confirm(`ç¡®å®šè¦æ¢å¤åˆ° ${item.timestamp} çš„çŠ¶æ€å—ï¼Ÿ`)) {
            content.value = item.content
            if (editorInstance) {
              editorInstance.setContent(item.content)
            }
            addToHistory(`æ¢å¤å†å²è®°å½•: ${item.timestamp}`)
          }
        }
        
        // ç›‘å¬å™¨
        watch(autoSaveInterval, () => {
          if (autoSave.value) {
            startAutoSave()
          }
        })
        
        // ç”Ÿå‘½å‘¨æœŸ
        onMounted(() => {
          nextTick(() => {
            initEditor()
            addToHistory('ç¼–è¾‘å™¨åˆå§‹åŒ–')
          })
        })
        
        onUnmounted(() => {
          if (editorInstance) {
            editorInstance.destroy()
          }
          stopAutoSave()
        })
        
        return {
          // æ•°æ®
          content,
          currentTheme,
          placeholder,
          isReadonly,
          autoSave,
          autoSaveInterval,
          history,
          stats,
          
          // å¼•ç”¨
          mainEditor,
          
          // æ–¹æ³•
          executeCommand,
          changeTheme,
          updatePlaceholder,
          toggleReadonly,
          saveContent,
          clearContent,
          toggleAutoSave,
          restoreFromHistory
        }
      }
    }).mount('#app')
  </script>
</body>
</html>
