<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDesign Rich Text Editor Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: #f8fafc;
            padding: 20px;
            line-height: 1.6;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            overflow: hidden;
        }

        .demo-header {
            padding: 24px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
        }

        .demo-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .demo-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .demo-content {
            padding: 24px;
        }

        .editor-container {
            margin-bottom: 24px;
        }

        .editor-label {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            display: block;
        }

        .demo-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .demo-button {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .demo-button:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }

        .demo-button.primary {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .demo-button.primary:hover {
            background: #2563eb;
            border-color: #2563eb;
        }

        .output-section {
            margin-top: 32px;
            padding-top: 32px;
            border-top: 1px solid #e5e7eb;
        }

        .output-content {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
            font-size: 13px;
            max-height: 300px;
            overflow: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        /* 深色主题样式 */
        [data-theme="dark"] {
            background: #1f2937;
            color: #f9fafb;
        }

        [data-theme="dark"] .demo-container {
            background: #374151;
        }

        [data-theme="dark"] .demo-content {
            color: #f9fafb;
        }

        [data-theme="dark"] .output-content {
            background: #1f2937;
            border-color: #4b5563;
            color: #e5e7eb;
        }

        /* 响应式样式 */
        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .demo-header {
                padding: 16px;
            }

            .demo-title {
                font-size: 24px;
            }

            .demo-content {
                padding: 16px;
            }

            .demo-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- 主题切换按钮 -->
    <button class="demo-button theme-toggle" onclick="toggleTheme()">🌓 切换主题</button>

    <div class="demo-container">
        <!-- 头部 -->
        <div class="demo-header">
            <h1 class="demo-title">LDesign Rich Text Editor</h1>
            <p class="demo-subtitle">功能完整的富文本编辑器，支持工具栏、插件系统、主题定制等特性</p>
        </div>

        <!-- 内容区域 -->
        <div class="demo-content">
            <!-- 主编辑器 -->
            <div class="editor-container">
                <label class="editor-label">富文本编辑器</label>
                <div id="editor"></div>
            </div>

            <!-- 操作按钮 -->
            <div class="demo-actions">
                <button class="demo-button primary" onclick="getContent()">获取内容</button>
                <button class="demo-button" onclick="setContent()">设置内容</button>
                <button class="demo-button" onclick="clearContent()">清空内容</button>
                <button class="demo-button" onclick="toggleReadonly()">切换只读</button>
                <button class="demo-button" onclick="focusEditor()">聚焦编辑器</button>
                <button class="demo-button" onclick="showShortcuts()">快捷键帮助</button>
                <button class="demo-button" onclick="testUndo()">测试撤销</button>
                <button class="demo-button" onclick="testRedo()">测试重做</button>
            </div>

            <!-- 输出区域 -->
            <div class="output-section">
                <label class="editor-label">HTML 输出</label>
                <div id="output" class="output-content">编辑器内容将显示在这里...</div>
            </div>
        </div>
    </div>

    <!-- 包含样式 -->
    <style>
        /* 这里会包含编辑器的CSS样式 - 在实际项目中应该作为外部文件引入 */
        
        /* CSS变量定义 */
        :root {
            /* 颜色变量 */
            --ldesign-editor-bg: #ffffff;
            --ldesign-editor-border: #e4e4e7;
            --ldesign-editor-text: #18181b;
            --ldesign-editor-text-secondary: #71717a;
            --ldesign-editor-primary: #3b82f6;
            --ldesign-editor-primary-hover: #2563eb;
            --ldesign-editor-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            --ldesign-editor-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);

            /* 工具栏变量 */
            --ldesign-toolbar-height: 48px;
            --ldesign-toolbar-bg: #fafafa;
            --ldesign-toolbar-border: #e4e4e7;
            --ldesign-toolbar-button-size: 32px;
            --ldesign-toolbar-button-radius: 4px;
            --ldesign-toolbar-button-hover: #f4f4f5;
            --ldesign-toolbar-button-active: #3b82f6;
            --ldesign-toolbar-button-active-bg: #eff6ff;

            /* 内容区域变量 */
            --ldesign-content-padding: 16px;
            --ldesign-content-min-height: 300px;
            --ldesign-content-font-size: 14px;
            --ldesign-content-line-height: 1.5;

            --ldesign-transition: all 0.2s ease-in-out;
        }

        /* 主容器样式 */
        .ldesign-editor {
            position: relative;
            width: 100%;
            min-height: var(--ldesign-content-min-height);
            background: var(--ldesign-editor-bg);
            border: 1px solid var(--ldesign-editor-border);
            border-radius: 8px;
            font-family: inherit;
            font-size: var(--ldesign-content-font-size);
            line-height: var(--ldesign-content-line-height);
            color: var(--ldesign-editor-text);
            box-shadow: var(--ldesign-editor-shadow);
            transition: var(--ldesign-transition);
        }

        .ldesign-editor:focus-within {
            border-color: var(--ldesign-editor-primary);
            box-shadow: var(--ldesign-editor-shadow-lg);
        }

        /* 工具栏样式 */
        .ldesign-editor-toolbar {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            background: var(--ldesign-toolbar-bg);
            border-bottom: 1px solid var(--ldesign-toolbar-border);
            border-radius: 8px 8px 0 0;
            min-height: var(--ldesign-toolbar-height);
            flex-wrap: wrap;
        }

        /* 工具栏按钮样式 */
        .ldesign-editor-toolbar-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: var(--ldesign-toolbar-button-size);
            height: var(--ldesign-toolbar-button-size);
            padding: 0;
            border: none;
            border-radius: var(--ldesign-toolbar-button-radius);
            background: transparent;
            color: var(--ldesign-editor-text);
            cursor: pointer;
            transition: var(--ldesign-transition);
            font-size: 0;
            outline: none;
        }

        .ldesign-editor-toolbar-button:hover {
            background: var(--ldesign-toolbar-button-hover);
        }

        .ldesign-editor-toolbar-button:focus {
            box-shadow: 0 0 0 2px var(--ldesign-editor-primary);
        }

        .ldesign-editor-toolbar-button-active {
            background: var(--ldesign-toolbar-button-active-bg);
            color: var(--ldesign-toolbar-button-active);
        }

        /* 工具栏分隔符 */
        .ldesign-editor-toolbar-separator {
            width: 1px;
            height: 20px;
            background: var(--ldesign-toolbar-border);
            margin: 0 4px;
        }

        /* 图标样式 */
        .ldesign-editor-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
        }

        .ldesign-editor-icon svg {
            width: 100%;
            height: 100%;
            color: currentColor;
        }

        /* 内容区域样式 */
        .ldesign-editor-content {
            padding: var(--ldesign-content-padding);
            min-height: var(--ldesign-content-min-height);
            outline: none;
            border: none;
            background: transparent;
            font-size: var(--ldesign-content-font-size);
            line-height: var(--ldesign-content-line-height);
            color: var(--ldesign-editor-text);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .ldesign-editor-content:focus {
            outline: none;
        }

        /* 占位符样式 */
        .ldesign-editor-content[data-placeholder]:empty::before {
            content: attr(data-placeholder);
            color: var(--ldesign-editor-text-secondary);
            pointer-events: none;
        }

        /* 内容元素样式 */
        .ldesign-editor-content h1, .ldesign-editor-content h2, 
        .ldesign-editor-content h3, .ldesign-editor-content h4, 
        .ldesign-editor-content h5, .ldesign-editor-content h6 {
            margin: 16px 0 8px 0;
            font-weight: 600;
            line-height: 1.3;
        }

        .ldesign-editor-content h1 { font-size: 28px; }
        .ldesign-editor-content h2 { font-size: 24px; }
        .ldesign-editor-content h3 { font-size: 20px; }
        .ldesign-editor-content h4 { font-size: 18px; }
        .ldesign-editor-content h5 { font-size: 16px; }
        .ldesign-editor-content h6 { font-size: 14px; }

        .ldesign-editor-content p {
            margin: 8px 0;
            line-height: 1.6;
        }

        .ldesign-editor-content ul, .ldesign-editor-content ol {
            margin: 8px 0;
            padding-left: 24px;
        }

        .ldesign-editor-content li {
            margin: 4px 0;
            line-height: 1.5;
        }

        .ldesign-editor-content blockquote {
            margin: 16px 0;
            padding: 12px 16px;
            border-left: 4px solid var(--ldesign-editor-primary);
            background: rgba(59, 130, 246, 0.05);
            color: var(--ldesign-editor-text-secondary);
            font-style: italic;
            border-radius: 0 4px 4px 0;
        }

        .ldesign-editor-content code {
            display: inline;
            padding: 2px 4px;
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid var(--ldesign-editor-border);
            border-radius: 3px;
            font-family: 'SF Mono', monospace;
            font-size: 0.9em;
            color: #d63384;
        }

        .ldesign-editor-content a {
            color: var(--ldesign-editor-primary);
            text-decoration: underline;
        }

        .ldesign-editor-content mark {
            background: #fef08a;
            padding: 0 2px;
            border-radius: 2px;
        }

        .ldesign-editor-readonly {
            background: #f9fafb;
            cursor: not-allowed;
        }
    </style>

    <script>
        // 模拟编辑器类 - 在实际项目中应该导入真实的编辑器
        class LDesignEditor {
            constructor(options) {
                this.container = typeof options.container === 'string' 
                    ? document.querySelector(options.container) 
                    : options.container;
                this.options = {
                    ...options,
                    content: options.content || '',
                    placeholder: options.placeholder || '开始写作...',
                    readonly: options.readonly || false
                };
                this.initialized = false;
                this.readonly = this.options.readonly;
                this.contentElement = null;
                this.toolbarElement = null;
            }

            init() {
                if (this.initialized) return;
                
                this.setupContainer();
                this.createToolbar();
                this.createContentArea();
                this.bindEvents();
                this.setContent(this.options.content);
                
                this.initialized = true;
            }

            setupContainer() {
                this.container.className = 'ldesign-editor';
                if (this.readonly) {
                    this.container.classList.add('ldesign-editor-readonly');
                }
            }

            createToolbar() {
                this.toolbarElement = document.createElement('div');
                this.toolbarElement.className = 'ldesign-editor-toolbar';
                
                const buttons = [
                    { name: 'bold', icon: 'B', title: '粗体', command: 'bold' },
                    { name: 'italic', icon: 'I', title: '斜体', command: 'italic' },
                    { name: 'underline', icon: 'U', title: '下划线', command: 'underline' },
                    { type: 'separator' },
                    { name: 'strikethrough', icon: 'S', title: '删除线', command: 'strikeThrough' },
                    { type: 'separator' },
                    { name: 'alignLeft', icon: '⟵', title: '左对齐', command: 'justifyLeft' },
                    { name: 'alignCenter', icon: '⟷', title: '居中', command: 'justifyCenter' },
                    { name: 'alignRight', icon: '⟶', title: '右对齐', command: 'justifyRight' },
                    { type: 'separator' },
                    { name: 'bulletList', icon: '•', title: '无序列表', command: 'insertUnorderedList' },
                    { name: 'numberedList', icon: '1.', title: '有序列表', command: 'insertOrderedList' },
                ];

                buttons.forEach(item => {
                    if (item.type === 'separator') {
                        const separator = document.createElement('div');
                        separator.className = 'ldesign-editor-toolbar-separator';
                        this.toolbarElement.appendChild(separator);
                    } else {
                        const button = document.createElement('button');
                        button.className = 'ldesign-editor-toolbar-button';
                        button.title = item.title;
                        button.innerHTML = `<span class="ldesign-editor-icon">${item.icon}</span>`;
                        button.onclick = () => this.executeCommand(item.command);
                        this.toolbarElement.appendChild(button);
                    }
                });

                this.container.appendChild(this.toolbarElement);
            }

            createContentArea() {
                this.contentElement = document.createElement('div');
                this.contentElement.className = 'ldesign-editor-content';
                this.contentElement.contentEditable = this.readonly ? 'false' : 'true';
                this.contentElement.setAttribute('data-placeholder', this.options.placeholder);
                this.container.appendChild(this.contentElement);
            }

            bindEvents() {
                this.contentElement.addEventListener('input', () => {
                    if (this.options.onChange) {
                        this.options.onChange(this.getContent());
                    }
                });

                this.contentElement.addEventListener('focus', () => {
                    if (this.options.onFocus) {
                        this.options.onFocus();
                    }
                });

                this.contentElement.addEventListener('blur', () => {
                    if (this.options.onBlur) {
                        this.options.onBlur();
                    }
                });

                // 更新工具栏状态
                this.contentElement.addEventListener('selectionchange', () => {
                    this.updateToolbarState();
                });

                document.addEventListener('selectionchange', () => {
                    if (document.activeElement === this.contentElement) {
                        this.updateToolbarState();
                    }
                });
            }

            updateToolbarState() {
                const buttons = this.toolbarElement.querySelectorAll('.ldesign-editor-toolbar-button');
                buttons.forEach((button, index) => {
                    const commands = ['bold', 'italic', 'underline', '', 'strikeThrough', '', 'justifyLeft', 'justifyCenter', 'justifyRight', '', 'insertUnorderedList', 'insertOrderedList'];
                    const command = commands[index];
                    if (command) {
                        try {
                            if (document.queryCommandState(command)) {
                                button.classList.add('ldesign-editor-toolbar-button-active');
                            } else {
                                button.classList.remove('ldesign-editor-toolbar-button-active');
                            }
                        } catch (e) {
                            // 忽略不支持的命令
                        }
                    }
                });
            }

            executeCommand(command) {
                if (this.readonly) return;
                
                document.execCommand(command, false, null);
                this.contentElement.focus();
                this.updateToolbarState();
                
                if (this.options.onChange) {
                    this.options.onChange(this.getContent());
                }
            }

            getContent() {
                return this.contentElement ? this.contentElement.innerHTML : '';
            }

            setContent(content) {
                if (this.contentElement) {
                    this.contentElement.innerHTML = content;
                    if (this.options.onChange) {
                        this.options.onChange(content);
                    }
                }
            }

            clear() {
                this.setContent('');
            }

            focus() {
                if (this.contentElement) {
                    this.contentElement.focus();
                }
            }

            blur() {
                if (this.contentElement) {
                    this.contentElement.blur();
                }
            }

            setReadonly(readonly) {
                this.readonly = readonly;
                if (this.contentElement) {
                    this.contentElement.contentEditable = readonly ? 'false' : 'true';
                }
                if (readonly) {
                    this.container.classList.add('ldesign-editor-readonly');
                } else {
                    this.container.classList.remove('ldesign-editor-readonly');
                }
            }

            destroy() {
                if (this.container) {
                    this.container.innerHTML = '';
                    this.container.className = '';
                }
                this.initialized = false;
                this.contentElement = null;
                this.toolbarElement = null;
            }
        }

        // 编辑器实例
        let editor;

        // 初始化编辑器
        function initEditor() {
            editor = new LDesignEditor({
                container: '#editor',
                content: `
                    <h2>欢迎使用 LDesign Rich Text Editor!</h2>
                    <p>这是一个功能强大的富文本编辑器，支持多种格式化选项：</p>
                    <ul>
                        <li><strong>粗体文本</strong></li>
                        <li><em>斜体文本</em></li>
                        <li><u>下划线文本</u></li>
                        <li><s>删除线文本</s></li>
                    </ul>
                    <blockquote>
                        <p>你也可以创建引用块来突出显示重要内容。</p>
                    </blockquote>
                    <p>试试不同的文本对齐方式和列表功能！</p>
                `,
                placeholder: '开始写作...',
                onChange: function(content) {
                    updateOutput(content);
                },
                onFocus: function() {
                    console.log('Editor focused');
                },
                onBlur: function() {
                    console.log('Editor blurred');
                }
            });
            
            editor.init();
        }

        // 更新输出
        function updateOutput(content) {
            const output = document.getElementById('output');
            if (output) {
                output.textContent = content;
            }
        }

        // 获取内容
        function getContent() {
            if (editor) {
                const content = editor.getContent();
                alert('编辑器内容已复制到输出区域');
                updateOutput(content);
            }
        }

        // 设置内容
        function setContent() {
            if (editor) {
                const sampleContent = `
                    <h1>示例内容</h1>
                    <p>这是通过 JavaScript 设置的内容。</p>
                    <p>包含 <strong>粗体</strong>、<em>斜体</em> 和 <code>代码</code> 等格式。</p>
                    <ol>
                        <li>有序列表项 1</li>
                        <li>有序列表项 2</li>
                        <li>有序列表项 3</li>
                    </ol>
                `;
                editor.setContent(sampleContent);
            }
        }

        // 清空内容
        function clearContent() {
            if (editor) {
                editor.clear();
            }
        }

        // 切换只读模式
        function toggleReadonly() {
            if (editor) {
                editor.setReadonly(!editor.readonly);
                const button = event.target;
                button.textContent = editor.readonly ? '取消只读' : '切换只读';
            }
        }

        // 聚焦编辑器
        function focusEditor() {
            if (editor) {
                editor.focus();
            }
        }

        // 快捷键帮助
        function showShortcuts() {
            const shortcuts = [
                'Ctrl+B: 粗体',
                'Ctrl+I: 斜体',
                'Ctrl+U: 下划线',
                'Ctrl+Z: 撤销',
                'Ctrl+Y: 重做',
                'Ctrl+A: 全选',
                'Ctrl+C: 复制',
                'Ctrl+V: 粘贴',
                'Ctrl+Shift+L: 左对齐',
                'Ctrl+Shift+E: 居中对齐',
                'Ctrl+Shift+R: 右对齐',
                'Ctrl+1-6: 标题1-6',
                'Ctrl+`: 内联代码',
                'F11: 全屏模式'
            ];
            
            alert('常用快捷键:\n\n' + shortcuts.join('\n'));
        }

        // 测试撤销
        function testUndo() {
            if (editor && editor.history) {
                editor.history.undo();
                console.log('Undo executed');
            } else {
                alert('历史管理器不可用');
            }
        }

        // 测试重做
        function testRedo() {
            if (editor && editor.history) {
                editor.history.redo();
                console.log('Redo executed');
            } else {
                alert('历史管理器不可用');
            }
        }

        // 切换主题
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 恢复主题
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            // 初始化编辑器
            initEditor();
        });
    </script>
</body>
</html>
