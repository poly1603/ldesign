# @ldesign/engine ğŸš€

ä¸€ä¸ªç°ä»£åŒ–ã€åŠŸèƒ½ä¸°å¯Œçš„ Vue 3 åº”ç”¨ç¨‹åºå¼•æ“ï¼Œä¸ºä¼ä¸šçº§åº”ç”¨æä¾›å®Œæ•´çš„åŸºç¡€è®¾æ–½æ”¯æŒã€‚

## âœ¨ ç‰¹æ€§äº®ç‚¹

### ğŸ—ï¸ æ ¸å¿ƒæ¶æ„
- ğŸ”Œ **æ’ä»¶ç³»ç»Ÿ** - æ¨¡å—åŒ–æ¶æ„ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½å’Œçƒ­æ’æ‹”
- âš¡ **ä¸­é—´ä»¶ç³»ç»Ÿ** - çµæ´»çš„ç®¡é“å¤„ç†æœºåˆ¶ï¼Œæ”¯æŒè¯·æ±‚/å“åº”æ‹¦æˆª
- ğŸ“¡ **äº‹ä»¶ç³»ç»Ÿ** - å¼ºå¤§çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œæ”¯æŒå¼‚æ­¥äº‹ä»¶å¤„ç†
- ğŸ’¾ **çŠ¶æ€ç®¡ç†** - å“åº”å¼çŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒæŒä¹…åŒ–å’Œæ—¶é—´æ—…è¡Œ
- ğŸ“ **æ—¥å¿—ç³»ç»Ÿ** - å¤šçº§åˆ«æ—¥å¿—è®°å½•ï¼Œæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼å’Œå­˜å‚¨æ–¹å¼
- ğŸ”” **é€šçŸ¥ç³»ç»Ÿ** - å…¨å±€é€šçŸ¥ç®¡ç†ï¼Œæ”¯æŒå¤šç§é€šçŸ¥ç±»å‹å’Œè‡ªå®šä¹‰æ ·å¼

### ğŸ›¡ï¸ å®‰å…¨ä¸æ€§èƒ½
- ğŸ”’ **å®‰å…¨ç®¡ç†** - å®Œæ•´çš„å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼ŒåŒ…æ‹¬ XSS é˜²æŠ¤ã€è¾“å…¥æ¸…ç†ã€URL éªŒè¯
- âš¡ **æ€§èƒ½ç›‘æ§** - å®æ—¶æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–å»ºè®®ï¼ŒåŒ…æ‹¬å†…å­˜ä½¿ç”¨ã€å“åº”æ—¶é—´ç­‰æŒ‡æ ‡
- ğŸ’¾ **ç¼“å­˜ç®¡ç†** - æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§ç¼“å­˜ç­–ç•¥å’Œè‡ªåŠ¨è¿‡æœŸç®¡ç†
- ğŸ¯ **æŒ‡ä»¤ç³»ç»Ÿ** - ä¸°å¯Œçš„è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œæ‰©å±• Vue çš„æŒ‡ä»¤åŠŸèƒ½
- ğŸš¨ **é”™è¯¯å¤„ç†** - å…¨é¢çš„é”™è¯¯æ•è·å’Œå¤„ç†æœºåˆ¶ï¼ŒåŒ…æ‹¬é”™è¯¯æ¢å¤å’Œæ™ºèƒ½ä¸ŠæŠ¥

### ğŸ¨ å¼€å‘ä½“éªŒ
- ğŸ“š **å®Œæ•´æ–‡æ¡£** - è¯¦ç»†çš„ API æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—
- ğŸ§ª **ç¤ºä¾‹é¡¹ç›®** - ä¸°å¯Œçš„æ¼”ç¤ºé¡µé¢ï¼Œå±•ç¤ºæ‰€æœ‰åŠŸèƒ½ç‰¹æ€§
- ğŸ”§ **TypeScript** - å®Œæ•´çš„ç±»å‹æ”¯æŒï¼Œæä¾›ä¼˜ç§€çš„å¼€å‘ä½“éªŒ
- ğŸ§ª **æµ‹è¯•è¦†ç›–** - å…¨é¢çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ğŸ“¦ **æ¨¡å—åŒ–è®¾è®¡** - å¯æŒ‰éœ€å¼•å…¥ï¼Œæ”¯æŒ Tree Shaking

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
# ä½¿ç”¨ pnpm (æ¨è)
pnpm add @ldesign/engine

# ä½¿ç”¨ npm
npm install @ldesign/engine

# ä½¿ç”¨ yarn
yarn add @ldesign/engine
```

### åŸºç¡€ä½¿ç”¨

```typescript
import { createApp } from 'vue'
import { createEngine } from '@ldesign/engine'
import App from './App.vue'

// åˆ›å»º Vue åº”ç”¨
const app = createApp(App)

// åˆ›å»ºå¼•æ“å®ä¾‹
const engine = createEngine({
  // æ’ä»¶é…ç½®
  plugins: {
    // å¯ç”¨å†…ç½®æ’ä»¶
    logger: true,
    notifications: true,
    cache: true,
  },
  
  // å®‰å…¨é…ç½®
  security: {
    sanitizeInput: true,
    validateUrls: true,
  },
  
  // æ€§èƒ½é…ç½®
  performance: {
    enabled: true,
    autoOptimization: true,
  }
})

// å®‰è£…å¼•æ“
app.use(engine)

// æŒ‚è½½åº”ç”¨
app.mount('#app')
```

### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <div class="my-component">
    <h1>{{ title }}</h1>
    <button @click="handleClick">ç‚¹å‡»æˆ‘</button>
    
    <!-- ä½¿ç”¨å†…ç½®æŒ‡ä»¤ -->
    <input v-debounce="handleInput" placeholder="é˜²æŠ–è¾“å…¥" />
    <div v-loading="isLoading">åŠ è½½ä¸­...</div>
  </div>
</template>

<script setup lang="ts">
import { inject, ref } from 'vue'
import type { Engine } from '@ldesign/engine'

// æ³¨å…¥å¼•æ“å®ä¾‹
const engine = inject<Engine>('engine')!

const title = ref('Hello Engine!')
const isLoading = ref(false)

// ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿ
function handleClick() {
  engine.logger.info('æŒ‰é’®è¢«ç‚¹å‡»äº†')
  
  // æ˜¾ç¤ºé€šçŸ¥
  engine.notifications.show({
    type: 'success',
    title: 'æ“ä½œæˆåŠŸ',
    message: 'æŒ‰é’®ç‚¹å‡»äº‹ä»¶å·²å¤„ç†',
    duration: 3000
  })
  
  // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
  engine.events.emit('button:clicked', { timestamp: Date.now() })
}

// ä½¿ç”¨é˜²æŠ–å¤„ç†
function handleInput(value: string) {
  engine.logger.debug('è¾“å…¥å†…å®¹:', value)
  
  // ä½¿ç”¨ç¼“å­˜
  engine.cache.set('user-input', value, 60000) // ç¼“å­˜1åˆ†é’Ÿ
}

// ç›‘å¬äº‹ä»¶
engine.events.on('button:clicked', (data) => {
  console.log('æ”¶åˆ°æŒ‰é’®ç‚¹å‡»äº‹ä»¶:', data)
})
</script>
```

## ğŸ“š æ ¸å¿ƒåŠŸèƒ½

### ğŸ”Œ æ’ä»¶ç³»ç»Ÿ

```typescript
// åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶
const myPlugin = {
  name: 'my-plugin',
  version: '1.0.0',
  
  install(engine) {
    // æ’ä»¶å®‰è£…é€»è¾‘
    engine.logger.info('æˆ‘çš„æ’ä»¶å·²å®‰è£…')
  },
  
  uninstall(engine) {
    // æ’ä»¶å¸è½½é€»è¾‘
    engine.logger.info('æˆ‘çš„æ’ä»¶å·²å¸è½½')
  }
}

// æ³¨å†Œæ’ä»¶
engine.plugins.register(myPlugin)

// å¯ç”¨æ’ä»¶
engine.plugins.enable('my-plugin')
```

### ğŸ“¡ äº‹ä»¶ç³»ç»Ÿ

```typescript
// ç›‘å¬äº‹ä»¶
engine.events.on('user:login', (user) => {
  console.log('ç”¨æˆ·ç™»å½•:', user)
})

// è§¦å‘äº‹ä»¶
engine.events.emit('user:login', { id: 1, name: 'Alice' })

// ä¸€æ¬¡æ€§ç›‘å¬
engine.events.once('app:ready', () => {
  console.log('åº”ç”¨å·²å‡†å¤‡å°±ç»ª')
})

// ç§»é™¤ç›‘å¬å™¨
const unsubscribe = engine.events.on('data:update', handler)
unsubscribe() // ç§»é™¤ç›‘å¬
```

### ğŸ’¾ çŠ¶æ€ç®¡ç†

```typescript
// è®¾ç½®çŠ¶æ€
engine.state.set('user.profile', {
  name: 'Alice',
  email: 'alice@example.com'
})

// è·å–çŠ¶æ€
const profile = engine.state.get('user.profile')

// ç›‘å¬çŠ¶æ€å˜åŒ–
engine.state.watch('user.profile', (newValue, oldValue) => {
  console.log('ç”¨æˆ·èµ„æ–™å·²æ›´æ–°:', newValue)
})

// æ‰¹é‡æ›´æ–°
engine.state.batch(() => {
  engine.state.set('user.name', 'Bob')
  engine.state.set('user.age', 30)
})
```

### ğŸ”’ å®‰å…¨ç®¡ç†

```typescript
// è¾“å…¥æ¸…ç†
const cleanInput = engine.security.sanitizeInput('<script>alert("xss")</script>Hello')
// ç»“æœ: 'Hello'

// HTML æ¸…ç†
const cleanHtml = engine.security.sanitizeHtml('<div>Safe</div><script>alert("xss")</script>')
// ç»“æœ: '<div>Safe</div>'

// URL éªŒè¯
const isValidUrl = engine.security.validateUrl('https://example.com')
// ç»“æœ: true

const isMaliciousUrl = engine.security.validateUrl('javascript:alert("xss")')
// ç»“æœ: false
```

### âš¡ æ€§èƒ½ç›‘æ§

```typescript
// å¼€å§‹æ€§èƒ½ç›‘æ§
engine.performance.startMonitoring()

// æ·»åŠ æ€§èƒ½æ ‡è®°
engine.performance.mark('operation-start')
await someAsyncOperation()
engine.performance.mark('operation-end')

// æµ‹é‡æ€§èƒ½
engine.performance.measure('operation-duration', 'operation-start', 'operation-end')

// è·å–æ€§èƒ½æ•°æ®
const metrics = engine.performance.getMetrics()
console.log('æ€§èƒ½æŒ‡æ ‡:', metrics)
```

## ğŸ¯ é«˜çº§åŠŸèƒ½

### ç¼“å­˜ç®¡ç†

```typescript
// åŸºç¡€ç¼“å­˜
engine.cache.set('user:123', userData, 3600000) // ç¼“å­˜1å°æ—¶
const user = engine.cache.get('user:123')

// å‘½åç©ºé—´ç¼“å­˜
const userCache = engine.cache.namespace('users')
userCache.set('123', userData)

// ç¼“å­˜ç­–ç•¥
engine.cache.setStrategy('api-data', {
  maxSize: 1000,
  defaultTTL: 300000,
  evictionPolicy: 'lru'
})
```

### æŒ‡ä»¤ç³»ç»Ÿ

```vue
<template>
  <!-- é˜²æŠ–ç‚¹å‡» -->
  <button v-click.debounce="handleClick">é˜²æŠ–ç‚¹å‡»</button>
  
  <!-- å·¥å…·æç¤º -->
  <span v-tooltip="'è¿™æ˜¯æç¤ºä¿¡æ¯'">æ‚¬åœæŸ¥çœ‹</span>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <div v-loading="isLoading">å†…å®¹åŒºåŸŸ</div>
  
  <!-- æ‹–æ‹½åŠŸèƒ½ -->
  <div v-drag="handleDrag">æ‹–æ‹½æˆ‘</div>
</template>
```

### é”™è¯¯å¤„ç†

```typescript
// å…¨å±€é”™è¯¯å¤„ç†
engine.errors.onError((error, context) => {
  console.error('æ•è·åˆ°é”™è¯¯:', error)
  
  // é”™è¯¯ä¸ŠæŠ¥
  engine.errors.reportError(error, context)
})

// é”™è¯¯æ¢å¤ç­–ç•¥
engine.errors.setRecoveryStrategy('NetworkError', async (error, context) => {
  if (context.retryCount < 3) {
    return { retry: true }
  }
  return { retry: false, fallback: () => showOfflineMessage() }
})
```

## ğŸ“– æ–‡æ¡£ä¸ç¤ºä¾‹

### ğŸ“š å®Œæ•´æ–‡æ¡£
- [å¿«é€Ÿå¼€å§‹](./docs/guide/quick-start.md)
- [æ ¸å¿ƒæ¦‚å¿µ](./docs/guide/getting-started.md)
- [API å‚è€ƒ](./docs/api/)
- [æœ€ä½³å®è·µ](./docs/examples/)

### ğŸ§ª åœ¨çº¿æ¼”ç¤º
è¿è¡Œç¤ºä¾‹é¡¹ç›®æŸ¥çœ‹æ‰€æœ‰åŠŸèƒ½çš„å®é™…æ•ˆæœï¼š

```bash
cd packages/engine/example
pnpm install
pnpm run dev
```

è®¿é—® `http://localhost:5173` æŸ¥çœ‹æ¼”ç¤ºé¡µé¢ï¼ŒåŒ…æ‹¬ï¼š
- ğŸ  **ä¸»é¡µ** - åŠŸèƒ½æ¦‚è§ˆå’Œå¿«é€Ÿå¯¼èˆª
- ğŸ”Œ **æ’ä»¶ç³»ç»Ÿæ¼”ç¤º** - æ’ä»¶çš„æ³¨å†Œã€å¯ç”¨ã€ç¦ç”¨
- ğŸ“¡ **äº‹ä»¶ç³»ç»Ÿæ¼”ç¤º** - äº‹ä»¶çš„å‘å¸ƒã€è®¢é˜…ã€ç®¡ç†
- ğŸ’¾ **çŠ¶æ€ç®¡ç†æ¼”ç¤º** - çŠ¶æ€çš„è®¾ç½®ã€è·å–ã€ç›‘å¬
- âš¡ **ä¸­é—´ä»¶æ¼”ç¤º** - ä¸­é—´ä»¶çš„æ³¨å†Œå’Œæ‰§è¡Œ
- ğŸ“ **æ—¥å¿—ç³»ç»Ÿæ¼”ç¤º** - ä¸åŒçº§åˆ«çš„æ—¥å¿—è®°å½•
- ğŸ”” **é€šçŸ¥ç³»ç»Ÿæ¼”ç¤º** - å„ç§ç±»å‹çš„é€šçŸ¥å±•ç¤º
- ğŸ”’ **å®‰å…¨ç®¡ç†æ¼”ç¤º** - è¾“å…¥æ¸…ç†å’Œå®‰å…¨éªŒè¯
- âš¡ **æ€§èƒ½ç›‘æ§æ¼”ç¤º** - å®æ—¶æ€§èƒ½æ•°æ®å±•ç¤º
- ğŸ’¾ **ç¼“å­˜ç®¡ç†æ¼”ç¤º** - ç¼“å­˜çš„è®¾ç½®ã€è·å–ã€ç®¡ç†
- ğŸ¯ **æŒ‡ä»¤ç³»ç»Ÿæ¼”ç¤º** - è‡ªå®šä¹‰æŒ‡ä»¤çš„ä½¿ç”¨
- ğŸš¨ **é”™è¯¯å¤„ç†æ¼”ç¤º** - é”™è¯¯æ•è·å’Œå¤„ç†æœºåˆ¶

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16
- pnpm >= 7
- Vue >= 3.3

### å¼€å‘å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¼€å‘æ¨¡å¼ (ç›‘å¬æ–‡ä»¶å˜åŒ–)
pnpm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm run build

# è¿è¡Œæµ‹è¯•
pnpm run test

# æµ‹è¯•è¦†ç›–ç‡
pnpm run test:coverage

# ä»£ç æ£€æŸ¥
pnpm run lint

# ä»£ç æ ¼å¼åŒ–
pnpm run format

# æ–‡æ¡£å¼€å‘æœåŠ¡å™¨
pnpm run docs:dev

# æ„å»ºæ–‡æ¡£
pnpm run docs:build

# ç¤ºä¾‹é¡¹ç›®å¼€å‘
cd example && pnpm run dev
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT](./LICENSE) è®¸å¯è¯ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

---

<div align="center">
  <p>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸</p>
  <p>Made with â¤ï¸ by LDesign Team</p>
</div>
