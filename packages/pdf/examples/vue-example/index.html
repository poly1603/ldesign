<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Vue 3 PDF Viewer Example - åŸºäº @ldesign/pdf çš„ Vue 3 PDF æŸ¥çœ‹å™¨ç¤ºä¾‹" />
  <meta name="keywords" content="Vue 3, PDF Viewer, TypeScript, Composition API, PDF, æ–‡æ¡£æŸ¥çœ‹å™¨" />
  <meta name="author" content="LDesign Team" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Vue 3 PDF Viewer Example" />
  <meta property="og:description" content="åŸºäº @ldesign/pdf çš„ Vue 3 PDF æŸ¥çœ‹å™¨ç¤ºä¾‹" />
  <meta property="og:image" content="/og-image.png" />
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:title" content="Vue 3 PDF Viewer Example" />
  <meta property="twitter:description" content="åŸºäº @ldesign/pdf çš„ Vue 3 PDF æŸ¥çœ‹å™¨ç¤ºä¾‹" />
  <meta property="twitter:image" content="/og-image.png" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  
  <!-- Theme color -->
  <meta name="theme-color" content="#1976d2" />
  <meta name="msapplication-TileColor" content="#1976d2" />
  
  <!-- PWA manifest -->
  <link rel="manifest" href="/manifest.json" />
  
  <title>Vue 3 PDF Viewer Example</title>
  
  <!-- å†…è”æ ·å¼ - åŠ è½½æŒ‡ç¤ºå™¨ -->
  <style>
    /* åŠ è½½æŒ‡ç¤ºå™¨æ ·å¼ */
    #app-loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: white;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    #app-loading.hidden {
      opacity: 0;
      visibility: hidden;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    .loading-text {
      font-size: 18px;
      font-weight: 500;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .loading-subtitle {
      font-size: 14px;
      opacity: 0.8;
      text-align: center;
      max-width: 300px;
      line-height: 1.5;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* é”™è¯¯é¡µé¢æ ·å¼ */
    .error-page {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #f5f5f5;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: #333;
      text-align: center;
      padding: 20px;
      z-index: 9998;
    }
    
    .error-icon {
      font-size: 64px;
      margin-bottom: 20px;
      color: #f44336;
    }
    
    .error-title {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #333;
    }
    
    .error-message {
      font-size: 16px;
      color: #666;
      margin-bottom: 30px;
      max-width: 500px;
      line-height: 1.5;
    }
    
    .error-actions {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .error-button {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .error-button.primary {
      background: #1976d2;
      color: white;
    }
    
    .error-button.primary:hover {
      background: #1565c0;
      transform: translateY(-1px);
    }
    
    .error-button.secondary {
      background: #e0e0e0;
      color: #333;
    }
    
    .error-button.secondary:hover {
      background: #d0d0d0;
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 640px) {
      .loading-text {
        font-size: 16px;
      }
      
      .loading-subtitle {
        font-size: 12px;
      }
      
      .error-title {
        font-size: 20px;
      }
      
      .error-message {
        font-size: 14px;
      }
      
      .error-actions {
        flex-direction: column;
        align-items: center;
      }
      
      .error-button {
        width: 200px;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- Vue åº”ç”¨æŒ‚è½½ç‚¹ -->
  <div id="app"></div>
  
  <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
  <div id="app-loading">
    <div class="loading-spinner"></div>
    <div class="loading-text">æ­£åœ¨åŠ è½½ Vue PDF Viewer</div>
    <div class="loading-subtitle">åŸºäº Vue 3 + Composition API + TypeScript æ„å»º</div>
  </div>
  
  <!-- é”™è¯¯é¡µé¢ -->
  <div id="error-page" class="error-page">
    <div class="error-icon">âš ï¸</div>
    <h1 class="error-title">åº”ç”¨åŠ è½½å¤±è´¥</h1>
    <p class="error-message">å¾ˆæŠ±æ­‰ï¼ŒVue PDF Viewer åº”ç”¨æ— æ³•æ­£å¸¸åŠ è½½ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç½‘ç»œé—®é¢˜ã€æµè§ˆå™¨å…¼å®¹æ€§æˆ–å…¶ä»–æŠ€æœ¯é—®é¢˜å¯¼è‡´çš„ã€‚</p>
    <div class="error-actions">
      <button class="error-button primary" onclick="window.location.reload()">
        ğŸ”„ é‡æ–°åŠ è½½
      </button>
      <button class="error-button secondary" onclick="window.history.back()">
        â† è¿”å›ä¸Šé¡µ
      </button>
      <a href="https://github.com/ldesign-team/pdf" class="error-button secondary" target="_blank">
        ğŸ“– æŸ¥çœ‹æ–‡æ¡£
      </a>
    </div>
  </div>
  
  <!-- Vue åº”ç”¨å…¥å£è„šæœ¬ -->
  <script type="module" src="/src/main.ts"></script>
  
  <!-- å†…è” JavaScript - å…¨å±€é”™è¯¯å¤„ç†å’Œæ€§èƒ½ç›‘æ§ -->
  <script>
    (function() {
      'use strict';
      
      // å…¨å±€é”™è¯¯å¤„ç†
      window.addEventListener('error', function(event) {
        console.error('Global Error:', event.error);
        showErrorPage('JavaScript æ‰§è¡Œé”™è¯¯: ' + (event.error?.message || 'æœªçŸ¥é”™è¯¯'));
      });
      
      window.addEventListener('unhandledrejection', function(event) {
        console.error('Unhandled Promise Rejection:', event.reason);
        showErrorPage('Promise æ‰§è¡Œé”™è¯¯: ' + (event.reason?.message || 'æœªçŸ¥é”™è¯¯'));
      });
      
      // æ˜¾ç¤ºé”™è¯¯é¡µé¢
      function showErrorPage(message) {
        const loadingEl = document.getElementById('app-loading');
        const errorEl = document.getElementById('error-page');
        const messageEl = errorEl?.querySelector('.error-message');
        
        if (loadingEl) {
          loadingEl.style.display = 'none';
        }
        
        if (errorEl) {
          errorEl.style.display = 'flex';
        }
        
        if (messageEl && message) {
          messageEl.textContent = message;
        }
      }
      
      // æµè§ˆå™¨å…¼å®¹æ€§æ£€æŸ¥
      function checkBrowserCompatibility() {
        const requiredFeatures = [
          'Promise',
          'fetch',
          'Map',
          'Set',
          'Symbol',
          'Proxy'
        ];
        
        const missingFeatures = requiredFeatures.filter(feature => {
          return typeof window[feature] === 'undefined';
        });
        
        if (missingFeatures.length > 0) {
          showErrorPage(
            'æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒä»¥ä¸‹å¿…éœ€åŠŸèƒ½: ' + missingFeatures.join(', ') + 
            'ã€‚è¯·å‡çº§åˆ°ç°ä»£æµè§ˆå™¨ï¼ˆChrome 61+, Firefox 60+, Safari 12+, Edge 79+ï¼‰ã€‚'
          );
          return false;
        }
        
        return true;
      }
      
      // æ€§èƒ½ç›‘æ§
      function trackPerformance() {
        if ('performance' in window && 'getEntriesByType' in performance) {
          window.addEventListener('load', function() {
            setTimeout(function() {
              const navigation = performance.getEntriesByType('navigation')[0];
              const paint = performance.getEntriesByType('paint');
              
              if (navigation) {
                console.log('é¡µé¢åŠ è½½æ€§èƒ½:', {
                  domContentLoaded: Math.round(navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart),
                  loadComplete: Math.round(navigation.loadEventEnd - navigation.loadEventStart),
                  totalTime: Math.round(navigation.loadEventEnd - navigation.fetchStart)
                });
              }
              
              if (paint.length > 0) {
                console.log('æ¸²æŸ“æ€§èƒ½:', paint.reduce((acc, entry) => {
                  acc[entry.name] = Math.round(entry.startTime);
                  return acc;
                }, {}));
              }
            }, 0);
          });
        }
      }
      
      // å†…å­˜ç›‘æ§
      function trackMemory() {
        if ('memory' in performance) {
          const logMemory = function() {
            const memory = performance.memory;
            console.log('å†…å­˜ä½¿ç”¨æƒ…å†µ:', {
              used: Math.round(memory.usedJSHeapSize / 1024 / 1024) + ' MB',
              total: Math.round(memory.totalJSHeapSize / 1024 / 1024) + ' MB',
              limit: Math.round(memory.jsHeapSizeLimit / 1024 / 1024) + ' MB'
            });
          };
          
          // åˆå§‹å†…å­˜çŠ¶æ€
          logMemory();
          
          // å®šæœŸæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
          setInterval(logMemory, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
        }
      }
      
      // ç½‘ç»œçŠ¶æ€ç›‘æ§
      function trackNetworkStatus() {
        if ('navigator' in window && 'onLine' in navigator) {
          function updateNetworkStatus() {
            const isOnline = navigator.onLine;
            document.body.classList.toggle('offline', !isOnline);
            
            if (!isOnline) {
              console.warn('ç½‘ç»œè¿æ¥å·²æ–­å¼€');
            } else {
              console.log('ç½‘ç»œè¿æ¥å·²æ¢å¤');
            }
          }
          
          window.addEventListener('online', updateNetworkStatus);
          window.addEventListener('offline', updateNetworkStatus);
          
          // åˆå§‹çŠ¶æ€æ£€æŸ¥
          updateNetworkStatus();
        }
      }
      
      // åº”ç”¨åŠ è½½å®Œæˆå¤„ç†
      function handleAppLoaded() {
        const loadingEl = document.getElementById('app-loading');
        if (loadingEl) {
          loadingEl.classList.add('hidden');
          setTimeout(function() {
            loadingEl.style.display = 'none';
          }, 300);
        }
      }
      
      // åˆå§‹åŒ–
      if (checkBrowserCompatibility()) {
        trackPerformance();
        trackMemory();
        trackNetworkStatus();
        
        // ç›‘å¬ Vue åº”ç”¨åŠ è½½å®Œæˆäº‹ä»¶
        window.addEventListener('vue-app-loaded', handleAppLoaded);
        
        // å¤‡ç”¨æ–¹æ¡ˆï¼šå¦‚æœ Vue åº”ç”¨åœ¨ 10 ç§’å†…æ²¡æœ‰åŠ è½½å®Œæˆï¼Œéšè—åŠ è½½æŒ‡ç¤ºå™¨
        setTimeout(function() {
          const loadingEl = document.getElementById('app-loading');
          if (loadingEl && !loadingEl.classList.contains('hidden')) {
            console.warn('Vue åº”ç”¨åŠ è½½è¶…æ—¶ï¼Œéšè—åŠ è½½æŒ‡ç¤ºå™¨');
            handleAppLoaded();
          }
        }, 10000);
      }
      
      // å¼€å‘ç¯å¢ƒä¸‹çš„é¢å¤–è°ƒè¯•ä¿¡æ¯
      if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
        console.log('ğŸš€ Vue 3 PDF Viewer Example - å¼€å‘æ¨¡å¼');
        console.log('ğŸ“¦ åŸºäº @ldesign/pdf æ„å»º');
        console.log('âš¡ ä½¿ç”¨ Vite æ„å»ºå·¥å…·');
        console.log('ğŸ¯ Vue 3 + Composition API + TypeScript');
        
        // å¼€å‘ç¯å¢ƒæ€§èƒ½æç¤º
        if ('performance' in window && performance.mark) {
          performance.mark('vue-app-start');
          window.addEventListener('vue-app-loaded', function() {
            performance.mark('vue-app-end');
            performance.measure('vue-app-load-time', 'vue-app-start', 'vue-app-end');
            
            const measure = performance.getEntriesByName('vue-app-load-time')[0];
            if (measure) {
              console.log('Vue åº”ç”¨åŠ è½½æ—¶é—´:', Math.round(measure.duration) + 'ms');
            }
          });
        }
      }
    })();
  </script>
  
  <!-- NoScript å›é€€ -->
  <noscript>
    <div style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: #333;
      text-align: center;
      padding: 20px;
      z-index: 10000;
    ">
      <div style="font-size: 64px; margin-bottom: 20px; color: #ff9800;">âš ï¸</div>
      <h1 style="font-size: 24px; font-weight: 600; margin-bottom: 10px;">éœ€è¦å¯ç”¨ JavaScript</h1>
      <p style="font-size: 16px; color: #666; margin-bottom: 30px; max-width: 500px; line-height: 1.5;">
        Vue PDF Viewer éœ€è¦ JavaScript æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚è¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­å¯ç”¨ JavaScriptï¼Œç„¶ååˆ·æ–°é¡µé¢ã€‚
      </p>
      <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
        <a href="https://enable-javascript.com/" target="_blank" style="
          padding: 12px 24px;
          background: #1976d2;
          color: white;
          text-decoration: none;
          border-radius: 6px;
          font-size: 14px;
          font-weight: 500;
        ">ğŸ“– å¦‚ä½•å¯ç”¨ JavaScript</a>
      </div>
    </div>
  </noscript>
</body>
</html>