<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@ldesign/tree - åŠŸèƒ½æ¼”ç¤º</title>
  <!-- CSSæ ·å¼å°†å†…è”åœ¨ä¸‹é¢ -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #722ED1, #9254DE);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }
    
    .demo-section {
      padding: 30px;
    }
    
    .demo-title {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: #333;
      border-bottom: 2px solid #722ED1;
      padding-bottom: 10px;
    }
    
    .demo-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 40px;
    }
    
    @media (max-width: 768px) {
      .demo-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .demo-item {
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .demo-item h3 {
      background: #f8f9fa;
      padding: 15px;
      margin: 0;
      font-size: 1.1rem;
      color: #333;
      border-bottom: 1px solid #e5e5e5;
    }
    
    .demo-content {
      padding: 20px;
    }
    
    .tree-container {
      height: 300px;
      border: 1px solid #e5e5e5;
      border-radius: 4px;
      overflow: auto;
    }
    
    .controls {
      margin-bottom: 15px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 8px 16px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .btn:hover {
      background: #f5f5f5;
      border-color: #722ED1;
    }
    
    .btn.primary {
      background: #722ED1;
      color: white;
      border-color: #722ED1;
    }
    
    .btn.primary:hover {
      background: #5e2aa7;
    }
    
    .info-panel {
      background: #f8f9fa;
      border: 1px solid #e5e5e5;
      border-radius: 4px;
      padding: 15px;
      margin-top: 15px;
      font-size: 14px;
    }
    
    .status {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .status.success {
      background: #f6ffed;
      color: #52c41a;
      border: 1px solid #b7eb8f;
    }
    
    .status.warning {
      background: #fffbe6;
      color: #faad14;
      border: 1px solid #ffe58f;
    }
    
    .footer {
      background: #f8f9fa;
      padding: 20px;
      text-align: center;
      color: #666;
      border-top: 1px solid #e5e5e5;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>@ldesign/tree</h1>
      <p>åŠŸèƒ½å®Œæ•´çš„æ ‘å½¢ç»„ä»¶åº“æ¼”ç¤º</p>
    </div>
    
    <div class="demo-section">
      <h2 class="demo-title">åŸºç¡€åŠŸèƒ½æ¼”ç¤º</h2>
      
      <div class="demo-grid">
        <!-- åŸºç¡€æ ‘å½¢å±•ç¤º -->
        <div class="demo-item">
          <h3>åŸºç¡€æ ‘å½¢å±•ç¤º</h3>
          <div class="demo-content">
            <div class="controls">
              <button class="btn" onclick="expandAll('basic')">å±•å¼€å…¨éƒ¨</button>
              <button class="btn" onclick="collapseAll('basic')">æ”¶èµ·å…¨éƒ¨</button>
            </div>
            <div id="tree-basic" class="tree-container"></div>
            <div class="info-panel">
              <div>çŠ¶æ€: <span class="status success">æ­£å¸¸</span></div>
              <div>èŠ‚ç‚¹æ•°: <span id="basic-count">0</span></div>
            </div>
          </div>
        </div>
        
        <!-- å¤šé€‰æ¨¡å¼ -->
        <div class="demo-item">
          <h3>å¤šé€‰æ¨¡å¼</h3>
          <div class="demo-content">
            <div class="controls">
              <button class="btn" onclick="selectAll('multiple')">å…¨é€‰</button>
              <button class="btn" onclick="unselectAll('multiple')">å–æ¶ˆå…¨é€‰</button>
            </div>
            <div id="tree-multiple" class="tree-container"></div>
            <div class="info-panel">
              <div>é€‰ä¸­èŠ‚ç‚¹: <span id="multiple-selected">0</span></div>
            </div>
          </div>
        </div>
        
        <!-- æœç´¢åŠŸèƒ½ -->
        <div class="demo-item">
          <h3>æœç´¢åŠŸèƒ½</h3>
          <div class="demo-content">
            <div class="controls">
              <input type="text" id="search-input" placeholder="æœç´¢èŠ‚ç‚¹..." style="flex: 1; padding: 8px; border: 1px solid #d9d9d9; border-radius: 4px;">
              <button class="btn primary" onclick="performSearch()">æœç´¢</button>
              <button class="btn" onclick="clearSearch()">æ¸…é™¤</button>
            </div>
            <div id="tree-search" class="tree-container"></div>
            <div class="info-panel">
              <div>æœç´¢ç»“æœ: <span id="search-results">0</span> ä¸ªåŒ¹é…é¡¹</div>
            </div>
          </div>
        </div>
        
        <!-- æ‹–æ‹½åŠŸèƒ½ -->
        <div class="demo-item">
          <h3>æ‹–æ‹½æ’åº</h3>
          <div class="demo-content">
            <div class="controls">
              <span class="status warning">æ‹–æ‹½èŠ‚ç‚¹è¿›è¡Œæ’åº</span>
            </div>
            <div id="tree-drag" class="tree-container"></div>
            <div class="info-panel">
              <div>æ‹–æ‹½æ“ä½œ: <span id="drag-operations">0</span> æ¬¡</div>
            </div>
          </div>
        </div>
      </div>
      
      <h2 class="demo-title">é«˜çº§åŠŸèƒ½æ¼”ç¤º</h2>
      
      <div class="demo-grid">
        <!-- è™šæ‹Ÿæ»šåŠ¨ -->
        <div class="demo-item">
          <h3>è™šæ‹Ÿæ»šåŠ¨ (å¤§æ•°æ®é‡)</h3>
          <div class="demo-content">
            <div class="controls">
              <button class="btn primary" onclick="generateLargeData()">ç”Ÿæˆ1000ä¸ªèŠ‚ç‚¹</button>
              <button class="btn" onclick="scrollToNode()">æ»šåŠ¨åˆ°èŠ‚ç‚¹500</button>
            </div>
            <div id="tree-virtual" class="tree-container"></div>
            <div class="info-panel">
              <div>æ€»èŠ‚ç‚¹æ•°: <span id="virtual-count">0</span></div>
              <div>æ¸²æŸ“æ€§èƒ½: <span id="virtual-performance">-</span></div>
            </div>
          </div>
        </div>
        
        <!-- å¼‚æ­¥åŠ è½½ -->
        <div class="demo-item">
          <h3>å¼‚æ­¥åŠ è½½</h3>
          <div class="demo-content">
            <div class="controls">
              <span class="status success">ç‚¹å‡»èŠ‚ç‚¹å±•å¼€å¼‚æ­¥åŠ è½½å­èŠ‚ç‚¹</span>
            </div>
            <div id="tree-async" class="tree-container"></div>
            <div class="info-panel">
              <div>åŠ è½½çŠ¶æ€: <span id="async-status">å°±ç»ª</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="footer">
      <p>&copy; 2024 ldesign. MIT License. æ„å»ºæ—¶é—´: <span id="build-time"></span></p>
    </div>
  </div>
  
  <script src="../dist/index.js"></script>
  <script>
    // è®¾ç½®æ„å»ºæ—¶é—´
    document.getElementById('build-time').textContent = new Date().toLocaleString()
    
    // å…¨å±€å˜é‡
    const trees = {}
    let dragOperations = 0
    
    // ç”Ÿæˆæµ‹è¯•æ•°æ®
    function generateTestData(count = 20, depth = 3) {
      const data = []
      let nodeId = 1
      
      function createNode(level, parentId) {
        const id = `node-${nodeId++}`
        const node = {
          id,
          label: `èŠ‚ç‚¹ ${id}`,
          icon: level === 0 ? 'ğŸ“' : (Math.random() > 0.5 ? 'ğŸ“„' : 'ğŸ–¼ï¸'),
          parentId,
        }
        
        if (level < depth && Math.random() > 0.3 && nodeId <= count) {
          const childCount = Math.floor(Math.random() * 4) + 1
          node.children = []
          for (let i = 0; i < childCount && nodeId <= count; i++) {
            node.children.push(createNode(level + 1, id))
          }
        }
        
        return node
      }
      
      while (nodeId <= count) {
        data.push(createNode(0))
      }
      
      return data
    }
    
    // åˆå§‹åŒ–åŸºç¡€æ ‘
    function initBasicTree() {
      const data = generateTestData(15, 2)
      trees.basic = new LDesignTree.Tree(document.getElementById('tree-basic'), {
        data,
        style: { showIcons: true, showLines: true }
      })
      
      document.getElementById('basic-count').textContent = trees.basic.getAllNodes().length
    }
    
    // åˆå§‹åŒ–å¤šé€‰æ ‘
    function initMultipleTree() {
      const data = generateTestData(12, 2)
      trees.multiple = new LDesignTree.Tree(document.getElementById('tree-multiple'), {
        data,
        selection: {
          mode: 'multiple',
          showCheckbox: true,
        },
        style: { showIcons: true }
      })
      
      trees.multiple.on('select', (selectedIds) => {
        document.getElementById('multiple-selected').textContent = selectedIds.length
      })
    }
    
    // åˆå§‹åŒ–æœç´¢æ ‘
    function initSearchTree() {
      const data = generateTestData(20, 3)
      trees.search = new LDesignTree.Tree(document.getElementById('tree-search'), {
        data,
        search: {
          enabled: true,
          highlightMatches: true,
        },
        style: { showIcons: true }
      })
      
      trees.search.on('search', (query, results) => {
        document.getElementById('search-results').textContent = results.length
      })
    }
    
    // åˆå§‹åŒ–æ‹–æ‹½æ ‘
    function initDragTree() {
      const data = generateTestData(10, 2)
      trees.drag = new LDesignTree.Tree(document.getElementById('tree-drag'), {
        data,
        dragDrop: {
          enabled: true,
          allowCrossLevel: true,
          allowReorder: true,
        },
        style: { showIcons: true }
      })
      
      trees.drag.on('drop', () => {
        dragOperations++
        document.getElementById('drag-operations').textContent = dragOperations
      })
    }
    
    // åˆå§‹åŒ–è™šæ‹Ÿæ»šåŠ¨æ ‘
    function initVirtualTree() {
      trees.virtual = new LDesignTree.Tree(document.getElementById('tree-virtual'), {
        data: [],
        virtualScroll: {
          enabled: true,
          itemHeight: 32,
        },
        style: { showIcons: true }
      })
    }
    
    // åˆå§‹åŒ–å¼‚æ­¥åŠ è½½æ ‘
    function initAsyncTree() {
      const rootData = [
        { id: 'async-1', label: 'å¼‚æ­¥èŠ‚ç‚¹1', children: [] },
        { id: 'async-2', label: 'å¼‚æ­¥èŠ‚ç‚¹2', children: [] },
        { id: 'async-3', label: 'å¼‚æ­¥èŠ‚ç‚¹3', children: [] },
      ]
      
      trees.async = new LDesignTree.Tree(document.getElementById('tree-async'), {
        data: rootData,
        async: {
          loadChildren: async (node) => {
            document.getElementById('async-status').textContent = 'åŠ è½½ä¸­...'
            
            // æ¨¡æ‹Ÿå¼‚æ­¥åŠ è½½
            await new Promise(resolve => setTimeout(resolve, 1000))
            
            const children = Array.from({ length: 3 }, (_, i) => ({
              id: `${node.id}-child-${i + 1}`,
              label: `${node.label} çš„å­èŠ‚ç‚¹ ${i + 1}`,
              icon: 'ğŸ“„',
            }))
            
            document.getElementById('async-status').textContent = 'åŠ è½½å®Œæˆ'
            setTimeout(() => {
              document.getElementById('async-status').textContent = 'å°±ç»ª'
            }, 2000)
            
            return children
          },
        },
        style: { showIcons: true }
      })
    }
    
    // æ§åˆ¶å‡½æ•°
    function expandAll(treeKey) {
      if (trees[treeKey]) {
        trees[treeKey].expandAll()
      }
    }
    
    function collapseAll(treeKey) {
      if (trees[treeKey]) {
        trees[treeKey].collapseAll()
      }
    }
    
    function selectAll(treeKey) {
      if (trees[treeKey]) {
        trees[treeKey].selectAll()
      }
    }
    
    function unselectAll(treeKey) {
      if (trees[treeKey]) {
        trees[treeKey].unselectAll()
      }
    }
    
    function performSearch() {
      const query = document.getElementById('search-input').value
      if (trees.search && query) {
        trees.search.search(query)
      }
    }
    
    function clearSearch() {
      document.getElementById('search-input').value = ''
      if (trees.search) {
        trees.search.clearSearch()
        document.getElementById('search-results').textContent = '0'
      }
    }
    
    function generateLargeData() {
      const startTime = performance.now()
      const data = generateTestData(1000, 1)
      const endTime = performance.now()
      
      trees.virtual.setData(data)
      document.getElementById('virtual-count').textContent = data.length
      document.getElementById('virtual-performance').textContent = `${(endTime - startTime).toFixed(2)}ms`
    }
    
    function scrollToNode() {
      if (trees.virtual) {
        trees.virtual.scrollToNode('node-500')
      }
    }
    
    // åˆå§‹åŒ–æ‰€æœ‰æ ‘
    try {
      initBasicTree()
      initMultipleTree()
      initSearchTree()
      initDragTree()
      initVirtualTree()
      initAsyncTree()
      
      console.log('âœ… æ‰€æœ‰æ ‘å½¢ç»„ä»¶åˆå§‹åŒ–æˆåŠŸ')
    } catch (error) {
      console.error('âŒ æ ‘å½¢ç»„ä»¶åˆå§‹åŒ–å¤±è´¥:', error)
    }
  </script>
</body>
</html>
