<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LDesign Tree - 原生JavaScript示例</title>
  <link rel="stylesheet" href="../dist/styles/tree.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    .header {
      padding: 20px;
      background: #1890ff;
      color: white;
    }
    
    .content {
      padding: 20px;
    }
    
    .demo-section {
      margin-bottom: 30px;
    }
    
    .demo-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #333;
    }
    
    .demo-tree {
      border: 1px solid #d9d9d9;
      border-radius: 6px;
      height: 400px;
      margin-bottom: 15px;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 6px 12px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .btn:hover {
      border-color: #1890ff;
      color: #1890ff;
    }
    
    .btn-primary {
      background: #1890ff;
      border-color: #1890ff;
      color: white;
    }
    
    .btn-primary:hover {
      background: #40a9ff;
      border-color: #40a9ff;
    }
    
    .search-input {
      padding: 6px 12px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      font-size: 14px;
      width: 200px;
    }
    
    .info {
      margin-top: 15px;
      padding: 10px;
      background: #f6ffed;
      border: 1px solid #b7eb8f;
      border-radius: 4px;
      font-size: 14px;
      color: #52c41a;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>LDesign Tree - 原生JavaScript示例</h1>
      <p>功能完整的树形组件，支持拖拽、搜索、虚拟滚动等特性</p>
    </div>
    
    <div class="content">
      <!-- 基础示例 -->
      <div class="demo-section">
        <div class="demo-title">基础树形结构</div>
        <div id="basic-tree" class="demo-tree"></div>
        <div class="controls">
          <button class="btn" onclick="expandAll()">展开全部</button>
          <button class="btn" onclick="collapseAll()">收起全部</button>
          <button class="btn" onclick="selectAll()">全选</button>
          <button class="btn" onclick="clearSelection()">清空选择</button>
        </div>
        <div id="basic-info" class="info" style="display: none;"></div>
      </div>
      
      <!-- 搜索示例 -->
      <div class="demo-section">
        <div class="demo-title">搜索功能</div>
        <div class="controls" style="margin-bottom: 15px;">
          <input type="text" class="search-input" placeholder="搜索节点..." onkeyup="handleSearch(event)">
          <button class="btn" onclick="clearSearch()">清空搜索</button>
        </div>
        <div id="search-tree" class="demo-tree"></div>
        <div id="search-info" class="info" style="display: none;"></div>
      </div>
      
      <!-- 拖拽示例 -->
      <div class="demo-section">
        <div class="demo-title">拖拽排序</div>
        <div id="drag-tree" class="demo-tree"></div>
        <div class="controls">
          <button class="btn" onclick="resetDragTree()">重置数据</button>
        </div>
        <div id="drag-info" class="info" style="display: none;"></div>
      </div>
    </div>
  </div>

  <script src="../dist/index.umd.js"></script>
  <script>
    // 示例数据
    const sampleData = [
      {
        id: '1',
        label: '根节点 1',
        children: [
          {
            id: '1-1',
            label: '子节点 1-1',
            children: [
              { id: '1-1-1', label: '叶子节点 1-1-1' },
              { id: '1-1-2', label: '叶子节点 1-1-2' },
            ]
          },
          {
            id: '1-2',
            label: '子节点 1-2',
            children: [
              { id: '1-2-1', label: '叶子节点 1-2-1' },
            ]
          }
        ]
      },
      {
        id: '2',
        label: '根节点 2',
        children: [
          { id: '2-1', label: '子节点 2-1' },
          { id: '2-2', label: '子节点 2-2' },
        ]
      },
      {
        id: '3',
        label: '根节点 3',
        children: [
          {
            id: '3-1',
            label: '子节点 3-1',
            children: [
              { id: '3-1-1', label: '叶子节点 3-1-1' },
              { id: '3-1-2', label: '叶子节点 3-1-2' },
              { id: '3-1-3', label: '叶子节点 3-1-3' },
            ]
          }
        ]
      }
    ]

    // 树实例
    let basicTree, searchTree, dragTree

    // 初始化基础树
    basicTree = LDesignTree.createTree({
      container: '#basic-tree',
      data: sampleData,
      options: {
        selection: {
          mode: 'multiple',
          showCheckbox: true
        }
      },
      onSelect: (selectedKeys) => {
        const info = document.getElementById('basic-info')
        info.style.display = 'block'
        info.textContent = `已选择: ${selectedKeys.join(', ')}`
      }
    })

    // 初始化搜索树
    searchTree = LDesignTree.createTree({
      container: '#search-tree',
      data: sampleData,
      options: {
        search: {
          enabled: true,
          highlightClass: 'tree-search-highlight'
        }
      },
      onSearch: (keyword, results) => {
        const info = document.getElementById('search-info')
        info.style.display = 'block'
        info.textContent = `搜索 "${keyword}" 找到 ${results.length} 个结果`
      }
    })

    // 初始化拖拽树
    dragTree = LDesignTree.createTree({
      container: '#drag-tree',
      data: JSON.parse(JSON.stringify(sampleData)), // 深拷贝
      options: {
        dragDrop: {
          enabled: true,
          mode: 'full'
        }
      },
      onDrop: (data) => {
        const info = document.getElementById('drag-info')
        info.style.display = 'block'
        info.textContent = `节点 "${data.dragNode.label}" 移动到 "${data.dropNode.label}" ${data.position}`
      }
    })

    // 控制函数
    function expandAll() {
      basicTree.expandAll()
    }

    function collapseAll() {
      basicTree.collapseAll()
    }

    function selectAll() {
      basicTree.selectAll()
    }

    function clearSelection() {
      basicTree.unselectAll()
      document.getElementById('basic-info').style.display = 'none'
    }

    function handleSearch(event) {
      const keyword = event.target.value
      if (keyword) {
        searchTree.search(keyword)
      } else {
        searchTree.clearSearch()
        document.getElementById('search-info').style.display = 'none'
      }
    }

    function clearSearch() {
      document.querySelector('.search-input').value = ''
      searchTree.clearSearch()
      document.getElementById('search-info').style.display = 'none'
    }

    function resetDragTree() {
      dragTree.setData(JSON.parse(JSON.stringify(sampleData)))
      document.getElementById('drag-info').style.display = 'none'
    }
  </script>
</body>
</html>
