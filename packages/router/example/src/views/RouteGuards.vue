<script setup lang="ts">
import { useRouter } from '@ldesign/router'

const router = useRouter()

function logout() {
  localStorage.removeItem('token')
  console.warn('å·²é€€å‡ºç™»å½•ï¼Œä¸‹æ¬¡è®¿é—®å°†è¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢')
  router.push('/login')
}

function clearPermissions() {
  // æ¨¡æ‹Ÿæ¸…é™¤æƒé™
  console.warn('æƒé™å·²æ¸…é™¤ï¼Œä¸‹æ¬¡è®¿é—®å—ä¿æŠ¤é¡µé¢å°†è¢«æ‹’ç»')
}

function goToProtected() {
  router.push('/guards')
}
</script>

<template>
  <div class="route-guards">
    <div class="card">
      <h1>è·¯ç”±å®ˆå«æ¼”ç¤º</h1>
      <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºäº†è·¯ç”±å®ˆå«åŠŸèƒ½ï¼ŒåŒ…æ‹¬æƒé™éªŒè¯å’Œè®¤è¯æ£€æŸ¥ã€‚</p>
      <div class="alert alert-success">
        <strong>æ­å–œï¼</strong> æ‚¨å·²é€šè¿‡æ‰€æœ‰è·¯ç”±å®ˆå«éªŒè¯ï¼ŒæˆåŠŸè®¿é—®æ­¤é¡µé¢ã€‚
      </div>
    </div>

    <div class="card">
      <h2>å®ˆå«ç±»å‹</h2>
      <div class="guard-types">
        <div class="guard-item">
          <h3>ğŸ” è®¤è¯å®ˆå«</h3>
          <p>éªŒè¯ç”¨æˆ·æ˜¯å¦å·²ç™»å½•</p>
          <div class="status success">âœ… å·²é€šè¿‡</div>
        </div>
        <div class="guard-item">
          <h3>ğŸ›¡ï¸ æƒé™å®ˆå«</h3>
          <p>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å…·æœ‰è®¿é—®æƒé™</p>
          <div class="status success">âœ… å·²é€šè¿‡</div>
        </div>
        <div class="guard-item">
          <h3>ğŸ“ æ ‡é¢˜å®ˆå«</h3>
          <p>è‡ªåŠ¨è®¾ç½®é¡µé¢æ ‡é¢˜</p>
          <div class="status success">âœ… å·²åº”ç”¨</div>
        </div>
        <div class="guard-item">
          <h3>â³ åŠ è½½å®ˆå«</h3>
          <p>æ˜¾ç¤ºåŠ è½½çŠ¶æ€</p>
          <div class="status success">âœ… å·²æ‰§è¡Œ</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>æ¨¡æ‹Ÿæ“ä½œ</h2>
      <div class="actions">
        <button class="btn btn-warning" @click="logout">é€€å‡ºç™»å½•</button>
        <button class="btn btn-error" @click="clearPermissions">
          æ¸…é™¤æƒé™
        </button>
        <button class="btn btn-info" @click="goToProtected">
          è®¿é—®å…¶ä»–å—ä¿æŠ¤é¡µé¢
        </button>
      </div>
    </div>
  </div>
</template>

<style lang="less" scoped>
.route-guards {
  max-width: 1000px;
  margin: 0 auto;
}

.alert {
  padding: @spacing-md;
  border-radius: @border-radius-md;
  margin-bottom: @spacing-lg;

  &-success {
    background: fade(@success-color, 10%);
    border: 1px solid fade(@success-color, 30%);
    color: @success-color;
  }
}

.guard-types {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: @spacing-lg;
}

.guard-item {
  padding: @spacing-md;
  border: 1px solid @gray-200;
  border-radius: @border-radius-md;
  text-align: center;

  h3 {
    color: @gray-800;
    margin-bottom: @spacing-sm;
  }

  p {
    color: @gray-600;
    margin-bottom: @spacing-md;
  }

  .status {
    padding: @spacing-xs @spacing-sm;
    border-radius: @border-radius-sm;
    font-weight: 500;
    font-size: @font-size-sm;

    &.success {
      background: fade(@success-color, 20%);
      color: @success-color;
    }
  }
}

.actions {
  display: flex;
  gap: @spacing-md;
  flex-wrap: wrap;
}

@media (max-width: 768px) {
  .guard-types {
    grid-template-columns: 1fr;
  }

  .actions {
    flex-direction: column;
  }

  .actions .btn {
    width: 100%;
  }
}
</style>
