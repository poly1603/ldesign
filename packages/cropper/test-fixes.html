<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LDESIGN Cropper - ä¿®å¤éªŒè¯</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #722ED1, #8c5ad3);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .content {
      padding: 30px;
    }

    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      border: 1px solid #e5e5e5;
      border-radius: 8px;
    }

    .test-section h3 {
      color: #722ED1;
      margin-bottom: 15px;
    }

    .cropper-container {
      width: 100%;
      height: 400px;
      border: 2px dashed #ddd;
      border-radius: 8px;
      margin: 20px 0;
      position: relative;
      background: #fafafa;
    }

    .controls {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .control-btn {
      padding: 8px 16px;
      border: 1px solid #722ED1;
      background: white;
      color: #722ED1;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .control-btn:hover {
      background: #722ED1;
      color: white;
    }

    .control-btn.primary {
      background: #722ED1;
      color: white;
    }

    .result-section {
      display: none;
      margin-top: 20px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .result-section.active {
      display: block;
    }

    .result-preview img {
      max-width: 300px;
      max-height: 300px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .demo-images {
      display: flex;
      gap: 10px;
      margin: 20px 0;
    }

    .demo-image {
      cursor: pointer;
      border-radius: 4px;
      overflow: hidden;
      transition: transform 0.3s;
    }

    .demo-image:hover {
      transform: scale(1.05);
    }

    .demo-image img {
      width: 100px;
      height: 60px;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ”§ LDESIGN Cropper ä¿®å¤éªŒè¯</h1>
      <p>éªŒè¯è£å‰ªç»“æœå¯¹åº”ã€å½¢çŠ¶æ¯”ä¾‹å®æ—¶æ›´æ–°ã€å·¥å…·æ æ ·å¼ç­‰é—®é¢˜ä¿®å¤</p>
    </div>

    <div class="content">
      <!-- æµ‹è¯•1: å·¥å…·æ æ ·å¼ -->
      <div class="test-section">
        <h3>âœ… æµ‹è¯•1: å·¥å…·æ æ ·å¼ä¿®å¤</h3>
        <p>éªŒè¯å·¥å…·æ æ˜¯å¦æœ‰æ­£ç¡®çš„æ ·å¼ï¼ŒæŒ‰é’®æ˜¯å¦ç¾è§‚</p>
        
        <div class="demo-images">
          <div class="demo-image" onclick="loadTestImage('https://picsum.photos/800/600?random=1')">
            <img src="https://picsum.photos/100/60?random=1" alt="æµ‹è¯•å›¾ç‰‡1">
          </div>
          <div class="demo-image" onclick="loadTestImage('https://picsum.photos/800/600?random=2')">
            <img src="https://picsum.photos/100/60?random=2" alt="æµ‹è¯•å›¾ç‰‡2">
          </div>
          <div class="demo-image" onclick="loadTestImage('https://picsum.photos/800/600?random=3')">
            <img src="https://picsum.photos/100/60?random=3" alt="æµ‹è¯•å›¾ç‰‡3">
          </div>
        </div>

        <div id="cropper1" class="cropper-container"></div>
      </div>

      <!-- æµ‹è¯•2: å½¢çŠ¶å’Œæ¯”ä¾‹å®æ—¶æ›´æ–° -->
      <div class="test-section">
        <h3>ğŸ”„ æµ‹è¯•2: å½¢çŠ¶å’Œæ¯”ä¾‹å®æ—¶æ›´æ–°</h3>
        <p>éªŒè¯æ”¹å˜è£å‰ªå½¢çŠ¶å’Œæ¯”ä¾‹æ—¶ï¼Œè£å‰ªåŒºåŸŸæ˜¯å¦å®æ—¶æ›´æ–°</p>
        
        <div class="controls">
          <button class="control-btn" onclick="changeShape('rectangle')">çŸ©å½¢</button>
          <button class="control-btn" onclick="changeShape('circle')">åœ†å½¢</button>
          <button class="control-btn" onclick="changeAspectRatio(1)">1:1</button>
          <button class="control-btn" onclick="changeAspectRatio(16/9)">16:9</button>
          <button class="control-btn" onclick="changeAspectRatio(4/3)">4:3</button>
          <button class="control-btn" onclick="changeAspectRatio(null)">è‡ªç”±</button>
        </div>
      </div>

      <!-- æµ‹è¯•3: è£å‰ªç»“æœå¯¹åº” -->
      <div class="test-section">
        <h3>âœ‚ï¸ æµ‹è¯•3: è£å‰ªç»“æœå¯¹åº”æ€§</h3>
        <p>éªŒè¯è£å‰ªçš„å›¾ç‰‡æ˜¯å¦ä¸å®é™…è£å‰ªçª—å£å¯¹åº”</p>
        
        <div class="controls">
          <button class="control-btn primary" onclick="testCrop()">æ‰§è¡Œè£å‰ªæµ‹è¯•</button>
        </div>

        <div id="resultSection" class="result-section">
          <h4>è£å‰ªç»“æœ:</h4>
          <div class="result-preview">
            <img id="resultImage" alt="è£å‰ªç»“æœ">
          </div>
          <div id="resultInfo"></div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { Cropper } from './src/index.js'

    let cropper = null

    // åˆå§‹åŒ–è£å‰ªå™¨
    function initCropper() {
      const container = document.getElementById('cropper1')
      
      cropper = new Cropper({
        container: container,
        aspectRatio: null,
        shape: 'rectangle',
        resizable: true,
        movable: true,
        rotatable: true,
        scalable: true,
        zoomable: true,
        showGrid: true,
        toolbar: {
          enabled: true,
          position: 'top',
          tools: [
            'zoom-in',
            'zoom-out',
            'rotate-left',
            'rotate-right',
            'flip-horizontal',
            'flip-vertical',
            'reset',
            'shape-rectangle',
            'shape-circle',
            'aspect-ratio',
            'mask-opacity',
            'export-format',
            'crop',
            'download'
          ]
        }
      })

      console.log('è£å‰ªå™¨åˆå§‹åŒ–å®Œæˆ:', cropper)
      return cropper
    }

    // åŠ è½½æµ‹è¯•å›¾ç‰‡
    window.loadTestImage = async (url) => {
      if (!cropper) {
        cropper = initCropper()
      }
      
      try {
        await cropper.setImage(url)
        console.log('å›¾ç‰‡åŠ è½½æˆåŠŸ:', url)
      } catch (error) {
        console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', error)
      }
    }

    // æ”¹å˜å½¢çŠ¶
    window.changeShape = (shape) => {
      if (cropper) {
        cropper.setShape(shape)
        console.log('å½¢çŠ¶å·²æ›´æ”¹ä¸º:', shape)
      }
    }

    // æ”¹å˜å®½é«˜æ¯”
    window.changeAspectRatio = (ratio) => {
      if (cropper) {
        cropper.setAspectRatio(ratio)
        console.log('å®½é«˜æ¯”å·²æ›´æ”¹ä¸º:', ratio)
      }
    }

    // æµ‹è¯•è£å‰ª
    window.testCrop = () => {
      if (!cropper) {
        alert('è¯·å…ˆåŠ è½½å›¾ç‰‡')
        return
      }

      try {
        const canvas = cropper.getCroppedCanvas()
        const dataURL = canvas.toDataURL('image/png')
        
        document.getElementById('resultImage').src = dataURL
        document.getElementById('resultInfo').innerHTML = `
          <strong>è£å‰ªä¿¡æ¯:</strong><br>
          å°ºå¯¸: ${canvas.width} Ã— ${canvas.height}<br>
          æ ¼å¼: PNG<br>
          å¤§å°: ${Math.round(dataURL.length * 0.75 / 1024)} KB
        `
        document.getElementById('resultSection').classList.add('active')
        
        console.log('è£å‰ªæµ‹è¯•å®Œæˆ')
      } catch (error) {
        console.error('è£å‰ªå¤±è´¥:', error)
        alert('è£å‰ªå¤±è´¥: ' + error.message)
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡åˆå§‹åŒ–è£å‰ªå™¨')
    })
  </script>
</body>
</html>
