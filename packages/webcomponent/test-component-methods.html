<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>组件方法测试</title>
  <script type="module" src="./dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
  <link rel="stylesheet" href="./dist/ldesign-webcomponent/ldesign-webcomponent.css">
  <style>
    body { padding: 20px; }
    .result { 
      margin: 10px 0; 
      padding: 15px; 
      background: #f0f0f0; 
      font-family: monospace;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>直接测试组件方法和属性</h1>

  <h2>Textarea 组件</h2>
  <ldesign-input type="textarea" id="textarea1" value="第一行
第二行
第三行"></ldesign-input>
  <div class="result" id="textarea-result"></div>

  <h2>Input 组件</h2>
  <ldesign-input id="input1"></ldesign-input>
  <div class="result" id="input-result"></div>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        const textarea1 = document.getElementById('textarea1');
        const input1 = document.getElementById('input1');
        
        // 测试 textarea
        console.log('=== Textarea 组件测试 ===');
        console.log('组件实例:', textarea1);
        console.log('组件属性:', {
          autosize: textarea1.autosize,
          type: textarea1.type,
          value: textarea1.value,
          rows: textarea1.rows
        });
        
        // 设置 autosize
        textarea1.autosize = { minRows: 2, maxRows: 5 };
        console.log('设置后的autosize:', textarea1.autosize);
        
        // 检查方法
        console.log('adjustTextareaHeight方法存在:', typeof textarea1.adjustTextareaHeight === 'function');
        
        // 获取内部元素
        const textareaEl = textarea1.querySelector('textarea');
        console.log('内部textarea元素:', textareaEl);
        
        if (textareaEl) {
          const style = window.getComputedStyle(textareaEl);
          document.getElementById('textarea-result').textContent = `Textarea 测试结果:
- autosize: ${JSON.stringify(textarea1.autosize)}
- 内部元素存在: ${!!textareaEl}
- overflow-y: ${style.overflowY}
- height: ${style.height}
- line-height: ${style.lineHeight}
- font-size: ${style.fontSize}
- padding: ${style.paddingTop} / ${style.paddingBottom}`;
          
          // 手动添加更多行测试
          textareaEl.value += '\n第四行\n第五行\n第六行';
          textareaEl.dispatchEvent(new Event('input', { bubbles: true }));
        }
        
        // 测试 input
        console.log('\n=== Input 组件测试 ===');
        input1.allowInput = /^\d*$/;
        console.log('设置的allowInput:', input1.allowInput);
        
        const inputEl = input1.querySelector('input');
        console.log('内部input元素:', inputEl);
        
        document.getElementById('input-result').textContent = `Input 测试结果:
- allowInput: ${input1.allowInput}
- 内部元素存在: ${!!inputEl}`;
        
        // 测试输入
        if (inputEl) {
          console.log('测试输入 "abc123"...');
          inputEl.value = 'abc123';
          inputEl.dispatchEvent(new Event('input', { bubbles: true }));
          
          setTimeout(() => {
            console.log('输入后的值:', inputEl.value);
            document.getElementById('input-result').textContent += `
- 测试输入 "abc123" 后的值: "${inputEl.value}"`;
          }, 100);
        }
        
      }, 1000); // 等待组件完全加载
    });
  </script>
</body>
</html>