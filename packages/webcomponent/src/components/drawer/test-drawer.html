<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Drawer 组件测试 - 移动端适配</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f0f2f5;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .header h1 {
      font-size: 24px;
      color: #1f2937;
      margin-bottom: 10px;
    }
    
    .device-info {
      font-size: 14px;
      color: #6b7280;
      background: #f9fafb;
      padding: 8px 12px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    
    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .control-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .control-group label {
      font-size: 14px;
      font-weight: 500;
      color: #374151;
    }
    
    button {
      padding: 10px 16px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    button:hover {
      background: #2563eb;
    }
    
    button:active {
      transform: scale(0.98);
    }
    
    button.secondary {
      background: #6b7280;
    }
    
    button.secondary:hover {
      background: #4b5563;
    }
    
    select, input {
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .drawer-content {
      padding: 20px;
    }
    
    .drawer-content h2 {
      margin-bottom: 15px;
      color: #1f2937;
    }
    
    .drawer-content p {
      color: #4b5563;
      line-height: 1.6;
      margin-bottom: 10px;
    }
    
    .test-content {
      height: 1500px;
      background: linear-gradient(to bottom, #f0f9ff, #e0f2fe);
      padding: 20px;
      border-radius: 8px;
    }
    
    @media (max-width: 768px) {
      .controls {
        grid-template-columns: 1fr;
      }
      
      body {
        padding: 10px;
      }
      
      .header h1 {
        font-size: 20px;
      }
    }
  </style>
  <script type="module" src="/build/ldesign-webcomponent.esm.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🎨 Drawer 组件测试 - 移动端适配</h1>
      <div class="device-info" id="deviceInfo">
        检测设备信息中...
      </div>
      <div class="device-info">
        当前视口: <span id="viewportSize">-</span>
      </div>
    </div>
    
    <div class="controls">
      <div class="control-group">
        <label>方向 (Placement)</label>
        <select id="placement">
          <option value="right">右侧 (right)</option>
          <option value="left">左侧 (left)</option>
          <option value="top">顶部 (top)</option>
          <option value="bottom">底部 (bottom)</option>
        </select>
      </div>
      
      <div class="control-group">
        <label>尺寸 (Size)</label>
        <input type="text" id="size" value="360" placeholder="360 或 80%">
        <button onclick="testPresetSizes()">测试预设尺寸</button>
      </div>
      
      <div class="control-group">
        <label>测试选项</label>
        <button onclick="toggleDrawer()">打开/关闭抽屉</button>
        <button onclick="testAllDirections()" class="secondary">测试所有方向</button>
        <button onclick="testMobileFeatures()">测试移动端特性</button>
      </div>
      
      <div class="control-group">
        <label>功能开关</label>
        <label style="font-weight: normal;">
          <input type="checkbox" id="resizable" checked> 可调整大小
        </label>
        <label style="font-weight: normal;">
          <input type="checkbox" id="swipeToClose" checked> 滑动关闭
        </label>
        <label style="font-weight: normal;">
          <input type="checkbox" id="rounded" checked> 圆角
        </label>
        <label style="font-weight: normal;">
          <input type="checkbox" id="mask" checked> 显示遮罩
        </label>
      </div>
    </div>
  </div>
  
  <!-- Drawer 组件 -->
  <ldesign-drawer id="testDrawer">
    <div class="drawer-content">
      <h2 id="drawerTitle">测试抽屉</h2>
      <p id="drawerInfo">-</p>
      <div class="test-content">
        <h3>滚动测试内容</h3>
        <p>这是一个很长的内容区域，用于测试滚动功能。</p>
        <p>请尝试滚动这个区域，验证滚动是否正常。</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit...</p>
      </div>
    </div>
  </ldesign-drawer>
  
  <script>
    // 获取设备信息
    function getDeviceInfo() {
      const ua = navigator.userAgent;
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);
      const isIOS = /iPhone|iPad|iPod/i.test(ua);
      const isAndroid = /Android/i.test(ua);
      const width = window.innerWidth;
      const height = window.innerHeight;
      
      let deviceType = 'Desktop';
      if (isMobile) {
        if (width <= 768) {
          deviceType = 'Mobile';
        } else {
          deviceType = 'Tablet';
        }
      }
      
      return {
        type: deviceType,
        os: isIOS ? 'iOS' : isAndroid ? 'Android' : 'Other',
        width,
        height,
        orientation: width > height ? 'landscape' : 'portrait',
        pixelRatio: window.devicePixelRatio || 1
      };
    }
    
    // 更新设备信息显示
    function updateDeviceInfo() {
      const info = getDeviceInfo();
      document.getElementById('deviceInfo').innerHTML = `
        设备: ${info.type} | 
        系统: ${info.os} | 
        方向: ${info.orientation} | 
        DPR: ${info.pixelRatio}
      `;
      document.getElementById('viewportSize').textContent = `${info.width} x ${info.height}px`;
    }
    
    // 监听窗口大小变化
    window.addEventListener('resize', updateDeviceInfo);
    window.addEventListener('orientationchange', updateDeviceInfo);
    updateDeviceInfo();
    
    // 获取抽屉组件
    const drawer = document.getElementById('testDrawer');
    
    // 切换抽屉
    function toggleDrawer() {
      const placement = document.getElementById('placement').value;
      const size = document.getElementById('size').value;
      const resizable = document.getElementById('resizable').checked;
      const swipeToClose = document.getElementById('swipeToClose').checked;
      const rounded = document.getElementById('rounded').checked;
      const mask = document.getElementById('mask').checked;
      
      drawer.placement = placement;
      drawer.size = isNaN(size) ? size : parseInt(size);
      drawer.resizable = resizable;
      drawer.swipeToClose = swipeToClose;
      drawer.rounded = rounded;
      drawer.mask = mask;
      drawer.drawerTitle = `${placement.toUpperCase()} 方向抽屉`;
      drawer.closable = true;
      drawer.visible = !drawer.visible;
      
      // 更新抽屉内信息
      updateDrawerInfo();
    }
    
    // 更新抽屉内的信息
    function updateDrawerInfo() {
      const info = getDeviceInfo();
      const drawerInfo = document.getElementById('drawerInfo');
      if (drawerInfo) {
        drawerInfo.innerHTML = `
          <strong>配置信息:</strong><br>
          方向: ${drawer.placement}<br>
          尺寸: ${drawer.size}<br>
          视口: ${info.width} x ${info.height}px<br>
          设备类型: ${info.type}<br>
          <br>
          <strong>功能状态:</strong><br>
          可调整大小: ${drawer.resizable ? '✓' : '✗'}<br>
          滑动关闭: ${drawer.swipeToClose ? '✓' : '✗'}<br>
          圆角: ${drawer.rounded ? '✓' : '✗'}
        `;
      }
    }
    
    // 测试所有方向
    async function testAllDirections() {
      const placements = ['right', 'left', 'top', 'bottom'];
      const size = document.getElementById('size').value;
      
      for (const placement of placements) {
        drawer.placement = placement;
        drawer.size = isNaN(size) ? size : parseInt(size);
        drawer.drawerTitle = `${placement.toUpperCase()} 方向测试`;
        drawer.visible = true;
        updateDrawerInfo();
        
        await new Promise(resolve => setTimeout(resolve, 1500));
        drawer.visible = false;
        await new Promise(resolve => setTimeout(resolve, 500));
      }
    }
    
    // 测试预设尺寸
    async function testPresetSizes() {
      const info = getDeviceInfo();
      const placement = document.getElementById('placement').value;
      
      // 根据设备类型选择测试尺寸
      let sizes;
      if (info.type === 'Mobile') {
        sizes = ['100%', '90%', '80%', '300px', '250px'];
      } else if (info.type === 'Tablet') {
        sizes = ['80%', '60%', '500px', '400px'];
      } else {
        sizes = ['50%', '40%', '600px', '400px', '360px'];
      }
      
      for (const size of sizes) {
        drawer.placement = placement;
        drawer.size = size;
        drawer.drawerTitle = `尺寸测试: ${size}`;
        drawer.visible = true;
        updateDrawerInfo();
        
        await new Promise(resolve => setTimeout(resolve, 1500));
        drawer.visible = false;
        await new Promise(resolve => setTimeout(resolve, 300));
      }
    }
    
    // 测试移动端特性
    function testMobileFeatures() {
      const info = getDeviceInfo();
      
      // 根据设备类型设置合适的配置
      if (info.type === 'Mobile') {
        // 移动端配置
        drawer.size = '85%';
        drawer.swipeToClose = true;
        drawer.swipeTriggerArea = 'handle';
        drawer.resizable = true;
        drawer.resizeMode = 'edge';
        drawer.rounded = true;
        drawer.borderRadius = '16px';
        drawer.showResizeHint = true;
        drawer.damping = true;
        drawer.animationDuration = 250;
      } else {
        // 桌面端配置
        drawer.size = '400px';
        drawer.swipeToClose = false;
        drawer.resizable = true;
        drawer.resizeMode = 'edge';
        drawer.rounded = true;
        drawer.borderRadius = '8px';
        drawer.animationDuration = 300;
      }
      
      drawer.drawerTitle = `${info.type} 优化配置`;
      drawer.visible = true;
      updateDrawerInfo();
    }
    
    // 监听抽屉事件
    drawer.addEventListener('ldesignVisibleChange', (e) => {
      console.log('Visibility changed:', e.detail);
    });
    
    drawer.addEventListener('ldesignSizeChange', (e) => {
      console.log('Size changed:', e.detail);
      document.getElementById('size').value = e.detail.size;
    });
    
    drawer.addEventListener('ldesignClose', () => {
      console.log('Drawer closed');
    });
  </script>
</body>
</html>