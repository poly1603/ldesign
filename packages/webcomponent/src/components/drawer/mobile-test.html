<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Drawer ç§»åŠ¨ç«¯å®Œæ•´æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding-bottom: env(safe-area-inset-bottom);
    }
    
    .mobile-simulator {
      width: 100%;
      max-width: 430px;
      margin: 0 auto;
      background: #f5f7fa;
      min-height: 100vh;
      position: relative;
      box-shadow: 0 0 40px rgba(0,0,0,0.2);
    }
    
    .status-bar {
      background: white;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: #666;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .test-section {
      background: white;
      margin: 10px;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .test-section h3 {
      font-size: 16px;
      color: #333;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .test-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .test-btn {
      padding: 12px 8px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }
    
    .test-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%);
      transition: width 0.4s, height 0.4s;
    }
    
    .test-btn:active::before {
      width: 200px;
      height: 200px;
    }
    
    .test-btn:active {
      transform: scale(0.95);
    }
    
    .test-btn.secondary {
      background: #6b7280;
    }
    
    .test-btn.success {
      background: #10b981;
    }
    
    .test-btn.warning {
      background: #f59e0b;
    }
    
    .test-btn.danger {
      background: #ef4444;
    }
    
    .test-btn.full {
      grid-column: 1 / -1;
    }
    
    .config-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
    }
    
    .config-item label {
      font-size: 14px;
      color: #555;
    }
    
    .config-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
    }
    
    .config-item input[type="text"],
    .config-item select {
      padding: 6px 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      width: 120px;
    }
    
    .device-info {
      background: #f0f9ff;
      padding: 10px;
      border-radius: 8px;
      margin: 10px 0;
      font-size: 12px;
      color: #0369a1;
    }
    
    .drawer-content {
      padding: 20px;
    }
    
    .drawer-content h2 {
      font-size: 20px;
      color: #333;
      margin-bottom: 15px;
    }
    
    .drawer-content .info {
      background: #f9fafb;
      padding: 12px;
      border-radius: 8px;
      margin: 10px 0;
      font-size: 14px;
      line-height: 1.6;
    }
    
    .drawer-content .long-content {
      height: 800px;
      background: linear-gradient(to bottom, #fef3c7, #fde68a);
      padding: 20px;
      border-radius: 8px;
      margin-top: 15px;
    }
    
    .drawer-content .long-content h3 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .drawer-content .long-content p {
      margin: 10px 0;
      line-height: 1.8;
    }
    
    /* é€‚é… iPhone åˆ˜æµ·å± */
    @supports (padding: env(safe-area-inset-top)) {
      .status-bar {
        padding-top: calc(10px + env(safe-area-inset-top));
      }
    }
    
    /* æ¨ªå±é€‚é… */
    @media (orientation: landscape) {
      .mobile-simulator {
        max-width: 100%;
      }
      
      .test-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    /* å°å±å¹•é€‚é… */
    @media (max-width: 360px) {
      .test-grid {
        grid-template-columns: 1fr;
      }
      
      .test-btn {
        padding: 14px 12px;
      }
    }
  </style>
  <script type="module" src="/build/ldesign-webcomponent.esm.js"></script>
</head>
<body>
  <div class="mobile-simulator">
    <div class="status-bar">
      <span id="deviceType">æ£€æµ‹ä¸­...</span>
      <span id="screenSize">--x--</span>
    </div>
    
    <div class="test-section">
      <h3>ğŸ“± è®¾å¤‡ä¿¡æ¯</h3>
      <div class="device-info" id="deviceInfo">
        æ­£åœ¨è·å–è®¾å¤‡ä¿¡æ¯...
      </div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ¯ åŸºç¡€æµ‹è¯•</h3>
      <div class="test-grid">
        <button class="test-btn" onclick="testDrawer('right')">å³ä¾§æŠ½å±‰</button>
        <button class="test-btn" onclick="testDrawer('left')">å·¦ä¾§æŠ½å±‰</button>
        <button class="test-btn" onclick="testDrawer('top')">é¡¶éƒ¨æŠ½å±‰</button>
        <button class="test-btn" onclick="testDrawer('bottom')">åº•éƒ¨æŠ½å±‰</button>
      </div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ“ å°ºå¯¸æµ‹è¯•</h3>
      <div class="test-grid">
        <button class="test-btn secondary" onclick="testSize('100%')">å…¨å± (100%)</button>
        <button class="test-btn secondary" onclick="testSize('90%')">90% å®½åº¦</button>
        <button class="test-btn secondary" onclick="testSize('80%')">80% å®½åº¦</button>
        <button class="test-btn secondary" onclick="testSize('60%')">60% å®½åº¦</button>
        <button class="test-btn secondary" onclick="testSize('300px')">300px å›ºå®š</button>
        <button class="test-btn secondary" onclick="testSize('50vh')">50vh é«˜åº¦</button>
      </div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ¨ åŠŸèƒ½æµ‹è¯•</h3>
      <div class="test-grid">
        <button class="test-btn success" onclick="testSwipeClose()">æ»‘åŠ¨å…³é—­</button>
        <button class="test-btn success" onclick="testResizable()">è°ƒæ•´å¤§å°</button>
        <button class="test-btn success" onclick="testFullscreen()">å…¨å±åˆ‡æ¢</button>
        <button class="test-btn success" onclick="testScrollContent()">é•¿å†…å®¹æ»šåŠ¨</button>
        <button class="test-btn warning full" onclick="testAllDirections()">è‡ªåŠ¨æµ‹è¯•æ‰€æœ‰æ–¹å‘</button>
        <button class="test-btn danger full" onclick="testStress()">å‹åŠ›æµ‹è¯•</button>
      </div>
    </div>
    
    <div class="test-section">
      <h3>âš™ï¸ é…ç½®</h3>
      <div class="config-item">
        <label>å¯ç”¨é®ç½©</label>
        <input type="checkbox" id="maskEnabled" checked>
      </div>
      <div class="config-item">
        <label>åœ†è§’æ ·å¼</label>
        <input type="checkbox" id="roundedEnabled" checked>
      </div>
      <div class="config-item">
        <label>æ»‘åŠ¨å…³é—­</label>
        <input type="checkbox" id="swipeEnabled" checked>
      </div>
      <div class="config-item">
        <label>å¯è°ƒæ•´å¤§å°</label>
        <input type="checkbox" id="resizableEnabled" checked>
      </div>
      <div class="config-item">
        <label>åŠ¨ç”»æ—¶é•¿</label>
        <select id="animDuration">
          <option value="200">200ms</option>
          <option value="300" selected>300ms</option>
          <option value="500">500ms</option>
        </select>
      </div>
    </div>
  </div>
  
  <!-- Drawer ç»„ä»¶å®ä¾‹ -->
  <ldesign-drawer id="testDrawer">
    <div class="drawer-content">
      <h2 id="drawerTitle">æµ‹è¯•æŠ½å±‰</h2>
      <div class="info" id="drawerInfo">
        æ­£åœ¨åŠ è½½ä¿¡æ¯...
      </div>
      <div id="scrollContent" style="display: none;">
        <div class="long-content">
          <h3>ğŸ“œ æ»šåŠ¨æµ‹è¯•å†…å®¹</h3>
          <p>è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å†…å®¹åŒºåŸŸï¼Œç”¨äºæµ‹è¯•æŠ½å±‰å†…çš„æ»šåŠ¨åŠŸèƒ½ã€‚</p>
          <p>åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œéœ€è¦ç¡®ä¿æ»šåŠ¨æµç•…ï¼Œå¹¶ä¸”ä¸ä¼šä¸æ»‘åŠ¨å…³é—­æ‰‹åŠ¿å†²çªã€‚</p>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
          <p>ç»§ç»­æ»šåŠ¨æŸ¥çœ‹æ›´å¤šå†…å®¹...</p>
          <p>1. æµ‹è¯•é¡¹ç›®ä¸€</p>
          <p>2. æµ‹è¯•é¡¹ç›®äºŒ</p>
          <p>3. æµ‹è¯•é¡¹ç›®ä¸‰</p>
          <p>4. æµ‹è¯•é¡¹ç›®å››</p>
          <p>5. æµ‹è¯•é¡¹ç›®äº”</p>
          <p>6. æµ‹è¯•é¡¹ç›®å…­</p>
          <p>7. æµ‹è¯•é¡¹ç›®ä¸ƒ</p>
          <p>8. æµ‹è¯•é¡¹ç›®å…«</p>
          <p>9. æµ‹è¯•é¡¹ç›®ä¹</p>
          <p>10. æµ‹è¯•é¡¹ç›®å</p>
          <p>ç»§ç»­æ·»åŠ æ›´å¤šå†…å®¹ä»¥ç¡®ä¿å¯ä»¥æ»šåŠ¨...</p>
          <p>è¿™é‡Œæ˜¯åº•éƒ¨å†…å®¹</p>
        </div>
      </div>
    </div>
  </ldesign-drawer>
  
  <script>
    const drawer = document.getElementById('testDrawer');
    let currentConfig = {};
    
    // è·å–è®¾å¤‡ä¿¡æ¯
    function updateDeviceInfo() {
      const ua = navigator.userAgent;
      const width = window.innerWidth;
      const height = window.innerHeight;
      const dpr = window.devicePixelRatio || 1;
      
      let deviceType = 'æ¡Œé¢ç«¯';
      let os = 'Unknown';
      
      if (/iPhone|iPad|iPod/.test(ua)) {
        deviceType = width <= 430 ? 'iPhone' : 'iPad';
        os = 'iOS';
      } else if (/Android/.test(ua)) {
        deviceType = width <= 430 ? 'Androidæ‰‹æœº' : 'Androidå¹³æ¿';
        os = 'Android';
      } else if (width <= 768) {
        deviceType = 'å°å±è®¾å¤‡';
      }
      
      document.getElementById('deviceType').textContent = deviceType;
      document.getElementById('screenSize').textContent = `${width}Ã—${height}`;
      
      const orientation = width > height ? 'æ¨ªå±' : 'ç«–å±';
      const touchSupport = 'ontouchstart' in window ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ';
      
      document.getElementById('deviceInfo').innerHTML = `
        <strong>è®¾å¤‡ï¼š</strong>${deviceType} (${os})<br>
        <strong>è§†å£ï¼š</strong>${width} Ã— ${height}px<br>
        <strong>DPRï¼š</strong>${dpr}<br>
        <strong>æ–¹å‘ï¼š</strong>${orientation}<br>
        <strong>è§¦æ‘¸ï¼š</strong>${touchSupport}<br>
        <strong>ç”¨æˆ·ä»£ç†ï¼š</strong>${ua.substring(0, 50)}...
      `;
    }
    
    // è·å–å½“å‰é…ç½®
    function getCurrentConfig() {
      return {
        mask: document.getElementById('maskEnabled').checked,
        rounded: document.getElementById('roundedEnabled').checked,
        swipeToClose: document.getElementById('swipeEnabled').checked,
        resizable: document.getElementById('resizableEnabled').checked,
        animationDuration: parseInt(document.getElementById('animDuration').value),
        closable: true,
        showResizeHint: true,
        damping: true,
        swipeTriggerArea: 'handle'
      };
    }
    
    // æ›´æ–°æŠ½å±‰ä¿¡æ¯
    function updateDrawerInfo(placement, size) {
      const config = getCurrentConfig();
      const width = window.innerWidth;
      const height = window.innerHeight;
      
      document.getElementById('drawerInfo').innerHTML = `
        <strong>ğŸ“ æ–¹å‘ï¼š</strong>${placement}<br>
        <strong>ğŸ“ å°ºå¯¸ï¼š</strong>${size}<br>
        <strong>ğŸ“± è§†å£ï¼š</strong>${width} Ã— ${height}px<br>
        <strong>âœ… é®ç½©ï¼š</strong>${config.mask ? 'å¯ç”¨' : 'ç¦ç”¨'}<br>
        <strong>ğŸ¨ åœ†è§’ï¼š</strong>${config.rounded ? 'å¯ç”¨' : 'ç¦ç”¨'}<br>
        <strong>ğŸ‘† æ»‘åŠ¨å…³é—­ï¼š</strong>${config.swipeToClose ? 'å¯ç”¨' : 'ç¦ç”¨'}<br>
        <strong>â†”ï¸ å¯è°ƒæ•´ï¼š</strong>${config.resizable ? 'å¯ç”¨' : 'ç¦ç”¨'}<br>
        <strong>â±ï¸ åŠ¨ç”»æ—¶é•¿ï¼š</strong>${config.animationDuration}ms
      `;
    }
    
    // åŸºç¡€æµ‹è¯•
    function testDrawer(placement) {
      const config = getCurrentConfig();
      drawer.placement = placement;
      
      // ç§»åŠ¨ç«¯æ™ºèƒ½å°ºå¯¸
      let size = '80%';
      if (placement === 'top' || placement === 'bottom') {
        size = '60%';
      }
      
      drawer.size = size;
      drawer.drawerTitle = `${placement.toUpperCase()} æ–¹å‘æŠ½å±‰`;
      Object.assign(drawer, config);
      
      // éšè—æ»šåŠ¨å†…å®¹
      document.getElementById('scrollContent').style.display = 'none';
      
      drawer.visible = true;
      updateDrawerInfo(placement, size);
    }
    
    // å°ºå¯¸æµ‹è¯•
    function testSize(size) {
      const config = getCurrentConfig();
      drawer.placement = 'right';
      drawer.size = size;
      drawer.drawerTitle = `å°ºå¯¸æµ‹è¯•ï¼š${size}`;
      Object.assign(drawer, config);
      
      document.getElementById('scrollContent').style.display = 'none';
      drawer.visible = true;
      updateDrawerInfo('right', size);
    }
    
    // æ»‘åŠ¨å…³é—­æµ‹è¯•
    function testSwipeClose() {
      const config = getCurrentConfig();
      drawer.placement = 'bottom';
      drawer.size = '50%';
      drawer.drawerTitle = 'ğŸ‘† æ»‘åŠ¨å…³é—­æµ‹è¯•';
      drawer.swipeToClose = true;
      drawer.swipeTriggerArea = 'handle';
      drawer.showResizeHint = true;
      Object.assign(drawer, config);
      
      document.getElementById('scrollContent').style.display = 'none';
      drawer.visible = true;
      updateDrawerInfo('bottom', '50%');
    }
    
    // è°ƒæ•´å¤§å°æµ‹è¯•
    function testResizable() {
      drawer.placement = 'right';
      drawer.size = '70%';
      drawer.drawerTitle = 'â†”ï¸ è°ƒæ•´å¤§å°æµ‹è¯•';
      drawer.resizable = true;
      drawer.resizeMode = 'edge';
      drawer.minSize = '30%';
      drawer.maxSize = '95%';
      drawer.showResizeHint = true;
      drawer.damping = true;
      
      const config = getCurrentConfig();
      Object.assign(drawer, config);
      
      document.getElementById('scrollContent').style.display = 'none';
      drawer.visible = true;
      updateDrawerInfo('right', '70%');
    }
    
    // å…¨å±æµ‹è¯•
    function testFullscreen() {
      drawer.placement = 'right';
      drawer.size = '80%';
      drawer.drawerTitle = 'ğŸ“º å…¨å±æµ‹è¯•';
      drawer.fullscreenable = true;
      drawer.fullscreen = false;
      
      const config = getCurrentConfig();
      Object.assign(drawer, config);
      
      document.getElementById('scrollContent').style.display = 'none';
      drawer.visible = true;
      updateDrawerInfo('right', '80%');
    }
    
    // æ»šåŠ¨å†…å®¹æµ‹è¯•
    function testScrollContent() {
      drawer.placement = 'bottom';
      drawer.size = '70%';
      drawer.drawerTitle = 'ğŸ“œ æ»šåŠ¨å†…å®¹æµ‹è¯•';
      drawer.swipeToClose = true;
      drawer.swipeTriggerArea = 'handle';
      
      const config = getCurrentConfig();
      Object.assign(drawer, config);
      
      // æ˜¾ç¤ºæ»šåŠ¨å†…å®¹
      document.getElementById('scrollContent').style.display = 'block';
      drawer.visible = true;
      updateDrawerInfo('bottom', '70%');
    }
    
    // æµ‹è¯•æ‰€æœ‰æ–¹å‘
    async function testAllDirections() {
      const placements = ['right', 'left', 'top', 'bottom'];
      const sizes = ['80%', '80%', '60%', '60%'];
      
      for (let i = 0; i < placements.length; i++) {
        const placement = placements[i];
        const size = sizes[i];
        
        drawer.placement = placement;
        drawer.size = size;
        drawer.drawerTitle = `è‡ªåŠ¨æµ‹è¯•ï¼š${placement.toUpperCase()}`;
        
        const config = getCurrentConfig();
        Object.assign(drawer, config);
        
        document.getElementById('scrollContent').style.display = 'none';
        drawer.visible = true;
        updateDrawerInfo(placement, size);
        
        await new Promise(resolve => setTimeout(resolve, 1500));
        drawer.visible = false;
        await new Promise(resolve => setTimeout(resolve, 500));
      }
    }
    
    // å‹åŠ›æµ‹è¯•
    async function testStress() {
      const configs = [
        { placement: 'right', size: '100%' },
        { placement: 'left', size: '10%' },
        { placement: 'top', size: '90%' },
        { placement: 'bottom', size: '30%' },
        { placement: 'right', size: '200px' },
        { placement: 'left', size: '50vw' },
        { placement: 'top', size: '80vh' },
        { placement: 'bottom', size: '400px' }
      ];
      
      for (const conf of configs) {
        drawer.placement = conf.placement;
        drawer.size = conf.size;
        drawer.drawerTitle = `å‹åŠ›æµ‹è¯•ï¼š${conf.placement} - ${conf.size}`;
        
        const config = getCurrentConfig();
        Object.assign(drawer, config);
        
        drawer.visible = true;
        await new Promise(resolve => setTimeout(resolve, 800));
        drawer.visible = false;
        await new Promise(resolve => setTimeout(resolve, 200));
      }
    }
    
    // ç›‘å¬çª—å£å˜åŒ–
    window.addEventListener('resize', updateDeviceInfo);
    window.addEventListener('orientationchange', updateDeviceInfo);
    
    // ç›‘å¬æŠ½å±‰äº‹ä»¶
    drawer.addEventListener('ldesignClose', () => {
      console.log('Drawer closed');
      document.getElementById('scrollContent').style.display = 'none';
    });
    
    drawer.addEventListener('ldesignSizeChange', (e) => {
      console.log('Size changed:', e.detail);
    });
    
    // åˆå§‹åŒ–
    updateDeviceInfo();
  </script>
</body>
</html>