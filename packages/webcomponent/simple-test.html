<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>简单测试</title>
  <script type="module" src="./dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
  <link rel="stylesheet" href="./dist/ldesign-webcomponent/ldesign-webcomponent.css">
  <style>
    body { padding: 20px; }
    .info { 
      margin: 20px 0; 
      padding: 10px; 
      background: #f0f0f0; 
      font-size: 12px;
    }
    /* 临时修复样式 */
    textarea.ldesign-input {
      overflow-y: auto !important;
    }
  </style>
</head>
<body>
  <h1>问题诊断</h1>

  <h2>1. Textarea 测试</h2>
  <ldesign-input type="textarea" id="textarea1" value="第一行
第二行
第三行
第四行
第五行
第六行
第七行"></ldesign-input>
  
  <h2>2. 输入限制测试</h2>
  <ldesign-input id="input1" placeholder="只能输入数字"></ldesign-input>
  
  <div class="info" id="info">等待...</div>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const textarea1 = document.getElementById('textarea1');
      const input1 = document.getElementById('input1');
      
      // 设置autosize
      console.log('设置前:', textarea1.autosize);
      textarea1.autosize = { minRows: 2, maxRows: 5 };
      console.log('设置后:', textarea1.autosize);
      
      // 设置输入限制
      console.log('设置前allowInput:', input1.allowInput);
      input1.allowInput = /^\d*$/;
      console.log('设置后allowInput:', input1.allowInput);
      
      // 检查实际DOM
      setTimeout(() => {
        const textareaEl = textarea1.querySelector('textarea');
        const inputEl = input1.querySelector('input');
        
        const info = {
          textarea: {
            exists: !!textareaEl,
            style: textareaEl ? {
              overflow: textareaEl.style.overflow,
              overflowY: textareaEl.style.overflowY,
              height: textareaEl.style.height,
              computedOverflowY: textareaEl ? window.getComputedStyle(textareaEl).overflowY : null
            } : null,
            scrollHeight: textareaEl?.scrollHeight,
            clientHeight: textareaEl?.clientHeight
          },
          input: {
            exists: !!inputEl,
            value: inputEl?.value
          },
          componentProps: {
            textarea_autosize: textarea1.autosize,
            input_allowInput: input1.allowInput
          }
        };
        
        document.getElementById('info').innerHTML = '<pre>' + JSON.stringify(info, null, 2) + '</pre>';
        
        // 测试输入
        if (inputEl) {
          console.log('测试输入abc123...');
          inputEl.value = 'abc123';
          inputEl.dispatchEvent(new Event('input', { bubbles: true }));
          
          setTimeout(() => {
            console.log('输入后的值:', inputEl.value);
            info.input.afterTestValue = inputEl.value;
            document.getElementById('info').innerHTML = '<pre>' + JSON.stringify(info, null, 2) + '</pre>';
          }, 100);
        }
      }, 1000);
    });
  </script>
</body>
</html>