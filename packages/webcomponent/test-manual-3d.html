<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual 3D Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 40px;
            background: #f5f5f5;
            display: flex;
            gap: 40px;
            align-items: center;
            justify-content: center;
        }
        
        /* Working 3D Picker */
        .manual-picker {
            width: 200px;
            height: 180px;
            overflow: hidden;
            position: relative;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            
            /* 3D perspective on container */
            perspective: 600px;
            perspective-origin: center;
        }
        
        .manual-list {
            list-style: none;
            margin: 0;
            padding: 0;
            position: relative;
            transform: translateY(72px); /* Center the list */
            
            /* Enable 3D for children */
            transform-style: preserve-3d;
        }
        
        .manual-item {
            height: 36px;
            line-height: 36px;
            text-align: center;
            font-size: 16px;
            color: #333;
            
            /* 3D transform origin - behind the item */
            transform-origin: center center -120px;
        }
        
        /* Manual 3D transforms for each item */
        .manual-item:nth-child(1) {
            transform: rotateX(44deg) translateZ(120px) scale(0.7);
            opacity: 0.6;
        }
        .manual-item:nth-child(2) {
            transform: rotateX(22deg) translateZ(120px) scale(0.85);
            opacity: 0.8;
        }
        .manual-item:nth-child(3) {
            transform: rotateX(0deg) translateZ(120px) scale(1.1);
            opacity: 1;
            color: #1890ff;
            font-weight: 600;
        }
        .manual-item:nth-child(4) {
            transform: rotateX(-22deg) translateZ(120px) scale(0.85);
            opacity: 0.8;
        }
        .manual-item:nth-child(5) {
            transform: rotateX(-44deg) translateZ(120px) scale(0.7);
            opacity: 0.6;
        }
        
        /* Center indicator */
        .manual-indicator {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 36px;
            transform: translateY(-50%);
            background: rgba(24, 144, 255, 0.08);
            border-top: 1px solid rgba(24, 144, 255, 0.2);
            border-bottom: 1px solid rgba(24, 144, 255, 0.2);
            pointer-events: none;
        }
        
        /* Gradient masks */
        .manual-mask-top,
        .manual-mask-bottom {
            position: absolute;
            left: 0;
            right: 0;
            height: 30%;
            pointer-events: none;
            z-index: 10;
        }
        
        .manual-mask-top {
            top: 0;
            background: linear-gradient(to bottom, rgba(255,255,255,0.9), transparent);
        }
        
        .manual-mask-bottom {
            bottom: 0;
            background: linear-gradient(to top, rgba(255,255,255,0.9), transparent);
        }
        
        /* Test with Ldesign */
        .test-section {
            text-align: center;
        }
        
        h3 {
            margin-bottom: 20px;
            color: #333;
        }
        
        .debug-info {
            margin-top: 20px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 8px;
            text-align: left;
            font-size: 13px;
            color: #666;
        }
    </style>
    <script type="module" src="./dist/ldesign/ldesign.esm.js"></script>
    <link rel="stylesheet" href="./dist/ldesign/ldesign.css">
</head>
<body>
    <!-- Manual 3D implementation -->
    <div class="test-section">
        <h3>手动实现的 3D 效果</h3>
        <div class="manual-picker">
            <div class="manual-indicator"></div>
            <ul class="manual-list">
                <li class="manual-item">选项 1</li>
                <li class="manual-item">选项 2</li>
                <li class="manual-item">选项 3</li>
                <li class="manual-item">选项 4</li>
                <li class="manual-item">选项 5</li>
            </ul>
            <div class="manual-mask-top"></div>
            <div class="manual-mask-bottom"></div>
        </div>
        <div class="debug-info">
            <strong>CSS 实现要点：</strong><br>
            • perspective: 600px<br>
            • transform-origin: center center -120px<br>
            • rotateX() + translateZ() + scale()<br>
            • opacity 渐变
        </div>
    </div>
    
    <!-- Ldesign Picker -->
    <div class="test-section">
        <h3>Ldesign Picker 3D</h3>
        <ldesign-picker 
            id="test-picker"
            enable-3d
            visible-items="5"
            show-mask
            style="
                --ldesign-picker-3d-perspective: 600px;
                --ldesign-picker-3d-radius: 120px;
                --ldesign-picker-3d-rotate: 30deg;
                --ldesign-picker-3d-step-deg: 22deg;
                --ldesign-picker-3d-scale-min: 0.7;
                --ldesign-picker-3d-scale-max: 1.1;
            "
        ></ldesign-picker>
        <div class="debug-info">
            <strong>配置参数：</strong><br>
            • enable-3d: true<br>
            • perspective: 600px<br>
            • radius: 120px<br>
            • step-deg: 22deg
        </div>
    </div>
    
    <!-- Force styles test -->
    <div class="test-section">
        <h3>强制样式测试</h3>
        <ldesign-picker 
            id="force-picker"
            enable-3d
            visible-items="5"
            show-mask
        ></ldesign-picker>
        <div class="debug-info">
            <button onclick="forceStyles()">应用强制样式</button><br>
            <span id="force-status">点击按钮测试</span>
        </div>
    </div>
    
    <script>
        // Set up picker data
        const options = [];
        for (let i = 1; i <= 10; i++) {
            options.push({
                value: `item${i}`,
                label: `选项 ${i}`
            });
        }
        
        document.getElementById('test-picker').options = options;
        document.getElementById('test-picker').value = 'item3';
        
        document.getElementById('force-picker').options = options;
        document.getElementById('force-picker').value = 'item3';
        
        function forceStyles() {
            const picker = document.getElementById('force-picker');
            const container = picker.querySelector('.ldesign-picker__picker');
            const list = picker.querySelector('.ldesign-picker__column');
            const items = picker.querySelectorAll('.ldesign-picker__item');
            
            // Force perspective on container
            if (container) {
                container.style.perspective = '600px';
                container.style.perspectiveOrigin = 'center';
            }
            
            // Force transform-style on list
            if (list) {
                list.style.transformStyle = 'preserve-3d';
            }
            
            // Force transforms on items
            items.forEach((item, index) => {
                const offset = index - 2; // Center is at index 2
                const angle = offset * 22;
                const scale = 1.1 - Math.abs(offset) * 0.2;
                const opacity = 1 - Math.abs(offset) * 0.2;
                
                item.style.transformOrigin = 'center center -120px';
                item.style.transform = `rotateX(${angle}deg) translateZ(120px) scale(${scale})`;
                item.style.opacity = opacity;
            });
            
            document.getElementById('force-status').textContent = '样式已应用！';
        }
    </script>
</body>
</html>