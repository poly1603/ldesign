<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>移动端全屏抽屉测试 - 修复验证</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
    }
    
    .test-section {
      margin-bottom: 30px;
      padding: 15px;
      background: #fafafa;
      border-radius: 4px;
    }
    
    .test-section h2 {
      font-size: 18px;
      margin-bottom: 10px;
      color: #555;
    }
    
    .test-section p {
      margin-bottom: 10px;
      color: #666;
      line-height: 1.6;
    }
    
    button {
      padding: 10px 20px;
      font-size: 14px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: #1890ff;
      color: white;
      margin: 5px 5px 5px 0;
      transition: all 0.3s;
    }
    
    button:hover {
      background: #40a9ff;
    }
    
    button:active {
      background: #096dd9;
    }
    
    .success {
      background: #52c41a;
    }
    
    .success:hover {
      background: #73d13d;
    }
    
    .info-box {
      background: #e6f7ff;
      border: 1px solid #91d5ff;
      padding: 12px;
      border-radius: 4px;
      margin-top: 15px;
    }
    
    .info-box strong {
      color: #0050b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🧪 移动端全屏抽屉修复验证</h1>
    
    <div class="test-section">
      <h2>测试 1: 基础全屏模式</h2>
      <p>点击按钮打开全屏抽屉，检查是否完全铺满屏幕（无白边、无溢出）</p>
      <button onclick="openDrawer('fullscreenDrawer1')">打开全屏抽屉</button>
      <div class="info-box">
        <strong>预期效果：</strong> 抽屉应该完全填充整个视口，没有任何边距，没有圆角，四个边缘都对齐屏幕边缘。
      </div>
    </div>
    
    <div class="test-section">
      <h2>测试 2: 带滑动关闭的全屏</h2>
      <p>测试全屏模式下的滑动关闭功能</p>
      <button onclick="openDrawer('fullscreenDrawer2')">打开可滑动全屏抽屉</button>
      <div class="info-box">
        <strong>预期效果：</strong> 全屏显示且支持向下/向右滑动关闭（根据方向）。
      </div>
    </div>
    
    <div class="test-section">
      <h2>测试 3: 不同方向的全屏</h2>
      <p>测试从不同方向弹出的全屏抽屉</p>
      <button onclick="openDrawer('fullscreenLeft')">左侧全屏</button>
      <button onclick="openDrawer('fullscreenRight')">右侧全屏</button>
      <button onclick="openDrawer('fullscreenTop')">顶部全屏</button>
      <button onclick="openDrawer('fullscreenBottom')">底部全屏</button>
      <div class="info-box">
        <strong>预期效果：</strong> 所有方向的全屏抽屉都应该完全填充视口。
      </div>
    </div>
    
    <div class="test-section">
      <h2>测试 4: 移动端模拟</h2>
      <p>在桌面浏览器中使用开发者工具的移动设备模拟器测试</p>
      <button onclick="openDrawer('mobileFullscreenDrawer')" class="success">打开移动端全屏（推荐）</button>
      <div class="info-box">
        <strong>测试步骤：</strong><br>
        1. 打开浏览器开发者工具（F12）<br>
        2. 切换到设备模拟模式（Ctrl+Shift+M 或点击设备工具栏图标）<br>
        3. 选择一个移动设备（如 iPhone 14 Pro）<br>
        4. 点击按钮打开抽屉，检查是否完全填充屏幕
      </div>
    </div>
  </div>
  
  <!-- 测试用的抽屉组件 -->
  <ldesign-drawer 
    id="fullscreenDrawer1" 
    drawer-title="基础全屏抽屉" 
    fullscreen="true"
    animation="true">
    <div style="padding: 20px;">
      <h3>全屏模式测试</h3>
      <p>这个抽屉应该完全填充整个屏幕，没有任何边距或圆角。</p>
      <p style="margin-top: 15px; color: #666;">检查以下几点：</p>
      <ul style="margin: 10px 0 10px 20px; line-height: 1.8; color: #666;">
        <li>✓ 抽屉宽度 = 100vw（视口宽度）</li>
        <li>✓ 抽屉高度 = 100vh（视口高度）</li>
        <li>✓ 无左右边距</li>
        <li>✓ 无上下边距</li>
        <li>✓ 无圆角</li>
        <li>✓ 内容不超出屏幕边界</li>
      </ul>
      <button onclick="document.getElementById('fullscreenDrawer1').close()" style="margin-top: 20px;">关闭抽屉</button>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="fullscreenDrawer2" 
    drawer-title="滑动关闭全屏" 
    fullscreen="true"
    swipe-to-close="true"
    swipe-threshold="0.3"
    animation="true">
    <div style="padding: 20px;">
      <h3>全屏 + 滑动关闭</h3>
      <p>这个抽屉支持滑动关闭功能。</p>
      <p style="margin-top: 15px; color: #999;">💡 提示：向下滑动可以关闭抽屉</p>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="fullscreenLeft" 
    drawer-title="左侧全屏" 
    placement="left"
    fullscreen="true"
    animation="true">
    <div style="padding: 20px;">
      <h3>左侧全屏抽屉</h3>
      <p>从左侧滑入的全屏抽屉。</p>
      <button onclick="document.getElementById('fullscreenLeft').close()" style="margin-top: 20px;">关闭</button>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="fullscreenRight" 
    drawer-title="右侧全屏" 
    placement="right"
    fullscreen="true"
    animation="true">
    <div style="padding: 20px;">
      <h3>右侧全屏抽屉</h3>
      <p>从右侧滑入的全屏抽屉。</p>
      <button onclick="document.getElementById('fullscreenRight').close()" style="margin-top: 20px;">关闭</button>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="fullscreenTop" 
    drawer-title="顶部全屏" 
    placement="top"
    fullscreen="true"
    animation="true">
    <div style="padding: 20px;">
      <h3>顶部全屏抽屉</h3>
      <p>从顶部滑入的全屏抽屉。</p>
      <button onclick="document.getElementById('fullscreenTop').close()" style="margin-top: 20px;">关闭</button>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="fullscreenBottom" 
    drawer-title="底部全屏" 
    placement="bottom"
    fullscreen="true"
    animation="true">
    <div style="padding: 20px;">
      <h3>底部全屏抽屉</h3>
      <p>从底部滑入的全屏抽屉。</p>
      <button onclick="document.getElementById('fullscreenBottom').close()" style="margin-top: 20px;">关闭</button>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="mobileFullscreenDrawer" 
    drawer-title="移动端全屏示例" 
    fullscreen="true"
    swipe-to-close="true"
    animation="true">
    <div style="padding: 20px;">
      <h3 style="color: #52c41a;">✅ 移动端全屏模式</h3>
      <p style="margin-top: 15px;">这是文档中使用的移动端全屏示例。</p>
      <p style="margin-top: 10px; color: #666;">在移动设备或浏览器的设备模拟器中，这个抽屉应该：</p>
      <ul style="margin: 10px 0 10px 20px; line-height: 1.8; color: #666;">
        <li>完全填充整个屏幕</li>
        <li>没有白边或溢出</li>
        <li>支持滑动关闭</li>
        <li>正确适配安全区域（刘海屏等）</li>
      </ul>
      <div style="margin-top: 30px; padding: 15px; background: #f6ffed; border: 1px solid #b7eb8f; border-radius: 4px;">
        <strong style="color: #389e0d;">修复说明：</strong>
        <p style="margin-top: 8px; color: #52c41a; line-height: 1.6;">
          通过在 componentWillLoad 中添加 <code style="background: #fff; padding: 2px 6px; border-radius: 2px;">this.isFullscreen = this.fullscreen;</code>，
          确保全屏属性在组件初始化时正确应用，从而修复了全屏模式下的显示问题。
        </p>
      </div>
    </div>
  </ldesign-drawer>
  
  <script type="module" src="./dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
  
  <script>
    function openDrawer(id) {
      const drawer = document.getElementById(id);
      if (drawer) {
        drawer.open();
      } else {
        console.error('Drawer not found:', id);
      }
    }
    
    // 等待组件加载
    window.addEventListener('DOMContentLoaded', () => {
      console.log('Test page loaded');
      console.log('Available drawers:', Array.from(document.querySelectorAll('ldesign-drawer')).map(d => d.id));
    });
  </script>
</body>
</html>
