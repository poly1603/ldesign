<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>锚点部分遮罩抽屉 - 铺满区域测试</title>
  <script type="module" src="./dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }
    
    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 32px;
    }
    
    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 16px;
    }
    
    .test-section {
      margin: 40px 0;
      padding: 30px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }
    
    .test-section h2 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 24px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .test-section .description {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.6;
      font-size: 14px;
    }
    
    .button-group {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .test-btn {
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 500;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .test-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .test-btn:active {
      transform: translateY(0);
    }
    
    .btn-bottom {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-top {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }
    
    .btn-left {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
    }
    
    .btn-right {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      color: white;
    }
    
    .expected {
      margin-top: 20px;
      padding: 15px;
      background: white;
      border-radius: 6px;
      border: 2px dashed #28a745;
    }
    
    .expected h3 {
      color: #28a745;
      margin-bottom: 10px;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .expected ul {
      margin-left: 20px;
      color: #666;
      line-height: 1.8;
    }
    
    .expected ul li {
      margin-bottom: 5px;
    }
    
    .coordinate-display {
      margin-top: 15px;
      padding: 12px;
      background: #e3f2fd;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      color: #1976d2;
    }
    
    .warning {
      margin-top: 20px;
      padding: 15px;
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      border-radius: 4px;
    }
    
    .warning h3 {
      color: #856404;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .warning p {
      color: #856404;
      font-size: 13px;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>🎯 锚点部分遮罩抽屉 - 铺满区域测试</h1>
    <p class="subtitle">验证抽屉是否从按钮位置向指定方向铺满整个区域</p>
    
    <!-- 测试 1: 向下展开 -->
    <div class="test-section">
      <h2>
        <span>📍</span>
        测试 1：向下展开（最常用场景）
      </h2>
      <div class="description">
        点击按钮后，抽屉应该：
        <br>1. 从按钮的<strong>底部边缘</strong>开始
        <br>2. 向下铺满到<strong>屏幕底部</strong>
        <br>3. 左右铺满<strong>整个屏幕宽度</strong>
        <br>4. 遮罩只覆盖<strong>按钮下方区域</strong>
      </div>
      
      <div class="button-group">
        <button id="btnBottom" class="test-btn btn-bottom">
          <span>向下展开</span>
          <span>▼</span>
        </button>
      </div>
      
      <div class="expected">
        <h3>✅ 预期效果</h3>
        <ul>
          <li>抽屉紧贴按钮底部，无缝隙</li>
          <li>抽屉高度 = 屏幕高度 - 按钮底部位置</li>
          <li>抽屉宽度 = 屏幕宽度（100vw）</li>
          <li>按钮上方区域保持透明可交互</li>
        </ul>
      </div>
      
      <div id="coordsBottom" class="coordinate-display"></div>
    </div>
    
    <!-- 测试 2: 向上展开 -->
    <div class="test-section">
      <h2>
        <span>📍</span>
        测试 2：向上展开
      </h2>
      <div class="description">
        点击按钮后，抽屉应该：
        <br>1. 从<strong>屏幕顶部</strong>开始
        <br>2. 向下延伸到按钮的<strong>顶部边缘</strong>
        <br>3. 左右铺满<strong>整个屏幕宽度</strong>
        <br>4. 遮罩只覆盖<strong>按钮上方区域</strong>
      </div>
      
      <div class="button-group">
        <button id="btnTop" class="test-btn btn-top">
          <span>向上展开</span>
          <span>▲</span>
        </button>
      </div>
      
      <div class="expected">
        <h3>✅ 预期效果</h3>
        <ul>
          <li>抽屉从屏幕顶部开始（top: 0）</li>
          <li>抽屉高度 = 按钮顶部位置</li>
          <li>抽屉宽度 = 屏幕宽度（100vw）</li>
          <li>按钮下方区域保持透明可交互</li>
        </ul>
      </div>
      
      <div id="coordsTop" class="coordinate-display"></div>
    </div>
    
    <!-- 测试 3: 向左展开 -->
    <div class="test-section">
      <h2>
        <span>📍</span>
        测试 3：向左展开
      </h2>
      <div class="description">
        点击按钮后，抽屉应该：
        <br>1. 从<strong>屏幕左边缘</strong>开始
        <br>2. 向右延伸到按钮的<strong>左边缘</strong>
        <br>3. 上下铺满<strong>整个屏幕高度</strong>
        <br>4. 遮罩只覆盖<strong>按钮左侧区域</strong>
      </div>
      
      <div class="button-group">
        <button id="btnLeft" class="test-btn btn-left">
          <span>向左展开</span>
          <span>◀</span>
        </button>
      </div>
      
      <div class="expected">
        <h3>✅ 预期效果</h3>
        <ul>
          <li>抽屉从屏幕左边缘开始（left: 0）</li>
          <li>抽屉宽度 = 按钮左边缘位置</li>
          <li>抽屉高度 = 屏幕高度（100vh）</li>
          <li>按钮右侧区域保持透明可交互</li>
        </ul>
      </div>
      
      <div id="coordsLeft" class="coordinate-display"></div>
    </div>
    
    <!-- 测试 4: 向右展开 -->
    <div class="test-section">
      <h2>
        <span>📍</span>
        测试 4：向右展开
      </h2>
      <div class="description">
        点击按钮后，抽屉应该：
        <br>1. 从按钮的<strong>右边缘</strong>开始
        <br>2. 向右延伸到<strong>屏幕右边缘</strong>
        <br>3. 上下铺满<strong>整个屏幕高度</strong>
        <br>4. 遮罩只覆盖<strong>按钮右侧区域</strong>
      </div>
      
      <div class="button-group">
        <button id="btnRight" class="test-btn btn-right">
          <span>向右展开</span>
          <span>▶</span>
        </button>
      </div>
      
      <div class="expected">
        <h3>✅ 预期效果</h3>
        <ul>
          <li>抽屉从按钮右边缘开始</li>
          <li>抽屉宽度 = 屏幕宽度 - 按钮右边缘位置</li>
          <li>抽屉高度 = 屏幕高度（100vh）</li>
          <li>按钮左侧区域保持透明可交互</li>
        </ul>
      </div>
      
      <div id="coordsRight" class="coordinate-display"></div>
    </div>
    
    <!-- 警告信息 -->
    <div class="warning">
      <h3>⚠️ 检查要点</h3>
      <p>
        1. <strong>抽屉是否可见</strong> - 抽屉应该完全显示在屏幕上，不被遮罩盖住
        <br>2. <strong>尺寸是否正确</strong> - 抽屉应该铺满从按钮到屏幕边界的整个区域
        <br>3. <strong>遮罩范围</strong> - 遮罩只应该覆盖展开方向的区域
        <br>4. <strong>无缝对接</strong> - 抽屉边缘应该紧贴按钮边缘，无缝隙
        <br>5. <strong>其他区域可交互</strong> - 未展开的区域应该保持透明，可以点击其他元素
      </p>
    </div>
  </div>
  
  <!-- 抽屉元素 -->
  <ldesign-drawer 
    id="drawerBottom"
    placement="bottom"
    anchor-mode="element"
    anchor-mask-partial="true"
    drawer-title="向下展开的抽屉"
    animation="true">
    <div style="padding: 20px;">
      <h3 style="margin-top: 0; color: #667eea;">🎯 向下展开的抽屉</h3>
      <p>这个抽屉应该从按钮下方开始，铺满到屏幕底部。</p>
      
      <div style="background: #e3f2fd; padding: 15px; border-radius: 6px; margin-top: 15px;">
        <p style="margin: 0; color: #1976d2; font-weight: 500;">✅ 检查列表：</p>
        <ul style="margin: 10px 0 0 20px; color: #1976d2;">
          <li>抽屉左对齐屏幕左边缘</li>
          <li>抽屉右对齐屏幕右边缘</li>
          <li>抽屉顶部紧贴按钮底部</li>
          <li>抽屉底部对齐屏幕底部</li>
        </ul>
      </div>
      
      <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 6px; border: 2px solid #667eea;">
        <p style="color: #333; font-weight: 500; margin-bottom: 10px;">提示：打开开发者工具检查</p>
        <code style="display: block; background: #f5f5f5; padding: 10px; border-radius: 4px; font-size: 12px;">
          const wrapper = document.querySelector('#drawerBottom').shadowRoot.querySelector('.drawer-wrapper');<br>
          console.log('Position:', wrapper.style.position); // fixed<br>
          console.log('Top:', wrapper.style.top);<br>
          console.log('Left:', wrapper.style.left);<br>
          console.log('Width:', wrapper.style.width);<br>
          console.log('Height:', wrapper.style.height);
        </code>
      </div>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="drawerTop"
    placement="top"
    anchor-mode="element"
    anchor-mask-partial="true"
    drawer-title="向上展开的抽屉"
    animation="true">
    <div style="padding: 20px;">
      <h3 style="margin-top: 0; color: #f5576c;">⬆️ 向上展开的抽屉</h3>
      <p>这个抽屉应该从屏幕顶部开始，延伸到按钮顶部。</p>
      
      <div style="background: #fff3e0; padding: 15px; border-radius: 6px; margin-top: 15px;">
        <p style="margin: 0; color: #e65100; font-weight: 500;">✅ 检查列表：</p>
        <ul style="margin: 10px 0 0 20px; color: #e65100;">
          <li>抽屉顶部对齐屏幕顶部（top: 0）</li>
          <li>抽屉底部紧贴按钮顶部</li>
          <li>抽屉左右铺满屏幕宽度</li>
        </ul>
      </div>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="drawerLeft"
    placement="left"
    anchor-mode="element"
    anchor-mask-partial="true"
    drawer-title="向左展开的抽屉"
    animation="true">
    <div style="padding: 20px;">
      <h3 style="margin-top: 0; color: #00f2fe;">⬅️ 向左展开的抽屉</h3>
      <p>这个抽屉应该从屏幕左边缘开始，延伸到按钮左边缘。</p>
      
      <div style="background: #e1f5fe; padding: 15px; border-radius: 6px; margin-top: 15px;">
        <p style="margin: 0; color: #01579b; font-weight: 500;">✅ 检查列表：</p>
        <ul style="margin: 10px 0 0 20px; color: #01579b;">
          <li>抽屉左边缘对齐屏幕左边缘（left: 0）</li>
          <li>抽屉右边缘紧贴按钮左边缘</li>
          <li>抽屉上下铺满屏幕高度</li>
        </ul>
      </div>
    </div>
  </ldesign-drawer>
  
  <ldesign-drawer 
    id="drawerRight"
    placement="right"
    anchor-mode="element"
    anchor-mask-partial="true"
    drawer-title="向右展开的抽屉"
    animation="true">
    <div style="padding: 20px;">
      <h3 style="margin-top: 0; color: #38f9d7;">➡️ 向右展开的抽屉</h3>
      <p>这个抽屉应该从按钮右边缘开始，延伸到屏幕右边缘。</p>
      
      <div style="background: #e8f5e9; padding: 15px; border-radius: 6px; margin-top: 15px;">
        <p style="margin: 0; color: #2e7d32; font-weight: 500;">✅ 检查列表：</p>
        <ul style="margin: 10px 0 0 20px; color: #2e7d32;">
          <li>抽屉左边缘紧贴按钮右边缘</li>
          <li>抽屉右边缘对齐屏幕右边缘</li>
          <li>抽屉上下铺满屏幕高度</li>
        </ul>
      </div>
    </div>
  </ldesign-drawer>
  
  <script>
    // 显示按钮和屏幕坐标信息
    function displayCoordinates(btnId, displayId) {
      const btn = document.getElementById(btnId);
      const display = document.getElementById(displayId);
      
      const rect = btn.getBoundingClientRect();
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      
      display.innerHTML = `
        <strong>按钮坐标：</strong><br>
        Top: ${rect.top.toFixed(2)}px | Bottom: ${rect.bottom.toFixed(2)}px | 
        Left: ${rect.left.toFixed(2)}px | Right: ${rect.right.toFixed(2)}px<br>
        <strong>视口尺寸：</strong> ${vw}px × ${vh}px
      `;
    }
    
    // 向下展开
    const btnBottom = document.getElementById('btnBottom');
    const drawerBottom = document.getElementById('drawerBottom');
    
    btnBottom.addEventListener('click', function() {
      displayCoordinates('btnBottom', 'coordsBottom');
      drawerBottom.anchorElement = this;
      drawerBottom.open();
      
      console.log('=== 向下展开抽屉 ===');
      console.log('按钮坐标:', this.getBoundingClientRect());
      console.log('预期抽屉高度:', window.innerHeight - this.getBoundingClientRect().bottom);
      console.log('预期抽屉宽度:', window.innerWidth);
      
      setTimeout(() => {
        const wrapper = drawerBottom.shadowRoot.querySelector('.drawer-wrapper');
        console.log('实际抽屉样式:', {
          top: wrapper.style.top,
          left: wrapper.style.left,
          width: wrapper.style.width,
          height: wrapper.style.height
        });
        
        const mask = document.querySelector('.drawer-partial-mask');
        if (mask) {
          console.log('遮罩样式:', {
            top: mask.style.top,
            left: mask.style.left,
            width: mask.style.width,
            height: mask.style.height
          });
        }
      }, 500);
    });
    
    // 向上展开
    const btnTop = document.getElementById('btnTop');
    const drawerTop = document.getElementById('drawerTop');
    
    btnTop.addEventListener('click', function() {
      displayCoordinates('btnTop', 'coordsTop');
      drawerTop.anchorElement = this;
      drawerTop.open();
      
      console.log('=== 向上展开抽屉 ===');
      console.log('按钮坐标:', this.getBoundingClientRect());
      console.log('预期抽屉高度:', this.getBoundingClientRect().top);
      console.log('预期抽屉宽度:', window.innerWidth);
    });
    
    // 向左展开
    const btnLeft = document.getElementById('btnLeft');
    const drawerLeft = document.getElementById('drawerLeft');
    
    btnLeft.addEventListener('click', function() {
      displayCoordinates('btnLeft', 'coordsLeft');
      drawerLeft.anchorElement = this;
      drawerLeft.open();
      
      console.log('=== 向左展开抽屉 ===');
      console.log('按钮坐标:', this.getBoundingClientRect());
      console.log('预期抽屉宽度:', this.getBoundingClientRect().left);
      console.log('预期抽屉高度:', window.innerHeight);
    });
    
    // 向右展开
    const btnRight = document.getElementById('btnRight');
    const drawerRight = document.getElementById('drawerRight');
    
    btnRight.addEventListener('click', function() {
      displayCoordinates('btnRight', 'coordsRight');
      drawerRight.anchorElement = this;
      drawerRight.open();
      
      console.log('=== 向右展开抽屉 ===');
      console.log('按钮坐标:', this.getBoundingClientRect());
      console.log('预期抽屉宽度:', window.innerWidth - this.getBoundingClientRect().right);
      console.log('预期抽屉高度:', window.innerHeight);
    });
    
    // 监听抽屉打开事件
    [drawerBottom, drawerTop, drawerLeft, drawerRight].forEach(drawer => {
      drawer.addEventListener('drawerOpen', () => {
        console.log(`${drawer.id} 已打开`);
      });
    });
  </script>
</body>
</html>
