<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>日历组件测试 - 月/周/日视图</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background: #f5f7fa;
      padding: 20px;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      color: #303133;
      margin-bottom: 20px;
      font-size: 24px;
    }
    .info {
      background: #ecf5ff;
      border-left: 3px solid #409eff;
      padding: 12px;
      margin-bottom: 20px;
      color: #606266;
      font-size: 14px;
    }
    .calendar-wrapper {
      min-height: 600px;
      border: 1px solid #e4e7ed;
      border-radius: 4px;
      padding: 10px;
    }
    .status {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #67c23a;
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
  </style>
  <!-- 加载组件样式和脚本 -->
  <link rel="stylesheet" href="./dist/ldesign-webcomponent/ldesign-webcomponent.css">
  <script type="module" src="./dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
</head>
<body>
  <div class="container">
    <h1>📅 日历组件测试 - 支持月/周/日视图</h1>
    
    <div class="info">
      <strong>使用说明：</strong>
      <ul style="margin-top: 10px; margin-left: 20px;">
        <li>点击头部的"月/周/日"按钮切换视图</li>
        <li>点击"今天"按钮快速回到当前日期</li>
        <li>使用左右箭头导航日期</li>
        <li>双击日期创建新日程</li>
        <li>右键点击查看更多操作</li>
      </ul>
    </div>

    <div class="calendar-wrapper">
      <ldesign-calendar 
        id="myCalendar"
        view="month"
        show-week-numbers="false"
        hour-start="8"
        hour-end="20"
        step-minutes="30"
        draggable-events="true"
        resizable-events="true"
        enable-crud="true"
      ></ldesign-calendar>
    </div>
  </div>

  <div class="status" id="status">
    准备就绪
  </div>

  <script>
    // 获取日历组件
    const calendar = document.getElementById('myCalendar');
    const status = document.getElementById('status');
    
    // 更新状态显示
    function updateStatus(text, color = '#67c23a') {
      status.textContent = text;
      status.style.background = color;
    }
    
    // 生成示例事件
    function generateSampleEvents() {
      const today = new Date();
      const events = [
        // 今天的事件
        {
          id: 'evt1',
          title: '团队会议',
          start: setTime(today, 10, 0),
          end: setTime(today, 11, 30),
          color: '#409eff'
        },
        {
          id: 'evt2',
          title: '产品评审',
          start: setTime(today, 14, 0),
          end: setTime(today, 15, 30),
          color: '#67c23a'
        },
        // 明天的全天事件
        {
          id: 'evt3',
          title: '项目发布',
          date: formatDate(addDays(today, 1)),
          allDay: true,
          color: '#e6a23c'
        },
        // 昨天的事件
        {
          id: 'evt4',
          title: '代码审查',
          start: setTime(addDays(today, -1), 15, 0),
          end: setTime(addDays(today, -1), 16, 30),
          color: '#f56c6c'
        },
        // 跨天事件
        {
          id: 'evt5',
          title: '技术大会',
          start: setTime(addDays(today, 2), 9, 0),
          end: setTime(addDays(today, 4), 18, 0),
          color: '#909399'
        }
      ];
      
      return events;
    }
    
    // 辅助函数
    function formatDate(date) {
      const d = new Date(date);
      const year = d.getFullYear();
      const month = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }
    
    function setTime(date, hour, minute) {
      const d = new Date(date);
      d.setHours(hour, minute, 0, 0);
      return d.toISOString();
    }
    
    function addDays(date, days) {
      const d = new Date(date);
      d.setDate(d.getDate() + days);
      return d;
    }
    
    // 监听事件
    calendar.addEventListener('ldesignChange', (e) => {
      console.log('日期改变:', e.detail);
      updateStatus(`选中日期: ${e.detail}`);
    });
    
    calendar.addEventListener('ldesignEventClick', (e) => {
      console.log('点击事件:', e.detail.event);
      updateStatus(`点击: ${e.detail.event.title}`, '#409eff');
    });
    
    calendar.addEventListener('ldesignEventCreate', (e) => {
      console.log('创建事件:', e.detail);
      updateStatus('正在创建新日程...', '#e6a23c');
    });
    
    calendar.addEventListener('ldesignEventDrop', (e) => {
      console.log('拖放事件:', e.detail);
      updateStatus(`已移动: ${e.detail.title}`, '#67c23a');
    });
    
    calendar.addEventListener('ldesignEventResize', (e) => {
      console.log('调整大小:', e.detail);
      updateStatus(`已调整: ${e.detail.title}`, '#67c23a');
    });
    
    // 页面加载完成后设置示例事件
    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        try {
          calendar.eventsData = generateSampleEvents();
          updateStatus('示例日程已加载');
          console.log('日历组件已初始化，包含以下视图：');
          console.log('- 月视图 (Month View)');
          console.log('- 周视图 (Week View)');
          console.log('- 日视图 (Day View)');
        } catch (error) {
          console.error('初始化失败:', error);
          updateStatus('初始化失败', '#f56c6c');
        }
      }, 500);
    });
  </script>
</body>
</html>