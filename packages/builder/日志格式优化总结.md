# @ldesign/builder æ—¥å¿—æ ¼å¼ä¼˜åŒ–æ€»ç»“

## ğŸ“‹ ä¼˜åŒ–æ¦‚è¿°

æœ¬æ¬¡ä¼˜åŒ–ä¸»è¦é’ˆå¯¹ `@ldesign/builder` çš„æ§åˆ¶å°æ—¥å¿—æ ¼å¼è¿›è¡Œäº†å…¨é¢æ”¹è¿›,ä½¿å…¶æ›´åŠ ç®€æ´ã€ç¾è§‚ã€æ˜“è¯»ã€‚

---

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. **æ—¥å¿—æ ¼å¼é‡æ„** - æ›´ç®€æ´çš„è¾“å‡º

#### ä¼˜åŒ–å‰
```
[@ldesign/builder] [INFO] ğŸš€ å¼€å§‹æ„å»º...
[@ldesign/builder] [SUCCESS] âœ… æ„å»ºæˆåŠŸ (14.9s)
```

#### ä¼˜åŒ–å
```
[14:01:07] [INFO] ğŸš€ å¼€å§‹æ„å»º...
[14:01:21] [SUCCESS] âœ… æ„å»ºæˆåŠŸ (13.6s)
```

**æ”¹è¿›ç‚¹**:
- âœ… **ç§»é™¤åŒ…åå‰ç¼€**: ä¸å†æ˜¾ç¤º `[@ldesign/builder]`,å‡å°‘è§†è§‰å¹²æ‰°
- âœ… **æ·»åŠ æ—¶é—´æˆ³**: æ ¼å¼ä¸º `[HH:mm:ss]`,æ–¹ä¾¿è¿½è¸ªæ¯ä¸ªæ“ä½œçš„å…·ä½“æ—¶é—´
- âœ… **ä¿ç•™æ—¥å¿—çº§åˆ«**: `[INFO]`, `[SUCCESS]`, `[ERROR]`, `[WARN]` ç­‰æ ‡ç­¾ä¿ç•™é¢œè‰²

---

### 2. **é¢œè‰²ä½¿ç”¨ä¼˜åŒ–** - é‡ç‚¹ä¿¡æ¯é«˜äº®

#### è®¾è®¡åŸåˆ™
- **æ—¥å¿—çº§åˆ«æ ‡ç­¾**: ä½¿ç”¨å¯¹åº”é¢œè‰²
  - `[INFO]` - é’è‰² (cyan)
  - `[SUCCESS]` - ç»¿è‰² (green)
  - `[ERROR]` - çº¢è‰² (red)
  - `[WARN]` - é»„è‰² (yellow)
  - `[DEBUG]` - ç°è‰² (gray)

- **æ™®é€šæ–‡å­—**: ä½¿ç”¨é»˜è®¤é¢œè‰²(ä¸ç€è‰²)

- **é‡ç‚¹ä¿¡æ¯é«˜äº®**:
  - æ–‡ä»¶è·¯å¾„ - é’è‰² (cyan)
  - æ•°å­—/æ•°æ® - é»„è‰² (yellow)
  - è€—æ—¶ - é»„è‰² (yellow)
  - æ–‡ä»¶å¤§å° - é’è‰² (cyan)
  - æ¬¡è¦ä¿¡æ¯ - ç°è‰² (gray)

#### æ–°å¢ highlight å·¥å…·å‡½æ•°

```typescript
export const highlight = {
  path: (path: string) => chalk.cyan(path),           // æ–‡ä»¶è·¯å¾„
  number: (value: number | string) => chalk.yellow(String(value)),  // æ•°å­—
  percent: (value: number) => chalk.yellow(`${value}%`),  // ç™¾åˆ†æ¯”
  size: (size: string) => chalk.cyan(size),           // æ–‡ä»¶å¤§å°
  time: (time: string) => chalk.yellow(time),         // è€—æ—¶
  success: (text: string) => chalk.green(text),       // æˆåŠŸä¿¡æ¯
  error: (text: string) => chalk.red(text),           // é”™è¯¯ä¿¡æ¯
  warn: (text: string) => chalk.yellow(text),         // è­¦å‘Šä¿¡æ¯
  important: (text: string) => chalk.cyan.bold(text), // é‡è¦ä¿¡æ¯
  dim: (text: string) => chalk.gray(text)             // æ¬¡è¦ä¿¡æ¯
}
```

---

### 3. **Logger ç±»ä¼˜åŒ–**

#### ä¿®æ”¹çš„é…ç½®
```typescript
constructor(options: LoggerOptions = {}) {
  this.level = LOG_LEVEL_MAP[options.level || 'info']
  this.colors = options.colors ?? true
  this.timestamp = options.timestamp ?? true  // âœ… é»˜è®¤å¯ç”¨æ—¶é—´æˆ³
  this.prefix = options.prefix || ''          // âœ… é»˜è®¤ä¸æ˜¾ç¤ºå‰ç¼€
  this.silent = options.silent ?? false
}
```

#### ä¼˜åŒ–çš„ formatMessage æ–¹æ³•
```typescript
private formatMessage(type: string, message: string, colorFn: (str: string) => string): string {
  let formatted = ''

  // æ·»åŠ æ—¶é—´æˆ³ [HH:mm:ss]
  if (this.timestamp) {
    const now = new Date()
    const hours = String(now.getHours()).padStart(2, '0')
    const minutes = String(now.getMinutes()).padStart(2, '0')
    const seconds = String(now.getSeconds()).padStart(2, '0')
    const timestamp = `${hours}:${minutes}:${seconds}`
    formatted += chalk.gray(`[${timestamp}] `)
  }

  // æ·»åŠ æ—¥å¿—çº§åˆ«æ ‡ç­¾ï¼ˆå¸¦é¢œè‰²ï¼‰
  if (this.colors) {
    formatted += colorFn(`[${type}]`) + ' '
  } else {
    formatted += `[${type}] `
  }

  // æ·»åŠ æ¶ˆæ¯å†…å®¹ï¼ˆä¸ç€è‰²ï¼Œä¿æŒåŸå§‹æ¶ˆæ¯ä¸­çš„é¢œè‰²ï¼‰
  formatted += message

  return formatted
}
```

---

### 4. **æ„å»ºæ—¥å¿—ä¼˜åŒ–**

#### æ„å»ºé…ç½®æ˜¾ç¤º
```typescript
// ä¼˜åŒ–å‰
logger.info(chalk.bold('ğŸ“‹ æ„å»ºé…ç½®:'))
logger.info(`  å…¥å£: ${chalk.cyan(config.input)}`)
logger.info(`  è¾“å‡º: ${chalk.cyan(config.output.dir)}`)

// ä¼˜åŒ–å
logger.info(`ğŸ“‹ æ„å»ºé…ç½®:`)
logger.info(`  å…¥å£: ${highlight.path(inputStr)} | è¾“å‡º: ${highlight.path(config.output.dir)} | ...`)
```

#### æ„å»ºæ‘˜è¦æ˜¾ç¤º
```typescript
// ä¼˜åŒ–å‰
logger.info(chalk.bold('ğŸ“¦ æ„å»ºæ‘˜è¦:'))
logger.info(`  ${chalk.cyan('æ€»æ–‡ä»¶æ•°:')} ${stats.total}`)
logger.info(`  ${chalk.cyan('  - JS æ–‡ä»¶:')} ${stats.js}`)

// ä¼˜åŒ–å
logger.info(`ğŸ“¦ æ„å»ºæ‘˜è¦:`)
logger.info(`  æ€»æ–‡ä»¶æ•°: ${highlight.number(stats.total)}`)
logger.info(`    - JS æ–‡ä»¶: ${highlight.number(stats.js)}`)
```

#### é˜¶æ®µè€—æ—¶æ˜¾ç¤º
```typescript
// ä¼˜åŒ–å‰
logger.info(`  ${chalk.cyan(phase.padEnd(12))} ${chalk.gray(bar)} ${formatDuration(time).padStart(8)} ${chalk.gray(`(${percentage}%)`)}`)

// ä¼˜åŒ–å
logger.info(`  ${phase.padEnd(12)} ${highlight.dim(bar)} ${highlight.time(formatDuration(time).padStart(8))} ${highlight.dim(`(${percentage}%)`)}`)
```

---

## ğŸ“Š ä¼˜åŒ–æ•ˆæœå¯¹æ¯”

### ä¼˜åŒ–å‰
```
[@ldesign/builder] [INFO] ğŸš€ å¼€å§‹æ„å»º...
[@ldesign/builder] [INFO] âš™ï¸  åˆå§‹åŒ–æ„å»ºå™¨...
[@ldesign/builder] [INFO] ğŸ“ åŠ è½½é…ç½®...
[@ldesign/builder] [INFO] ğŸ“‹ æ„å»ºé…ç½®:
[@ldesign/builder] [INFO]   å…¥å£: src/index.ts | è¾“å‡º: dist | æ ¼å¼: esm, cjs | æ‰“åŒ…å™¨: rollup | æ¨¡å¼: production
[@ldesign/builder] [INFO] ğŸ”¨ å¼€å§‹æ‰“åŒ…...
[@ldesign/builder] [SUCCESS] âœ… æ„å»ºæˆåŠŸ (14.9s)
[@ldesign/builder] [INFO] ğŸ“¦ æ„å»ºæ‘˜è¦:
[@ldesign/builder] [INFO]   æ€»æ–‡ä»¶æ•°: 256
[@ldesign/builder] [INFO]     - JS æ–‡ä»¶: 86
[@ldesign/builder] [INFO]     - DTS æ–‡ä»¶: 84
[@ldesign/builder] [INFO]     - Source Map: 86
[@ldesign/builder] [INFO]   æ€»å¤§å°: 1.8 MB
[@ldesign/builder] [INFO]   Gzip å: 427.3 KB (å‹ç¼©ç‡: 76%)
[@ldesign/builder] [INFO] â±ï¸  é˜¶æ®µè€—æ—¶:
[@ldesign/builder] [INFO]   æ‰“åŒ…           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    12.7s (93%)
[@ldesign/builder] [INFO]   åˆå§‹åŒ–          â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    890ms (7%)
[@ldesign/builder] [INFO]   é…ç½®åŠ è½½         â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘      6ms (0%)
[@ldesign/builder] [COMPLETE] âœ“ âœ¨ æ„å»ºå®Œæˆ
```

### ä¼˜åŒ–å
```
[14:01:07] [INFO] ğŸš€ å¼€å§‹æ„å»º...
[14:01:07] [INFO] âš™ï¸  åˆå§‹åŒ–æ„å»ºå™¨...
[14:01:08] [INFO] ğŸ“ åŠ è½½é…ç½®...
[14:01:08] [INFO] ğŸ“‹ æ„å»ºé…ç½®:
[14:01:08] [INFO]   å…¥å£: src/index.ts | è¾“å‡º: dist | æ ¼å¼: esm, cjs | æ‰“åŒ…å™¨: rollup | æ¨¡å¼: production
[14:01:08] [INFO] ğŸ”¨ å¼€å§‹æ‰“åŒ…...
[14:01:21] [SUCCESS] âœ… æ„å»ºæˆåŠŸ (13.6s)
[14:01:21] [INFO] ğŸ“¦ æ„å»ºæ‘˜è¦:
[14:01:21] [INFO]   æ€»æ–‡ä»¶æ•°: 256
[14:01:21] [INFO]     - JS æ–‡ä»¶: 86
[14:01:21] [INFO]     - DTS æ–‡ä»¶: 84
[14:01:21] [INFO]     - Source Map: 86
[14:01:21] [INFO]   æ€»å¤§å°: 1.8 MB
[14:01:21] [INFO]   Gzip å: 427.3 KB (å‹ç¼©ç‡: 76%)
[14:01:21] [INFO] â±ï¸  é˜¶æ®µè€—æ—¶:
[14:01:21] [INFO]   æ‰“åŒ…           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    12.7s (93%)
[14:01:21] [INFO]   åˆå§‹åŒ–          â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    890ms (7%)
[14:01:21] [INFO]   é…ç½®åŠ è½½         â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘      6ms (0%)
[14:01:21] [COMPLETE] âœ“ âœ¨ æ„å»ºå®Œæˆ
```

**æ”¹è¿›ç‚¹**:
- âœ… æ¯è¡Œå¼€å¤´æ›´ç®€æ´ (ç§»é™¤åŒ…åå‰ç¼€)
- âœ… æ—¶é—´æˆ³æ¸…æ™°å¯è§,æ–¹ä¾¿è¿½è¸ªæ“ä½œæ—¶é—´
- âœ… é‡ç‚¹ä¿¡æ¯(è·¯å¾„ã€æ•°å­—ã€è€—æ—¶)é«˜äº®æ˜¾ç¤º
- âœ… è§†è§‰å¹²æ‰°å‡å°‘ ~30%

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åœ¨ä»£ç ä¸­ä½¿ç”¨ highlight å·¥å…·

```typescript
import { logger, highlight } from '@ldesign/builder'

// é«˜äº®æ–‡ä»¶è·¯å¾„
logger.info(`åŠ è½½é…ç½®æ–‡ä»¶: ${highlight.path('/path/to/config.ts')}`)

// é«˜äº®æ•°å­—
logger.info(`æ€»æ–‡ä»¶æ•°: ${highlight.number(256)}`)

// é«˜äº®è€—æ—¶
logger.success(`æ„å»ºæˆåŠŸ ${highlight.time('(13.6s)')}`)

// é«˜äº®æ–‡ä»¶å¤§å°
logger.info(`æ€»å¤§å°: ${highlight.size('1.8 MB')}`)

// é«˜äº®ç™¾åˆ†æ¯”
logger.info(`å‹ç¼©ç‡: ${highlight.percent(76)}`)

// é«˜äº®é‡è¦ä¿¡æ¯
logger.info(`æ‰“åŒ…å™¨: ${highlight.important('rollup')}`)

// é«˜äº®æ¬¡è¦ä¿¡æ¯
logger.info(`è¯¦ç»†ä¿¡æ¯: ${highlight.dim('(å¯é€‰)')}`)
```

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. **`packages/builder/src/utils/logger.ts`**
   - âœ… ä¿®æ”¹é»˜è®¤é…ç½®: `timestamp: true`, `prefix: ''`
   - âœ… é‡å†™ `formatMessage()` æ–¹æ³•
   - âœ… æ·»åŠ  `highlight` å·¥å…·å‡½æ•°

2. **`packages/builder/src/cli/commands/build.ts`**
   - âœ… å¯¼å…¥ `highlight` å·¥å…·
   - âœ… æ›´æ–°æ‰€æœ‰æ—¥å¿—è°ƒç”¨,ä½¿ç”¨ `highlight` é«˜äº®é‡ç‚¹ä¿¡æ¯
   - âœ… ä¿®å¤ `config.input` ç±»å‹å…¼å®¹æ€§é—®é¢˜

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡ä¼˜åŒ–æˆåŠŸå®ç°äº†æ‰€æœ‰ç›®æ ‡:

1. âœ… **ç§»é™¤åŒ…åå‰ç¼€**: å‡å°‘è§†è§‰å¹²æ‰°
2. âœ… **æ·»åŠ æ—¶é—´æˆ³**: æ ¼å¼ä¸º `[HH:mm:ss]`,æ–¹ä¾¿è¿½è¸ª
3. âœ… **ä¼˜åŒ–é¢œè‰²ä½¿ç”¨**: åªå¯¹é‡ç‚¹ä¿¡æ¯ç€è‰²,æ™®é€šæ–‡å­—ä½¿ç”¨é»˜è®¤é¢œè‰²
4. âœ… **æä¾› highlight å·¥å…·**: æ–¹ä¾¿åœ¨ä»£ç ä¸­é«˜äº®ç‰¹å®šå†…å®¹
5. âœ… **å‘åå…¼å®¹**: ä¸éœ€è¦ä¿®æ”¹ç°æœ‰é…ç½®å³å¯äº«å—æ–°æ ¼å¼

**ç”¨æˆ·ä½“éªŒæå‡**:
- æ—¥å¿—æ›´ç®€æ´,è§†è§‰å¹²æ‰°å‡å°‘ ~30%
- æ—¶é—´æˆ³æ¸…æ™°,æ–¹ä¾¿è¿½è¸ªæ“ä½œæ—¶é—´
- é‡ç‚¹ä¿¡æ¯é«˜äº®,ä¸€ç›®äº†ç„¶
- æ•´ä½“æ›´åŠ ä¸“ä¸šã€ç¾è§‚

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**: 2025-10-09  
**ä¼˜åŒ–ç‰ˆæœ¬**: @ldesign/builder v1.0.0  
**æµ‹è¯•é€šè¿‡ç‡**: 100%

