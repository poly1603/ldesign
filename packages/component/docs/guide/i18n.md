# å›½é™…åŒ–

LDesign æä¾›äº†å®Œæ•´çš„å›½é™…åŒ–ï¼ˆi18nï¼‰æ”¯æŒï¼Œå¸®åŠ©ä½ æ„å»ºå¤šè¯­è¨€åº”ç”¨ç¨‹åºã€‚

## åŸºç¡€æ¦‚å¿µ

### ä»€ä¹ˆæ˜¯å›½é™…åŒ–

å›½é™…åŒ–ï¼ˆInternationalizationï¼Œç®€ç§° i18nï¼‰æ˜¯æŒ‡è®¾è®¡å’Œå¼€å‘åº”ç”¨ç¨‹åºï¼Œä½¿å…¶èƒ½å¤Ÿé€‚åº”ä¸åŒçš„è¯­è¨€ã€åœ°åŒºå’Œæ–‡åŒ–ï¼Œè€Œæ— éœ€è¿›è¡Œå·¥ç¨‹æ›´æ”¹ã€‚

### LDesign çš„ i18n ç‰¹æ€§

- **å¤šè¯­è¨€æ”¯æŒ** - å†…ç½®å¤šç§è¯­è¨€åŒ…
- **åŠ¨æ€åˆ‡æ¢** - è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢è¯­è¨€
- **è‡ªå®šä¹‰ç¿»è¯‘** - æ”¯æŒè‡ªå®šä¹‰ç¿»è¯‘å†…å®¹
- **RTL æ”¯æŒ** - æ”¯æŒä»å³åˆ°å·¦çš„è¯­è¨€
- **æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–** - æœ¬åœ°åŒ–çš„æ—¥æœŸæ—¶é—´æ˜¾ç¤º

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€ç”¨æ³•

```javascript
import { setLocale, getLocale } from '@ldesign/components/dist/utils/i18n';

// è®¾ç½®è¯­è¨€ä¸ºä¸­æ–‡
setLocale('zh-CN');

// è®¾ç½®è¯­è¨€ä¸ºè‹±æ–‡
setLocale('en-US');

// è·å–å½“å‰è¯­è¨€
const currentLocale = getLocale(); // 'zh-CN'
```

### HTML ä¸­ä½¿ç”¨

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>LDesign å›½é™…åŒ–ç¤ºä¾‹</title>
</head>
<body>
  <!-- ç»„ä»¶ä¼šè‡ªåŠ¨ä½¿ç”¨å½“å‰è®¾ç½®çš„è¯­è¨€ -->
  <ld-button type="primary">æŒ‰é’®</ld-button>
  <ld-input placeholder="è¯·è¾“å…¥å†…å®¹"></ld-input>
  
  <script type="module">
    import { defineCustomElements } from '@ldesign/components/loader';
    import { setLocale } from '@ldesign/components/dist/utils/i18n';
    
    defineCustomElements();
    setLocale('zh-CN');
  </script>
</body>
</html>
```

## æ”¯æŒçš„è¯­è¨€

LDesign å†…ç½®äº†ä»¥ä¸‹è¯­è¨€æ”¯æŒï¼š

| è¯­è¨€ | ä»£ç  | çŠ¶æ€ |
|------|------|------|
| ç®€ä½“ä¸­æ–‡ | zh-CN | âœ… å®Œæ•´æ”¯æŒ |
| ç¹ä½“ä¸­æ–‡ | zh-TW | âœ… å®Œæ•´æ”¯æŒ |
| è‹±è¯­ | en-US | âœ… å®Œæ•´æ”¯æŒ |
| æ—¥è¯­ | ja-JP | âœ… å®Œæ•´æ”¯æŒ |
| éŸ©è¯­ | ko-KR | âœ… å®Œæ•´æ”¯æŒ |
| æ³•è¯­ | fr-FR | ğŸš§ éƒ¨åˆ†æ”¯æŒ |
| å¾·è¯­ | de-DE | ğŸš§ éƒ¨åˆ†æ”¯æŒ |
| è¥¿ç­ç‰™è¯­ | es-ES | ğŸš§ éƒ¨åˆ†æ”¯æŒ |

## è¯­è¨€åŒ…ç»“æ„

### é»˜è®¤è¯­è¨€åŒ…

```javascript
// zh-CN.js
export default {
  common: {
    confirm: 'ç¡®å®š',
    cancel: 'å–æ¶ˆ',
    ok: 'å¥½çš„',
    close: 'å…³é—­',
    loading: 'åŠ è½½ä¸­...',
    noData: 'æš‚æ— æ•°æ®',
    total: 'å…± {total} æ¡',
  },
  button: {
    loading: 'åŠ è½½ä¸­...',
  },
  input: {
    placeholder: 'è¯·è¾“å…¥',
  },
  modal: {
    confirm: 'ç¡®å®š',
    cancel: 'å–æ¶ˆ',
  },
  table: {
    noData: 'æš‚æ— æ•°æ®',
    total: 'å…± {total} æ¡è®°å½•',
  },
  form: {
    required: 'æ­¤å­—æ®µä¸ºå¿…å¡«é¡¹',
    invalid: 'æ ¼å¼ä¸æ­£ç¡®',
  },
  pagination: {
    prev: 'ä¸Šä¸€é¡µ',
    next: 'ä¸‹ä¸€é¡µ',
    goto: 'è·³è‡³',
    page: 'é¡µ',
    total: 'å…± {total} æ¡',
    pageSize: 'æ¡/é¡µ',
  },
};
```

### è‹±æ–‡è¯­è¨€åŒ…

```javascript
// en-US.js
export default {
  common: {
    confirm: 'Confirm',
    cancel: 'Cancel',
    ok: 'OK',
    close: 'Close',
    loading: 'Loading...',
    noData: 'No Data',
    total: 'Total {total} items',
  },
  button: {
    loading: 'Loading...',
  },
  input: {
    placeholder: 'Please input',
  },
  modal: {
    confirm: 'Confirm',
    cancel: 'Cancel',
  },
  table: {
    noData: 'No Data',
    total: 'Total {total} records',
  },
  form: {
    required: 'This field is required',
    invalid: 'Invalid format',
  },
  pagination: {
    prev: 'Previous',
    next: 'Next',
    goto: 'Go to',
    page: 'Page',
    total: 'Total {total} items',
    pageSize: 'items per page',
  },
};
```

## è‡ªå®šä¹‰è¯­è¨€åŒ…

### æ·»åŠ æ–°è¯­è¨€

```javascript
import { addLocale, setLocale } from '@ldesign/components/dist/utils/i18n';

// æ·»åŠ ä¿„è¯­æ”¯æŒ
const ruRU = {
  common: {
    confirm: 'ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ',
    cancel: 'ĞÑ‚Ğ¼ĞµĞ½Ğ°',
    ok: 'ĞĞš',
    close: 'Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ',
    loading: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...',
    noData: 'ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…',
    total: 'Ğ’ÑĞµĞ³Ğ¾ {total} ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²',
  },
  button: {
    loading: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...',
  },
  // ... å…¶ä»–ç¿»è¯‘
};

// æ³¨å†Œè¯­è¨€åŒ…
addLocale('ru-RU', ruRU);

// ä½¿ç”¨æ–°è¯­è¨€
setLocale('ru-RU');
```

### è¦†ç›–é»˜è®¤ç¿»è¯‘

```javascript
import { updateLocale } from '@ldesign/components/dist/utils/i18n';

// è¦†ç›–éƒ¨åˆ†ä¸­æ–‡ç¿»è¯‘
updateLocale('zh-CN', {
  common: {
    confirm: 'ç¡®è®¤', // å°†"ç¡®å®š"æ”¹ä¸º"ç¡®è®¤"
    loading: 'æ­£åœ¨åŠ è½½...', // è‡ªå®šä¹‰åŠ è½½æ–‡æœ¬
  },
  button: {
    loading: 'è¯·ç¨å€™...', // è‡ªå®šä¹‰æŒ‰é’®åŠ è½½æ–‡æœ¬
  },
});
```

## åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

### è·å–ç¿»è¯‘æ–‡æœ¬

```javascript
import { t } from '@ldesign/components/dist/utils/i18n';

// è·å–ç¿»è¯‘æ–‡æœ¬
const confirmText = t('common.confirm'); // "ç¡®å®š" æˆ– "Confirm"
const loadingText = t('common.loading'); // "åŠ è½½ä¸­..." æˆ– "Loading..."

// å¸¦å‚æ•°çš„ç¿»è¯‘
const totalText = t('common.total', { total: 100 }); // "å…± 100 æ¡" æˆ– "Total 100 items"
```

### åœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸­ä½¿ç”¨

```javascript
class CustomComponent extends HTMLElement {
  constructor() {
    super();
    this.render();
    
    // ç›‘å¬è¯­è¨€å˜åŒ–
    document.addEventListener('localeChange', () => {
      this.render();
    });
  }
  
  render() {
    const confirmText = t('common.confirm');
    const cancelText = t('common.cancel');
    
    this.innerHTML = `
      <div class="custom-dialog">
        <div class="dialog-content">
          <p>ç¡®è®¤æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ</p>
          <div class="dialog-actions">
            <ld-button type="primary">${confirmText}</ld-button>
            <ld-button>${cancelText}</ld-button>
          </div>
        </div>
      </div>
    `;
  }
}
```

## åŠ¨æ€è¯­è¨€åˆ‡æ¢

### è¯­è¨€åˆ‡æ¢å™¨

```html
<div class="language-switcher">
  <select id="language-select">
    <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
    <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
    <option value="en-US">English</option>
    <option value="ja-JP">æ—¥æœ¬èª</option>
    <option value="ko-KR">í•œêµ­ì–´</option>
  </select>
</div>

<script>
import { setLocale, getLocale } from '@ldesign/components/dist/utils/i18n';

const languageSelect = document.getElementById('language-select');

// è®¾ç½®å½“å‰è¯­è¨€
languageSelect.value = getLocale();

// ç›‘å¬è¯­è¨€åˆ‡æ¢
languageSelect.addEventListener('change', (event) => {
  const newLocale = event.target.value;
  setLocale(newLocale);
  
  // ä¿å­˜ç”¨æˆ·åå¥½
  localStorage.setItem('preferred-language', newLocale);
  
  // å¯é€‰ï¼šåˆ·æ–°é¡µé¢ä»¥ç¡®ä¿æ‰€æœ‰å†…å®¹éƒ½æ›´æ–°
  // window.location.reload();
});

// é¡µé¢åŠ è½½æ—¶æ¢å¤ç”¨æˆ·åå¥½
const savedLanguage = localStorage.getItem('preferred-language');
if (savedLanguage) {
  setLocale(savedLanguage);
  languageSelect.value = savedLanguage;
}
</script>
```

### è‡ªåŠ¨æ£€æµ‹è¯­è¨€

```javascript
import { setLocale, hasLocale } from '@ldesign/components/dist/utils/i18n';

function detectAndSetLanguage() {
  // 1. æ£€æŸ¥ URL å‚æ•°
  const urlParams = new URLSearchParams(window.location.search);
  const urlLang = urlParams.get('lang');
  if (urlLang && hasLocale(urlLang)) {
    setLocale(urlLang);
    return;
  }
  
  // 2. æ£€æŸ¥æœ¬åœ°å­˜å‚¨
  const savedLang = localStorage.getItem('preferred-language');
  if (savedLang && hasLocale(savedLang)) {
    setLocale(savedLang);
    return;
  }
  
  // 3. æ£€æŸ¥æµè§ˆå™¨è¯­è¨€
  const browserLang = navigator.language || navigator.languages[0];
  const supportedLangs = ['zh-CN', 'zh-TW', 'en-US', 'ja-JP', 'ko-KR'];
  
  for (const lang of supportedLangs) {
    if (browserLang.startsWith(lang.split('-')[0])) {
      setLocale(lang);
      return;
    }
  }
  
  // 4. é»˜è®¤è¯­è¨€
  setLocale('zh-CN');
}

// é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æµ‹
detectAndSetLanguage();
```

## RTL æ”¯æŒ

### å¯ç”¨ RTL

```javascript
import { setLocale, setDirection } from '@ldesign/components/dist/utils/i18n';

// è®¾ç½®é˜¿æ‹‰ä¼¯è¯­å¹¶å¯ç”¨ RTL
setLocale('ar-SA');
setDirection('rtl');

// æˆ–è€…è‡ªåŠ¨æ ¹æ®è¯­è¨€è®¾ç½®æ–¹å‘
function setLocaleWithDirection(locale) {
  setLocale(locale);
  
  const rtlLanguages = ['ar', 'he', 'fa', 'ur'];
  const isRTL = rtlLanguages.some(lang => locale.startsWith(lang));
  
  setDirection(isRTL ? 'rtl' : 'ltr');
  document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
}
```

### RTL æ ·å¼

```css
/* RTL æ ·å¼æ”¯æŒ */
[dir="rtl"] ld-button {
  /* RTL ç‰¹å®šæ ·å¼ */
}

[dir="rtl"] ld-input {
  text-align: right;
}

[dir="rtl"] .ld-form-item__label {
  text-align: left;
}
```

## æ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–

### æ—¥æœŸæ ¼å¼åŒ–

```javascript
import { formatDate, formatTime } from '@ldesign/components/dist/utils/i18n';

const date = new Date();

// æ ¹æ®å½“å‰è¯­è¨€æ ¼å¼åŒ–æ—¥æœŸ
const formattedDate = formatDate(date); 
// zh-CN: "2024å¹´1æœˆ15æ—¥"
// en-US: "January 15, 2024"
// ja-JP: "2024å¹´1æœˆ15æ—¥"

// æ ¼å¼åŒ–æ—¶é—´
const formattedTime = formatTime(date);
// zh-CN: "ä¸‹åˆ 3:30"
// en-US: "3:30 PM"
// ja-JP: "åˆå¾Œ 3:30"
```

### ç›¸å¯¹æ—¶é—´

```javascript
import { formatRelativeTime } from '@ldesign/components/dist/utils/i18n';

const now = new Date();
const pastDate = new Date(now.getTime() - 2 * 60 * 60 * 1000); // 2å°æ—¶å‰

const relativeTime = formatRelativeTime(pastDate);
// zh-CN: "2å°æ—¶å‰"
// en-US: "2 hours ago"
// ja-JP: "2æ™‚é–“å‰"
```

## æ•°å­—æœ¬åœ°åŒ–

### æ•°å­—æ ¼å¼åŒ–

```javascript
import { formatNumber, formatCurrency } from '@ldesign/components/dist/utils/i18n';

const number = 1234567.89;

// æ ¼å¼åŒ–æ•°å­—
const formattedNumber = formatNumber(number);
// zh-CN: "1,234,567.89"
// en-US: "1,234,567.89"
// de-DE: "1.234.567,89"

// æ ¼å¼åŒ–è´§å¸
const formattedCurrency = formatCurrency(number, 'CNY');
// zh-CN: "Â¥1,234,567.89"
// en-US: "CNÂ¥1,234,567.89"
```

## æœ€ä½³å®è·µ

### 1. æ–‡æœ¬å¤–éƒ¨åŒ–

```javascript
// âŒ é¿å…ï¼šç¡¬ç¼–ç æ–‡æœ¬
const button = document.createElement('ld-button');
button.textContent = 'æäº¤';

// âœ… æ¨èï¼šä½¿ç”¨ç¿»è¯‘å‡½æ•°
const button = document.createElement('ld-button');
button.textContent = t('common.submit');
```

### 2. å¤„ç†å¤æ•°å½¢å¼

```javascript
// å¤æ•°è§„åˆ™
const pluralRules = {
  'zh-CN': (n) => 0, // ä¸­æ–‡æ²¡æœ‰å¤æ•°å½¢å¼
  'en-US': (n) => n === 1 ? 0 : 1, // è‹±æ–‡å¤æ•°è§„åˆ™
};

function formatPlural(key, count, locale) {
  const rule = pluralRules[locale] || pluralRules['en-US'];
  const pluralIndex = rule(count);
  return t(`${key}.${pluralIndex}`, { count });
}

// ä½¿ç”¨ç¤ºä¾‹
const itemCount = 5;
const text = formatPlural('items', itemCount, getLocale());
// zh-CN: "5ä¸ªé¡¹ç›®"
// en-US: "5 items"
```

### 3. ä¸Šä¸‹æ–‡ç›¸å…³ç¿»è¯‘

```javascript
// æ ¹æ®ä¸Šä¸‹æ–‡æä¾›ä¸åŒç¿»è¯‘
const contextualTranslations = {
  'button.save': {
    'form': 'ä¿å­˜',
    'document': 'å­˜å‚¨',
    'game': 'å­˜æ¡£',
  }
};

function tWithContext(key, context) {
  const contextual = contextualTranslations[key];
  if (contextual && contextual[context]) {
    return contextual[context];
  }
  return t(key);
}
```

### 4. ç¿»è¯‘ç¼ºå¤±å¤„ç†

```javascript
import { onTranslationMissing } from '@ldesign/components/dist/utils/i18n';

// å¤„ç†ç¿»è¯‘ç¼ºå¤±
onTranslationMissing((key, locale) => {
  console.warn(`Missing translation: ${key} for locale: ${locale}`);
  
  // ä¸ŠæŠ¥åˆ°ç›‘æ§ç³»ç»Ÿ
  // analytics.reportMissingTranslation(key, locale);
  
  // è¿”å›é»˜è®¤å€¼
  return `[${key}]`;
});
```

## å·¥å…·å’Œå·¥ä½œæµ

### ç¿»è¯‘æ–‡ä»¶ç®¡ç†

å»ºè®®çš„ç›®å½•ç»“æ„ï¼š

```
src/
  locales/
    zh-CN/
      common.json
      components.json
      pages.json
    en-US/
      common.json
      components.json
      pages.json
    ja-JP/
      common.json
      components.json
      pages.json
```

### è‡ªåŠ¨åŒ–ç¿»è¯‘æ£€æŸ¥

```javascript
// ç¿»è¯‘å®Œæ•´æ€§æ£€æŸ¥è„šæœ¬
const fs = require('fs');
const path = require('path');

function checkTranslationCompleteness() {
  const localesDir = path.join(__dirname, 'src/locales');
  const languages = fs.readdirSync(localesDir);
  const baseLanguage = 'zh-CN';
  
  const baseTranslations = loadTranslations(baseLanguage);
  const allKeys = getAllKeys(baseTranslations);
  
  languages.forEach(lang => {
    if (lang === baseLanguage) return;
    
    const translations = loadTranslations(lang);
    const missingKeys = findMissingKeys(allKeys, translations);
    
    if (missingKeys.length > 0) {
      console.log(`Missing translations in ${lang}:`);
      missingKeys.forEach(key => console.log(`  - ${key}`));
    }
  });
}
```

## æ€»ç»“

LDesign çš„å›½é™…åŒ–ç³»ç»Ÿæä¾›äº†ï¼š

1. **å®Œæ•´çš„å¤šè¯­è¨€æ”¯æŒ** - å†…ç½®å¤šç§è¯­è¨€åŒ…
2. **çµæ´»çš„è‡ªå®šä¹‰èƒ½åŠ›** - æ”¯æŒæ·»åŠ å’Œä¿®æ”¹ç¿»è¯‘
3. **åŠ¨æ€è¯­è¨€åˆ‡æ¢** - è¿è¡Œæ—¶åˆ‡æ¢è¯­è¨€
4. **RTL æ”¯æŒ** - æ”¯æŒä»å³åˆ°å·¦çš„è¯­è¨€
5. **æœ¬åœ°åŒ–æ ¼å¼** - æ—¥æœŸã€æ—¶é—´ã€æ•°å­—çš„æœ¬åœ°åŒ–

é€šè¿‡åˆç†ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼Œä½ å¯ä»¥è½»æ¾æ„å»ºæ”¯æŒå¤šè¯­è¨€çš„å›½é™…åŒ–åº”ç”¨ç¨‹åºã€‚
