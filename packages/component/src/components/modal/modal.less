/**
 * Modal 模态框样式
 */

@import '../../global/variables.less';
@import '../../global/mixins.less';

:host {
  display: contents;
}

.ld-modal-root {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: var(--ld-modal-z-index, 1000);
  pointer-events: none;
  
  &.ld-modal--visible {
    pointer-events: auto;
  }
}

// ==================== 遮罩层 ====================

.ld-modal__mask {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--ld-modal-mask-bg, rgba(0, 0, 0, 0.45));
  pointer-events: auto;
  
  // 遮罩层动画
  opacity: 0;
  transition: opacity var(--ld-modal-animation-duration, 0.25s) ease-out;
  
  .ld-modal--visible & {
    opacity: 1;
  }
}

// ==================== 模态框容器 ====================

.ld-modal__wrap {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: var(--ld-modal-wrap-padding, 50px 16px);
  overflow: auto;
  pointer-events: none;
  
  // 居中显示
  &.ld-modal--centered {
    align-items: center;
  }
}

// ==================== 模态框主体 ====================

.ld-modal {
  position: relative;
  background: var(--ld-modal-bg, #fff);
  border-radius: var(--ld-modal-border-radius, 8px);
  box-shadow: var(--ld-modal-shadow, 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05));
  pointer-events: auto;
  max-width: calc(100vw - 32px);
  max-height: calc(100vh - 100px);
  display: flex;
  flex-direction: column;
  
  // 基础动画
  opacity: 0;
  transform: scale(0.8);
  transition: all var(--ld-modal-animation-duration, 0.25s) ease-out;
  
  &.ld-modal--visible {
    opacity: 1;
    transform: scale(1);
  }
  
  // 全屏模式
  &.ld-modal--fullscreen {
    width: 100vw !important;
    height: 100vh !important;
    max-width: none;
    max-height: none;
    border-radius: 0;
    
    .ld-modal__wrap {
      padding: 0;
    }
  }
  
  // 可拖拽
  &.ld-modal--draggable {
    .ld-modal__header {
      cursor: move;
      user-select: none;
    }
  }
  
  // 可调整大小
  &.ld-modal--resizable {
    resize: both;
    overflow: hidden;
    min-width: 200px;
    min-height: 100px;
  }
}

// ==================== 动画效果 ====================

// 淡入淡出
.ld-modal--fade {
  &:not(.ld-modal--visible) {
    opacity: 0;
    transform: scale(1);
  }
}

// 缩放
.ld-modal--zoom {
  &:not(.ld-modal--visible) {
    opacity: 0;
    transform: scale(0.8);
  }
}

// 从上滑入
.ld-modal--slide-up {
  &:not(.ld-modal--visible) {
    opacity: 0;
    transform: translateY(-50px);
  }
}

// 从下滑入
.ld-modal--slide-down {
  &:not(.ld-modal--visible) {
    opacity: 0;
    transform: translateY(50px);
  }
}

// ==================== 头部 ====================

.ld-modal__header {
  position: relative;
  padding: var(--ld-modal-header-padding, 16px 24px);
  border-bottom: var(--ld-modal-header-border, 1px solid #f0f0f0);
  border-radius: var(--ld-modal-border-radius, 8px) var(--ld-modal-border-radius, 8px) 0 0;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.ld-modal__title {
  font-size: var(--ld-modal-title-font-size, 16px);
  font-weight: var(--ld-modal-title-font-weight, 500);
  color: var(--ld-modal-title-color, rgba(0, 0, 0, 0.85));
  line-height: var(--ld-modal-title-line-height, 1.5);
  margin: 0;
  flex: 1;
}

.ld-modal__close {
  position: absolute;
  top: 50%;
  right: 16px;
  transform: translateY(-50%);
  width: 32px;
  height: 32px;
  border: none;
  background: transparent;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: all 0.25s ease;
  
  &:hover {
    background: var(--ld-modal-close-hover-bg, rgba(0, 0, 0, 0.06));
  }
  
  &:focus {
    outline: 2px solid var(--ld-color-primary, #1976d2);
    outline-offset: 2px;
  }
}

.ld-modal__close-icon {
  font-size: 18px;
  color: var(--ld-modal-close-color, rgba(0, 0, 0, 0.45));
  line-height: 1;
  
  .ld-modal__close:hover & {
    color: var(--ld-modal-close-hover-color, rgba(0, 0, 0, 0.75));
  }
}

// ==================== 内容区域 ====================

.ld-modal__body {
  padding: var(--ld-modal-body-padding, 24px);
  flex: 1;
  overflow: auto;
  font-size: var(--ld-modal-body-font-size, 14px);
  color: var(--ld-modal-body-color, rgba(0, 0, 0, 0.65));
  line-height: var(--ld-modal-body-line-height, 1.5715);
}

// ==================== 底部操作区域 ====================

.ld-modal__footer {
  padding: var(--ld-modal-footer-padding, 10px 16px);
  border-top: var(--ld-modal-footer-border, 1px solid #f0f0f0);
  border-radius: 0 0 var(--ld-modal-border-radius, 8px) var(--ld-modal-border-radius, 8px);
  text-align: right;
  flex-shrink: 0;
  
  ld-button {
    margin-left: 8px;
    
    &:first-child {
      margin-left: 0;
    }
  }
}

// ==================== 响应式设计 ====================

@media (max-width: 768px) {
  .ld-modal__wrap {
    padding: 16px;
  }
  
  .ld-modal {
    max-width: none;
    width: 100% !important;
    margin: 0;
  }
  
  .ld-modal__header {
    padding: 16px;
  }
  
  .ld-modal__body {
    padding: 16px;
  }
  
  .ld-modal__footer {
    padding: 12px 16px;
    
    ld-button {
      width: 100%;
      margin: 4px 0 0 0;
      
      &:first-child {
        margin-top: 0;
      }
    }
  }
}

// ==================== 暗色主题 ====================

:host([data-theme="dark"]) {
  .ld-modal {
    --ld-modal-bg: #1f1f1f;
    --ld-modal-title-color: rgba(255, 255, 255, 0.85);
    --ld-modal-body-color: rgba(255, 255, 255, 0.65);
    --ld-modal-header-border: 1px solid #303030;
    --ld-modal-footer-border: 1px solid #303030;
    --ld-modal-close-color: rgba(255, 255, 255, 0.45);
    --ld-modal-close-hover-color: rgba(255, 255, 255, 0.75);
    --ld-modal-close-hover-bg: rgba(255, 255, 255, 0.06);
  }
}

// ==================== 高对比度模式 ====================

@media (prefers-contrast: high) {
  .ld-modal {
    border: 2px solid;
    
    .ld-modal__header {
      border-bottom-width: 2px;
    }
    
    .ld-modal__footer {
      border-top-width: 2px;
    }
  }
}

// ==================== 减少动画模式 ====================

@media (prefers-reduced-motion: reduce) {
  .ld-modal {
    transition: none;
  }
  
  .ld-modal__mask {
    transition: none;
  }
}
