# LDesign 组件库 - 使用指南

## 快速开始

### 1. 安装组件库

#### 使用 npm
```bash
npm install @ldesign/components
```

#### 使用 yarn
```bash
yarn add @ldesign/components
```

#### 使用 pnpm
```bash
pnpm add @ldesign/components
```

### 2. 基础使用

#### 在 HTML 中使用
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LDesign 示例</title>
  <!-- 引入组件库 -->
  <script type="module" src="https://unpkg.com/@ldesign/components/dist/ldesign/ldesign.esm.js"></script>
</head>
<body>
  <!-- 使用组件 -->
  <ld-button type="primary">主要按钮</ld-button>
  <ld-input placeholder="请输入内容"></ld-input>
  <ld-card title="卡片标题">
    <p>这是卡片内容</p>
  </ld-card>
</body>
</html>
```

#### 在模块化项目中使用
```javascript
// 导入组件定义
import { defineCustomElements } from '@ldesign/components/loader';

// 注册组件
defineCustomElements();

// 现在可以在 HTML 中使用组件了
document.body.innerHTML = `
  <ld-button type="primary">点击我</ld-button>
`;
```

### 3. 框架集成

#### React 集成
```tsx
// App.tsx
import React, { useEffect } from 'react';
import { defineCustomElements } from '@ldesign/components/loader';

// 注册组件
defineCustomElements();

// 类型定义（可选）
declare global {
  namespace JSX {
    interface IntrinsicElements {
      'ld-button': any;
      'ld-input': any;
      'ld-card': any;
    }
  }
}

function App() {
  const handleButtonClick = (event: CustomEvent) => {
    console.log('按钮被点击了', event.detail);
  };

  return (
    <div className="App">
      <h1>LDesign + React 示例</h1>
      
      {/* 基础组件使用 */}
      <ld-button 
        type="primary" 
        onLdClick={handleButtonClick}
      >
        主要按钮
      </ld-button>
      
      <ld-input 
        placeholder="请输入内容"
        onLdChange={(e: CustomEvent) => console.log(e.detail)}
      />
      
      <ld-card title="React 卡片">
        <p>这是在 React 中使用的 LDesign 卡片组件</p>
      </ld-card>
    </div>
  );
}

export default App;
```

#### Vue 3 集成
```vue
<!-- App.vue -->
<template>
  <div class="app">
    <h1>LDesign + Vue 3 示例</h1>
    
    <!-- 基础组件使用 -->
    <ld-button 
      type="primary" 
      @ldClick="handleButtonClick"
    >
      主要按钮
    </ld-button>
    
    <ld-input 
      :value="inputValue"
      placeholder="请输入内容"
      @ldChange="handleInputChange"
    />
    
    <ld-card title="Vue 卡片">
      <p>这是在 Vue 中使用的 LDesign 卡片组件</p>
      <p>输入值：{{ inputValue }}</p>
    </ld-card>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue';
import { defineCustomElements } from '@ldesign/components/loader';

// 注册组件
onMounted(() => {
  defineCustomElements();
});

const inputValue = ref('');

const handleButtonClick = (event: CustomEvent) => {
  console.log('按钮被点击了', event.detail);
};

const handleInputChange = (event: CustomEvent) => {
  inputValue.value = event.detail;
};
</script>
```

#### Angular 集成
```typescript
// app.module.ts
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { defineCustomElements } from '@ldesign/components/loader';

import { AppComponent } from './app.component';

// 注册组件
defineCustomElements();

@NgModule({
  declarations: [AppComponent],
  imports: [BrowserModule],
  providers: [],
  bootstrap: [AppComponent],
  schemas: [CUSTOM_ELEMENTS_SCHEMA], // 允许使用自定义元素
})
export class AppModule {}
```

```typescript
// app.component.ts
import { Component } from '@angular/core';

@Component({
  selector: 'app-root',
  template: `
    <div class="app">
      <h1>LDesign + Angular 示例</h1>
      
      <ld-button 
        type="primary" 
        (ldClick)="handleButtonClick($event)"
      >
        主要按钮
      </ld-button>
      
      <ld-input 
        [value]="inputValue"
        placeholder="请输入内容"
        (ldChange)="handleInputChange($event)"
      ></ld-input>
      
      <ld-card title="Angular 卡片">
        <p>这是在 Angular 中使用的 LDesign 卡片组件</p>
        <p>输入值：{{ inputValue }}</p>
      </ld-card>
    </div>
  `,
})
export class AppComponent {
  inputValue = '';

  handleButtonClick(event: CustomEvent) {
    console.log('按钮被点击了', event.detail);
  }

  handleInputChange(event: CustomEvent) {
    this.inputValue = event.detail;
  }
}
```

## 主题定制

### 1. CSS 变量定制

#### 基础主题定制
```css
/* 自定义主题变量 */
:root {
  /* 主色调 */
  --ld-color-primary: #1976d2;
  --ld-color-primary-hover: #1565c0;
  --ld-color-primary-active: #0d47a1;
  
  /* 成功色 */
  --ld-color-success: #52c41a;
  --ld-color-success-hover: #73d13d;
  --ld-color-success-active: #389e0d;
  
  /* 警告色 */
  --ld-color-warning: #faad14;
  --ld-color-warning-hover: #ffc53d;
  --ld-color-warning-active: #d48806;
  
  /* 错误色 */
  --ld-color-error: #ff4d4f;
  --ld-color-error-hover: #ff7875;
  --ld-color-error-active: #d9363e;
  
  /* 字体 */
  --ld-font-family: 'PingFang SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --ld-font-size-base: 14px;
  --ld-line-height-base: 1.5715;
  
  /* 间距 */
  --ld-spacing-xs: 4px;
  --ld-spacing-sm: 8px;
  --ld-spacing-base: 16px;
  --ld-spacing-lg: 24px;
  --ld-spacing-xl: 32px;
  
  /* 圆角 */
  --ld-border-radius-sm: 4px;
  --ld-border-radius-base: 6px;
  --ld-border-radius-lg: 8px;
  
  /* 阴影 */
  --ld-shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
  --ld-shadow-base: 0 2px 8px rgba(0, 0, 0, 0.15);
  --ld-shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.15);
}
```

#### 暗色主题
```css
/* 暗色主题 */
[data-theme="dark"] {
  /* 背景色 */
  --ld-color-bg-primary: #1f1f1f;
  --ld-color-bg-secondary: #262626;
  --ld-color-bg-tertiary: #2f2f2f;
  
  /* 文字色 */
  --ld-color-text-primary: rgba(255, 255, 255, 0.85);
  --ld-color-text-secondary: rgba(255, 255, 255, 0.65);
  --ld-color-text-tertiary: rgba(255, 255, 255, 0.45);
  
  /* 边框色 */
  --ld-color-border-primary: #303030;
  --ld-color-border-secondary: #404040;
  
  /* 组件特定颜色 */
  --ld-button-default-bg: transparent;
  --ld-button-default-border: #404040;
  --ld-input-bg: #262626;
  --ld-card-bg: #262626;
}
```

### 2. 主题切换实现

#### JavaScript 主题切换
```javascript
// 主题管理器
class ThemeManager {
  constructor() {
    this.currentTheme = this.getStoredTheme() || 'light';
    this.applyTheme(this.currentTheme);
  }
  
  // 切换主题
  toggleTheme() {
    this.currentTheme = this.currentTheme === 'light' ? 'dark' : 'light';
    this.applyTheme(this.currentTheme);
    this.storeTheme(this.currentTheme);
  }
  
  // 应用主题
  applyTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    
    // 触发主题变化事件
    window.dispatchEvent(new CustomEvent('themechange', {
      detail: { theme }
    }));
  }
  
  // 存储主题偏好
  storeTheme(theme) {
    localStorage.setItem('ld-theme', theme);
  }
  
  // 获取存储的主题
  getStoredTheme() {
    return localStorage.getItem('ld-theme');
  }
  
  // 获取系统主题偏好
  getSystemTheme() {
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  }
}

// 使用主题管理器
const themeManager = new ThemeManager();

// 主题切换按钮
document.getElementById('theme-toggle').addEventListener('click', () => {
  themeManager.toggleTheme();
});
```

#### React 主题切换
```tsx
import React, { createContext, useContext, useEffect, useState } from 'react';

// 主题上下文
const ThemeContext = createContext<{
  theme: 'light' | 'dark';
  toggleTheme: () => void;
}>({
  theme: 'light',
  toggleTheme: () => {},
});

// 主题提供者
export const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [theme, setTheme] = useState<'light' | 'dark'>('light');
  
  useEffect(() => {
    // 从本地存储获取主题
    const storedTheme = localStorage.getItem('ld-theme') as 'light' | 'dark';
    if (storedTheme) {
      setTheme(storedTheme);
    } else {
      // 使用系统主题偏好
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      setTheme(systemTheme);
    }
  }, []);
  
  useEffect(() => {
    // 应用主题
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('ld-theme', theme);
  }, [theme]);
  
  const toggleTheme = () => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  };
  
  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
};

// 主题钩子
export const useTheme = () => {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
};

// 主题切换组件
export const ThemeToggle: React.FC = () => {
  const { theme, toggleTheme } = useTheme();
  
  return (
    <ld-button onClick={toggleTheme}>
      {theme === 'light' ? '🌙' : '☀️'} 切换主题
    </ld-button>
  );
};
```

## 最佳实践

### 1. 组件使用最佳实践

#### 按钮组件
```html
<!-- ✅ 推荐：语义化的按钮文本 -->
<ld-button type="primary">保存</ld-button>
<ld-button type="default">取消</ld-button>

<!-- ❌ 不推荐：模糊的按钮文本 -->
<ld-button type="primary">确定</ld-button>
<ld-button type="default">按钮</ld-button>

<!-- ✅ 推荐：为图标按钮提供无障碍标签 -->
<ld-button icon="search" icon-only aria-label="搜索"></ld-button>

<!-- ✅ 推荐：合理的按钮层次 -->
<div class="button-group">
  <ld-button type="primary">主要操作</ld-button>
  <ld-button type="default">次要操作</ld-button>
  <ld-button type="text">辅助操作</ld-button>
</div>
```

#### 表单组件
```html
<!-- ✅ 推荐：完整的表单结构 -->
<ld-form layout="vertical">
  <ld-form-item label="用户名" prop="username" required>
    <ld-input 
      placeholder="请输入用户名"
      aria-describedby="username-help"
    ></ld-input>
    <div id="username-help" slot="help">
      用户名长度应在 3-20 个字符之间
    </div>
  </ld-form-item>
  
  <ld-form-item label="密码" prop="password" required>
    <ld-input 
      type="password"
      placeholder="请输入密码"
    ></ld-input>
  </ld-form-item>
  
  <ld-form-item>
    <ld-button type="primary" html-type="submit">登录</ld-button>
  </ld-form-item>
</ld-form>
```

### 2. 性能优化最佳实践

#### 按需加载
```javascript
// ✅ 推荐：按需加载组件
import { defineCustomElement } from '@ldesign/components/dist/components/ld-button';
import { defineCustomElement as defineInput } from '@ldesign/components/dist/components/ld-input';

// 只注册需要的组件
defineCustomElement();
defineInput();
```

#### 事件处理优化
```javascript
// ✅ 推荐：使用事件委托
document.addEventListener('ldClick', (event) => {
  const target = event.target;
  
  if (target.matches('ld-button[data-action="save"]')) {
    handleSave();
  } else if (target.matches('ld-button[data-action="cancel"]')) {
    handleCancel();
  }
});

// ❌ 不推荐：为每个按钮单独绑定事件
document.querySelectorAll('ld-button').forEach(button => {
  button.addEventListener('ldClick', handleClick);
});
```

### 3. 无障碍最佳实践

#### 键盘导航
```html
<!-- ✅ 推荐：支持键盘导航的模态框 -->
<ld-modal 
  visible="true"
  aria-labelledby="modal-title"
  aria-describedby="modal-content"
>
  <h2 id="modal-title" slot="title">确认删除</h2>
  <div id="modal-content">
    <p>确定要删除这个项目吗？此操作不可撤销。</p>
  </div>
  <div slot="footer">
    <ld-button type="default">取消</ld-button>
    <ld-button type="primary" danger>删除</ld-button>
  </div>
</ld-modal>
```

#### 屏幕阅读器支持
```html
<!-- ✅ 推荐：为表格提供完整的无障碍信息 -->
<ld-table 
  aria-label="用户列表"
  role="table"
>
  <caption>共 100 个用户，当前显示第 1-10 个</caption>
  <!-- 表格内容 -->
</ld-table>

<!-- ✅ 推荐：为表单提供错误信息 -->
<ld-form-item 
  label="邮箱地址" 
  prop="email" 
  required
  validate-status="error"
  validate-message="请输入有效的邮箱地址"
>
  <ld-input 
    type="email"
    aria-invalid="true"
    aria-describedby="email-error"
  ></ld-input>
  <div id="email-error" role="alert">
    请输入有效的邮箱地址
  </div>
</ld-form-item>
```

### 4. 样式定制最佳实践

#### 组件级样式定制
```css
/* ✅ 推荐：使用 CSS 变量定制组件 */
.custom-button {
  --ld-button-primary-bg: #e91e63;
  --ld-button-primary-hover-bg: #c2185b;
  --ld-button-border-radius: 20px;
}

/* ✅ 推荐：使用 CSS 类覆盖样式 */
.large-card {
  --ld-card-padding: 32px;
  --ld-card-border-radius: 12px;
}

/* ❌ 不推荐：直接修改组件内部样式 */
ld-button::part(button) {
  background: red; /* 可能在未来版本中失效 */
}
```

#### 响应式设计
```css
/* ✅ 推荐：响应式组件样式 */
@media (max-width: 768px) {
  .mobile-form {
    --ld-form-layout: vertical;
    --ld-form-label-width: auto;
  }
  
  .mobile-table {
    --ld-table-font-size: 12px;
    --ld-table-padding: 8px;
  }
}
```
