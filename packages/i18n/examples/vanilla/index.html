<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ldesign/i18n - Vanilla JavaScript Example</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        line-height: 1.6;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        width: 100%;
        max-width: none;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
      }

      /* Header Styles */
      .header {
        text-align: center;
        margin-bottom: 30px;
        padding: 40px 20px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
      }

      .header h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 3em;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .header p {
        color: #666;
        font-size: 1.3em;
        margin-bottom: 30px;
      }

      /* Language Switcher */
      .language-switcher {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .lang-btn {
        padding: 15px 30px;
        border: 2px solid transparent;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 16px;
        font-weight: 600;
        min-width: 140px;
        position: relative;
        overflow: hidden;
      }

      .lang-btn:hover:not(:disabled) {
        background: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .lang-btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none;
      }

      .lang-btn.active {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      .lang-btn.active:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
      }

      .loading-spinner {
        display: inline-block;
        width: 16px;
        height: 16px;
        border: 2px solid #ffffff40;
        border-top: 2px solid #ffffff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-left: 8px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .current-language {
        font-size: 18px;
        color: #667eea;
        font-weight: 600;
        margin-top: 15px;
      }

      /* Main Content Layout */
      .main-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 30px;
      }

      /* Translation Keys Section */
      .translation-keys {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
      }

      .translation-keys h2 {
        color: #333;
        margin-bottom: 25px;
        font-size: 2em;
        text-align: center;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .key-category {
        margin-bottom: 25px;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        overflow: hidden;
      }

      .category-header {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 15px 20px;
        font-weight: 600;
        font-size: 1.1em;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .category-header:hover {
        background: linear-gradient(135deg, #5a6fd8, #6a4190);
      }

      .category-content {
        background: white;
        max-height: 300px;
        overflow-y: auto;
      }

      .key-item {
        padding: 12px 20px;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .key-item:last-child {
        border-bottom: none;
      }

      .key-item:hover {
        background: #f8f9ff;
      }

      .key-name {
        font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
        font-size: 13px;
        color: #666;
        background: #f5f5f5;
        padding: 4px 8px;
        border-radius: 4px;
        flex: 1;
        margin-right: 15px;
      }

      .key-value {
        color: #333;
        font-weight: 500;
        flex: 2;
        text-align: right;
      }

      /* Usage Examples Section */
      .usage-examples {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
      }

      .usage-examples h2 {
        color: #333;
        margin-bottom: 25px;
        font-size: 2em;
        text-align: center;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .example-section {
        margin-bottom: 30px;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        overflow: hidden;
      }

      .example-header {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 15px 20px;
        font-weight: 600;
        font-size: 1.1em;
      }

      .example-content {
        background: white;
        padding: 20px;
      }

      .example-item {
        margin-bottom: 20px;
        padding: 15px;
        background: #f8f9ff;
        border-radius: 8px;
        border-left: 4px solid #667eea;
      }

      .example-item:last-child {
        margin-bottom: 0;
      }

      .code-block {
        font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
        font-size: 14px;
        color: #666;
        background: #f5f5f5;
        padding: 12px 16px;
        border-radius: 6px;
        margin-bottom: 10px;
        border: 1px solid #e0e0e0;
      }

      .result-block {
        font-weight: 600;
        color: #667eea;
        font-size: 16px;
        padding: 10px 16px;
        background: white;
        border-radius: 6px;
        border: 1px solid #e0e0e0;
      }

      .result-block pre {
        margin: 0;
        white-space: pre-wrap;
        font-family: inherit;
      }

      /* Error Handling */
      .error {
        color: #dc3545;
        background: #f8d7da;
        padding: 15px 20px;
        border-radius: 8px;
        margin: 20px 0;
        border: 1px solid #f5c6cb;
        border-left: 4px solid #dc3545;
      }

      #error-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        max-width: 400px;
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .main-content {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .header h1 {
          font-size: 2.2em;
        }

        .language-switcher {
          flex-direction: column;
          align-items: center;
        }

        .lang-btn {
          width: 100%;
          max-width: 250px;
        }
      }

      /* Scrollbar Styling */
      .category-content::-webkit-scrollbar {
        width: 6px;
      }

      .category-content::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      .category-content::-webkit-scrollbar-thumb {
        background: #c1c1c1;
        border-radius: 3px;
      }

      .category-content::-webkit-scrollbar-thumb:hover {
        background: #a8a8a8;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <h1>@ldesign/i18n</h1>
        <p>Vanilla JavaScript Example</p>

        <!-- Language Switcher -->
        <div class="language-switcher">
          <button class="lang-btn" id="btn-en" onclick="changeLanguage('en')">English</button>
          <button class="lang-btn" id="btn-zh-cn" onclick="changeLanguage('zh-CN')">中文</button>
          <button class="lang-btn" id="btn-ja" onclick="changeLanguage('ja')">日本語</button>
        </div>

        <!-- Current Language Display -->
        <div class="current-language" id="current-language">Loading...</div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Translation Keys Section -->
        <div class="translation-keys">
          <h2>Translation Keys</h2>
          <div id="translation-keys-content">
            <!-- Keys will be populated by JavaScript -->
          </div>
        </div>

        <!-- Usage Examples Section -->
        <div class="usage-examples">
          <h2>Usage Examples</h2>

          <!-- Basic Translation -->
          <div class="example-section">
            <div class="example-header">Basic Translation</div>
            <div class="example-content">
              <div class="example-item">
                <div class="code-block">i18n.t('common.ok')</div>
                <div class="result-block" id="example-basic-ok">-</div>
              </div>
              <div class="example-item">
                <div class="code-block">i18n.t('common.cancel')</div>
                <div class="result-block" id="example-basic-cancel">-</div>
              </div>
              <div class="example-item">
                <div class="code-block">i18n.t('common.loading')</div>
                <div class="result-block" id="example-basic-loading">-</div>
              </div>
            </div>
          </div>

          <!-- Interpolation -->
          <div class="example-section">
            <div class="example-header">Parameter Interpolation</div>
            <div class="example-content">
              <div class="example-item">
                <div class="code-block">i18n.t('common.pageOf', { current: 1, total: 10 })</div>
                <div class="result-block" id="example-interpolation-page">-</div>
              </div>
              <div class="example-item">
                <div class="code-block">i18n.t('common.showingItems', { start: 1, end: 20, total: 100 })</div>
                <div class="result-block" id="example-interpolation-items">-</div>
              </div>
            </div>
          </div>

          <!-- Pluralization -->
          <div class="example-section">
            <div class="example-header">Pluralization</div>
            <div class="example-content">
              <div class="example-item">
                <div class="code-block">i18n.t('date.duration.minutes', { count: 1 })</div>
                <div class="result-block" id="example-plural-minute">-</div>
              </div>
              <div class="example-item">
                <div class="code-block">i18n.t('date.duration.minutes', { count: 5 })</div>
                <div class="result-block" id="example-plural-minutes">-</div>
              </div>
            </div>
          </div>

          <!-- Nested Keys -->
          <div class="example-section">
            <div class="example-header">Nested Keys</div>
            <div class="example-content">
              <div class="example-item">
                <div class="code-block">i18n.t('menu.file.new')</div>
                <div class="result-block" id="example-nested-new">-</div>
              </div>
              <div class="example-item">
                <div class="code-block">i18n.t('menu.edit.copy')</div>
                <div class="result-block" id="example-nested-copy">-</div>
              </div>
              <div class="example-item">
                <div class="code-block">i18n.t('validation.username.required')</div>
                <div class="result-block" id="example-nested-validation">-</div>
              </div>
            </div>
          </div>

          <!-- Batch Translation -->
          <div class="example-section">
            <div class="example-header">Batch Translation</div>
            <div class="example-content">
              <div class="example-item">
                <div class="code-block">i18n.batchTranslate(['common.save', 'common.delete', 'common.edit'])</div>
                <div class="result-block" id="example-batch">
                  <pre>-</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error Container -->
    <div id="error-container"></div>

    <script type="module">
      import { createI18nWithBuiltinLocales } from '@ldesign/i18n'

      let i18n = null

      // Initialize I18n
      async function initI18n() {
        try {
          i18n = await createI18nWithBuiltinLocales({
            defaultLocale: 'en',
            fallbackLocale: 'en',
            storage: 'localStorage',
            autoDetect: true,
          })

          // Listen for language change events
          i18n.on('languageChanged', (locale) => {
            console.log('Language changed to:', locale)
            updateUI()
          })

          // Initial UI update
          updateUI()

          console.log('I18n initialized successfully')
        } catch (error) {
          console.error('Failed to initialize I18n:', error)
          showError('Failed to initialize I18n: ' + error.message)
        }
      }

      // Update UI with current translations
      function updateUI() {
        if (!i18n) return

        try {
          const currentLang = i18n.getCurrentLanguage()
          const langInfo = i18n.getCurrentLanguageInfo()

          // Update current language display
          document.getElementById('current-language').textContent =
            `Current Language: ${langInfo?.nativeName || currentLang} (${currentLang})`

          // Update button states
          document.querySelectorAll('.lang-btn').forEach((btn) => btn.classList.remove('active'))
          const activeBtn = document.getElementById(`btn-${currentLang.toLowerCase()}`)
          if (activeBtn) activeBtn.classList.add('active')

          // Update translation examples
          updateExamples()

          // Update translation keys display
          updateTranslationKeys()
        } catch (error) {
          console.error('Error updating UI:', error)
          showError('Error updating UI: ' + error.message)
        }
      }

      // Update translation examples
      function updateExamples() {
        if (!i18n) return

        try {
          // Basic translations
          document.getElementById('example-basic-ok').textContent = i18n.t('common.ok')
          document.getElementById('example-basic-cancel').textContent = i18n.t('common.cancel')
          document.getElementById('example-basic-loading').textContent = i18n.t('common.loading')

          // Interpolation
          document.getElementById('example-interpolation-page').textContent = i18n.t('common.pageOf', {
            current: 1,
            total: 10,
          })
          document.getElementById('example-interpolation-items').textContent = i18n.t('common.showingItems', {
            start: 1,
            end: 20,
            total: 100,
          })

          // Pluralization
          document.getElementById('example-plural-minute').textContent = i18n.t('date.duration.minutes', { count: 1 })
          document.getElementById('example-plural-minutes').textContent = i18n.t('date.duration.minutes', { count: 5 })

          // Nested keys
          document.getElementById('example-nested-new').textContent = i18n.t('menu.file.new')
          document.getElementById('example-nested-copy').textContent = i18n.t('menu.edit.copy')
          document.getElementById('example-nested-validation').textContent = i18n.t('validation.username.required')

          // Batch translation
          const batchResult = i18n.batchTranslate(['common.save', 'common.delete', 'common.edit'])
          document.getElementById('example-batch').innerHTML = `<pre>${JSON.stringify(batchResult, null, 2)}</pre>`
        } catch (error) {
          console.error('Error updating examples:', error)
          showError('Error updating examples: ' + error.message)
        }
      }

      // Update translation keys display
      function updateTranslationKeys() {
        if (!i18n) return

        try {
          const container = document.getElementById('translation-keys-content')
          container.innerHTML = ''

          // Get all available keys organized by category
          const categories = {
            common: [],
            menu: [],
            validation: [],
            date: [],
          }

          // 手动定义所有可用的翻译键
          const allKeys = [
            // Common keys
            'common.ok',
            'common.cancel',
            'common.save',
            'common.delete',
            'common.edit',
            'common.loading',
            'common.online',
            'common.offline',
            'common.searchPlaceholder',
            'common.pageOf',
            'common.showingItems',

            // Menu keys
            'menu.file.new',
            'menu.file.open',
            'menu.file.save',
            'menu.edit.copy',
            'menu.edit.paste',
            'menu.edit.cut',

            // Validation keys
            'validation.username.required',
            'validation.password.required',
            'validation.email.invalid',

            // Date keys
            'date.duration.minutes',
            'date.duration.hours',
            'date.duration.days',
          ]

          // Organize keys by category
          allKeys.forEach((key) => {
            const category = key.split('.')[0]
            if (categories[category]) {
              categories[category].push(key)
            }
          })

          // Create category sections
          Object.entries(categories).forEach(([categoryName, keys]) => {
            if (keys.length === 0) return

            const categoryDiv = document.createElement('div')
            categoryDiv.className = 'key-category'

            const headerDiv = document.createElement('div')
            headerDiv.className = 'category-header'
            headerDiv.innerHTML = `${categoryName.toUpperCase()} (${keys.length} keys) <span>▼</span>`

            const contentDiv = document.createElement('div')
            contentDiv.className = 'category-content'

            // Add click handler for expand/collapse
            headerDiv.addEventListener('click', () => {
              const isVisible = contentDiv.style.display !== 'none'
              contentDiv.style.display = isVisible ? 'none' : 'block'
              headerDiv.querySelector('span').textContent = isVisible ? '▶' : '▼'
            })

            // Add keys to content
            keys.forEach((key) => {
              const keyDiv = document.createElement('div')
              keyDiv.className = 'key-item'

              const keyNameSpan = document.createElement('span')
              keyNameSpan.className = 'key-name'
              keyNameSpan.textContent = key

              const keyValueSpan = document.createElement('span')
              keyValueSpan.className = 'key-value'

              try {
                const translation = i18n.t(key)
                keyValueSpan.textContent = translation === key ? '[Missing]' : translation
              } catch (error) {
                keyValueSpan.textContent = '[Error]'
              }

              keyDiv.appendChild(keyNameSpan)
              keyDiv.appendChild(keyValueSpan)
              contentDiv.appendChild(keyDiv)
            })

            categoryDiv.appendChild(headerDiv)
            categoryDiv.appendChild(contentDiv)
            container.appendChild(categoryDiv)
          })
        } catch (error) {
          console.error('Error updating translation keys:', error)
          showError('Error updating translation keys: ' + error.message)
        }
      }

      // Change language function
      window.changeLanguage = async function (locale) {
        if (!i18n) return

        // Show loading state
        const btn = document.getElementById(`btn-${locale.toLowerCase()}`)
        if (btn) {
          btn.disabled = true
          const originalText = btn.textContent
          btn.innerHTML = originalText + ' <span class="loading-spinner"></span>'
        }

        try {
          await i18n.changeLanguage(locale)
        } catch (error) {
          console.error('Failed to change language:', error)
          showError('Failed to change language: ' + error.message)
        } finally {
          // Restore button state
          if (btn) {
            btn.disabled = false
            btn.innerHTML = btn.innerHTML.replace(' <span class="loading-spinner"></span>', '')
          }
        }
      }

      // Show error message
      function showError(message) {
        const errorContainer = document.getElementById('error-container')
        const errorDiv = document.createElement('div')
        errorDiv.className = 'error'
        errorDiv.textContent = message
        errorContainer.appendChild(errorDiv)

        // Auto remove after 5 seconds
        setTimeout(() => {
          errorDiv.remove()
        }, 5000)
      }

      // Initialize when page loads
      initI18n()
    </script>
  </body>
</html>
