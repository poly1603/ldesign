<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>React é›†æˆç¤ºä¾‹ - LDESIGN Table</title>
  <link rel="stylesheet" href="../src/styles/main.css">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback } = React;

    // LDESIGN Table React ç»„ä»¶
    function LDesignTable({ 
      columns, 
      data, 
      config = {}, 
      onSelectionChange,
      onSortChange,
      onRowClick 
    }) {
      const containerRef = useRef(null);
      const tableInstanceRef = useRef(null);

      useEffect(() => {
        // åŠ¨æ€å¯¼å…¥ Table ç±»
        import('@ldesign/table').then(({ Table }) => {
          if (tableInstanceRef.current) {
            tableInstanceRef.current.destroy();
          }

          tableInstanceRef.current = new Table({
            container: containerRef.current,
            columns,
            data,
            rowKey: 'id',
            ...config,
            onSelectionChange,
            onSortChange,
            onRowClick
          });
        });

        return () => {
          if (tableInstanceRef.current) {
            tableInstanceRef.current.destroy();
          }
        };
      }, [columns, config]);

      useEffect(() => {
        if (tableInstanceRef.current) {
          tableInstanceRef.current.setData(data);
        }
      }, [data]);

      return React.createElement('div', { 
        ref: containerRef, 
        className: 'table-container' 
      });
    }

    // ä¸»åº”ç”¨ç»„ä»¶
    function App() {
      const [employees, setEmployees] = useState([
        { id: 1, name: 'å¼ ä¸‰', age: 25, department: 'æŠ€æœ¯éƒ¨', salary: 8000, joinDate: '2023-01-15', status: 'åœ¨èŒ' },
        { id: 2, name: 'æå››', age: 30, department: 'å¸‚åœºéƒ¨', salary: 7500, joinDate: '2022-06-20', status: 'åœ¨èŒ' },
        { id: 3, name: 'ç‹äº”', age: 28, department: 'äººäº‹éƒ¨', salary: 6500, joinDate: '2023-03-10', status: 'åœ¨èŒ' },
        { id: 4, name: 'èµµå…­', age: 32, department: 'æŠ€æœ¯éƒ¨', salary: 9000, joinDate: '2021-11-05', status: 'åœ¨èŒ' },
        { id: 5, name: 'é’±ä¸ƒ', age: 27, department: 'è´¢åŠ¡éƒ¨', salary: 7000, joinDate: '2023-08-12', status: 'åœ¨èŒ' }
      ]);

      const [selectedEmployees, setSelectedEmployees] = useState([]);
      const [currentTheme, setCurrentTheme] = useState('light');
      const [eventLog, setEventLog] = useState([]);
      const [tableConfig, setTableConfig] = useState({
        pagination: { enabled: true, pageSize: 10 },
        selection: { enabled: true, multiple: true, checkboxColumn: true },
        sorting: { enabled: true }
      });

      const tableRef = useRef(null);

      // è¡¨æ ¼åˆ—é…ç½®
      const columns = [
        { key: 'name', title: 'å§“å', sortable: true, width: 100 },
        { key: 'age', title: 'å¹´é¾„', sortable: true, width: 80 },
        { key: 'department', title: 'éƒ¨é—¨', sortable: true, width: 120 },
        { key: 'salary', title: 'è–ªèµ„', sortable: true, width: 100, render: (value) => `Â¥${value}` },
        { key: 'joinDate', title: 'å…¥èŒæ—¥æœŸ', sortable: true, width: 120 },
        { key: 'status', title: 'çŠ¶æ€', width: 80 }
      ];

      // æ·»åŠ äº‹ä»¶æ—¥å¿—
      const addEventLog = useCallback((type, message) => {
        const event = {
          id: Date.now(),
          time: new Date().toLocaleTimeString(),
          type: type.toLowerCase(),
          message
        };
        setEventLog(prev => [event, ...prev.slice(0, 19)]);
      }, []);

      // äº‹ä»¶å¤„ç†å™¨
      const handleSelectionChange = useCallback((data) => {
        setSelectedEmployees(data.selectedRows);
        addEventLog('é€‰æ‹©å˜æ›´', `é€‰ä¸­ ${data.selectedRows.length} è¡Œ`);
      }, [addEventLog]);

      const handleSortChange = useCallback((data) => {
        addEventLog('æ’åºå˜æ›´', `æŒ‰ ${data.column} ${data.direction} æ’åº`);
      }, [addEventLog]);

      const handleRowClick = useCallback((data) => {
        addEventLog('è¡Œç‚¹å‡»', `ç‚¹å‡»äº† ${data.row.name}`);
      }, [addEventLog]);

      // æ•°æ®æ“ä½œ
      const addRandomEmployee = () => {
        const names = ['æ–°å‘˜å·¥A', 'æ–°å‘˜å·¥B', 'æ–°å‘˜å·¥C', 'æ–°å‘˜å·¥D', 'æ–°å‘˜å·¥E'];
        const departments = ['æŠ€æœ¯éƒ¨', 'å¸‚åœºéƒ¨', 'äººäº‹éƒ¨', 'è´¢åŠ¡éƒ¨'];
        const newEmployee = {
          id: Date.now(),
          name: names[Math.floor(Math.random() * names.length)],
          age: Math.floor(Math.random() * 20) + 25,
          department: departments[Math.floor(Math.random() * departments.length)],
          salary: Math.floor(Math.random() * 5000) + 6000,
          joinDate: new Date().toISOString().split('T')[0],
          status: 'åœ¨èŒ'
        };
        
        setEmployees(prev => [...prev, newEmployee]);
        addEventLog('æ•°æ®æ“ä½œ', `æ·»åŠ å‘˜å·¥: ${newEmployee.name}`);
      };

      const removeSelectedEmployees = () => {
        if (selectedEmployees.length === 0) {
          addEventLog('è­¦å‘Š', 'è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„å‘˜å·¥');
          return;
        }

        const selectedIds = selectedEmployees.map(emp => emp.id);
        setEmployees(prev => prev.filter(emp => !selectedIds.includes(emp.id)));
        setSelectedEmployees([]);
        addEventLog('æ•°æ®æ“ä½œ', `åˆ é™¤ ${selectedIds.length} åå‘˜å·¥`);
      };

      const updateRandomEmployee = () => {
        if (employees.length === 0) return;
        
        const randomIndex = Math.floor(Math.random() * employees.length);
        const newSalary = Math.floor(Math.random() * 5000) + 6000;
        
        setEmployees(prev => prev.map((emp, index) => 
          index === randomIndex ? { ...emp, salary: newSalary } : emp
        ));
        
        addEventLog('æ•°æ®æ“ä½œ', `æ›´æ–°å‘˜å·¥ ${employees[randomIndex].name} è–ªèµ„ä¸º Â¥${newSalary}`);
      };

      const refreshData = () => {
        setEmployees(prev => [...prev]);
        addEventLog('æ•°æ®æ“ä½œ', 'åˆ·æ–°è¡¨æ ¼æ•°æ®');
      };

      // é…ç½®æ›´æ–°
      const updateConfig = (key, value) => {
        setTableConfig(prev => ({
          ...prev,
          [key]: { ...prev[key], ...value }
        }));
        addEventLog('é…ç½®', 'è¡¨æ ¼é…ç½®å·²æ›´æ–°');
      };

      // ä¸»é¢˜åˆ‡æ¢
      const changeTheme = (theme) => {
        setCurrentTheme(theme);
        // è¿™é‡Œéœ€è¦é€šè¿‡ ref è®¿é—®è¡¨æ ¼å®ä¾‹æ¥åˆ‡æ¢ä¸»é¢˜
        addEventLog('ä¸»é¢˜', `åˆ‡æ¢åˆ° ${theme} ä¸»é¢˜`);
      };

      const clearEventLog = () => {
        setEventLog([]);
      };

      return React.createElement('div', null,
        React.createElement('div', { className: 'page-header' },
          React.createElement('h1', null, 'âš›ï¸ React é›†æˆç¤ºä¾‹'),
          React.createElement('p', null, 'æ¼”ç¤º LDESIGN Table ä¸ React çš„é›†æˆä½¿ç”¨')
        ),

        React.createElement('nav', { className: 'nav' },
          React.createElement('div', { className: 'container' },
            React.createElement('ul', { className: 'nav-links' },
              React.createElement('li', null, React.createElement('a', { href: '../index.html' }, 'é¦–é¡µ')),
              React.createElement('li', null, React.createElement('a', { href: './vue-example.html' }, 'Vue.js ç¤ºä¾‹')),
              React.createElement('li', null, React.createElement('a', { href: './react-example.html', className: 'active' }, 'React ç¤ºä¾‹')),
              React.createElement('li', null, React.createElement('a', { href: './angular-example.html' }, 'Angular ç¤ºä¾‹'))
            )
          )
        ),

        React.createElement('div', { className: 'container' },
          React.createElement('div', { className: 'example-section' },
            React.createElement('h2', null, 'React é›†æˆæ¼”ç¤º'),
            React.createElement('p', null, 'è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åœ¨ React åº”ç”¨ä¸­ä½¿ç”¨ LDESIGN Table ç»„ä»¶ã€‚'),
            
            React.createElement('div', { className: 'info-panel' },
              React.createElement('h4', null, 'é›†æˆç‰¹æ€§'),
              React.createElement('ul', null,
                React.createElement('li', null, 'ğŸ”„ React Hooks é›†æˆ'),
                React.createElement('li', null, 'ğŸ“Š ç»„ä»¶åŒ–è¡¨æ ¼å°è£…'),
                React.createElement('li', null, 'ğŸ¯ äº‹ä»¶å¤„ç†é›†æˆ'),
                React.createElement('li', null, 'ğŸ”§ çŠ¶æ€ç®¡ç†é›†æˆ'),
                React.createElement('li', null, 'ğŸ“± ç”Ÿå‘½å‘¨æœŸç®¡ç†'),
                React.createElement('li', null, 'ğŸ¨ æ ·å¼ä¸»é¢˜é›†æˆ')
              )
            ),

            React.createElement('div', { className: 'controls' },
              React.createElement('h3', null, 'æ•°æ®æ“ä½œ'),
              React.createElement('button', { className: 'btn', onClick: addRandomEmployee }, 'æ·»åŠ å‘˜å·¥'),
              React.createElement('button', { className: 'btn', onClick: removeSelectedEmployees }, 'åˆ é™¤é€‰ä¸­'),
              React.createElement('button', { className: 'btn', onClick: updateRandomEmployee }, 'æ›´æ–°éšæœºå‘˜å·¥'),
              React.createElement('button', { className: 'btn', onClick: refreshData }, 'åˆ·æ–°æ•°æ®')
            ),

            React.createElement('div', { className: 'controls' },
              React.createElement('h3', null, 'è¡¨æ ¼é…ç½®'),
              React.createElement('label', null,
                React.createElement('input', {
                  type: 'checkbox',
                  checked: tableConfig.pagination.enabled,
                  onChange: (e) => updateConfig('pagination', { enabled: e.target.checked })
                }),
                'å¯ç”¨åˆ†é¡µ'
              ),
              React.createElement('label', null,
                React.createElement('input', {
                  type: 'checkbox',
                  checked: tableConfig.selection.enabled,
                  onChange: (e) => updateConfig('selection', { enabled: e.target.checked })
                }),
                'å¯ç”¨é€‰æ‹©'
              ),
              React.createElement('label', null,
                React.createElement('input', {
                  type: 'checkbox',
                  checked: tableConfig.sorting.enabled,
                  onChange: (e) => updateConfig('sorting', { enabled: e.target.checked })
                }),
                'å¯ç”¨æ’åº'
              )
            ),

            React.createElement('div', { className: 'controls' },
              React.createElement('h3', null, 'ä¸»é¢˜åˆ‡æ¢'),
              React.createElement('select', {
                value: currentTheme,
                onChange: (e) => changeTheme(e.target.value)
              },
                React.createElement('option', { value: 'light' }, 'æ˜äº®ä¸»é¢˜'),
                React.createElement('option', { value: 'dark' }, 'æš—é»‘ä¸»é¢˜'),
                React.createElement('option', { value: 'compact' }, 'ç´§å‡‘ä¸»é¢˜'),
                React.createElement('option', { value: 'comfortable' }, 'èˆ’é€‚ä¸»é¢˜')
              )
            ),

            React.createElement(LDesignTable, {
              ref: tableRef,
              columns,
              data: employees,
              config: tableConfig,
              onSelectionChange: handleSelectionChange,
              onSortChange: handleSortChange,
              onRowClick: handleRowClick
            }),

            React.createElement('div', { className: 'info-panel' },
              React.createElement('h4', null, 'React çŠ¶æ€'),
              React.createElement('div', null,
                'å‘˜å·¥æ€»æ•°: ', React.createElement('span', { className: 'status' }, employees.length),
                ' é€‰ä¸­æ•°é‡: ', React.createElement('span', { className: 'status' }, selectedEmployees.length),
                ' å½“å‰ä¸»é¢˜: ', React.createElement('span', { className: 'status' }, currentTheme)
              ),
              React.createElement('div', null,
                'åˆ†é¡µçŠ¶æ€: ', React.createElement('span', { className: 'status' }, tableConfig.pagination.enabled ? 'å¯ç”¨' : 'ç¦ç”¨'),
                ' æ’åºçŠ¶æ€: ', React.createElement('span', { className: 'status' }, tableConfig.sorting.enabled ? 'å¯ç”¨' : 'ç¦ç”¨')
              )
            ),

            React.createElement('div', { className: 'info-panel' },
              React.createElement('h4', null, 'äº‹ä»¶æ—¥å¿—'),
              React.createElement('div', { className: 'event-log' },
                eventLog.map(event =>
                  React.createElement('div', { key: event.id, className: 'event-item' },
                    React.createElement('span', { className: 'event-time' }, event.time),
                    React.createElement('span', { className: `event-type ${event.type}` }, event.message)
                  )
                )
              ),
              React.createElement('button', { className: 'btn btn-small', onClick: clearEventLog }, 'æ¸…é™¤æ—¥å¿—')
            )
          )
        )
      );
    }

    // æ¸²æŸ“åº”ç”¨
    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>

  <style>
    .event-log {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid var(--ldesign-border-color);
      border-radius: var(--ls-border-radius-base);
      padding: 10px;
      background: var(--ldesign-bg-color-component);
    }

    .event-item {
      display: flex;
      align-items: center;
      padding: 3px 0;
      border-bottom: 1px solid var(--ldesign-border-level-1-color);
    }

    .event-item:last-child {
      border-bottom: none;
    }

    .event-time {
      font-size: var(--ls-font-size-xs);
      color: var(--ldesign-text-color-secondary);
      min-width: 80px;
    }

    .event-type {
      margin-left: 10px;
      font-size: var(--ls-font-size-sm);
    }

    .event-type.ç³»ç»Ÿ { color: var(--ldesign-brand-color); }
    .event-type.æ•°æ®æ“ä½œ { color: var(--ldesign-success-color); }
    .event-type.é…ç½® { color: var(--ldesign-warning-color); }
    .event-type.ä¸»é¢˜ { color: var(--ldesign-brand-color); }
    .event-type.è­¦å‘Š { color: var(--ldesign-error-color); }

    .btn-small {
      padding: 5px 10px;
      font-size: var(--ls-font-size-xs);
      margin-top: 10px;
    }
  </style>
</body>
</html>
