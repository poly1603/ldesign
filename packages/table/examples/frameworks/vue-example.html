<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue.js 集成示例 - LDESIGN Table</title>
  <link rel="stylesheet" href="../src/styles/main.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app">
    <div class="page-header">
      <h1>🔧 Vue.js 集成示例</h1>
      <p>演示 LDESIGN Table 与 Vue.js 的集成使用</p>
    </div>

    <nav class="nav">
      <div class="container">
        <ul class="nav-links">
          <li><a href="../index.html">首页</a></li>
          <li><a href="./vue-example.html" class="active">Vue.js 示例</a></li>
          <li><a href="./react-example.html">React 示例</a></li>
          <li><a href="./angular-example.html">Angular 示例</a></li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <div class="example-section">
        <h2>Vue.js 集成演示</h2>
        <p>这个示例展示了如何在 Vue.js 应用中使用 LDESIGN Table 组件。</p>
        
        <div class="info-panel">
          <h4>集成特性</h4>
          <ul>
            <li>🔄 Vue 响应式数据绑定</li>
            <li>📊 组件化表格封装</li>
            <li>🎯 事件处理集成</li>
            <li>🔧 配置动态更新</li>
            <li>📱 生命周期管理</li>
            <li>🎨 样式主题集成</li>
          </ul>
        </div>

        <div class="controls">
          <h3>数据操作</h3>
          <button class="btn" @click="addRandomEmployee">添加员工</button>
          <button class="btn" @click="removeSelectedEmployees">删除选中</button>
          <button class="btn" @click="updateRandomEmployee">更新随机员工</button>
          <button class="btn" @click="refreshData">刷新数据</button>
        </div>

        <div class="controls">
          <h3>表格配置</h3>
          <label>
            <input type="checkbox" v-model="tableConfig.pagination.enabled">
            启用分页
          </label>
          <label>
            <input type="checkbox" v-model="tableConfig.selection.enabled">
            启用选择
          </label>
          <label>
            <input type="checkbox" v-model="tableConfig.sorting.enabled">
            启用排序
          </label>
          <label>
            每页条数:
            <select v-model="tableConfig.pagination.pageSize" @change="updateTableConfig">
              <option value="5">5</option>
              <option value="10">10</option>
              <option value="20">20</option>
            </select>
          </label>
        </div>

        <div class="controls">
          <h3>主题切换</h3>
          <select v-model="currentTheme" @change="changeTheme">
            <option value="light">明亮主题</option>
            <option value="dark">暗黑主题</option>
            <option value="compact">紧凑主题</option>
            <option value="comfortable">舒适主题</option>
          </select>
        </div>

        <!-- 表格容器 -->
        <div class="table-container" ref="tableContainer"></div>

        <div class="info-panel">
          <h4>Vue 状态</h4>
          <div>
            员工总数: <span class="status">{{ employees.length }}</span>
            选中数量: <span class="status">{{ selectedEmployees.length }}</span>
            当前主题: <span class="status">{{ currentTheme }}</span>
          </div>
          <div>
            分页状态: <span class="status">{{ tableConfig.pagination.enabled ? '启用' : '禁用' }}</span>
            排序状态: <span class="status">{{ tableConfig.sorting.enabled ? '启用' : '禁用' }}</span>
          </div>
        </div>

        <div class="info-panel">
          <h4>事件日志</h4>
          <div class="event-log" ref="eventLog">
            <div v-for="event in eventLog" :key="event.id" class="event-item">
              <span class="event-time">{{ event.time }}</span>
              <span class="event-type" :class="event.type">{{ event.message }}</span>
            </div>
          </div>
          <button class="btn btn-small" @click="clearEventLog">清除日志</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { Table } from '@ldesign/table'
    import '@ldesign/table/styles'

    const { createApp, ref, reactive, onMounted, onUnmounted, watch, nextTick } = Vue

    createApp({
      setup() {
        // 响应式数据
        const employees = ref([
          { id: 1, name: '张三', age: 25, department: '技术部', salary: 8000, joinDate: '2023-01-15', status: '在职' },
          { id: 2, name: '李四', age: 30, department: '市场部', salary: 7500, joinDate: '2022-06-20', status: '在职' },
          { id: 3, name: '王五', age: 28, department: '人事部', salary: 6500, joinDate: '2023-03-10', status: '在职' },
          { id: 4, name: '赵六', age: 32, department: '技术部', salary: 9000, joinDate: '2021-11-05', status: '在职' },
          { id: 5, name: '钱七', age: 27, department: '财务部', salary: 7000, joinDate: '2023-08-12', status: '在职' }
        ])

        const selectedEmployees = ref([])
        const currentTheme = ref('light')
        const eventLog = ref([])
        const tableContainer = ref(null)
        
        // 表格配置
        const tableConfig = reactive({
          pagination: {
            enabled: true,
            pageSize: 10
          },
          selection: {
            enabled: true,
            multiple: true,
            checkboxColumn: true
          },
          sorting: {
            enabled: true
          }
        })

        // 表格实例
        let tableInstance = null

        // 表格列配置
        const columns = [
          { key: 'name', title: '姓名', sortable: true, width: 100 },
          { key: 'age', title: '年龄', sortable: true, width: 80 },
          { key: 'department', title: '部门', sortable: true, width: 120 },
          { key: 'salary', title: '薪资', sortable: true, width: 100, render: (value) => `¥${value}` },
          { key: 'joinDate', title: '入职日期', sortable: true, width: 120 },
          { key: 'status', title: '状态', width: 80 }
        ]

        // 初始化表格
        const initTable = () => {
          if (tableInstance) {
            tableInstance.destroy()
          }

          tableInstance = new Table({
            container: tableContainer.value,
            columns,
            data: employees.value,
            rowKey: 'id',
            ...tableConfig,
            onRowClick: (data) => {
              addEventLog('行点击', `点击了 ${data.row.name}`)
            },
            onSelectionChange: (data) => {
              selectedEmployees.value = data.selectedRows
              addEventLog('选择变更', `选中 ${data.selectedRows.length} 行`)
            },
            onSortChange: (data) => {
              addEventLog('排序变更', `按 ${data.column} ${data.direction} 排序`)
            }
          })

          addEventLog('系统', '表格初始化完成')
        }

        // 添加事件日志
        const addEventLog = (type, message) => {
          const event = {
            id: Date.now(),
            time: new Date().toLocaleTimeString(),
            type: type.toLowerCase(),
            message
          }
          eventLog.value.unshift(event)
          if (eventLog.value.length > 20) {
            eventLog.value = eventLog.value.slice(0, 20)
          }
        }

        // 添加随机员工
        const addRandomEmployee = () => {
          const names = ['新员工A', '新员工B', '新员工C', '新员工D', '新员工E']
          const departments = ['技术部', '市场部', '人事部', '财务部']
          const newEmployee = {
            id: Date.now(),
            name: names[Math.floor(Math.random() * names.length)],
            age: Math.floor(Math.random() * 20) + 25,
            department: departments[Math.floor(Math.random() * departments.length)],
            salary: Math.floor(Math.random() * 5000) + 6000,
            joinDate: new Date().toISOString().split('T')[0],
            status: '在职'
          }
          
          employees.value.push(newEmployee)
          tableInstance.addRow(newEmployee)
          addEventLog('数据操作', `添加员工: ${newEmployee.name}`)
        }

        // 删除选中员工
        const removeSelectedEmployees = () => {
          if (selectedEmployees.value.length === 0) {
            addEventLog('警告', '请先选择要删除的员工')
            return
          }

          const selectedIds = selectedEmployees.value.map(emp => emp.id)
          employees.value = employees.value.filter(emp => !selectedIds.includes(emp.id))
          
          selectedIds.forEach(id => {
            tableInstance.removeRow(id)
          })
          
          addEventLog('数据操作', `删除 ${selectedIds.length} 名员工`)
          selectedEmployees.value = []
        }

        // 更新随机员工
        const updateRandomEmployee = () => {
          if (employees.value.length === 0) return
          
          const randomIndex = Math.floor(Math.random() * employees.value.length)
          const employee = employees.value[randomIndex]
          const newSalary = Math.floor(Math.random() * 5000) + 6000
          
          employee.salary = newSalary
          tableInstance.updateRow(employee.id, employee)
          addEventLog('数据操作', `更新员工 ${employee.name} 薪资为 ¥${newSalary}`)
        }

        // 刷新数据
        const refreshData = () => {
          tableInstance.setData([...employees.value])
          addEventLog('数据操作', '刷新表格数据')
        }

        // 更新表格配置
        const updateTableConfig = () => {
          nextTick(() => {
            initTable()
            addEventLog('配置', '表格配置已更新')
          })
        }

        // 切换主题
        const changeTheme = () => {
          if (tableInstance) {
            tableInstance.setTheme({ type: currentTheme.value })
            addEventLog('主题', `切换到 ${currentTheme.value} 主题`)
          }
        }

        // 清除事件日志
        const clearEventLog = () => {
          eventLog.value = []
        }

        // 监听配置变化
        watch(() => tableConfig.pagination.enabled, updateTableConfig)
        watch(() => tableConfig.selection.enabled, updateTableConfig)
        watch(() => tableConfig.sorting.enabled, updateTableConfig)

        // 生命周期
        onMounted(() => {
          nextTick(() => {
            initTable()
          })
        })

        onUnmounted(() => {
          if (tableInstance) {
            tableInstance.destroy()
          }
        })

        return {
          employees,
          selectedEmployees,
          currentTheme,
          eventLog,
          tableConfig,
          tableContainer,
          addRandomEmployee,
          removeSelectedEmployees,
          updateRandomEmployee,
          refreshData,
          updateTableConfig,
          changeTheme,
          clearEventLog
        }
      }
    }).mount('#app')
  </script>

  <style>
    .event-log {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid var(--ldesign-border-color);
      border-radius: var(--ls-border-radius-base);
      padding: 10px;
      background: var(--ldesign-bg-color-component);
    }

    .event-item {
      display: flex;
      align-items: center;
      padding: 3px 0;
      border-bottom: 1px solid var(--ldesign-border-level-1-color);
    }

    .event-item:last-child {
      border-bottom: none;
    }

    .event-time {
      font-size: var(--ls-font-size-xs);
      color: var(--ldesign-text-color-secondary);
      min-width: 80px;
    }

    .event-type {
      margin-left: 10px;
      font-size: var(--ls-font-size-sm);
    }

    .event-type.系统 { color: var(--ldesign-brand-color); }
    .event-type.数据操作 { color: var(--ldesign-success-color); }
    .event-type.配置 { color: var(--ldesign-warning-color); }
    .event-type.主题 { color: var(--ldesign-brand-color); }
    .event-type.警告 { color: var(--ldesign-error-color); }

    .btn-small {
      padding: 5px 10px;
      font-size: var(--ls-font-size-xs);
      margin-top: 10px;
    }
  </style>
</body>
</html>
