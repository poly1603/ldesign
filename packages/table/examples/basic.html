<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>基础表格示例 - LDESIGN Table</title>
  <link rel="stylesheet" href="./src/styles/main.css">
</head>
<body>
  <div class="page-header">
    <h1>🏁 基础表格示例</h1>
    <p>展示基本的表格功能，包括数据渲染、排序和分页</p>
  </div>

  <nav class="nav">
    <div class="container">
      <ul class="nav-links">
        <li><a href="./index.html">首页</a></li>
        <li><a href="./basic.html" class="active">基础表格</a></li>
        <li><a href="./filter.html">筛选搜索</a></li>
        <li><a href="./editable.html">可编辑表格</a></li>
        <li><a href="./drag-sort.html">拖拽排序</a></li>
        <li><a href="./export.html">数据导出</a></li>
        <li><a href="./complete.html">完整功能</a></li>
      </ul>
    </div>
  </nav>

  <div class="container">
    <div class="example-section">
      <h2>基础功能演示</h2>
      <p>这个示例展示了表格的基础功能，包括数据渲染、列排序、分页等核心特性。</p>
      
      <div class="info-panel">
        <h4>功能特性</h4>
        <ul>
          <li>数据渲染和显示</li>
          <li>列排序（点击列标题）</li>
          <li>分页导航</li>
          <li>行选择</li>
          <li>自定义格式化</li>
        </ul>
      </div>

      <div class="controls">
        <button class="btn" onclick="addRandomRow()">添加随机行</button>
        <button class="btn" onclick="removeSelectedRows()">删除选中行</button>
        <button class="btn" onclick="clearTable()">清空表格</button>
        <button class="btn" onclick="resetData()">重置数据</button>
      </div>

      <div class="table-container" id="basicTableContainer"></div>

      <div class="info-panel">
        <h4>当前状态</h4>
        <p>总行数: <span id="totalRows">0</span></p>
        <p>选中行数: <span id="selectedRows">0</span></p>
        <p>当前页: <span id="currentPage">1</span></p>
      </div>

      <div class="log" id="operationLog"></div>
    </div>
  </div>

  <script type="module">
    import { Table } from '@ldesign/table'
    import '@ldesign/table/styles'
    import { sampleEmployees, basicColumns, generateRandomEmployee, createLogger } from './src/utils/data.js'

    let basicTable = null
    const log = createLogger('operationLog')

    // 初始化表格
    function initBasicTable() {
      const container = document.getElementById('basicTableContainer')
      container.innerHTML = ''

      basicTable = new Table({
        container,
        columns: basicColumns,
        data: [...sampleEmployees],
        rowKey: 'id',
        selection: {
          enabled: true,
          multiple: true,
          checkboxColumn: true
        },
        pagination: {
          enabled: true,
          pageSize: 5,
          showSizeChanger: true,
          showQuickJumper: true,
          showTotal: true
        },
        sorting: {
          enabled: true,
          multiple: false
        }
      })

      // 绑定事件
      bindTableEvents()
      updateStatus()
      log('基础表格初始化完成', 'success')
    }

    // 绑定表格事件
    function bindTableEvents() {
      // 选择变化事件
      basicTable.on('selection-change', (data) => {
        log(`选择变更: ${data.selectedKeys.length}行被选中`, 'info')
        updateStatus()
      })

      // 排序变化事件
      basicTable.on('sort-change', (data) => {
        log(`排序变更: ${data.column.title} ${data.direction || '无排序'}`, 'info')
      })

      // 分页变化事件
      basicTable.on('page-change', (data) => {
        log(`分页变更: 第${data.current}页，每页${data.pageSize}条`, 'info')
        updateStatus()
      })

      // 数据变化事件
      basicTable.on('data-change', (data) => {
        log(`数据变更: 当前${data.data.length}行数据`, 'info')
        updateStatus()
      })
    }

    // 添加随机行
    window.addRandomRow = function() {
      const newRow = generateRandomEmployee()
      basicTable.addData(newRow)
      log(`添加新行: ${newRow.name}`, 'success')
    }

    // 删除选中行
    window.removeSelectedRows = function() {
      const selectedKeys = basicTable.getSelectedKeys()
      if (selectedKeys.length === 0) {
        log('请先选择要删除的行', 'warning')
        return
      }
      
      basicTable.removeData(selectedKeys)
      log(`删除了${selectedKeys.length}行数据`, 'success')
    }

    // 清空表格
    window.clearTable = function() {
      basicTable.setData([])
      log('表格已清空', 'warning')
    }

    // 重置数据
    window.resetData = function() {
      basicTable.setData([...sampleEmployees])
      log('数据已重置', 'info')
    }

    // 更新状态
    function updateStatus() {
      const totalRows = basicTable.getData().length
      const selectedRows = basicTable.getSelectedKeys().length
      const pagination = basicTable.getPagination()
      
      document.getElementById('totalRows').textContent = totalRows
      document.getElementById('selectedRows').textContent = selectedRows
      document.getElementById('currentPage').textContent = pagination.current
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', () => {
      initBasicTable()
      log('页面加载完成', 'success')
    })
  </script>
</body>
</html>
