<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Adaptive Form - Basic Usage</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #333;
        margin-bottom: 30px;
      }

      .form-container {
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        min-height: 300px;
      }

      /* è¡¨å•æ ·å¼ */
      .adaptive-form-container {
        padding: 16px;
      }

      .form-item {
        border: 1px solid #d9d9d9;
        border-radius: 4px;
        padding: 12px;
        background: #fafafa;
      }

      .form-item-label {
        font-weight: 500;
        color: #333;
        margin-bottom: 4px;
      }

      .form-item-required {
        color: #ff4d4f;
        margin-left: 4px;
      }

      .form-input,
      .form-textarea,
      .form-select {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #d9d9d9;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
      }

      .form-input:focus,
      .form-textarea:focus,
      .form-select:focus {
        border-color: #1890ff;
        outline: none;
        box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
      }

      .form-item.has-error {
        border-color: #ff4d4f;
      }

      .form-item-error {
        margin-top: 4px;
      }

      .error-message {
        color: #ff4d4f;
        font-size: 12px;
      }

      .controls {
        margin-top: 20px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      button {
        padding: 8px 16px;
        border: 1px solid #d9d9d9;
        border-radius: 4px;
        background: white;
        cursor: pointer;
        font-size: 14px;
      }

      button:hover {
        border-color: #1890ff;
        color: #1890ff;
      }

      button.primary {
        background: #1890ff;
        border-color: #1890ff;
        color: white;
      }

      button.primary:hover {
        background: #40a9ff;
      }

      .info {
        margin-top: 20px;
        padding: 16px;
        background: #f6ffed;
        border: 1px solid #b7eb8f;
        border-radius: 4px;
      }

      .info h3 {
        margin: 0 0 10px 0;
        color: #52c41a;
      }

      .info pre {
        background: white;
        padding: 12px;
        border-radius: 4px;
        overflow-x: auto;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¯ Adaptive Form - æ™ºèƒ½è¡¨å•å¸ƒå±€ç³»ç»Ÿ</h1>

      <div class="form-container" id="form-container"></div>

      <div class="controls">
        <button class="primary" onclick="validateForm()">éªŒè¯è¡¨å•</button>
        <button onclick="resetForm()">é‡ç½®è¡¨å•</button>
        <button onclick="expandForm()">å±•å¼€è¡¨å•</button>
        <button onclick="collapseForm()">æ”¶èµ·è¡¨å•</button>
        <button onclick="toggleReadonly()">åˆ‡æ¢åªè¯»</button>
        <button onclick="showValues()">æ˜¾ç¤ºå€¼</button>
      </div>

      <div class="info">
        <h3>ğŸ“‹ åŠŸèƒ½è¯´æ˜</h3>
        <ul>
          <li><strong>è‡ªé€‚åº”å¸ƒå±€</strong>ï¼šæ ¹æ®å®¹å™¨å®½åº¦è‡ªåŠ¨è®¡ç®—æœ€ä½³åˆ—æ•°</li>
          <li><strong>å“åº”å¼è®¾è®¡</strong>ï¼šæ”¯æŒå¤šç§å±å¹•å°ºå¯¸</li>
          <li><strong>è¡¨å•éªŒè¯</strong>ï¼šå†…ç½®éªŒè¯è§„åˆ™å’Œé”™è¯¯æ˜¾ç¤º</li>
          <li><strong>å±•å¼€æ”¶èµ·</strong>ï¼šæ”¯æŒéšè—å¤šä½™è¡¨å•é¡¹</li>
          <li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šå®Œæ•´çš„è¡¨å•çŠ¶æ€ç®¡ç†</li>
        </ul>

        <h3>ğŸ“Š å½“å‰è¡¨å•å€¼</h3>
        <pre id="form-values">{}</pre>
      </div>
    </div>

    <script type="module">
      // è¿™é‡Œåº”è¯¥å¯¼å…¥å®é™…çš„FormManagerç±»
      // import { FormManager } from '@ldesign/form'

      // æ¨¡æ‹ŸFormManagerç±»ï¼ˆå®é™…ä½¿ç”¨æ—¶åº”è¯¥ä»åŒ…ä¸­å¯¼å…¥ï¼‰
      class MockFormManager {
        constructor(config, container) {
          this.config = config
          this.container = container
          this.values = {}
          this.readonly = false
          this.expanded = false

          this.render()
        }

        render() {
          this.container.innerHTML = `
                    <div class="adaptive-form-container">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                            ${this.config.items.map((item) => this.renderItem(item)).join('')}
                        </div>
                    </div>
                `

          // ç»‘å®šäº‹ä»¶
          this.bindEvents()
        }

        renderItem(item) {
          const value = this.values[item.key] || item.value || ''
          const required = item.required ? '<span class="form-item-required">*</span>' : ''

          return `
                    <div class="form-item" data-key="${item.key}">
                        <label class="form-item-label">
                            ${item.label}${required}
                        </label>
                        <div class="form-item-input-wrapper">
                            ${this.renderInput(item, value)}
                        </div>
                        <div class="form-item-error"></div>
                    </div>
                `
        }

        renderInput(item, value) {
          const readonly = this.readonly ? 'readonly' : ''
          const placeholder = item.placeholder || ''

          switch (item.type) {
            case 'textarea':
              return `<textarea class="form-textarea" data-key="${item.key}" placeholder="${placeholder}" ${readonly}>${value}</textarea>`
            case 'select':
              const options =
                item.options
                  ?.map(
                    (opt) =>
                      `<option value="${opt.value}" ${opt.value === value ? 'selected' : ''}>${opt.label}</option>`,
                  )
                  .join('') || ''
              return `<select class="form-select" data-key="${item.key}" ${readonly}>${options}</select>`
            default:
              return `<input type="${item.type || 'text'}" class="form-input" data-key="${item.key}" value="${value}" placeholder="${placeholder}" ${readonly}>`
          }
        }

        bindEvents() {
          const inputs = this.container.querySelectorAll('input, textarea, select')
          inputs.forEach((input) => {
            input.addEventListener('input', (e) => {
              this.values[e.target.dataset.key] = e.target.value
              this.updateFormValues()
            })
          })
        }

        getValue(key) {
          return key ? this.values[key] : { ...this.values }
        }

        setValue(key, value) {
          if (typeof key === 'object') {
            Object.assign(this.values, key)
          } else {
            this.values[key] = value
          }
          this.render()
          this.updateFormValues()
        }

        validate() {
          const errors = []
          this.config.items.forEach((item) => {
            const value = this.values[item.key]
            const element = this.container.querySelector(`[data-key="${item.key}"]`).parentElement

            if (item.required && (!value || value.trim() === '')) {
              errors.push(`${item.label} æ˜¯å¿…å¡«é¡¹`)
              element.classList.add('has-error')
              element.querySelector('.form-item-error').innerHTML =
                `<div class="error-message">${item.label} æ˜¯å¿…å¡«é¡¹</div>`
            } else {
              element.classList.remove('has-error')
              element.querySelector('.form-item-error').innerHTML = ''
            }
          })

          return { valid: errors.length === 0, errors }
        }

        reset() {
          this.values = {}
          this.render()
          this.updateFormValues()
        }

        expand() {
          this.expanded = true
          // ç®€åŒ–å®ç°
          console.log('è¡¨å•å·²å±•å¼€')
        }

        collapse() {
          this.expanded = false
          // ç®€åŒ–å®ç°
          console.log('è¡¨å•å·²æ”¶èµ·')
        }

        setReadonly(readonly) {
          this.readonly = readonly
          this.render()
        }

        updateFormValues() {
          document.getElementById('form-values').textContent = JSON.stringify(this.values, null, 2)
        }
      }

      // è¡¨å•é…ç½®
      const formConfig = {
        items: [
          {
            key: 'name',
            label: 'å§“å',
            type: 'input',
            required: true,
            placeholder: 'è¯·è¾“å…¥å§“å',
          },
          {
            key: 'email',
            label: 'é‚®ç®±',
            type: 'email',
            required: true,
            placeholder: 'è¯·è¾“å…¥é‚®ç®±åœ°å€',
          },
          {
            key: 'phone',
            label: 'ç”µè¯',
            type: 'tel',
            placeholder: 'è¯·è¾“å…¥ç”µè¯å·ç ',
          },
          {
            key: 'company',
            label: 'å…¬å¸',
            type: 'input',
            placeholder: 'è¯·è¾“å…¥å…¬å¸åç§°',
          },
          {
            key: 'position',
            label: 'èŒä½',
            type: 'input',
            placeholder: 'è¯·è¾“å…¥èŒä½',
          },
          {
            key: 'city',
            label: 'åŸå¸‚',
            type: 'select',
            options: [
              { label: 'è¯·é€‰æ‹©åŸå¸‚', value: '' },
              { label: 'åŒ—äº¬', value: 'beijing' },
              { label: 'ä¸Šæµ·', value: 'shanghai' },
              { label: 'å¹¿å·', value: 'guangzhou' },
              { label: 'æ·±åœ³', value: 'shenzhen' },
            ],
          },
          {
            key: 'experience',
            label: 'å·¥ä½œç»éªŒ',
            type: 'select',
            options: [
              { label: 'è¯·é€‰æ‹©ç»éªŒ', value: '' },
              { label: '1å¹´ä»¥ä¸‹', value: '0-1' },
              { label: '1-3å¹´', value: '1-3' },
              { label: '3-5å¹´', value: '3-5' },
              { label: '5å¹´ä»¥ä¸Š', value: '5+' },
            ],
          },
          {
            key: 'description',
            label: 'ä¸ªäººæè¿°',
            type: 'textarea',
            placeholder: 'è¯·ç®€å•ä»‹ç»ä¸€ä¸‹è‡ªå·±...',
          },
        ],
        layout: {
          defaultRows: 2,
          minColumns: 1,
          maxColumns: 4,
          columnWidth: 250,
          gap: {
            horizontal: 16,
            vertical: 16,
          },
        },
        display: {
          labelPosition: 'top',
          showExpandButton: true,
          expandMode: 'inline',
        },
        validation: {
          validateOnChange: true,
        },
        behavior: {
          readonly: false,
        },
      }

      // åˆ›å»ºè¡¨å•å®ä¾‹
      const container = document.getElementById('form-container')
      const formManager = new MockFormManager(formConfig, container)

      // å…¨å±€å‡½æ•°
      window.validateForm = () => {
        const result = formManager.validate()
        alert(result.valid ? 'è¡¨å•éªŒè¯é€šè¿‡ï¼' : `éªŒè¯å¤±è´¥ï¼š\n${result.errors.join('\n')}`)
      }

      window.resetForm = () => {
        formManager.reset()
      }

      window.expandForm = () => {
        formManager.expand()
      }

      window.collapseForm = () => {
        formManager.collapse()
      }

      window.toggleReadonly = () => {
        formManager.setReadonly(!formManager.readonly)
      }

      window.showValues = () => {
        const values = formManager.getValue()
        alert('å½“å‰è¡¨å•å€¼ï¼š\n' + JSON.stringify(values, null, 2))
      }

      // åˆå§‹åŒ–æ˜¾ç¤º
      formManager.updateFormValues()
    </script>
  </body>
</html>
