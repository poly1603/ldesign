<!--
æ¡ä»¶æ¸²æŸ“æ¼”ç¤º - å±•ç¤ºå­—æ®µè”åŠ¨å’Œæ¡ä»¶æ˜¾ç¤º
-->

<template>
  <div class="conditional-demo">
    <div class="demo-header">
      <h2>ğŸ”„ æ¡ä»¶æ¸²æŸ“æ¼”ç¤º</h2>
      <p>LemonForm æ”¯æŒå¼ºå¤§çš„æ¡ä»¶æ¸²æŸ“åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®å…¶ä»–å­—æ®µçš„å€¼åŠ¨æ€æ˜¾ç¤ºæˆ–éšè—å­—æ®µã€‚</p>
    </div>

    <div class="demo-content">
      <div class="form-section">
        <h3>ğŸ¯ åŸºç¡€æ¡ä»¶æ¸²æŸ“</h3>
        <p>æ ¹æ®ç”¨æˆ·ç±»å‹æ˜¾ç¤ºä¸åŒçš„å­—æ®µ</p>
        
        <div class="conditional-form">
          <FormField
            :field="{
              type: 'radio',
              name: 'userType',
              label: 'ç”¨æˆ·ç±»å‹',
              props: {
                options: [
                  { label: 'ä¸ªäººç”¨æˆ·', value: 'personal' },
                  { label: 'ä¼ä¸šç”¨æˆ·', value: 'business' },
                  { label: 'å­¦ç”Ÿç”¨æˆ·', value: 'student' }
                ]
              }
            }"
            :value="formData.userType"
            @update:value="formData.userType = $event"
          />

          <!-- ä¸ªäººç”¨æˆ·å­—æ®µ -->
          <template v-if="formData.userType === 'personal'">
            <FormField
              :field="{
                type: 'input',
                name: 'realName',
                label: 'çœŸå®å§“å',
                placeholder: 'è¯·è¾“å…¥çœŸå®å§“å',
                required: true
              }"
              :value="formData.realName"
              @update:value="formData.realName = $event"
            />
            
            <FormField
              :field="{
                type: 'input',
                name: 'idCard',
                label: 'èº«ä»½è¯å·',
                placeholder: 'è¯·è¾“å…¥èº«ä»½è¯å·',
                required: true
              }"
              :value="formData.idCard"
              @update:value="formData.idCard = $event"
            />
          </template>

          <!-- ä¼ä¸šç”¨æˆ·å­—æ®µ -->
          <template v-if="formData.userType === 'business'">
            <FormField
              :field="{
                type: 'input',
                name: 'companyName',
                label: 'å…¬å¸åç§°',
                placeholder: 'è¯·è¾“å…¥å…¬å¸åç§°',
                required: true
              }"
              :value="formData.companyName"
              @update:value="formData.companyName = $event"
            />
            
            <FormField
              :field="{
                type: 'input',
                name: 'businessLicense',
                label: 'è¥ä¸šæ‰§ç…§å·',
                placeholder: 'è¯·è¾“å…¥è¥ä¸šæ‰§ç…§å·',
                required: true
              }"
              :value="formData.businessLicense"
              @update:value="formData.businessLicense = $event"
            />
            
            <FormField
              :field="{
                type: 'input',
                name: 'contactPerson',
                label: 'è”ç³»äºº',
                placeholder: 'è¯·è¾“å…¥è”ç³»äººå§“å',
                required: true
              }"
              :value="formData.contactPerson"
              @update:value="formData.contactPerson = $event"
            />
          </template>

          <!-- å­¦ç”Ÿç”¨æˆ·å­—æ®µ -->
          <template v-if="formData.userType === 'student'">
            <FormField
              :field="{
                type: 'input',
                name: 'studentName',
                label: 'å­¦ç”Ÿå§“å',
                placeholder: 'è¯·è¾“å…¥å­¦ç”Ÿå§“å',
                required: true
              }"
              :value="formData.studentName"
              @update:value="formData.studentName = $event"
            />
            
            <FormField
              :field="{
                type: 'input',
                name: 'school',
                label: 'å­¦æ ¡åç§°',
                placeholder: 'è¯·è¾“å…¥å­¦æ ¡åç§°',
                required: true
              }"
              :value="formData.school"
              @update:value="formData.school = $event"
            />
            
            <FormField
              :field="{
                type: 'input',
                name: 'studentId',
                label: 'å­¦å·',
                placeholder: 'è¯·è¾“å…¥å­¦å·',
                required: true
              }"
              :value="formData.studentId"
              @update:value="formData.studentId = $event"
            />
          </template>
        </div>
      </div>

      <!-- å¤æ‚æ¡ä»¶æ¼”ç¤º -->
      <div class="form-section">
        <h3>ğŸ›ï¸ å¤æ‚æ¡ä»¶æ¼”ç¤º</h3>
        <p>å¤šçº§è”åŠ¨å’Œå¤æ‚æ¡ä»¶åˆ¤æ–­</p>
        
        <div class="conditional-form">
          <FormField
            :field="{
              type: 'switch',
              name: 'hasAddress',
              label: 'éœ€è¦é‚®å¯„åœ°å€'
            }"
            :value="formData.hasAddress"
            @update:value="formData.hasAddress = $event"
          />

          <template v-if="formData.hasAddress">
            <FormField
              :field="{
                type: 'select',
                name: 'country',
                label: 'å›½å®¶/åœ°åŒº',
                placeholder: 'è¯·é€‰æ‹©å›½å®¶',
                props: {
                  options: [
                    { label: 'ä¸­å›½', value: 'china' },
                    { label: 'ç¾å›½', value: 'usa' },
                    { label: 'å…¶ä»–', value: 'other' }
                  ]
                }
              }"
              :value="formData.country"
              @update:value="formData.country = $event"
            />

            <!-- ä¸­å›½åœ°å€ -->
            <template v-if="formData.country === 'china'">
              <FormField
                :field="{
                  type: 'select',
                  name: 'province',
                  label: 'çœä»½',
                  placeholder: 'è¯·é€‰æ‹©çœä»½',
                  props: {
                    options: [
                      { label: 'åŒ—äº¬å¸‚', value: 'beijing' },
                      { label: 'ä¸Šæµ·å¸‚', value: 'shanghai' },
                      { label: 'å¹¿ä¸œçœ', value: 'guangdong' },
                      { label: 'æµ™æ±Ÿçœ', value: 'zhejiang' }
                    ]
                  }
                }"
                :value="formData.province"
                @update:value="formData.province = $event"
              />

              <FormField
                :field="{
                  type: 'select',
                  name: 'city',
                  label: 'åŸå¸‚',
                  placeholder: 'è¯·é€‰æ‹©åŸå¸‚',
                  props: {
                    options: getCityOptions(formData.province)
                  }
                }"
                :value="formData.city"
                @update:value="formData.city = $event"
              />
            </template>

            <!-- ç¾å›½åœ°å€ -->
            <template v-if="formData.country === 'usa'">
              <FormField
                :field="{
                  type: 'input',
                  name: 'state',
                  label: 'å·',
                  placeholder: 'è¯·è¾“å…¥å·å'
                }"
                :value="formData.state"
                @update:value="formData.state = $event"
              />

              <FormField
                :field="{
                  type: 'input',
                  name: 'zipCode',
                  label: 'é‚®ç¼–',
                  placeholder: 'è¯·è¾“å…¥é‚®ç¼–'
                }"
                :value="formData.zipCode"
                @update:value="formData.zipCode = $event"
              />
            </template>

            <!-- å…¶ä»–å›½å®¶åœ°å€ -->
            <template v-if="formData.country === 'other'">
              <FormField
                :field="{
                  type: 'input',
                  name: 'countryName',
                  label: 'å›½å®¶åç§°',
                  placeholder: 'è¯·è¾“å…¥å›½å®¶åç§°'
                }"
                :value="formData.countryName"
                @update:value="formData.countryName = $event"
              />
            </template>

            <!-- é€šç”¨åœ°å€å­—æ®µ -->
            <FormField
              :field="{
                type: 'textarea',
                name: 'detailAddress',
                label: 'è¯¦ç»†åœ°å€',
                placeholder: 'è¯·è¾“å…¥è¯¦ç»†åœ°å€',
                props: { rows: 3 }
              }"
              :value="formData.detailAddress"
              @update:value="formData.detailAddress = $event"
            />
          </template>
        </div>
      </div>
    </div>

    <!-- è¡¨å•æ•°æ®å±•ç¤º -->
    <div class="data-display">
      <h3>ğŸ“Š å½“å‰è¡¨å•æ•°æ®</h3>
      <pre>{{ JSON.stringify(formData, null, 2) }}</pre>
    </div>
  </div>
</template>

<script setup lang="ts">
import { reactive, watch } from 'vue'
import FormField from '../components/FormField.vue'

// è¡¨å•æ•°æ®
const formData = reactive({
  userType: '',
  realName: '',
  idCard: '',
  companyName: '',
  businessLicense: '',
  contactPerson: '',
  studentName: '',
  school: '',
  studentId: '',
  hasAddress: false,
  country: '',
  province: '',
  city: '',
  state: '',
  zipCode: '',
  countryName: '',
  detailAddress: ''
})

// åŸå¸‚é€‰é¡¹æ˜ å°„
const cityOptions = {
  beijing: [
    { label: 'ä¸œåŸåŒº', value: 'dongcheng' },
    { label: 'è¥¿åŸåŒº', value: 'xicheng' },
    { label: 'æœé˜³åŒº', value: 'chaoyang' },
    { label: 'æµ·æ·€åŒº', value: 'haidian' }
  ],
  shanghai: [
    { label: 'é»„æµ¦åŒº', value: 'huangpu' },
    { label: 'å¾æ±‡åŒº', value: 'xuhui' },
    { label: 'é•¿å®åŒº', value: 'changning' },
    { label: 'é™å®‰åŒº', value: 'jingan' }
  ],
  guangdong: [
    { label: 'å¹¿å·å¸‚', value: 'guangzhou' },
    { label: 'æ·±åœ³å¸‚', value: 'shenzhen' },
    { label: 'ç æµ·å¸‚', value: 'zhuhai' },
    { label: 'ä½›å±±å¸‚', value: 'foshan' }
  ],
  zhejiang: [
    { label: 'æ­å·å¸‚', value: 'hangzhou' },
    { label: 'å®æ³¢å¸‚', value: 'ningbo' },
    { label: 'æ¸©å·å¸‚', value: 'wenzhou' },
    { label: 'å˜‰å…´å¸‚', value: 'jiaxing' }
  ]
}

// è·å–åŸå¸‚é€‰é¡¹
const getCityOptions = (province: string) => {
  return cityOptions[province as keyof typeof cityOptions] || []
}

// ç›‘å¬çœä»½å˜åŒ–ï¼Œæ¸…ç©ºåŸå¸‚é€‰æ‹©
watch(() => formData.province, () => {
  formData.city = ''
})

// ç›‘å¬å›½å®¶å˜åŒ–ï¼Œæ¸…ç©ºç›¸å…³å­—æ®µ
watch(() => formData.country, () => {
  formData.province = ''
  formData.city = ''
  formData.state = ''
  formData.zipCode = ''
  formData.countryName = ''
})

// ç›‘å¬ç”¨æˆ·ç±»å‹å˜åŒ–ï¼Œæ¸…ç©ºç›¸å…³å­—æ®µ
watch(() => formData.userType, () => {
  formData.realName = ''
  formData.idCard = ''
  formData.companyName = ''
  formData.businessLicense = ''
  formData.contactPerson = ''
  formData.studentName = ''
  formData.school = ''
  formData.studentId = ''
})
</script>

<style scoped>
.conditional-demo {
  max-width: 1200px;
  margin: 0 auto;
}

.demo-header {
  text-align: center;
  margin-bottom: 40px;
}

.demo-header h2 {
  color: #333;
  margin-bottom: 10px;
  font-size: 2rem;
}

.demo-header p {
  color: #666;
  font-size: 1.1rem;
  line-height: 1.6;
  max-width: 800px;
  margin: 0 auto;
}

.demo-content {
  display: flex;
  flex-direction: column;
  gap: 30px;
  margin-bottom: 30px;
}

.form-section {
  background: white;
  padding: 25px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.form-section h3 {
  margin: 0 0 10px 0;
  color: #333;
  font-size: 1.3rem;
}

.form-section p {
  margin: 0 0 20px 0;
  color: #666;
  font-size: 0.95rem;
}

.conditional-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
  max-width: 600px;
}

.data-display {
  background: white;
  padding: 25px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.data-display h3 {
  margin: 0 0 15px 0;
  color: #333;
  font-size: 1.3rem;
}

.data-display pre {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 4px;
  padding: 15px;
  font-size: 12px;
  overflow: auto;
  max-height: 400px;
  margin: 0;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
}

@media (max-width: 768px) {
  .demo-header h2 {
    font-size: 1.5rem;
  }
  
  .demo-header p {
    font-size: 1rem;
  }
  
  .form-section {
    padding: 20px;
  }
  
  .conditional-form {
    max-width: 100%;
  }
}
</style>
