<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LDesign Form - 简单测试</title>
  <link rel="stylesheet" href="css/styles.css">
  <style>
    .demo-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .config-panel {
      background: var(--ldesign-bg-color-container);
      border: 1px solid var(--ldesign-border-color);
      border-radius: var(--ls-border-radius-base);
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .config-group {
      margin-bottom: 15px;
    }
    
    .config-label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .config-input, .config-select {
      width: 200px;
      padding: 8px 12px;
      border: 1px solid var(--ldesign-border-color);
      border-radius: var(--ls-border-radius-sm);
    }
    
    .config-button {
      padding: 10px 20px;
      background: var(--ldesign-brand-color);
      color: white;
      border: none;
      border-radius: var(--ls-border-radius-sm);
      cursor: pointer;
      margin-right: 10px;
    }
    
    .render-area {
      background: var(--ldesign-bg-color-container);
      border: 1px solid var(--ldesign-border-color);
      border-radius: var(--ls-border-radius-base);
      padding: 20px;
    }
    
    .status-info {
      background: var(--ldesign-bg-color-page);
      padding: 15px;
      border-radius: var(--ls-border-radius-sm);
      margin-bottom: 20px;
      font-size: 14px;
    }
    
    /* 简单的查询表单样式 */
    .query-form-grid {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(4, 1fr);
    }
    
    .form-field {
      display: flex;
      flex-direction: column;
    }
    
    .form-label {
      margin-bottom: 4px;
      font-weight: 500;
      color: var(--ldesign-text-color-primary);
    }
    
    .form-input, .form-select {
      padding: 8px 12px;
      border: 1px solid var(--ldesign-border-color);
      border-radius: var(--ls-border-radius-sm);
      font-size: 14px;
    }
    
    .query-form-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: var(--ls-border-radius-sm);
      font-size: 14px;
      cursor: pointer;
    }
    
    .btn-primary {
      background: var(--ldesign-brand-color);
      color: white;
    }
    
    .btn-secondary {
      background: var(--ldesign-gray-color-2);
      color: var(--ldesign-text-color-primary);
    }
    
    .btn-text {
      background: transparent;
      color: var(--ldesign-brand-color);
    }
  </style>
</head>
<body>
  <div class="demo-container">
    <h1>LDesign Form - 内联按钮布局测试</h1>
    
    <!-- 配置面板 -->
    <div class="config-panel">
      <h3>配置面板</h3>
      
      <div class="config-group">
        <label class="config-label">字段数量</label>
        <input type="range" id="fieldCount" class="config-input" min="1" max="10" value="3">
        <span id="fieldCountValue">3</span> 个字段
      </div>
      
      <div class="config-group">
        <label class="config-label">列数</label>
        <select id="colCount" class="config-select">
          <option value="3">3列</option>
          <option value="4" selected>4列</option>
          <option value="5">5列</option>
        </select>
      </div>
      
      <div class="config-group">
        <label class="config-label">按钮位置</label>
        <select id="actionPosition" class="config-select">
          <option value="auto">自动</option>
          <option value="inline" selected>内联</option>
          <option value="block">独占行</option>
        </select>
      </div>
      
      <div class="config-group">
        <label class="config-label">
          <input type="checkbox" id="collapsed" checked>
          收起状态
        </label>
      </div>
      
      <button id="updateForm" class="config-button">更新表单</button>
      <button id="resetConfig" class="config-button">重置配置</button>
    </div>
    
    <!-- 渲染区域 -->
    <div class="render-area">
      <h3>查询表单演示</h3>
      
      <div class="status-info" id="statusInfo">
        当前配置：3个字段，4列布局，收起状态，内联按钮
      </div>
      
      <div id="queryFormContainer">
        <!-- 查询表单将在这里动态渲染 -->
        <form class="query-form">
          <div class="query-form-grid" id="formGrid">
            <!-- 字段将在这里动态生成 -->
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // 简单的演示数据
    const fieldTemplates = [
      { name: 'name', label: '姓名', type: 'text', placeholder: '请输入姓名' },
      { name: 'email', label: '邮箱', type: 'email', placeholder: '请输入邮箱' },
      { name: 'phone', label: '手机号', type: 'text', placeholder: '请输入手机号' },
      { name: 'department', label: '部门', type: 'select', options: ['技术部', '产品部', '设计部'] },
      { name: 'position', label: '职位', type: 'select', options: ['前端工程师', '后端工程师', '产品经理'] },
      { name: 'status', label: '状态', type: 'select', options: ['在职', '离职', '试用期'] },
      { name: 'startDate', label: '入职日期', type: 'date' },
      { name: 'endDate', label: '离职日期', type: 'date' },
      { name: 'salary', label: '薪资', type: 'text', placeholder: '请输入薪资' },
      { name: 'experience', label: '经验', type: 'select', options: ['1年以下', '1-3年', '3-5年', '5年以上'] }
    ];

    // 应用状态
    let currentConfig = {
      fieldCount: 3,
      colCount: 4,
      actionPosition: 'inline',
      collapsed: true
    };

    // 初始化
    function init() {
      bindEvents();
      updateForm();
    }

    // 绑定事件
    function bindEvents() {
      document.getElementById('fieldCount').addEventListener('input', (e) => {
        document.getElementById('fieldCountValue').textContent = e.target.value;
      });

      document.getElementById('updateForm').addEventListener('click', updateForm);
      document.getElementById('resetConfig').addEventListener('click', resetConfig);
    }

    // 更新表单
    function updateForm() {
      // 获取当前配置
      currentConfig.fieldCount = parseInt(document.getElementById('fieldCount').value);
      currentConfig.colCount = parseInt(document.getElementById('colCount').value);
      currentConfig.actionPosition = document.getElementById('actionPosition').value;
      currentConfig.collapsed = document.getElementById('collapsed').checked;

      // 更新状态信息
      updateStatusInfo();

      // 渲染表单
      renderForm();
    }

    // 重置配置
    function resetConfig() {
      document.getElementById('fieldCount').value = '3';
      document.getElementById('fieldCountValue').textContent = '3';
      document.getElementById('colCount').value = '4';
      document.getElementById('actionPosition').value = 'inline';
      document.getElementById('collapsed').checked = true;
      updateForm();
    }

    // 更新状态信息
    function updateStatusInfo() {
      const { fieldCount, colCount, actionPosition, collapsed } = currentConfig;
      const statusText = `当前配置：${fieldCount}个字段，${colCount}列布局，${collapsed ? '收起' : '展开'}状态，${actionPosition}按钮`;
      document.getElementById('statusInfo').textContent = statusText;
    }

    // 渲染表单
    function renderForm() {
      const { fieldCount, colCount, actionPosition, collapsed } = currentConfig;
      const formGrid = document.getElementById('formGrid');
      
      // 清空现有内容
      formGrid.innerHTML = '';
      
      // 设置网格列数
      formGrid.style.gridTemplateColumns = `repeat(${colCount}, 1fr)`;
      
      // 计算显示的字段数量
      let visibleFieldCount = fieldCount;
      if (collapsed && actionPosition === 'inline') {
        // 收起状态下，如果按钮是内联的，为按钮组预留最后一列
        visibleFieldCount = Math.min(fieldCount, colCount - 1);
      }
      
      // 渲染字段
      for (let i = 0; i < visibleFieldCount; i++) {
        const field = fieldTemplates[i];
        const fieldElement = createFieldElement(field);
        formGrid.appendChild(fieldElement);
      }
      
      // 渲染按钮组
      const actionsElement = createActionsElement();
      
      // 计算按钮组位置
      if (actionPosition === 'inline') {
        if (collapsed) {
          // 收起状态：按钮组固定占用最后一列
          actionsElement.style.gridColumn = `${colCount} / -1`;
        } else {
          // 展开状态：根据字段数量计算位置
          const lastRowFieldCount = fieldCount % colCount;
          if (lastRowFieldCount === 0) {
            // 最后一行已满，按钮组独占新行
            actionsElement.style.gridColumn = '1 / -1';
          } else {
            // 按钮组占用最后一行的剩余列数
            const startCol = lastRowFieldCount + 1;
            actionsElement.style.gridColumn = `${startCol} / -1`;
          }
        }
      } else {
        // 独占行模式
        actionsElement.style.gridColumn = '1 / -1';
      }
      
      formGrid.appendChild(actionsElement);
    }

    // 创建字段元素
    function createFieldElement(field) {
      const fieldDiv = document.createElement('div');
      fieldDiv.className = 'form-field';
      
      const label = document.createElement('label');
      label.className = 'form-label';
      label.textContent = field.label;
      
      let input;
      if (field.type === 'select') {
        input = document.createElement('select');
        input.className = 'form-select';
        
        const defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.textContent = `请选择${field.label}`;
        input.appendChild(defaultOption);
        
        field.options.forEach(option => {
          const optionElement = document.createElement('option');
          optionElement.value = option;
          optionElement.textContent = option;
          input.appendChild(optionElement);
        });
      } else {
        input = document.createElement('input');
        input.className = 'form-input';
        input.type = field.type;
        input.placeholder = field.placeholder || '';
      }
      
      input.name = field.name;
      
      fieldDiv.appendChild(label);
      fieldDiv.appendChild(input);
      
      return fieldDiv;
    }

    // 创建按钮组元素
    function createActionsElement() {
      const actionsDiv = document.createElement('div');
      actionsDiv.className = 'query-form-actions';
      
      const queryBtn = document.createElement('button');
      queryBtn.type = 'submit';
      queryBtn.className = 'btn btn-primary';
      queryBtn.textContent = '查询';
      
      const resetBtn = document.createElement('button');
      resetBtn.type = 'button';
      resetBtn.className = 'btn btn-secondary';
      resetBtn.textContent = '重置';
      
      const toggleBtn = document.createElement('button');
      toggleBtn.type = 'button';
      toggleBtn.className = 'btn btn-text';
      toggleBtn.textContent = currentConfig.collapsed ? '展开' : '收起';
      
      actionsDiv.appendChild(queryBtn);
      actionsDiv.appendChild(resetBtn);
      actionsDiv.appendChild(toggleBtn);
      
      return actionsDiv;
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
