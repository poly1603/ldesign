# 国际化

@ldesign/form 提供了完整的国际化支持，让你可以轻松地为不同语言的用户提供本地化的表单体验。

## 基础配置

### 设置语言

```javascript
import { createApp } from 'vue'
import LDesignForm from '@ldesign/form'
import '@ldesign/form/dist/style.css'

// 导入语言包
import zhCN from '@ldesign/form/locale/zh-CN'
import enUS from '@ldesign/form/locale/en-US'

const app = createApp(App)

// 配置默认语言
app.use(LDesignForm, {
  locale: zhCN,
})
```

### 动态切换语言

```vue
<template>
  <div>
    <select v-model="currentLocale" @change="changeLocale">
      <option value="zh-CN">中文</option>
      <option value="en-US">English</option>
      <option value="ja-JP">日本語</option>
    </select>

    <DynamicForm v-model="formData" :options="formOptions" />
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { useI18n } from '@ldesign/form'

// 导入语言包
import zhCN from '@ldesign/form/locale/zh-CN'
import enUS from '@ldesign/form/locale/en-US'
import jaJP from '@ldesign/form/locale/ja-JP'

const locales = {
  'zh-CN': zhCN,
  'en-US': enUS,
  'ja-JP': jaJP,
}

const currentLocale = ref('zh-CN')
const { setLocale, t } = useI18n()

const changeLocale = () => {
  setLocale(locales[currentLocale.value])
}

const formData = ref({})

const formOptions = {
  fields: [
    {
      name: 'username',
      label: t('form.username'),
      component: 'FormInput',
      required: true,
      placeholder: t('form.usernamePlaceholder'),
    },
    {
      name: 'email',
      label: t('form.email'),
      component: 'FormInput',
      props: { type: 'email' },
      required: true,
      placeholder: t('form.emailPlaceholder'),
    },
  ],
  submitButton: {
    text: t('form.submit'),
  },
}
</script>
```

## 内置语言包

### 支持的语言

| 语言     | 代码    | 包名                         |
| -------- | ------- | ---------------------------- |
| 简体中文 | `zh-CN` | `@ldesign/form/locale/zh-CN` |
| 繁体中文 | `zh-TW` | `@ldesign/form/locale/zh-TW` |
| 英语     | `en-US` | `@ldesign/form/locale/en-US` |
| 日语     | `ja-JP` | `@ldesign/form/locale/ja-JP` |
| 韩语     | `ko-KR` | `@ldesign/form/locale/ko-KR` |
| 法语     | `fr-FR` | `@ldesign/form/locale/fr-FR` |
| 德语     | `de-DE` | `@ldesign/form/locale/de-DE` |
| 西班牙语 | `es-ES` | `@ldesign/form/locale/es-ES` |

### 语言包结构

```javascript
// zh-CN.js
export default {
  form: {
    // 通用文本
    submit: '提交',
    reset: '重置',
    cancel: '取消',
    confirm: '确认',
    clear: '清空',

    // 字段标签
    username: '用户名',
    password: '密码',
    email: '邮箱',
    phone: '电话',
    name: '姓名',

    // 占位符
    usernamePlaceholder: '请输入用户名',
    passwordPlaceholder: '请输入密码',
    emailPlaceholder: '请输入邮箱地址',
    phonePlaceholder: '请输入电话号码',

    // 验证消息
    validation: {
      required: '此字段为必填项',
      email: '请输入有效的邮箱地址',
      phone: '请输入有效的电话号码',
      min: '输入长度不能少于 {min} 个字符',
      max: '输入长度不能超过 {max} 个字符',
      pattern: '输入格式不正确',
    },

    // 组件文本
    select: {
      placeholder: '请选择',
      noData: '暂无数据',
      loading: '加载中...',
    },

    datePicker: {
      placeholder: '请选择日期',
      startPlaceholder: '开始日期',
      endPlaceholder: '结束日期',
    },

    upload: {
      dragText: '点击或拖拽文件到此处上传',
      buttonText: '选择文件',
      removeText: '删除',
      previewText: '预览',
    },
  },
}
```

## 自定义语言包

### 创建自定义语言包

```javascript
// locale/my-custom.js
export default {
  form: {
    submit: 'Submit Form',
    reset: 'Reset Form',
    cancel: 'Cancel',

    // 自定义字段标签
    customField: 'Custom Field',
    specialInput: 'Special Input',

    validation: {
      required: 'This field is required',
      email: 'Please enter a valid email address',
      custom: 'Custom validation message',
    },
  },
}
```

### 扩展现有语言包

```javascript
import zhCN from '@ldesign/form/locale/zh-CN'

// 扩展中文语言包
const customZhCN = {
  ...zhCN,
  form: {
    ...zhCN.form,
    // 添加自定义翻译
    customField: '自定义字段',
    specialInput: '特殊输入',

    validation: {
      ...zhCN.form.validation,
      custom: '自定义验证消息',
    },
  },
}

export default customZhCN
```

## 表单字段国际化

### 字段标签国际化

```javascript
const formOptions = {
  fields: [
    {
      name: 'username',
      label: {
        'zh-CN': '用户名',
        'en-US': 'Username',
        'ja-JP': 'ユーザー名',
      },
      component: 'FormInput',
      placeholder: {
        'zh-CN': '请输入用户名',
        'en-US': 'Please enter username',
        'ja-JP': 'ユーザー名を入力してください',
      },
    },
    {
      name: 'email',
      label: {
        'zh-CN': '邮箱地址',
        'en-US': 'Email Address',
        'ja-JP': 'メールアドレス',
      },
      component: 'FormInput',
      props: { type: 'email' },
    },
  ],
}
```

### 选项国际化

```javascript
const formOptions = {
  fields: [
    {
      name: 'country',
      label: 'form.country',
      component: 'FormSelect',
      props: {
        options: [
          {
            label: {
              'zh-CN': '中国',
              'en-US': 'China',
              'ja-JP': '中国',
            },
            value: 'china',
          },
          {
            label: {
              'zh-CN': '美国',
              'en-US': 'United States',
              'ja-JP': 'アメリカ',
            },
            value: 'usa',
          },
          {
            label: {
              'zh-CN': '日本',
              'en-US': 'Japan',
              'ja-JP': '日本',
            },
            value: 'japan',
          },
        ],
      },
    },
  ],
}
```

## 验证消息国际化

### 自定义验证消息

```javascript
const formOptions = {
  fields: [
    {
      name: 'username',
      label: 'form.username',
      component: 'FormInput',
      rules: [
        {
          required: true,
          message: {
            'zh-CN': '请输入用户名',
            'en-US': 'Please enter username',
            'ja-JP': 'ユーザー名を入力してください',
          },
        },
        {
          min: 3,
          max: 20,
          message: {
            'zh-CN': '用户名长度为3-20个字符',
            'en-US': 'Username length should be 3-20 characters',
            'ja-JP': 'ユーザー名の長さは3-20文字である必要があります',
          },
        },
      ],
    },
  ],
}
```

### 使用翻译函数

```javascript
import { useI18n } from '@ldesign/form'

const { t } = useI18n()

const formOptions = {
  fields: [
    {
      name: 'email',
      label: t('form.email'),
      component: 'FormInput',
      rules: [
        {
          required: true,
          message: t('form.validation.emailRequired'),
        },
        {
          type: 'email',
          message: t('form.validation.emailFormat'),
        },
      ],
    },
  ],
}
```

## 日期和数字格式化

### 日期格式化

```javascript
const formOptions = {
  fields: [
    {
      name: 'birthday',
      label: 'form.birthday',
      component: 'FormDatePicker',
      props: {
        format: {
          'zh-CN': 'YYYY年MM月DD日',
          'en-US': 'MM/DD/YYYY',
          'ja-JP': 'YYYY年MM月DD日',
        },
      },
    },
  ],
}
```

### 数字格式化

```javascript
const formOptions = {
  fields: [
    {
      name: 'price',
      label: 'form.price',
      component: 'FormInput',
      props: {
        type: 'number',
        formatter: (value, locale) => {
          const formatters = {
            'zh-CN': new Intl.NumberFormat('zh-CN', {
              style: 'currency',
              currency: 'CNY',
            }),
            'en-US': new Intl.NumberFormat('en-US', {
              style: 'currency',
              currency: 'USD',
            }),
            'ja-JP': new Intl.NumberFormat('ja-JP', {
              style: 'currency',
              currency: 'JPY',
            }),
          }
          return formatters[locale]?.format(value) || value
        },
      },
    },
  ],
}
```

## RTL 支持

### 启用 RTL

```javascript
import { createApp } from 'vue'
import LDesignForm from '@ldesign/form'
import arEG from '@ldesign/form/locale/ar-EG'

const app = createApp(App)

app.use(LDesignForm, {
  locale: arEG,
  rtl: true, // 启用 RTL 支持
})
```

### RTL 样式

```css
/* RTL 样式会自动应用 */
.ldesign-form[dir='rtl'] {
  direction: rtl;
}

.ldesign-form[dir='rtl'] .form-field {
  text-align: right;
}

.ldesign-form[dir='rtl'] .form-label {
  margin-left: 8px;
  margin-right: 0;
}
```

## 最佳实践

1. **统一管理**: 将所有翻译文本集中管理
2. **懒加载**: 按需加载语言包，减少初始包大小
3. **回退机制**: 提供默认语言作为回退
4. **上下文翻译**: 考虑不同上下文中的翻译差异
5. **测试覆盖**: 确保所有语言版本都经过测试

### 语言包懒加载

```javascript
const loadLocale = async locale => {
  const localeMap = {
    'zh-CN': () => import('@ldesign/form/locale/zh-CN'),
    'en-US': () => import('@ldesign/form/locale/en-US'),
    'ja-JP': () => import('@ldesign/form/locale/ja-JP'),
  }

  if (localeMap[locale]) {
    const module = await localeMap[locale]()
    return module.default
  }

  // 回退到默认语言
  const defaultModule = await import('@ldesign/form/locale/zh-CN')
  return defaultModule.default
}

// 使用
const changeLanguage = async locale => {
  const localeData = await loadLocale(locale)
  setLocale(localeData)
}
```

## 下一步

- [性能优化](/guide/performance) - 优化国际化性能
- [自定义组件](/guide/custom-components) - 创建支持国际化的自定义组件
- [布局系统](/guide/layout) - 了解布局配置
