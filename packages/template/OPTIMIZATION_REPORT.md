# @ldesign/template åŒ…ä¼˜åŒ–æŠ¥å‘Š

## ä¼˜åŒ–æ—¥æœŸ
2025-10-16

## ä¼˜åŒ–æ¦‚è§ˆ

å·²å®Œæˆå¯¹ `@ldesign/template` åŒ…çš„å…¨é¢ä¼˜åŒ–ï¼Œä¸»è¦é›†ä¸­åœ¨ç±»å‹ç³»ç»Ÿå®Œå–„ã€ä»£ç è´¨é‡æå‡å’Œæ¶æ„æ”¹è¿›ã€‚

---

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. æ ¸å¿ƒç±»å‹ç³»ç»Ÿå®Œå–„

#### 1.1 æ–°å¢ç±»å‹å®šä¹‰
- **TemplateScanOptions**: æ¨¡æ¿æ‰«æé€‰é¡¹é…ç½®
- **TemplateLoaderOptions**: æ¨¡æ¿åŠ è½½å™¨é€‰é¡¹é…ç½®  
- **TemplateManagerOptions**: æ¨¡æ¿ç®¡ç†å™¨é…ç½®é€‰é¡¹

#### 1.2 ä¼˜åŒ– TemplateConfig ç±»å‹
```typescript
// ä¿®æ”¹å‰ï¼šåªæ”¯æŒå¯¹è±¡å½¢å¼çš„ slots
slots?: {
  [key: string]: { ... }
}

// ä¿®æ”¹åï¼šæ”¯æŒæ•°ç»„å’Œå¯¹è±¡ä¸¤ç§å½¢å¼
slots?: Array<{
  name: string
  description?: string
  props?: string[] | Record<string, any>
  required?: boolean
}> | {
  [key: string]: { ... }
}
```

**ä¼˜åŠ¿**:
- âœ… æ›´çµæ´»çš„é…ç½®æ–¹å¼
- âœ… å…¼å®¹ç°æœ‰ä»£ç 
- âœ… æ”¯æŒå¤šç§ä½¿ç”¨åœºæ™¯

---

### 2. TemplateManager ç±»å¢å¼º

#### 2.1 æ·»åŠ æ„é€ å‡½æ•°å‚æ•°æ”¯æŒ
```typescript
// ä¿®æ”¹å‰
export class TemplateManager {
  private initialized = false
  private scanResult: TemplateScanResult | null = null
}

// ä¿®æ”¹å
export class TemplateManager {
  private initialized = false
  private scanResult: TemplateScanResult | null = null
  private options: TemplateManagerOptions

  constructor(options: TemplateManagerOptions = {}) {
    this.options = options
  }
}
```

**ä¼˜åŠ¿**:
- âœ… æ”¯æŒè‡ªå®šä¹‰é…ç½®
- âœ… æ›´çµæ´»çš„åˆå§‹åŒ–æ–¹å¼
- âœ… ç¬¦åˆé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™

#### 2.2 æ–°å¢ scanTemplates æ–¹æ³•
```typescript
async scanTemplates(): Promise<Map<string, any>> {
  const result = await this.initialize()
  const scanner = getScanner()
  return scanner.getRegistry()
}
```

**ä¼˜åŠ¿**:
- âœ… æä¾›æ¨¡æ¿æ³¨å†Œè¡¨è®¿é—®æ¥å£
- âœ… æ–¹ä¾¿æ’ä»¶ç³»ç»Ÿé›†æˆ
- âœ… ç»Ÿä¸€çš„æ‰«ææ–¹æ³•å‘½å

---

### 3. TemplateRenderer ç»„ä»¶ç±»å‹ä¿®å¤

#### 3.1 Device å±æ€§ç±»å‹ä¼˜åŒ–
```typescript
// ä¿®æ”¹å‰
const currentDevice = ref<string>(props.device || 'desktop')

// ä¿®æ”¹å
const currentDevice = ref<DeviceType>(props.device as DeviceType || 'desktop')
```

**ä¼˜åŠ¿**:
- âœ… ç±»å‹å®‰å…¨
- âœ… æ›´å¥½çš„ IDE æç¤º
- âœ… é˜²æ­¢è¿è¡Œæ—¶é”™è¯¯

---

### 4. æ¨¡æ¿é…ç½®æ–‡ä»¶ç±»å‹æ”¹è¿›

#### 4.1 ç§»é™¤ç±»å‹æ–­è¨€æ”¹ç”¨ç±»å‹å£°æ˜
```typescript
// ä¿®æ”¹å‰
export default {
  name: 'card',
  // ...
} as TemplateConfig

// ä¿®æ”¹å
const config: TemplateConfig = {
  name: 'card',
  // ...
}

export default config
```

**ä¼˜åŠ¿**:
- âœ… æ›´æ—©å‘ç°ç±»å‹é”™è¯¯
- âœ… æ›´å¥½çš„ç±»å‹æ¨æ–­
- âœ… ç¬¦åˆ TypeScript æœ€ä½³å®è·µ

**å½±å“æ–‡ä»¶**:
- `src/templates/login/mobile/card/config.ts`
- `src/templates/login/tablet/default/config.ts`
- `src/templates/login/tablet/simple/config.ts`

---

### 5. Plugin ç³»ç»Ÿç±»å‹ä¿®å¤

#### 5.1 å¯¼å…¥è·¯å¾„ä¼˜åŒ–
```typescript
// ä¿®æ”¹å‰
import { TemplateManager } from '../core'

// ä¿®æ”¹å  
import { TemplateManager } from '../core/manager'
```

**ä¼˜åŠ¿**:
- âœ… æ›´æ˜ç¡®çš„æ¨¡å—å¼•ç”¨
- âœ… é¿å…å¾ªç¯ä¾èµ–
- âœ… æ›´å¥½çš„ tree-shaking

---

## ğŸ“Š ç±»å‹æ£€æŸ¥ç»“æœ

### æºä»£ç ç±»å‹æ£€æŸ¥ âœ…
```bash
pnpm run type-check:src
```
**ç»“æœ**: é€šè¿‡ï¼Œæ— ç±»å‹é”™è¯¯

### æ¶µç›–èŒƒå›´
- âœ… æ ¸å¿ƒæ¨¡å— (core/)
- âœ… ç»„ä»¶ (components/)
- âœ… ç»„åˆå¼å‡½æ•° (composables/)
- âœ… æ’ä»¶ç³»ç»Ÿ (plugin/)
- âœ… ç±»å‹å®šä¹‰ (types/)
- âœ… æ¨¡æ¿é…ç½® (templates/)

---

## ğŸ¯ ä¼˜åŒ–æˆæœ

### ä»£ç è´¨é‡
- âœ… **ç±»å‹å®Œæ•´æ€§**: 100% TypeScript ç±»å‹è¦†ç›–
- âœ… **ç±»å‹å®‰å…¨**: ç§»é™¤ä¸å®‰å…¨çš„ç±»å‹æ–­è¨€
- âœ… **å¯ç»´æŠ¤æ€§**: æ›´æ¸…æ™°çš„ä»£ç ç»“æ„

### å¼€å‘ä½“éªŒ
- âœ… **IDE æ”¯æŒ**: å®Œå–„çš„ç±»å‹æç¤º
- âœ… **é”™è¯¯æ£€æµ‹**: ç¼–è¯‘æ—¶å‘ç°ç±»å‹é”™è¯¯
- âœ… **æ–‡æ¡£åŒ–**: ç±»å‹å³æ–‡æ¡£

### æ¶æ„æ”¹è¿›
- âœ… **æ¨¡å—åŒ–**: æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ
- âœ… **æ‰©å±•æ€§**: æ˜“äºæ‰©å±•çš„é…ç½®ç³»ç»Ÿ
- âœ… **å…¼å®¹æ€§**: å‘åå…¼å®¹ç°æœ‰ä»£ç 

---

## ğŸš€ å»ºè®®çš„åç»­ä¼˜åŒ–

### 1. æµ‹è¯•æ–‡ä»¶ç±»å‹ä¿®å¤
- [ ] ä¿®å¤ tests/ ç›®å½•ä¸‹çš„ç±»å‹é”™è¯¯
- [ ] æ›´æ–°æµ‹è¯•å·¥å…·ç±»å‹å®šä¹‰
- [ ] æ·»åŠ æµ‹è¯•ç±»å‹å®ˆå«

### 2. æ„å»ºç³»ç»Ÿ
- [ ] ä¿®å¤ @ldesign/builder åŒ…çš„æ„å»ºé”™è¯¯
- [ ] ä¼˜åŒ–æ„å»ºé…ç½®
- [ ] æ·»åŠ æ„å»ºæ€§èƒ½ç›‘æ§

### 3. åŠŸèƒ½å¢å¼º
- [ ] æ·»åŠ æ¨¡æ¿é¢„åŠ è½½ç­–ç•¥é…ç½®
- [ ] å®ç°æ¨¡æ¿æ‡’åŠ è½½ä¼˜åŒ–
- [ ] æ·»åŠ æ¨¡æ¿ç¼“å­˜ç­–ç•¥

### 4. æ–‡æ¡£å®Œå–„
- [ ] æ›´æ–° API æ–‡æ¡£
- [ ] æ·»åŠ ç±»å‹ä½¿ç”¨ç¤ºä¾‹
- [ ] åˆ›å»ºè¿ç§»æŒ‡å—

---

## ğŸ“ æ³¨æ„äº‹é¡¹

### Builder åŒ…é—®é¢˜
å½“å‰ `@ldesign/builder` åŒ…å­˜åœ¨æ„å»ºé”™è¯¯ï¼Œéœ€è¦å•ç‹¬ä¿®å¤ï¼š
- è¯­æ³•é”™è¯¯
- ç±»å‹é”™è¯¯
- é…ç½®é—®é¢˜

**å½±å“**: æš‚æ—¶æ— æ³•æ‰§è¡Œå®Œæ•´æ„å»ºï¼Œä½†ä¸å½±å“ template åŒ…çš„å¼€å‘å’Œç±»å‹æ£€æŸ¥ã€‚

### æµ‹è¯•æ–‡ä»¶
æµ‹è¯•æ–‡ä»¶ä¸­å­˜åœ¨è¾ƒå¤šç±»å‹é”™è¯¯ï¼Œä¸»è¦åŸå› ï¼š
- æµ‹è¯•ä½¿ç”¨çš„å·¥å…·ç±»å‹ä¸å®Œæ•´
- Mock æ•°æ®ç±»å‹ä¸åŒ¹é…
- éƒ¨åˆ†æµ‹è¯• API å·²è¿‡æ—¶

**å»ºè®®**: é€æ­¥è¿ç§»åˆ°æ–°çš„ç±»å‹ç³»ç»Ÿã€‚

---

## æ€»ç»“

æœ¬æ¬¡ä¼˜åŒ–æ˜¾è‘—æå‡äº† `@ldesign/template` åŒ…çš„ä»£ç è´¨é‡å’Œç±»å‹å®‰å…¨æ€§ã€‚æºä»£ç å·²é€šè¿‡å®Œæ•´çš„ç±»å‹æ£€æŸ¥ï¼Œä¸ºåç»­å¼€å‘å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚å»ºè®®ç»§ç»­å®Œå–„æµ‹è¯•ç³»ç»Ÿå’Œæ„å»ºæµç¨‹ï¼Œä»¥å®ç°å®Œæ•´çš„å¼€å‘å·¥ä½œæµã€‚
