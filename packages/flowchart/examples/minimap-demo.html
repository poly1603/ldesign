<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°åœ°å›¾åŠŸèƒ½æ¼”ç¤º</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        
        .container {
            width: 100%;
            height: 600px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .main-canvas {
            width: 100%;
            height: 100%;
            background: #fafafa;
            position: relative;
            overflow: hidden;
            cursor: grab;
        }
        
        .main-canvas:active {
            cursor: grabbing;
        }
        
        .content {
            position: absolute;
            width: 2000px;
            height: 1500px;
            background: 
                radial-gradient(circle at 200px 200px, #52c41a 10px, transparent 10px),
                radial-gradient(circle at 500px 300px, #722ed1 10px, transparent 10px),
                radial-gradient(circle at 800px 400px, #fa8c16 10px, transparent 10px),
                radial-gradient(circle at 1200px 500px, #13c2c2 10px, transparent 10px),
                radial-gradient(circle at 1500px 600px, #f5222d 10px, transparent 10px),
                linear-gradient(90deg, transparent 199px, #ddd 200px, #ddd 201px, transparent 202px),
                linear-gradient(0deg, transparent 199px, #ddd 200px, #ddd 201px, transparent 202px);
            background-size: 
                400px 400px,
                400px 400px,
                400px 400px,
                400px 400px,
                400px 400px,
                200px 200px,
                200px 200px;
            transform: translate(0px, 0px) scale(1);
            transition: transform 0.1s ease;
        }
        
        .minimap {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 200px;
            height: 150px;
            background: #fafafa;
            border: 2px solid #722ed1;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
            overflow: hidden;
            cursor: pointer;
        }
        
        .minimap-content {
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20px 20px, #52c41a 1px, transparent 1px),
                radial-gradient(circle at 50px 30px, #722ed1 1px, transparent 1px),
                radial-gradient(circle at 80px 40px, #fa8c16 1px, transparent 1px),
                radial-gradient(circle at 120px 50px, #13c2c2 1px, transparent 1px),
                radial-gradient(circle at 150px 60px, #f5222d 1px, transparent 1px),
                linear-gradient(90deg, transparent 19px, #f0f0f0 20px, #f0f0f0 20px, transparent 21px),
                linear-gradient(0deg, transparent 19px, #f0f0f0 20px, #f0f0f0 20px, transparent 21px);
            background-size: 
                40px 40px,
                40px 40px,
                40px 40px,
                40px 40px,
                40px 40px,
                20px 20px,
                20px 20px;
            position: relative;
        }
        
        .viewport {
            position: absolute;
            border: 2px solid #722ed1;
            background: rgba(114, 46, 209, 0.1);
            cursor: move;
            pointer-events: auto;
            box-sizing: border-box;
            left: 0px;
            top: 0px;
            width: 80px;
            height: 60px;
        }
        
        .controls {
            margin-bottom: 20px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        
        button {
            margin-right: 10px;
            padding: 8px 16px;
            border: 1px solid #722ed1;
            background: #722ed1;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background: #5e2aa7;
        }
        
        .info {
            margin-top: 20px;
            padding: 10px;
            background: #f0f8ff;
            border-radius: 4px;
            border: 1px solid #d0e7ff;
        }
        
        .status {
            margin-top: 10px;
            padding: 10px;
            background: #f6ffed;
            border-radius: 4px;
            border: 1px solid #b7eb8f;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸ—ºï¸ æç®€å°åœ°å›¾åŠŸèƒ½æ¼”ç¤º</h1>
    
    <div class="controls">
        <button onclick="zoomIn()">æ”¾å¤§ (+)</button>
        <button onclick="zoomOut()">ç¼©å° (-)</button>
        <button onclick="resetView()">é‡ç½®è§†å›¾</button>
        <button onclick="toggleMiniMap()">åˆ‡æ¢å°åœ°å›¾</button>
        <button onclick="addRandomNode()">æ·»åŠ èŠ‚ç‚¹</button>
    </div>
    
    <div id="container" class="container">
        <div id="mainCanvas" class="main-canvas">
            <div id="content" class="content"></div>
        </div>
        
        <div id="minimap" class="minimap">
            <div class="minimap-content">
                <div id="viewport" class="viewport"></div>
            </div>
        </div>
    </div>
    
    <div class="info">
        <h3>åŠŸèƒ½æ¼”ç¤ºï¼š</h3>
        <ul>
            <li>âœ… <strong>ç‚¹å‡»å°åœ°å›¾</strong>ï¼šä¸»ç”»å¸ƒè·³è½¬åˆ°å¯¹åº”ä½ç½®</li>
            <li>âœ… <strong>æ‹–æ‹½è§†å£çª—å£</strong>ï¼šä¸»ç”»å¸ƒè·Ÿéšç§»åŠ¨</li>
            <li>âœ… <strong>æ‹–æ‹½ä¸»ç”»å¸ƒ</strong>ï¼šå°åœ°å›¾è§†å£çª—å£åŒæ­¥æ›´æ–°</li>
            <li>âœ… <strong>ç¼©æ”¾æ“ä½œ</strong>ï¼šå°åœ°å›¾è§†å£çª—å£å¤§å°åŒæ­¥è°ƒæ•´</li>
            <li>âœ… <strong>å®æ—¶åŒæ­¥</strong>ï¼šæ‰€æœ‰æ“ä½œéƒ½æœ‰æµç•…çš„è§†è§‰åé¦ˆ</li>
        </ul>
    </div>
    
    <div id="status" class="status">
        çŠ¶æ€ï¼šå°åœ°å›¾å·²åˆå§‹åŒ– | è§†å£ä½ç½®ï¼š(0, 0) | ç¼©æ”¾æ¯”ä¾‹ï¼š1.0
    </div>

    <script>
        // çŠ¶æ€ç®¡ç†
        let currentTransform = { x: 0, y: 0, scale: 1 }
        let isDragging = false
        let isViewportDragging = false
        let dragStart = { x: 0, y: 0 }
        let minimapVisible = true
        let nodeCount = 5
        
        // DOMå…ƒç´ 
        const container = document.getElementById('container')
        const mainCanvas = document.getElementById('mainCanvas')
        const content = document.getElementById('content')
        const minimap = document.getElementById('minimap')
        const viewport = document.getElementById('viewport')
        const status = document.getElementById('status')
        
        // åˆå§‹åŒ–
        function init() {
            setupMainCanvasEvents()
            setupMinimapEvents()
            updateViewport()
            updateStatus()
        }
        
        // ä¸»ç”»å¸ƒäº‹ä»¶
        function setupMainCanvasEvents() {
            mainCanvas.addEventListener('mousedown', (e) => {
                isDragging = true
                dragStart = { x: e.clientX - currentTransform.x, y: e.clientY - currentTransform.y }
                mainCanvas.style.cursor = 'grabbing'
            })
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    currentTransform.x = e.clientX - dragStart.x
                    currentTransform.y = e.clientY - dragStart.y
                    updateMainCanvas()
                    updateViewport()
                    updateStatus()
                }
            })
            
            document.addEventListener('mouseup', () => {
                isDragging = false
                mainCanvas.style.cursor = 'grab'
            })
            
            // æ»šè½®ç¼©æ”¾
            mainCanvas.addEventListener('wheel', (e) => {
                e.preventDefault()
                const delta = e.deltaY > 0 ? 0.9 : 1.1
                const rect = mainCanvas.getBoundingClientRect()
                const centerX = rect.width / 2
                const centerY = rect.height / 2
                
                zoom(delta, centerX, centerY)
            })
        }
        
        // å°åœ°å›¾äº‹ä»¶
        function setupMinimapEvents() {
            // ç‚¹å‡»å°åœ°å›¾è·³è½¬
            minimap.addEventListener('click', (e) => {
                if (e.target === viewport) return
                
                const rect = minimap.getBoundingClientRect()
                const x = e.clientX - rect.left
                const y = e.clientY - rect.top
                
                // è½¬æ¢ä¸ºä¸»ç”»å¸ƒåæ ‡
                const scaleX = 2000 / 200  // ä¸»ç”»å¸ƒå®½åº¦ / å°åœ°å›¾å®½åº¦
                const scaleY = 1500 / 150  // ä¸»ç”»å¸ƒé«˜åº¦ / å°åœ°å›¾é«˜åº¦
                
                const targetX = -(x * scaleX - container.offsetWidth / 2)
                const targetY = -(y * scaleY - container.offsetHeight / 2)
                
                currentTransform.x = targetX
                currentTransform.y = targetY
                
                updateMainCanvas()
                updateViewport()
                updateStatus()
            })
            
            // è§†å£æ‹–æ‹½
            viewport.addEventListener('mousedown', (e) => {
                e.stopPropagation()
                isViewportDragging = true
                const rect = viewport.getBoundingClientRect()
                dragStart = { 
                    x: e.clientX - rect.left, 
                    y: e.clientY - rect.top 
                }
            })
            
            document.addEventListener('mousemove', (e) => {
                if (isViewportDragging) {
                    const minimapRect = minimap.getBoundingClientRect()
                    const x = e.clientX - minimapRect.left - dragStart.x
                    const y = e.clientY - minimapRect.top - dragStart.y
                    
                    // è½¬æ¢ä¸ºä¸»ç”»å¸ƒåæ ‡
                    const scaleX = 2000 / 200
                    const scaleY = 1500 / 150
                    
                    currentTransform.x = -(x * scaleX)
                    currentTransform.y = -(y * scaleY)
                    
                    updateMainCanvas()
                    updateViewport()
                    updateStatus()
                }
            })
            
            document.addEventListener('mouseup', () => {
                isViewportDragging = false
            })
        }
        
        // æ›´æ–°ä¸»ç”»å¸ƒ
        function updateMainCanvas() {
            content.style.transform = `translate(${currentTransform.x}px, ${currentTransform.y}px) scale(${currentTransform.scale})`
        }
        
        // æ›´æ–°è§†å£çª—å£
        function updateViewport() {
            const scaleX = 200 / 2000  // å°åœ°å›¾å®½åº¦ / ä¸»ç”»å¸ƒå®½åº¦
            const scaleY = 150 / 1500  // å°åœ°å›¾é«˜åº¦ / ä¸»ç”»å¸ƒé«˜åº¦
            
            const viewportWidth = (container.offsetWidth / currentTransform.scale) * scaleX
            const viewportHeight = (container.offsetHeight / currentTransform.scale) * scaleY
            
            const viewportX = (-currentTransform.x / currentTransform.scale) * scaleX
            const viewportY = (-currentTransform.y / currentTransform.scale) * scaleY
            
            viewport.style.width = `${Math.max(10, viewportWidth)}px`
            viewport.style.height = `${Math.max(10, viewportHeight)}px`
            viewport.style.left = `${Math.max(0, Math.min(200 - viewportWidth, viewportX))}px`
            viewport.style.top = `${Math.max(0, Math.min(150 - viewportHeight, viewportY))}px`
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus() {
            status.textContent = `çŠ¶æ€ï¼šå°åœ°å›¾${minimapVisible ? 'æ˜¾ç¤º' : 'éšè—'} | è§†å£ä½ç½®ï¼š(${Math.round(currentTransform.x)}, ${Math.round(currentTransform.y)}) | ç¼©æ”¾æ¯”ä¾‹ï¼š${currentTransform.scale.toFixed(2)}`
        }
        
        // ç¼©æ”¾åŠŸèƒ½
        function zoom(factor, centerX = container.offsetWidth / 2, centerY = container.offsetHeight / 2) {
            const newScale = Math.max(0.1, Math.min(3, currentTransform.scale * factor))
            
            if (newScale !== currentTransform.scale) {
                const scaleDiff = newScale / currentTransform.scale
                
                currentTransform.x = centerX - (centerX - currentTransform.x) * scaleDiff
                currentTransform.y = centerY - (centerY - currentTransform.y) * scaleDiff
                currentTransform.scale = newScale
                
                updateMainCanvas()
                updateViewport()
                updateStatus()
            }
        }
        
        // æ§åˆ¶å‡½æ•°
        function zoomIn() {
            zoom(1.2)
        }
        
        function zoomOut() {
            zoom(0.8)
        }
        
        function resetView() {
            currentTransform = { x: 0, y: 0, scale: 1 }
            updateMainCanvas()
            updateViewport()
            updateStatus()
        }
        
        function toggleMiniMap() {
            minimapVisible = !minimapVisible
            minimap.style.display = minimapVisible ? 'block' : 'none'
            updateStatus()
        }
        
        function addRandomNode() {
            // è¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œå®é™…ä¼šåœ¨çœŸå®çš„æµç¨‹å›¾ä¸­æ·»åŠ èŠ‚ç‚¹
            nodeCount++
            updateStatus()
        }
        
        // åˆå§‹åŒ–
        init()
        
        console.log('ğŸ‰ å°åœ°å›¾æ¼”ç¤ºé¡µé¢åŠ è½½å®Œæˆï¼')
        console.log('âœ… æ‰€æœ‰åŠŸèƒ½éƒ½å·²å®ç°å¹¶å¯ä»¥æ­£å¸¸ä½¿ç”¨')
    </script>
</body>
</html>
