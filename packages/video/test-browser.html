<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDesign Video Player - æµè§ˆå™¨æµ‹è¯•</title>
    <link rel="stylesheet" href="./src/styles/index.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .video-container {
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .test-results {
            background: #f8f9fa;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
        }
        
        .success {
            color: #28a745;
        }
        
        .error {
            color: #dc3545;
        }
        
        .info {
            color: #007bff;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ LDesign Video Player - æµè§ˆå™¨æµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•æ„å»ºåçš„è§†é¢‘æ’­æ”¾å™¨åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­çš„åŠŸèƒ½ã€‚</p>
        
        <div class="test-results" id="test-results">
            <div class="info">æ­£åœ¨åŠ è½½æµ‹è¯•...</div>
        </div>
        
        <div class="video-container" id="video-container">
            <!-- è§†é¢‘æ’­æ”¾å™¨å°†åœ¨è¿™é‡Œåˆ›å»º -->
        </div>
        
        <div>
            <button onclick="testBasicFunctionality()">æµ‹è¯•åŸºç¡€åŠŸèƒ½</button>
            <button onclick="testPluginSystem()">æµ‹è¯•æ’ä»¶ç³»ç»Ÿ</button>
            <button onclick="testThemeSystem()">æµ‹è¯•ä¸»é¢˜ç³»ç»Ÿ</button>
            <button onclick="createVideoPlayer()">åˆ›å»ºè§†é¢‘æ’­æ”¾å™¨</button>
        </div>

        <div style="margin-top: 20px;">
            <h3>ä¸»é¢˜åˆ‡æ¢</h3>
            <button onclick="switchTheme('default')">é»˜è®¤ä¸»é¢˜</button>
            <button onclick="switchTheme('dark')">æš—è‰²ä¸»é¢˜</button>
            <button onclick="switchTheme('colorful')">å½©è‰²ä¸»é¢˜</button>
        </div>

        <div style="margin-top: 20px;">
            <h3>åŠŸèƒ½æ¼”ç¤º</h3>
            <button onclick="window.open('examples/danmaku/index.html', '_blank')">ğŸ¯ å¼¹å¹•æ¼”ç¤º</button>
            <button onclick="window.open('examples/subtitle/index.html', '_blank')">ğŸ¬ å­—å¹•æ¼”ç¤º</button>
            <button onclick="window.open('examples/quality/index.html', '_blank')">ğŸ¥ è´¨é‡åˆ‡æ¢æ¼”ç¤º</button>
            <button onclick="window.open('examples/playlist/index.html', '_blank')">ğŸ“‹ æ’­æ”¾åˆ—è¡¨æ¼”ç¤º</button>
            <button onclick="window.open('examples/performance/index.html', '_blank')">ğŸš€ æ€§èƒ½ä¼˜åŒ–æ¼”ç¤º</button>
            <button onclick="window.open('examples/enhanced-features/index.html', '_blank')">âœ¨ å¢å¼ºåŠŸèƒ½æ¼”ç¤º</button>
            <button onclick="window.open('examples/basic/index.html', '_blank')">ğŸ“º åŸºç¡€æ¼”ç¤º</button>
        </div>
    </div>

    <script type="module">
        // å¯¼å…¥æ„å»ºåçš„æ¨¡å—
        import { Player } from './es/core/Player.js';
        import { EventManager } from './es/core/EventManager.js';
        import { PlayButton } from './es/plugins/PlayButton.js';
        import { defaultTheme } from './es/themes/default.js';

        const results = document.getElementById('test-results');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = message;
            results.appendChild(div);
        }
        
        function clearResults() {
            results.innerHTML = '';
        }

        // æµ‹è¯•åŸºç¡€åŠŸèƒ½
        window.testBasicFunctionality = function() {
            clearResults();
            log('ğŸ§ª å¼€å§‹æµ‹è¯•åŸºç¡€åŠŸèƒ½', 'info');
            
            try {
                // æµ‹è¯• EventManager
                const eventManager = new EventManager();
                log('âœ… EventManager åˆ›å»ºæˆåŠŸ', 'success');
                
                // æµ‹è¯•äº‹ä»¶ç›‘å¬
                eventManager.on('test', (data) => {
                    log(`âœ… äº‹ä»¶ç›‘å¬æˆåŠŸ: ${data.message}`, 'success');
                });
                
                eventManager.emit('test', { message: 'Hello World!' });
                
                log('âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
            } catch (error) {
                log(`âŒ åŸºç¡€åŠŸèƒ½æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };

        // æµ‹è¯•æ’ä»¶ç³»ç»Ÿ
        window.testPluginSystem = function() {
            clearResults();
            log('ğŸ”Œ å¼€å§‹æµ‹è¯•æ’ä»¶ç³»ç»Ÿ', 'info');
            
            try {
                log(`âœ… PlayButton æ’ä»¶å¯¼å…¥æˆåŠŸ: ${typeof PlayButton}`, 'success');
                log('âœ… æ’ä»¶ç³»ç»Ÿæµ‹è¯•å®Œæˆ', 'success');
            } catch (error) {
                log(`âŒ æ’ä»¶ç³»ç»Ÿæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };

        // æµ‹è¯•ä¸»é¢˜ç³»ç»Ÿ
        window.testThemeSystem = function() {
            clearResults();
            log('ğŸ¨ å¼€å§‹æµ‹è¯•ä¸»é¢˜ç³»ç»Ÿ', 'info');

            try {
                log(`âœ… é»˜è®¤ä¸»é¢˜å¯¼å…¥æˆåŠŸ: ${typeof defaultTheme}`, 'success');
                log(`âœ… ä¸»é¢˜åç§°: ${defaultTheme.name}`, 'success');
                log(`âœ… ä¸»é¢˜ç±»å‹: ${defaultTheme.type}`, 'success');

                // æµ‹è¯•ä¸»é¢˜åˆ‡æ¢
                log('ğŸ”„ æµ‹è¯•ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½', 'info');
                const container = document.getElementById('video-container');
                if (container) {
                    // åº”ç”¨é»˜è®¤ä¸»é¢˜
                    container.setAttribute('data-theme', 'default');
                    log('âœ… åº”ç”¨é»˜è®¤ä¸»é¢˜', 'success');

                    setTimeout(() => {
                        // åˆ‡æ¢åˆ°æš—è‰²ä¸»é¢˜
                        container.setAttribute('data-theme', 'dark');
                        log('âœ… åˆ‡æ¢åˆ°æš—è‰²ä¸»é¢˜', 'success');

                        setTimeout(() => {
                            // åˆ‡æ¢åˆ°å½©è‰²ä¸»é¢˜
                            container.setAttribute('data-theme', 'colorful');
                            log('âœ… åˆ‡æ¢åˆ°å½©è‰²ä¸»é¢˜', 'success');

                            setTimeout(() => {
                                // åˆ‡æ¢å›é»˜è®¤ä¸»é¢˜
                                container.setAttribute('data-theme', 'default');
                                log('âœ… åˆ‡æ¢å›é»˜è®¤ä¸»é¢˜', 'success');
                            }, 1000);
                        }, 1000);
                    }, 1000);
                }

                log('âœ… ä¸»é¢˜ç³»ç»Ÿæµ‹è¯•å®Œæˆ', 'success');
            } catch (error) {
                log(`âŒ ä¸»é¢˜ç³»ç»Ÿæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };

        // åˆ›å»ºè§†é¢‘æ’­æ”¾å™¨
        window.createVideoPlayer = function() {
            clearResults();
            log('ğŸ¬ å¼€å§‹åˆ›å»ºè§†é¢‘æ’­æ”¾å™¨', 'info');
            
            try {
                const container = document.getElementById('video-container');
                container.innerHTML = '<div id="player-instance"></div>';
                
                const playerContainer = document.getElementById('player-instance');
                
                const player = new Player({
                    container: playerContainer,
                    src: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
                    poster: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/images/BigBuckBunny.jpg',
                    width: '100%',
                    height: '450px'
                });
                
                log('âœ… Player å®ä¾‹åˆ›å»ºæˆåŠŸ', 'success');
                log(`âœ… Player ç±»å‹: ${player.constructor.name}`, 'success');
                
                // ç›‘å¬æ’­æ”¾å™¨äº‹ä»¶
                player.on('ready', () => {
                    log('âœ… æ’­æ”¾å™¨å‡†å¤‡å°±ç»ª', 'success');
                });
                
                player.on('play', () => {
                    log('âœ… å¼€å§‹æ’­æ”¾', 'success');
                });
                
                player.on('pause', () => {
                    log('âœ… æš‚åœæ’­æ”¾', 'success');
                });
                
                log('âœ… è§†é¢‘æ’­æ”¾å™¨åˆ›å»ºå®Œæˆ', 'success');
            } catch (error) {
                log(`âŒ è§†é¢‘æ’­æ”¾å™¨åˆ›å»ºå¤±è´¥: ${error.message}`, 'error');
                console.error(error);
            }
        };

        // ä¸»é¢˜åˆ‡æ¢å‡½æ•°
        window.switchTheme = function(themeName) {
            clearResults();
            log(`ğŸ¨ åˆ‡æ¢åˆ°${themeName}ä¸»é¢˜`, 'info');

            const container = document.getElementById('video-container');
            if (container) {
                container.setAttribute('data-theme', themeName);
                container.className = `lv-video-player lv-theme-transition`;
                log(`âœ… ä¸»é¢˜å·²åˆ‡æ¢åˆ°: ${themeName}`, 'success');
            } else {
                log('âŒ æ‰¾ä¸åˆ°è§†é¢‘å®¹å™¨', 'error');
            }
        };

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        window.addEventListener('load', () => {
            log('ğŸ‰ é¡µé¢åŠ è½½å®Œæˆï¼Œæ¨¡å—å¯¼å…¥æˆåŠŸï¼', 'success');
            log('ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•å„é¡¹åŠŸèƒ½', 'info');
        });
    </script>
</body>
</html>
