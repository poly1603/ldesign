<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ’ä»¶ç³»ç»Ÿæ¼”ç¤º - LDesign Video Player</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      color: #333;
      line-height: 1.6;
    }

    .header {
      background: linear-gradient(135deg, #722ED1, #9254DE);
      color: white;
      padding: 1.5rem 0;
      text-align: center;
    }

    .header h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .nav {
      background: white;
      padding: 1rem 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .nav a {
      color: #666;
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      transition: all 0.3s ease;
    }

    .nav a:hover,
    .nav a.active {
      background: #722ED1;
      color: white;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .demo-section {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .demo-section h2 {
      color: #722ED1;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }

    .demo-section p {
      color: #666;
      margin-bottom: 1.5rem;
    }

    .player-container {
      width: 100%;
      max-width: 800px;
      margin: 0 auto 2rem;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .plugin-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .plugin-card {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 1.5rem;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .plugin-card.active {
      border-color: #722ED1;
      background: #f6f0ff;
    }

    .plugin-card h3 {
      color: #333;
      margin-bottom: 1rem;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .plugin-card .status {
      font-size: 0.8rem;
      padding: 0.2rem 0.5rem;
      border-radius: 12px;
      background: #28a745;
      color: white;
    }

    .plugin-card .status.disabled {
      background: #6c757d;
    }

    .plugin-controls-group {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }

    .control-row {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .control-row label {
      font-weight: 500;
      color: #555;
      min-width: 60px;
    }

    .btn {
      padding: 0.5rem 1rem;
      background: #722ED1;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s ease;
      font-size: 0.9rem;
    }

    .btn:hover {
      background: #5e2aa7;
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .btn-sm {
      padding: 0.3rem 0.6rem;
      font-size: 0.8rem;
    }

    .btn-toggle {
      background: #28a745;
    }

    .btn-toggle:hover {
      background: #218838;
    }

    .btn-toggle.disabled {
      background: #dc3545;
    }

    .btn-toggle.disabled:hover {
      background: #c82333;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex: 1;
    }

    .input-group input,
    .input-group select {
      padding: 0.4rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .input-group input[type="range"] {
      flex: 1;
    }

    .danmaku-demo {
      background: #e3f2fd;
      border-radius: 4px;
      padding: 1rem;
      margin-top: 1rem;
    }

    .danmaku-demo h4 {
      color: #1976d2;
      margin-bottom: 0.5rem;
    }

    .danmaku-input {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .danmaku-input input {
      flex: 1;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .subtitle-demo {
      background: #fff3e0;
      border-radius: 4px;
      padding: 1rem;
      margin-top: 1rem;
    }

    .subtitle-demo h4 {
      color: #f57c00;
      margin-bottom: 0.5rem;
    }

    .code-block {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 4px;
      padding: 1rem;
      margin: 1rem 0;
      overflow-x: auto;
    }

    .code-block pre {
      margin: 0;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      color: #333;
    }

    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }
      
      .plugin-controls {
        grid-template-columns: 1fr;
      }
      
      .control-row {
        flex-direction: column;
        align-items: stretch;
      }
      
      .control-row label {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>æ’ä»¶ç³»ç»Ÿæ¼”ç¤º</h1>
    <p>å±•ç¤º LDesign Video Player å¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿ</p>
  </div>

  <div class="nav">
    <div class="nav-container">
      <a href="index.html">â† è¿”å›é¦–é¡µ</a>
      <a href="basic.html">åŸºç¡€åŠŸèƒ½</a>
      <a href="plugins.html" class="active">æ’ä»¶ç³»ç»Ÿ</a>
      <a href="themes.html">ä¸»é¢˜ç³»ç»Ÿ</a>
      <a href="advanced.html">é«˜çº§åŠŸèƒ½</a>
    </div>
  </div>

  <div class="container">
    <div class="demo-section">
      <h2>ğŸ”Œ æ’ä»¶ç³»ç»Ÿæ¼”ç¤º</h2>
      <p>è¿™ä¸ªæ’­æ”¾å™¨å®ä¾‹åŠ è½½äº†å¤šä¸ªæ’ä»¶ï¼Œå±•ç¤ºäº†æ’ä»¶ç³»ç»Ÿçš„å¼ºå¤§åŠŸèƒ½ã€‚</p>
      
      <div id="player-plugins" class="player-container"></div>

      <div class="plugin-controls">
        <!-- å¼¹å¹•æ’ä»¶ -->
        <div class="plugin-card" id="danmaku-card">
          <h3>
            ğŸ’¬ å¼¹å¹•æ’ä»¶
            <span class="status" id="danmaku-status">å·²å¯ç”¨</span>
          </h3>
          <div class="plugin-controls-group">
            <div class="control-row">
              <button id="danmaku-toggle" class="btn btn-toggle">ç¦ç”¨</button>
              <button id="danmaku-clear" class="btn btn-sm">æ¸…ç©ºå¼¹å¹•</button>
            </div>
            <div class="danmaku-demo">
              <h4>å‘é€å¼¹å¹•</h4>
              <div class="danmaku-input">
                <input type="text" id="danmaku-text" placeholder="è¾“å…¥å¼¹å¹•å†…å®¹..." maxlength="50">
                <select id="danmaku-type">
                  <option value="scroll">æ»šåŠ¨</option>
                  <option value="top">é¡¶éƒ¨</option>
                  <option value="bottom">åº•éƒ¨</option>
                </select>
                <button id="danmaku-send" class="btn btn-sm">å‘é€</button>
              </div>
              <div class="control-row">
                <label>é€æ˜åº¦:</label>
                <div class="input-group">
                  <input type="range" id="danmaku-opacity" min="0.1" max="1" step="0.1" value="0.8">
                  <span id="danmaku-opacity-value">80%</span>
                </div>
              </div>
              <div class="control-row">
                <label>å­—ä½“å¤§å°:</label>
                <div class="input-group">
                  <input type="range" id="danmaku-fontsize" min="12" max="24" step="2" value="16">
                  <span id="danmaku-fontsize-value">16px</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- å­—å¹•æ’ä»¶ -->
        <div class="plugin-card" id="subtitle-card">
          <h3>
            ğŸ“ å­—å¹•æ’ä»¶
            <span class="status" id="subtitle-status">å·²å¯ç”¨</span>
          </h3>
          <div class="plugin-controls-group">
            <div class="control-row">
              <button id="subtitle-toggle" class="btn btn-toggle">ç¦ç”¨</button>
              <button id="subtitle-load" class="btn btn-sm">åŠ è½½å­—å¹•</button>
            </div>
            <div class="subtitle-demo">
              <h4>å­—å¹•æ§åˆ¶</h4>
              <div class="control-row">
                <label>å­—å¹•è½¨é“:</label>
                <div class="input-group">
                  <select id="subtitle-track">
                    <option value="">æ— å­—å¹•</option>
                    <option value="zh">ä¸­æ–‡å­—å¹•</option>
                    <option value="en">è‹±æ–‡å­—å¹•</option>
                  </select>
                </div>
              </div>
              <div class="control-row">
                <label>å­—ä½“å¤§å°:</label>
                <div class="input-group">
                  <input type="range" id="subtitle-fontsize" min="14" max="28" step="2" value="18">
                  <span id="subtitle-fontsize-value">18px</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- æˆªå›¾æ’ä»¶ -->
        <div class="plugin-card" id="screenshot-card">
          <h3>
            ğŸ“· æˆªå›¾æ’ä»¶
            <span class="status" id="screenshot-status">å·²å¯ç”¨</span>
          </h3>
          <div class="plugin-controls-group">
            <div class="control-row">
              <button id="screenshot-toggle" class="btn btn-toggle">ç¦ç”¨</button>
              <button id="screenshot-capture" class="btn btn-sm">æˆªå›¾</button>
            </div>
            <div class="control-row">
              <label>æ ¼å¼:</label>
              <div class="input-group">
                <select id="screenshot-format">
                  <option value="png">PNG</option>
                  <option value="jpeg">JPEG</option>
                  <option value="webp">WebP</option>
                </select>
              </div>
            </div>
            <div class="control-row">
              <label>è´¨é‡:</label>
              <div class="input-group">
                <input type="range" id="screenshot-quality" min="0.1" max="1" step="0.1" value="0.9">
                <span id="screenshot-quality-value">90%</span>
              </div>
            </div>
          </div>
        </div>

        <!-- ç”»ä¸­ç”»æ’ä»¶ -->
        <div class="plugin-card" id="pip-card">
          <h3>
            ğŸ–¼ï¸ ç”»ä¸­ç”»æ’ä»¶
            <span class="status" id="pip-status">å·²å¯ç”¨</span>
          </h3>
          <div class="plugin-controls-group">
            <div class="control-row">
              <button id="pip-toggle" class="btn btn-toggle">ç¦ç”¨</button>
              <button id="pip-enter" class="btn btn-sm">è¿›å…¥ç”»ä¸­ç”»</button>
              <button id="pip-exit" class="btn btn-sm">é€€å‡ºç”»ä¸­ç”»</button>
            </div>
            <div class="control-row">
              <label>è‡ªåŠ¨è¿›å…¥:</label>
              <div class="input-group">
                <input type="checkbox" id="pip-auto">
                <select id="pip-trigger">
                  <option value="scroll">æ»šåŠ¨è§¦å‘</option>
                  <option value="visibility">å¯è§æ€§è§¦å‘</option>
                  <option value="focus">ç„¦ç‚¹è§¦å‘</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>ğŸ“ ä»£ç ç¤ºä¾‹</h2>
      <p>ä»¥ä¸‹æ˜¯åŠ è½½å’Œä½¿ç”¨æ’ä»¶çš„ä»£ç ç¤ºä¾‹ï¼š</p>
      
      <div class="code-block">
        <pre><code>import { VideoPlayer } from '@ldesign/video'
import { DanmakuPlugin, SubtitlePlugin, ScreenshotPlugin, PipPlugin } from '@ldesign/video/plugins'

// åˆ›å»ºæ’­æ”¾å™¨å®ä¾‹å¹¶åŠ è½½æ’ä»¶
const player = new VideoPlayer({
  container: document.getElementById('player'),
  src: 'video.mp4',
  plugins: [
    new DanmakuPlugin({
      enabled: true,
      opacity: 0.8,
      fontSize: 16
    }),
    new SubtitlePlugin({
      enabled: true,
      fontSize: 18
    }),
    new ScreenshotPlugin({
      enabled: true,
      format: 'png',
      quality: 0.9
    }),
    new PipPlugin({
      enabled: true,
      autoEnter: false
    })
  ]
})

await player.initialize()

// æ’ä»¶æ§åˆ¶
const danmakuPlugin = player.getPlugin('danmaku')
danmakuPlugin.send('è¿™æ˜¯ä¸€æ¡å¼¹å¹•', 'scroll')

const screenshotPlugin = player.getPlugin('screenshot')
const dataUrl = await screenshotPlugin.capture()</code></pre>
      </div>
    </div>
  </div>

  <script type="module">
    import { VideoPlayer } from '../../src/index.ts'
    import { DanmakuPlugin, SubtitlePlugin, ScreenshotPlugin, PipPlugin } from '../../plugins/index.ts'

    let player = null
    let plugins = {}

    // åˆå§‹åŒ–æ’­æ”¾å™¨
    async function initPlayer() {
      try {
        // åˆ›å»ºæ’ä»¶å®ä¾‹
        plugins.danmaku = new DanmakuPlugin({
          enabled: true,
          opacity: 0.8,
          fontSize: 16
        })

        plugins.subtitle = new SubtitlePlugin({
          enabled: true,
          fontSize: 18
        })

        plugins.screenshot = new ScreenshotPlugin({
          enabled: true,
          format: 'png',
          quality: 0.9
        })

        plugins.pip = new PipPlugin({
          enabled: true,
          autoEnter: false
        })

        player = new VideoPlayer({
          container: document.getElementById('player-plugins'),
          src: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
          autoplay: false,
          controls: true,
          volume: 1,
          theme: 'default',
          plugins: Object.values(plugins)
        })

        await player.initialize()
        
        // ç»‘å®šæ’ä»¶æ§åˆ¶
        bindPluginControls()
        
        console.log('æ’­æ”¾å™¨å’Œæ’ä»¶åˆå§‹åŒ–æˆåŠŸ')
      } catch (error) {
        console.error('æ’­æ”¾å™¨åˆå§‹åŒ–å¤±è´¥:', error)
      }
    }

    // ç»‘å®šæ’ä»¶æ§åˆ¶
    function bindPluginControls() {
      // å¼¹å¹•æ’ä»¶æ§åˆ¶
      bindDanmakuControls()
      
      // å­—å¹•æ’ä»¶æ§åˆ¶
      bindSubtitleControls()
      
      // æˆªå›¾æ’ä»¶æ§åˆ¶
      bindScreenshotControls()
      
      // ç”»ä¸­ç”»æ’ä»¶æ§åˆ¶
      bindPipControls()
    }

    // å¼¹å¹•æ’ä»¶æ§åˆ¶
    function bindDanmakuControls() {
      const danmakuPlugin = plugins.danmaku

      document.getElementById('danmaku-toggle').onclick = () => {
        const enabled = danmakuPlugin.enabled
        if (enabled) {
          danmakuPlugin.disable()
          updatePluginStatus('danmaku', false)
        } else {
          danmakuPlugin.enable()
          updatePluginStatus('danmaku', true)
        }
      }

      document.getElementById('danmaku-clear').onclick = () => {
        danmakuPlugin.clear()
      }

      document.getElementById('danmaku-send').onclick = () => {
        const text = document.getElementById('danmaku-text').value
        const type = document.getElementById('danmaku-type').value
        if (text.trim()) {
          danmakuPlugin.send(text, type)
          document.getElementById('danmaku-text').value = ''
        }
      }

      document.getElementById('danmaku-opacity').oninput = (e) => {
        const opacity = parseFloat(e.target.value)
        danmakuPlugin.setOpacity(opacity)
        document.getElementById('danmaku-opacity-value').textContent = Math.round(opacity * 100) + '%'
      }

      document.getElementById('danmaku-fontsize').oninput = (e) => {
        const fontSize = parseInt(e.target.value)
        danmakuPlugin.setFontSize(fontSize)
        document.getElementById('danmaku-fontsize-value').textContent = fontSize + 'px'
      }

      // å›è½¦å‘é€å¼¹å¹•
      document.getElementById('danmaku-text').onkeypress = (e) => {
        if (e.key === 'Enter') {
          document.getElementById('danmaku-send').click()
        }
      }
    }

    // å­—å¹•æ’ä»¶æ§åˆ¶
    function bindSubtitleControls() {
      const subtitlePlugin = plugins.subtitle

      document.getElementById('subtitle-toggle').onclick = () => {
        const enabled = subtitlePlugin.enabled
        if (enabled) {
          subtitlePlugin.disable()
          updatePluginStatus('subtitle', false)
        } else {
          subtitlePlugin.enable()
          updatePluginStatus('subtitle', true)
        }
      }

      document.getElementById('subtitle-track').onchange = (e) => {
        const track = e.target.value
        if (track) {
          subtitlePlugin.setTrack(track)
        } else {
          subtitlePlugin.hide()
        }
      }

      document.getElementById('subtitle-fontsize').oninput = (e) => {
        const fontSize = parseInt(e.target.value)
        subtitlePlugin.setFontSize(fontSize)
        document.getElementById('subtitle-fontsize-value').textContent = fontSize + 'px'
      }
    }

    // æˆªå›¾æ’ä»¶æ§åˆ¶
    function bindScreenshotControls() {
      const screenshotPlugin = plugins.screenshot

      document.getElementById('screenshot-toggle').onclick = () => {
        const enabled = screenshotPlugin.enabled
        if (enabled) {
          screenshotPlugin.disable()
          updatePluginStatus('screenshot', false)
        } else {
          screenshotPlugin.enable()
          updatePluginStatus('screenshot', true)
        }
      }

      document.getElementById('screenshot-capture').onclick = async () => {
        try {
          const dataUrl = await screenshotPlugin.capture()
          console.log('æˆªå›¾æˆåŠŸ:', dataUrl)
        } catch (error) {
          console.error('æˆªå›¾å¤±è´¥:', error)
        }
      }

      document.getElementById('screenshot-format').onchange = (e) => {
        screenshotPlugin.setFormat(e.target.value)
      }

      document.getElementById('screenshot-quality').oninput = (e) => {
        const quality = parseFloat(e.target.value)
        screenshotPlugin.setQuality(quality)
        document.getElementById('screenshot-quality-value').textContent = Math.round(quality * 100) + '%'
      }
    }

    // ç”»ä¸­ç”»æ’ä»¶æ§åˆ¶
    function bindPipControls() {
      const pipPlugin = plugins.pip

      document.getElementById('pip-toggle').onclick = () => {
        const enabled = pipPlugin.enabled
        if (enabled) {
          pipPlugin.disable()
          updatePluginStatus('pip', false)
        } else {
          pipPlugin.enable()
          updatePluginStatus('pip', true)
        }
      }

      document.getElementById('pip-enter').onclick = async () => {
        try {
          await pipPlugin.enter()
        } catch (error) {
          console.error('è¿›å…¥ç”»ä¸­ç”»å¤±è´¥:', error)
        }
      }

      document.getElementById('pip-exit').onclick = async () => {
        try {
          await pipPlugin.exit()
        } catch (error) {
          console.error('é€€å‡ºç”»ä¸­ç”»å¤±è´¥:', error)
        }
      }

      document.getElementById('pip-auto').onchange = (e) => {
        if (e.target.checked) {
          pipPlugin.enableAutoEnter()
        } else {
          pipPlugin.disableAutoEnter()
        }
      }
    }

    // æ›´æ–°æ’ä»¶çŠ¶æ€æ˜¾ç¤º
    function updatePluginStatus(pluginName, enabled) {
      const statusEl = document.getElementById(`${pluginName}-status`)
      const cardEl = document.getElementById(`${pluginName}-card`)
      const toggleEl = document.getElementById(`${pluginName}-toggle`)

      if (enabled) {
        statusEl.textContent = 'å·²å¯ç”¨'
        statusEl.className = 'status'
        cardEl.classList.add('active')
        toggleEl.textContent = 'ç¦ç”¨'
        toggleEl.className = 'btn btn-toggle'
      } else {
        statusEl.textContent = 'å·²ç¦ç”¨'
        statusEl.className = 'status disabled'
        cardEl.classList.remove('active')
        toggleEl.textContent = 'å¯ç”¨'
        toggleEl.className = 'btn btn-toggle disabled'
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', initPlayer)
  </script>
</body>
</html>
