<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LDesign Calendar - 现代化日历组件演示</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .demo-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .demo-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .demo-subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }

        .demo-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .feature-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .demo-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .demo-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .demo-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .demo-btn.active {
            background: linear-gradient(135deg, #764ba2, #667eea);
        }

        .calendar-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        .demo-instructions {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }

        .demo-instructions h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .demo-instructions ul {
            list-style: none;
            padding-left: 0;
        }

        .demo-instructions li {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
        }

        .demo-instructions li:before {
            content: "✨";
            position: absolute;
            left: 0;
        }

        @media (max-width: 768px) {
            .demo-container {
                padding: 20px;
                margin: 10px;
            }

            .demo-title {
                font-size: 2rem;
            }

            .demo-controls {
                justify-content: center;
            }

            .demo-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1 class="demo-title">LDesign Calendar</h1>
            <p class="demo-subtitle">现代化日历JavaScript插件 - 功能完整版演示</p>
            
            <div class="demo-features">
                <div class="feature-tag">🎯 右键菜单</div>
                <div class="feature-tag">📅 农历信息</div>
                <div class="feature-tag">🌟 天干地支</div>
                <div class="feature-tag">✨ 宜忌显示</div>
                <div class="feature-tag">🎨 多种视图</div>
                <div class="feature-tag">📱 响应式设计</div>
                <div class="feature-tag">🌍 国际化</div>
                <div class="feature-tag">🎭 主题切换</div>
            </div>
        </div>

        <div class="demo-controls">
            <button class="demo-btn active" onclick="switchView('month')">月视图</button>
            <button class="demo-btn" onclick="switchView('week')">周视图</button>
            <button class="demo-btn" onclick="switchView('day')">日视图</button>
            <button class="demo-btn" onclick="switchView('desk')">台历视图</button>
            <button class="demo-btn" onclick="switchTheme()">切换主题</button>
            <button class="demo-btn" onclick="addSampleEvents()">添加示例事件</button>
            <button class="demo-btn" onclick="toggleLunar()">农历显示</button>
        </div>

        <div id="calendar" class="calendar-container"></div>

        <div class="demo-instructions">
            <h3>🎮 使用说明</h3>
            <ul>
                <li><strong>右键点击日期</strong> - 显示上下文菜单，可新建日程、查看详情</li>
                <li><strong>右键点击事件</strong> - 编辑、删除或复制事件</li>
                <li><strong>双击日期</strong> - 快速查看详细信息（农历、宜忌等）</li>
                <li><strong>拖拽事件</strong> - 移动事件到其他日期</li>
                <li><strong>键盘导航</strong> - 方向键导航，Enter选择，Space切换视图</li>
                <li><strong>台历视图</strong> - 显示详细的农历信息、天干地支、宜忌</li>
                <li><strong>主题切换</strong> - 支持多种主题风格</li>
                <li><strong>农历功能</strong> - 显示农历日期、节气、传统节日</li>
            </ul>
        </div>
    </div>

    <!-- 引入日历样式和脚本 -->
    <link rel="stylesheet" href="./src/index.css">
    <script type="module">
        // 模拟Calendar类和相关功能
        class MockCalendar {
            constructor(container, options = {}) {
                this.container = typeof container === 'string' ? document.querySelector(container) : container;
                this.options = options;
                this.currentView = options.view || 'month';
                this.currentDate = new Date();
                this.showLunar = options.showLunar !== false;
                this.theme = options.theme || 'default';
                this.events = [];
                
                this.init();
            }

            init() {
                this.render();
                this.bindEvents();
            }

            render() {
                if (this.currentView === 'desk') {
                    this.renderDeskView();
                } else {
                    this.renderCalendarView();
                }
            }

            renderCalendarView() {
                const today = new Date();
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                let html = `
                    <div class="ldesign-calendar">
                        <div class="ldesign-calendar-header">
                            <div class="ldesign-calendar-nav">
                                <button class="ldesign-calendar-btn ldesign-calendar-prev-btn">‹</button>
                                <h2 class="ldesign-calendar-title">${year}年${month + 1}月</h2>
                                <button class="ldesign-calendar-btn ldesign-calendar-next-btn">›</button>
                            </div>
                            <div class="ldesign-calendar-toolbar">
                                <button class="ldesign-calendar-btn ldesign-calendar-today-btn">今天</button>
                            </div>
                        </div>
                        <div class="ldesign-calendar-body">
                `;

                if (this.currentView === 'month') {
                    html += this.renderMonthView(year, month);
                } else if (this.currentView === 'week') {
                    html += this.renderWeekView();
                } else if (this.currentView === 'day') {
                    html += this.renderDayView();
                }

                html += `
                        </div>
                    </div>
                `;

                this.container.innerHTML = html;
            }

            renderMonthView(year, month) {
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());

                let html = `
                    <div class="ldesign-calendar-month-view">
                        <div class="ldesign-calendar-weekdays">
                            <div class="ldesign-calendar-weekday">日</div>
                            <div class="ldesign-calendar-weekday">一</div>
                            <div class="ldesign-calendar-weekday">二</div>
                            <div class="ldesign-calendar-weekday">三</div>
                            <div class="ldesign-calendar-weekday">四</div>
                            <div class="ldesign-calendar-weekday">五</div>
                            <div class="ldesign-calendar-weekday">六</div>
                        </div>
                        <div class="ldesign-calendar-dates">
                `;

                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    
                    const isCurrentMonth = date.getMonth() === month;
                    const isToday = date.toDateString() === new Date().toDateString();
                    const lunarInfo = this.getLunarInfo(date);
                    
                    let classes = ['ldesign-calendar-date'];
                    if (!isCurrentMonth) classes.push('other-month');
                    if (isToday) classes.push('today');
                    
                    html += `
                        <div class="${classes.join(' ')}" data-date="${date.toISOString()}">
                            <div class="ldesign-calendar-date-number">${date.getDate()}</div>
                            ${this.showLunar ? `<div class="ldesign-calendar-lunar-info">${lunarInfo}</div>` : ''}
                            ${this.renderDateEvents(date)}
                        </div>
                    `;
                }

                html += `
                        </div>
                    </div>
                `;

                return html;
            }

            renderWeekView() {
                return `
                    <div class="ldesign-calendar-week-view">
                        <div class="ldesign-calendar-week-header">
                            <div class="ldesign-calendar-time-column"></div>
                            ${this.getWeekDays().map(day => `
                                <div class="ldesign-calendar-week-day">
                                    <div class="ldesign-calendar-week-day-name">${day.name}</div>
                                    <div class="ldesign-calendar-week-day-number">${day.number}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="ldesign-calendar-week-body">
                            <div class="ldesign-calendar-time-slots">
                                ${Array.from({length: 24}, (_, i) => `
                                    <div class="ldesign-calendar-time-slot">
                                        <span class="ldesign-calendar-time-label">${i.toString().padStart(2, '0')}:00</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderDayView() {
                const date = this.currentDate;
                const lunarInfo = this.getLunarInfo(date);
                
                return `
                    <div class="ldesign-calendar-day-view">
                        <div class="ldesign-calendar-day-header">
                            <h3>${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日</h3>
                            <div class="ldesign-calendar-day-lunar">${lunarInfo}</div>
                        </div>
                        <div class="ldesign-calendar-day-body">
                            ${Array.from({length: 24}, (_, i) => `
                                <div class="ldesign-calendar-hour-slot">
                                    <span class="ldesign-calendar-hour-label">${i.toString().padStart(2, '0')}:00</span>
                                    <div class="ldesign-calendar-hour-content"></div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            renderDeskView() {
                const date = this.currentDate;
                const lunarInfo = this.getLunarInfo(date);
                const ganzhi = this.getGanzhi(date);
                const suitable = this.getSuitable(date);
                const avoid = this.getAvoid(date);
                
                this.container.innerHTML = `
                    <div class="ldesign-calendar-desk-view">
                        <div class="ldesign-calendar-desk-container">
                            <div class="ldesign-calendar-desk-header">
                                <div class="ldesign-calendar-desk-date">${date.getDate()}</div>
                                <div class="ldesign-calendar-desk-weekday">${this.getWeekdayName(date)}</div>
                                <div class="ldesign-calendar-desk-month-year">${date.getFullYear()}年${date.getMonth() + 1}月</div>
                            </div>
                            <div class="ldesign-calendar-desk-body">
                                <div class="ldesign-calendar-desk-lunar-section">
                                    <h3 class="ldesign-calendar-desk-section-title">农历信息</h3>
                                    <div class="ldesign-calendar-desk-lunar-date">${lunarInfo}</div>
                                    <div class="ldesign-calendar-desk-ganzhi">${ganzhi}</div>
                                    <div class="ldesign-calendar-desk-zodiac">生肖：${this.getZodiac(date)}</div>
                                    <div class="ldesign-calendar-desk-suitable-avoid">
                                        <div class="ldesign-calendar-desk-suitable">
                                            <div class="ldesign-calendar-desk-suitable-title">宜</div>
                                            <div class="ldesign-calendar-desk-suitable-list">${suitable.join('、')}</div>
                                        </div>
                                        <div class="ldesign-calendar-desk-avoid">
                                            <div class="ldesign-calendar-desk-avoid-title">忌</div>
                                            <div class="ldesign-calendar-desk-avoid-list">${avoid.join('、')}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ldesign-calendar-desk-events-section">
                                    <h3 class="ldesign-calendar-desk-section-title">今日日程</h3>
                                    ${this.renderTodayEvents()}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            renderDateEvents(date) {
                const dayEvents = this.events.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate.toDateString() === date.toDateString();
                });

                if (dayEvents.length === 0) return '';

                return `
                    <div class="ldesign-calendar-date-events">
                        ${dayEvents.slice(0, 2).map(event => `
                            <div class="ldesign-calendar-event" data-event-id="${event.id}" style="background-color: ${event.color}">
                                ${event.title}
                            </div>
                        `).join('')}
                        ${dayEvents.length > 2 ? `<div class="ldesign-calendar-more-events">+${dayEvents.length - 2}更多</div>` : ''}
                    </div>
                `;
            }

            renderTodayEvents() {
                const todayEvents = this.events.filter(event => {
                    const eventDate = new Date(event.start);
                    return eventDate.toDateString() === this.currentDate.toDateString();
                });

                if (todayEvents.length === 0) {
                    return '<div class="ldesign-calendar-desk-no-events">今日暂无日程安排</div>';
                }

                return todayEvents.map(event => `
                    <div class="ldesign-calendar-desk-event" style="border-left-color: ${event.color}">
                        <div class="ldesign-calendar-desk-event-title">${event.title}</div>
                        <div class="ldesign-calendar-desk-event-time">${this.formatEventTime(event)}</div>
                        ${event.description ? `<div class="ldesign-calendar-desk-event-description">${event.description}</div>` : ''}
                    </div>
                `).join('');
            }

            bindEvents() {
                // 右键菜单
                this.container.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    this.showContextMenu(e);
                });

                // 双击查看详情
                this.container.addEventListener('dblclick', (e) => {
                    const dateEl = e.target.closest('.ldesign-calendar-date');
                    if (dateEl) {
                        this.showDetailModal(new Date(dateEl.dataset.date));
                    }
                });

                // 导航按钮
                this.container.addEventListener('click', (e) => {
                    if (e.target.classList.contains('ldesign-calendar-prev-btn')) {
                        this.prev();
                    } else if (e.target.classList.contains('ldesign-calendar-next-btn')) {
                        this.next();
                    } else if (e.target.classList.contains('ldesign-calendar-today-btn')) {
                        this.goToToday();
                    }
                });
            }

            showContextMenu(e) {
                const menu = document.createElement('div');
                menu.className = 'ldesign-calendar-context-menu';
                menu.style.left = e.clientX + 'px';
                menu.style.top = e.clientY + 'px';
                
                const dateEl = e.target.closest('.ldesign-calendar-date');
                if (dateEl) {
                    menu.innerHTML = `
                        <div class="ldesign-calendar-context-menu-item" onclick="calendar.createEvent('${dateEl.dataset.date}')">
                            <span>➕ 新建日程</span>
                        </div>
                        <div class="ldesign-calendar-context-menu-item" onclick="calendar.showDetailModal('${dateEl.dataset.date}')">
                            <span>📅 查看详情</span>
                        </div>
                        <div class="ldesign-calendar-context-menu-divider"></div>
                        <div class="ldesign-calendar-context-menu-item" onclick="calendar.goToToday()">
                            <span>🏠 回到今天</span>
                        </div>
                    `;
                }

                document.body.appendChild(menu);
                
                // 点击其他地方关闭菜单
                setTimeout(() => {
                    document.addEventListener('click', () => {
                        menu.remove();
                    }, { once: true });
                }, 0);
            }

            createEvent(dateStr) {
                const title = prompt('请输入日程标题:');
                if (title) {
                    const event = {
                        id: 'event-' + Date.now(),
                        title,
                        start: new Date(dateStr),
                        end: new Date(new Date(dateStr).getTime() + 60 * 60 * 1000),
                        color: '#722ED1',
                        description: ''
                    };
                    this.events.push(event);
                    this.render();
                }
            }

            showDetailModal(dateStr) {
                const date = new Date(dateStr);
                const lunarInfo = this.getLunarInfo(date);
                const ganzhi = this.getGanzhi(date);
                const suitable = this.getSuitable(date);
                const avoid = this.getAvoid(date);
                
                alert(`日期详情：
${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日
农历：${lunarInfo}
天干地支：${ganzhi}
宜：${suitable.join('、')}
忌：${avoid.join('、')}`);
            }

            // 工具方法
            getLunarInfo(date) {
                const lunarDays = ['初一', '初二', '初三', '初四', '初五', '初六', '初七', '初八', '初九', '初十',
                                 '十一', '十二', '十三', '十四', '十五', '十六', '十七', '十八', '十九', '二十',
                                 '廿一', '廿二', '廿三', '廿四', '廿五', '廿六', '廿七', '廿八', '廿九', '三十'];
                return lunarDays[date.getDate() % 30];
            }

            getGanzhi(date) {
                const stems = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
                const branches = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
                const year = date.getFullYear();
                return stems[(year - 4) % 10] + branches[(year - 4) % 12] + '年';
            }

            getZodiac(date) {
                const zodiacs = ['鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊', '猴', '鸡', '狗', '猪'];
                return zodiacs[(date.getFullYear() - 4) % 12];
            }

            getSuitable(date) {
                const activities = ['祭祀', '祈福', '开光', '出行', '嫁娶', '动土', '开业', '交易'];
                return activities.slice(0, 3 + (date.getDate() % 3));
            }

            getAvoid(date) {
                const activities = ['安葬', '破土', '修造', '搬家', '开市'];
                return activities.slice(0, 2 + (date.getDate() % 2));
            }

            getWeekdayName(date) {
                const days = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
                return days[date.getDay()];
            }

            getWeekDays() {
                const days = [];
                const start = new Date(this.currentDate);
                start.setDate(start.getDate() - start.getDay());
                
                for (let i = 0; i < 7; i++) {
                    const day = new Date(start);
                    day.setDate(start.getDate() + i);
                    days.push({
                        name: ['日', '一', '二', '三', '四', '五', '六'][i],
                        number: day.getDate()
                    });
                }
                return days;
            }

            formatEventTime(event) {
                const start = new Date(event.start);
                const end = new Date(event.end);
                return `${start.getHours().toString().padStart(2, '0')}:${start.getMinutes().toString().padStart(2, '0')} - ${end.getHours().toString().padStart(2, '0')}:${end.getMinutes().toString().padStart(2, '0')}`;
            }

            // 公共方法
            changeView(view) {
                this.currentView = view;
                this.render();
            }

            prev() {
                if (this.currentView === 'month') {
                    this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                } else if (this.currentView === 'week') {
                    this.currentDate.setDate(this.currentDate.getDate() - 7);
                } else {
                    this.currentDate.setDate(this.currentDate.getDate() - 1);
                }
                this.render();
            }

            next() {
                if (this.currentView === 'month') {
                    this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                } else if (this.currentView === 'week') {
                    this.currentDate.setDate(this.currentDate.getDate() + 7);
                } else {
                    this.currentDate.setDate(this.currentDate.getDate() + 1);
                }
                this.render();
            }

            goToToday() {
                this.currentDate = new Date();
                this.render();
            }

            setTheme(theme) {
                this.theme = theme;
                this.container.className = `calendar-container theme-${theme}`;
            }

            toggleLunar() {
                this.showLunar = !this.showLunar;
                this.render();
            }
        }

        // 全局变量和函数
        let calendar;
        let currentTheme = 'default';
        const themes = ['default', 'blue', 'dark', 'green'];

        // 初始化日历
        calendar = new MockCalendar('#calendar', {
            view: 'month',
            showLunar: true,
            theme: 'default'
        });

        // 全局函数
        window.switchView = function(view) {
            calendar.changeView(view);
            
            // 更新按钮状态
            document.querySelectorAll('.demo-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        };

        window.switchTheme = function() {
            const currentIndex = themes.indexOf(currentTheme);
            currentTheme = themes[(currentIndex + 1) % themes.length];
            calendar.setTheme(currentTheme);
        };

        window.addSampleEvents = function() {
            const sampleEvents = [
                { title: '团队会议', start: new Date(), color: '#722ED1' },
                { title: '项目评审', start: new Date(Date.now() + 86400000), color: '#52C41A' },
                { title: '客户拜访', start: new Date(Date.now() + 172800000), color: '#FA8C16' }
            ];
            
            sampleEvents.forEach(event => {
                event.id = 'event-' + Date.now() + Math.random();
                event.end = new Date(event.start.getTime() + 60 * 60 * 1000);
                calendar.events.push(event);
            });
            
            calendar.render();
        };

        window.toggleLunar = function() {
            calendar.toggleLunar();
        };

        // 添加键盘导航
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                    calendar.prev();
                    break;
                case 'ArrowRight':
                    calendar.next();
                    break;
                case ' ':
                    e.preventDefault();
                    const views = ['month', 'week', 'day', 'desk'];
                    const currentIndex = views.indexOf(calendar.currentView);
                    const nextView = views[(currentIndex + 1) % views.length];
                    calendar.changeView(nextView);
                    break;
                case 'Home':
                    calendar.goToToday();
                    break;
            }
        });
    </script>
</body>
</html>
