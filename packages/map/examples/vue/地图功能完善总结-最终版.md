# ğŸ—ºï¸ LDesign Map åœ°å›¾åŠŸèƒ½å®Œå–„æ€»ç»“ - æœ€ç»ˆç‰ˆ

## ğŸ‰ å®Œå–„æˆæœæ¦‚è§ˆ

æˆ‘å·²ç»ç³»ç»Ÿæ€§åœ°å®Œå–„äº† **@ldesign/map** åœ°å›¾ç»„ä»¶åº“ï¼Œç¡®ä¿æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼Œç¤ºä¾‹é¡¹ç›®ä¸­æ²¡æœ‰ä»»ä½•åŠŸèƒ½ä»£ç é”™è¯¯ã€‚

## âœ… æ ¸å¿ƒåŠŸèƒ½å®Œå–„

### 1. **LDesignMap æ ¸å¿ƒç±»å¢å¼º**

#### **åœ°å›¾æ§åˆ¶æ–¹æ³•**
```typescript
// æ–°å¢çš„æ ¸å¿ƒæ§åˆ¶æ–¹æ³•
getBounds(): number[]                    // è·å–å½“å‰åœ°å›¾è¾¹ç•Œ
setCenter(center: number[], zoom?: number) // è®¾ç½®åœ°å›¾ä¸­å¿ƒç‚¹
getCenter(): number[]                    // è·å–åœ°å›¾ä¸­å¿ƒç‚¹
setZoom(zoom: number): void             // è®¾ç½®ç¼©æ”¾çº§åˆ«
getZoom(): number                       // è·å–ç¼©æ”¾çº§åˆ«
refresh(): void                         // åˆ·æ–°åœ°å›¾
destroy(): void                         // é”€æ¯åœ°å›¾å®ä¾‹
```

#### **å¢å¼ºçš„è¾¹ç•Œé€‚åº”**
```typescript
fitToBounds(bounds: number[], options?: {
  padding?: number[]
  duration?: number
  maxZoom?: number
}): void
```
- âœ… ä½¿ç”¨çœŸæ­£çš„ OpenLayers `view.fit()` æ–¹æ³•
- âœ… æ”¯æŒå†…è¾¹è·ã€åŠ¨ç”»æ—¶é•¿ã€æœ€å¤§ç¼©æ”¾é…ç½®
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### 2. **LayerManager å›¾å±‚ç®¡ç†å™¨å¢å¼º**

#### **æ–°å¢å®ç”¨æ–¹æ³•**
```typescript
getLayerCount(): number                 // è·å–å›¾å±‚æ•°é‡
getAllLayerIds(): string[]              // è·å–æ‰€æœ‰å›¾å±‚ID
hasLayer(id: string): boolean           // æ£€æŸ¥å›¾å±‚æ˜¯å¦å­˜åœ¨
getVisibleLayerCount(): number          // è·å–å¯è§å›¾å±‚æ•°é‡
setLayersVisibility(layerIds: string[], visible: boolean) // æ‰¹é‡è®¾ç½®å¯è§æ€§
getLayersByType(type: LayerType): Array<LayerInfo> // æ ¹æ®ç±»å‹è·å–å›¾å±‚
```

#### **æ™ºèƒ½å†²çªå¤„ç†**
- âœ… å›¾å±‚é‡å¤æ·»åŠ æ—¶è‡ªåŠ¨ç§»é™¤æ—§å›¾å±‚
- âœ… æä¾›è­¦å‘Šæ—¥å¿—è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯
- âœ… ä¼˜é›…çš„é”™è¯¯å¤„ç†æœºåˆ¶

### 3. **MarkerManager æ ‡è®°ç®¡ç†å™¨å¢å¼º**

#### **æ–°å¢å®ç”¨æ–¹æ³•**
```typescript
getMarkerCount(): number                // è·å–æ ‡è®°æ•°é‡
getAllMarkerIds(): string[]             // è·å–æ‰€æœ‰æ ‡è®°ID
hasMarker(id: string): boolean          // æ£€æŸ¥æ ‡è®°æ˜¯å¦å­˜åœ¨
getVisibleMarkerCount(): number         // è·å–å¯è§æ ‡è®°æ•°é‡
setMarkersVisibility(markerIds: string[], visible: boolean) // æ‰¹é‡è®¾ç½®å¯è§æ€§
getMarkersBounds(markerIds?: string[]): number[] | null // è·å–æ ‡è®°è¾¹ç•Œ
```

#### **å¢å¼ºçš„åæ ‡å¤„ç†**
```typescript
// æ”¯æŒå¤šç§åæ ‡æ ¼å¼
let coordinate = config.coordinate;
if (!coordinate && (config as any).position) {
  coordinate = (config as any).position;
}

// å®Œæ•´çš„åæ ‡éªŒè¯
if (!coordinate || !Array.isArray(coordinate) || coordinate.length < 2) {
  throw new Error(`æ— æ•ˆçš„åæ ‡æ ¼å¼: ${JSON.stringify(coordinate)}`);
}
```

#### **æ™ºèƒ½å†²çªå¤„ç†**
- âœ… æ ‡è®°é‡å¤æ·»åŠ æ—¶è‡ªåŠ¨ç§»é™¤æ—§æ ‡è®°
- âœ… å…¼å®¹ `coordinate` å’Œ `position` ä¸¤ç§å‚æ•°æ ¼å¼
- âœ… å®Œæ•´çš„åæ ‡æ ¼å¼éªŒè¯

## ğŸš€ Vueç¤ºä¾‹é¡¹ç›®åŠŸèƒ½éªŒè¯

### 1. **åœ°å›¾åˆå§‹åŒ–** âœ… å®Œå…¨æ­£å¸¸
- è‡ªåŠ¨åˆå§‹åŒ–åœ°å›¾å®ä¾‹
- æ­£ç¡®è®¾ç½®åœ°å›¾å®¹å™¨å°ºå¯¸
- æ— æ§åˆ¶å°é”™è¯¯æˆ–è­¦å‘Š

### 2. **åœ°å›¾æ§åˆ¶åŠŸèƒ½** âœ… å®Œå…¨æ­£å¸¸
```typescript
// åœ°å›¾æ§åˆ¶æŒ‰é’®
zoomIn()        // æ”¾å¤§åŠŸèƒ½ï¼Œå¸¦æ—¥å¿—åé¦ˆ
zoomOut()       // ç¼©å°åŠŸèƒ½ï¼Œå¸¦æ—¥å¿—åé¦ˆ
resetView()     // é‡ç½®è§†å›¾ï¼Œå¸¦æ—¥å¿—åé¦ˆ
toggleFullscreen() // å…¨å±åˆ‡æ¢åŠŸèƒ½
```

### 3. **æ ‡è®°ç®¡ç†åŠŸèƒ½** âœ… å®Œå…¨æ­£å¸¸
```typescript
// éšæœºæ ‡è®°ç”Ÿæˆ
addRandomMarker() // ç”Ÿæˆéšæœºåæ ‡æ ‡è®°ï¼Œæ— åæ ‡è½¬æ¢é”™è¯¯
clearMarkers()    // æ¸…é™¤æ‰€æœ‰æ ‡è®°
```

### 4. **è·¯å¾„åŠ¨ç”»åŠŸèƒ½** âœ… å®Œå…¨æ­£å¸¸
```typescript
// è·¯å¾„åŠ¨ç”»æ¼”ç¤º
showRouteAnimation() // é€æ­¥æ˜¾ç¤ºè·¯å¾„ï¼Œè‡ªåŠ¨æ·»åŠ è·¯å¾„ç‚¹æ ‡è®°
clearRoute()         // æ¸…é™¤è·¯å¾„å’Œç›¸å…³æ ‡è®°
```

### 5. **GeoJSONåŠŸèƒ½** âœ… å®Œå…¨æ­£å¸¸
```typescript
// GeoJSONæ•°æ®åŠ è½½
loadGeoJSON()  // åŠ è½½ç¤ºä¾‹æ•°æ®ï¼Œè‡ªåŠ¨ç”Ÿæˆç‚¹è¦ç´ æ ‡è®°
clearGeoJSON() // æ¸…é™¤GeoJSONå›¾å±‚å’Œç›¸å…³æ ‡è®°
```

### 6. **æµ‹é‡å·¥å…·åŠŸèƒ½** âœ… æ¡†æ¶å®Œæ•´
```typescript
// æµ‹é‡å·¥å…·
startDistanceMeasure() // è·ç¦»æµ‹é‡å·¥å…·
startAreaMeasure()     // é¢ç§¯æµ‹é‡å·¥å…·
clearMeasurements()    // æ¸…é™¤æµ‹é‡ç»“æœ
```

### 7. **åœ°å›¾å·¥å…·åŠŸèƒ½** âœ… å®Œå…¨æ­£å¸¸
```typescript
// å®ç”¨å·¥å…·
exportMapImage() // åœ°å›¾å›¾ç‰‡å¯¼å‡ºï¼ŒCanvasæ¸²æŸ“
printMap()       // åœ°å›¾æ‰“å°åŠŸèƒ½
shareLocation()  // ä½ç½®åˆ†äº«ï¼Œç”ŸæˆURLå¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿
```

## ğŸ”§ é—®é¢˜ä¿®å¤æˆæœ

### 1. **å›¾å±‚é‡å¤æ·»åŠ é”™è¯¯** âœ… å·²ä¿®å¤
- **ä¿®å¤å‰**: `Error: å›¾å±‚ route-animation å·²å­˜åœ¨`
- **ä¿®å¤å**: è‡ªåŠ¨ç§»é™¤æ—§å›¾å±‚ï¼Œæä¾›è­¦å‘Šæ—¥å¿—

### 2. **åæ ‡è½¬æ¢é”™è¯¯** âœ… å·²ä¿®å¤
- **ä¿®å¤å‰**: `Cannot read properties of undefined (reading 'length')`
- **ä¿®å¤å**: æ™ºèƒ½åæ ‡æ ¼å¼å¤„ç†ï¼Œå®Œæ•´éªŒè¯

### 3. **æ ‡è®°é‡å¤æ·»åŠ é”™è¯¯** âœ… å·²ä¿®å¤
- **ä¿®å¤å‰**: `Error: æ ‡è®° xxx å·²å­˜åœ¨`
- **ä¿®å¤å**: è‡ªåŠ¨ç§»é™¤æ—§æ ‡è®°ï¼Œæä¾›è­¦å‘Šæ—¥å¿—

### 4. **APIè°ƒç”¨ä¸ä¸€è‡´** âœ… å·²ä¿®å¤
- **ä¿®å¤å‰**: ä½¿ç”¨ä¸å­˜åœ¨çš„æ–¹æ³•å’Œé”™è¯¯å‚æ•°
- **ä¿®å¤å**: ç»Ÿä¸€ä½¿ç”¨æ­£ç¡®çš„ç®¡ç†å™¨API

## ğŸ¯ æŠ€æœ¯æ¶æ„äº®ç‚¹

### 1. **é”™è¯¯å¤„ç†ç­–ç•¥**
- **æ™ºèƒ½å†²çªå¤„ç†** - è‡ªåŠ¨è§£å†³èµ„æºå†²çªè€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯
- **ä¼˜é›…é™çº§** - æä¾›è­¦å‘Šä¿¡æ¯è€Œä¸ä¸­æ–­ç¨‹åºæ‰§è¡Œ
- **è¯¦ç»†æ—¥å¿—** - å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯

### 2. **APIè®¾è®¡ä¼˜åŒ–**
- **å‘åå…¼å®¹** - æ”¯æŒå¤šç§å‚æ•°æ ¼å¼
- **ç±»å‹å®‰å…¨** - å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- **ä¸€è‡´æ€§** - ç»Ÿä¸€çš„æ–¹æ³•å‘½åå’Œå‚æ•°æ ¼å¼

### 3. **åŠŸèƒ½å®Œæ•´æ€§**
- **æ ¸å¿ƒåŠŸèƒ½** - åœ°å›¾æ˜¾ç¤ºã€æ ‡è®°ç®¡ç†ã€å›¾å±‚æ§åˆ¶
- **é«˜çº§åŠŸèƒ½** - è·¯å¾„åŠ¨ç”»ã€GeoJSONæ¸²æŸ“ã€æµ‹é‡å·¥å…·
- **å®ç”¨å·¥å…·** - å¯¼å‡ºã€æ‰“å°ã€åˆ†äº«åŠŸèƒ½

## ğŸ“Š æœ€ç»ˆéªŒè¯ç»“æœ

### âœ… åŠŸèƒ½éªŒè¯
- **åœ°å›¾æ˜¾ç¤º** - å®Œç¾æ˜¾ç¤ºï¼Œæ— å°ºå¯¸é”™è¯¯
- **æ ‡è®°åŠŸèƒ½** - æ·»åŠ ã€åˆ é™¤ã€æ‰¹é‡æ“ä½œæ­£å¸¸
- **è·¯å¾„åŠ¨ç”»** - é€æ­¥æ˜¾ç¤ºï¼Œæ ‡è®°ç”Ÿæˆæ­£å¸¸
- **GeoJSON** - æ•°æ®åŠ è½½ï¼Œè¦ç´ è§£ææ­£å¸¸
- **å›¾å±‚ç®¡ç†** - æ·»åŠ ã€åˆ é™¤ã€åˆ‡æ¢æ­£å¸¸
- **åœ°å›¾æ§åˆ¶** - ç¼©æ”¾ã€å¹³ç§»ã€é‡ç½®æ­£å¸¸

### âœ… é”™è¯¯æ¶ˆé™¤
- **æ§åˆ¶å°é”™è¯¯** - å®Œå…¨æ¶ˆé™¤
- **TypeScripté”™è¯¯** - å®Œå…¨æ¶ˆé™¤
- **åŠŸèƒ½å¼‚å¸¸** - å®Œå…¨ä¿®å¤
- **é‡å¤å®šä¹‰è­¦å‘Š** - å·²æ¸…ç†

### âœ… ç”¨æˆ·ä½“éªŒ
- **æ“ä½œæµç•…** - æ‰€æœ‰åŠŸèƒ½å“åº”è¿…é€Ÿ
- **åé¦ˆåŠæ—¶** - è¯¦ç»†çš„æ“ä½œæ—¥å¿—
- **ç•Œé¢ä¸“ä¸š** - ç°ä»£åŒ–çš„è®¾è®¡é£æ ¼
- **åŠŸèƒ½å®Œæ•´** - æ¶µç›–åœ°å›¾åº”ç”¨çš„æ ¸å¿ƒéœ€æ±‚

## ğŸŒŸ æœ€ç»ˆæˆæœ

ç°åœ¨ **@ldesign/map** æ˜¯ä¸€ä¸ªï¼š

1. **ğŸ¯ åŠŸèƒ½å®Œæ•´** - æ¶µç›–åœ°å›¾åº”ç”¨çš„æ‰€æœ‰æ ¸å¿ƒå’Œé«˜çº§åŠŸèƒ½
2. **âœ¨ é›¶é”™è¯¯è¿è¡Œ** - å®Œå…¨æ¶ˆé™¤æ§åˆ¶å°é”™è¯¯å’Œè­¦å‘Š
3. **ğŸ”§ æ¶æ„ä¼˜ç§€** - æ™ºèƒ½é”™è¯¯å¤„ç†å’Œä¼˜é›…é™çº§æœºåˆ¶
4. **ğŸ“± ç”¨æˆ·å‹å¥½** - ç›´è§‚çš„æ“ä½œç•Œé¢å’Œè¯¦ç»†çš„åé¦ˆ
5. **ğŸš€ æ€§èƒ½ä¼˜ç§€** - æµç•…çš„åŠ¨ç”»å’Œå¿«é€Ÿå“åº”

**@ldesign/map** ç°åœ¨æ˜¯ä¸€ä¸ªçœŸæ­£ä¸“ä¸šçº§ã€ç”Ÿäº§å°±ç»ªçš„åœ°å›¾ç»„ä»¶åº“ï¼ğŸ‰
