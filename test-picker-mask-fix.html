<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pickeré®ç½©ä¿®å¤æµ‹è¯•</title>
  <style>
    body {
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: #f5f5f5;
    }
    
    .test-container {
      display: flex;
      gap: 40px;
      flex-wrap: wrap;
      align-items: flex-start;
    }
    
    .test-section {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .test-section h3 {
      margin-top: 0;
      color: #333;
      border-bottom: 2px solid #1d4ed8;
      padding-bottom: 10px;
    }
    
    .control-panel {
      margin-top: 20px;
      padding: 15px;
      background: #f9fafb;
      border-radius: 6px;
    }
    
    .control-group {
      margin-bottom: 15px;
    }
    
    .control-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #4b5563;
    }
    
    .control-group input,
    .control-group select {
      width: 100%;
      padding: 8px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 14px;
    }
    
    button {
      background: #1d4ed8;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 10px;
      margin-top: 10px;
      font-size: 14px;
    }
    
    button:hover {
      background: #1e40af;
    }
    
    button.secondary {
      background: #6b7280;
    }
    
    button.secondary:hover {
      background: #4b5563;
    }
    
    .status {
      margin-top: 15px;
      padding: 10px;
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .debug-info {
      margin-top: 15px;
      padding: 10px;
      background: #f3f4f6;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .mask-visual {
      margin-top: 15px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      padding: 10px;
    }
    
    .mask-visual h4 {
      margin-top: 0;
      color: #6b7280;
      font-size: 14px;
    }
    
    /* è‡ªå®šä¹‰pickeræ ·å¼æµ‹è¯• */
    .custom-mask-test {
      --ldesign-picker-mask-gradient-top: linear-gradient(to bottom, 
        rgba(255,0,0,0.5) 0%, 
        rgba(255,0,0,0.3) 50%, 
        rgba(255,0,0,0) 100%) !important;
      --ldesign-picker-mask-gradient-bottom: linear-gradient(to top, 
        rgba(0,0,255,0.5) 0%, 
        rgba(0,0,255,0.3) 50%, 
        rgba(0,0,255,0) 100%) !important;
    }
    
    .force-mask-visible {
      --ldesign-picker-mask-gradient-top: linear-gradient(to bottom, 
        rgba(0,0,0,0.8) 0%, 
        rgba(0,0,0,0.5) 30%, 
        rgba(0,0,0,0.2) 60%, 
        rgba(0,0,0,0) 100%) !important;
      --ldesign-picker-mask-gradient-bottom: linear-gradient(to top, 
        rgba(0,0,0,0.8) 0%, 
        rgba(0,0,0,0.5) 30%, 
        rgba(0,0,0,0.2) 60%, 
        rgba(0,0,0,0) 100%) !important;
    }
  </style>
  <script type="module">
    import './packages/webcomponent/dist/index.js';
  </script>
</head>
<body>
  <h1>ğŸ”§ Pickeré®ç½©ä¿®å¤æµ‹è¯•</h1>
  
  <div class="test-container">
    <!-- åŸå§‹Picker -->
    <div class="test-section">
      <h3>1. åŸå§‹Pickerï¼ˆé»˜è®¤é®ç½©ï¼‰</h3>
      <ldesign-picker
        id="picker1"
        options="è‹¹æœ,æ©™å­,é¦™è•‰,è‘¡è„,è¥¿ç“œ,è‰è“,èŠ’æœ,è è,è”æ,é¾™çœ¼"
        show-mask="true"
        value="é¦™è•‰"
        style="width: 150px"
      ></ldesign-picker>
      <div class="status">é»˜è®¤é®ç½©è®¾ç½®ï¼ˆç™½è‰²æ¸å˜ï¼‰</div>
    </div>
    
    <!-- å½©è‰²é®ç½©æµ‹è¯• -->
    <div class="test-section">
      <h3>2. å½©è‰²é®ç½©æµ‹è¯•</h3>
      <ldesign-picker
        id="picker2"
        class="custom-mask-test"
        options="å‘¨ä¸€,å‘¨äºŒ,å‘¨ä¸‰,å‘¨å››,å‘¨äº”,å‘¨å…­,å‘¨æ—¥"
        show-mask="true"
        value="å‘¨ä¸‰"
        style="width: 150px"
      ></ldesign-picker>
      <div class="status">çº¢è“æ¸å˜é®ç½©ï¼ˆç”¨äºéªŒè¯é®ç½©ä½ç½®ï¼‰</div>
    </div>
    
    <!-- å¼ºåˆ¶æ˜¾ç¤ºé®ç½© -->
    <div class="test-section">
      <h3>3. å¼ºåˆ¶é»‘è‰²é®ç½©</h3>
      <ldesign-picker
        id="picker3"
        class="force-mask-visible"
        options="1æœˆ,2æœˆ,3æœˆ,4æœˆ,5æœˆ,6æœˆ,7æœˆ,8æœˆ,9æœˆ,10æœˆ,11æœˆ,12æœˆ"
        show-mask="true"
        value="6æœˆ"
        style="width: 150px"
      ></ldesign-picker>
      <div class="status">é»‘è‰²åŠé€æ˜é®ç½©ï¼ˆé«˜å¯¹æ¯”åº¦ï¼‰</div>
    </div>
    
    <!-- æš—é»‘ä¸»é¢˜æµ‹è¯• -->
    <div class="test-section" style="background: #1f2937;">
      <h3 style="color: white;">4. æš—é»‘ä¸»é¢˜</h3>
      <ldesign-picker
        id="picker4"
        theme="dark"
        options="é€‰é¡¹1,é€‰é¡¹2,é€‰é¡¹3,é€‰é¡¹4,é€‰é¡¹5,é€‰é¡¹6,é€‰é¡¹7,é€‰é¡¹8"
        show-mask="true"
        value="é€‰é¡¹4"
        style="width: 150px"
      ></ldesign-picker>
      <div class="status" style="background: #374151; color: white; border-color: #60a5fa;">æš—é»‘ä¸»é¢˜é®ç½©</div>
    </div>
  </div>
  
  <!-- æ§åˆ¶é¢æ¿ -->
  <div class="test-section" style="margin-top: 30px;">
    <h3>ğŸ›ï¸ é®ç½©è°ƒè¯•å·¥å…·</h3>
    
    <div class="control-panel">
      <div class="control-group">
        <label>é®ç½©é€æ˜åº¦ï¼š</label>
        <input type="range" id="maskOpacity" min="0" max="1" step="0.05" value="0.95">
        <span id="opacityValue">0.95</span>
      </div>
      
      <div class="control-group">
        <label>é®ç½©é«˜åº¦ï¼ˆ%ï¼‰ï¼š</label>
        <input type="range" id="maskHeight" min="10" max="50" step="5" value="35">
        <span id="heightValue">35%</span>
      </div>
      
      <div class="control-group">
        <label>é¡¶éƒ¨é®ç½©é¢œè‰²ï¼š</label>
        <select id="topMaskColor">
          <option value="white">ç™½è‰²</option>
          <option value="black">é»‘è‰²</option>
          <option value="red">çº¢è‰²</option>
          <option value="blue">è“è‰²</option>
          <option value="custom">è‡ªå®šä¹‰æ¸å˜</option>
        </select>
      </div>
      
      <div class="control-group">
        <label>åº•éƒ¨é®ç½©é¢œè‰²ï¼š</label>
        <select id="bottomMaskColor">
          <option value="white">ç™½è‰²</option>
          <option value="black">é»‘è‰²</option>
          <option value="red">çº¢è‰²</option>
          <option value="blue">è“è‰²</option>
          <option value="custom">è‡ªå®šä¹‰æ¸å˜</option>
        </select>
      </div>
      
      <button onclick="applyMaskSettings()">åº”ç”¨è®¾ç½®</button>
      <button onclick="resetMaskSettings()" class="secondary">é‡ç½®</button>
      <button onclick="inspectMasks()">æ£€æŸ¥é®ç½©å…ƒç´ </button>
      <button onclick="toggleMasks()" class="secondary">åˆ‡æ¢é®ç½©æ˜¾ç¤º</button>
    </div>
    
    <div class="mask-visual">
      <h4>é®ç½©é¢„è§ˆï¼š</h4>
      <div style="position: relative; height: 200px; background: #f9fafb; border-radius: 4px; overflow: hidden;">
        <div id="topMaskPreview" style="position: absolute; top: 0; left: 0; right: 0; height: 35%; background: linear-gradient(to bottom, white 0%, transparent 100%);"></div>
        <div id="bottomMaskPreview" style="position: absolute; bottom: 0; left: 0; right: 0; height: 35%; background: linear-gradient(to top, white 0%, transparent 100%);"></div>
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #6b7280;">å†…å®¹åŒºåŸŸ</div>
      </div>
    </div>
    
    <div class="debug-info" id="debugInfo">
      ç‚¹å‡»"æ£€æŸ¥é®ç½©å…ƒç´ "æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯...
    </div>
  </div>
  
  <script>
    // é®ç½©è®¾ç½®åº”ç”¨å‡½æ•°
    function applyMaskSettings() {
      const opacity = document.getElementById('maskOpacity').value;
      const height = document.getElementById('maskHeight').value;
      const topColor = document.getElementById('topMaskColor').value;
      const bottomColor = document.getElementById('bottomMaskColor').value;
      
      // è·å–æ‰€æœ‰picker
      const pickers = document.querySelectorAll('ldesign-picker');
      
      pickers.forEach(picker => {
        const shadowRoot = picker.shadowRoot;
        if (!shadowRoot) return;
        
        // æ›´æ–°é®ç½©æ ·å¼
        const masks = shadowRoot.querySelectorAll('.ldesign-picker__mask');
        masks.forEach(mask => {
          mask.style.opacity = opacity;
          mask.style.height = `${height}%`;
        });
        
        // æ›´æ–°é¡¶éƒ¨é®ç½©é¢œè‰²
        const topMask = shadowRoot.querySelector('.ldesign-picker__mask--top');
        if (topMask) {
          topMask.style.background = getGradient(topColor, 'top');
        }
        
        // æ›´æ–°åº•éƒ¨é®ç½©é¢œè‰²
        const bottomMask = shadowRoot.querySelector('.ldesign-picker__mask--bottom');
        if (bottomMask) {
          bottomMask.style.background = getGradient(bottomColor, 'bottom');
        }
      });
      
      // æ›´æ–°é¢„è§ˆ
      updatePreview();
      
      // æ›´æ–°æ˜¾ç¤ºå€¼
      document.getElementById('opacityValue').textContent = opacity;
      document.getElementById('heightValue').textContent = `${height}%`;
      
      console.log('é®ç½©è®¾ç½®å·²åº”ç”¨:', { opacity, height, topColor, bottomColor });
    }
    
    // è·å–æ¸å˜æ ·å¼
    function getGradient(color, direction) {
      const isTop = direction === 'top';
      const gradientDir = isTop ? 'to bottom' : 'to top';
      
      const gradients = {
        white: `linear-gradient(${gradientDir}, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%)`,
        black: `linear-gradient(${gradientDir}, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%)`,
        red: `linear-gradient(${gradientDir}, rgba(255,0,0,0.6) 0%, rgba(255,0,0,0) 100%)`,
        blue: `linear-gradient(${gradientDir}, rgba(0,0,255,0.6) 0%, rgba(0,0,255,0) 100%)`,
        custom: `linear-gradient(${gradientDir}, rgba(128,128,128,0.9) 0%, rgba(128,128,128,0.5) 30%, rgba(128,128,128,0.2) 60%, rgba(128,128,128,0) 100%)`
      };
      
      return gradients[color] || gradients.white;
    }
    
    // æ›´æ–°é¢„è§ˆ
    function updatePreview() {
      const topColor = document.getElementById('topMaskColor').value;
      const bottomColor = document.getElementById('bottomMaskColor').value;
      const height = document.getElementById('maskHeight').value;
      const opacity = document.getElementById('maskOpacity').value;
      
      const topPreview = document.getElementById('topMaskPreview');
      const bottomPreview = document.getElementById('bottomMaskPreview');
      
      topPreview.style.background = getGradient(topColor, 'top');
      topPreview.style.height = `${height}%`;
      topPreview.style.opacity = opacity;
      
      bottomPreview.style.background = getGradient(bottomColor, 'bottom');
      bottomPreview.style.height = `${height}%`;
      bottomPreview.style.opacity = opacity;
    }
    
    // é‡ç½®è®¾ç½®
    function resetMaskSettings() {
      document.getElementById('maskOpacity').value = '0.95';
      document.getElementById('maskHeight').value = '35';
      document.getElementById('topMaskColor').value = 'white';
      document.getElementById('bottomMaskColor').value = 'white';
      
      // ç§»é™¤è‡ªå®šä¹‰æ ·å¼
      const pickers = document.querySelectorAll('ldesign-picker');
      pickers.forEach(picker => {
        const shadowRoot = picker.shadowRoot;
        if (!shadowRoot) return;
        
        const masks = shadowRoot.querySelectorAll('.ldesign-picker__mask');
        masks.forEach(mask => {
          mask.style.opacity = '';
          mask.style.height = '';
          mask.style.background = '';
        });
      });
      
      updatePreview();
      console.log('é®ç½©è®¾ç½®å·²é‡ç½®');
    }
    
    // æ£€æŸ¥é®ç½©å…ƒç´ 
    function inspectMasks() {
      const debugInfo = document.getElementById('debugInfo');
      let info = '=== é®ç½©å…ƒç´ æ£€æŸ¥ç»“æœ ===\n\n';
      
      const pickers = document.querySelectorAll('ldesign-picker');
      pickers.forEach((picker, index) => {
        info += `Picker #${index + 1} (${picker.id || 'æ— ID'}):\n`;
        
        const shadowRoot = picker.shadowRoot;
        if (!shadowRoot) {
          info += '  âŒ æ— æ³•è®¿é—®Shadow DOM\n';
          return;
        }
        
        const topMask = shadowRoot.querySelector('.ldesign-picker__mask--top');
        const bottomMask = shadowRoot.querySelector('.ldesign-picker__mask--bottom');
        
        if (topMask) {
          const topStyles = window.getComputedStyle(topMask);
          info += `  âœ… é¡¶éƒ¨é®ç½©:\n`;
          info += `     - æ˜¾ç¤º: ${topStyles.display}\n`;
          info += `     - ä½ç½®: ${topStyles.position}\n`;
          info += `     - é«˜åº¦: ${topStyles.height}\n`;
          info += `     - é€æ˜åº¦: ${topStyles.opacity}\n`;
          info += `     - z-index: ${topStyles.zIndex}\n`;
          info += `     - èƒŒæ™¯: ${topStyles.background.substring(0, 50)}...\n`;
        } else {
          info += '  âŒ æœªæ‰¾åˆ°é¡¶éƒ¨é®ç½©\n';
        }
        
        if (bottomMask) {
          const bottomStyles = window.getComputedStyle(bottomMask);
          info += `  âœ… åº•éƒ¨é®ç½©:\n`;
          info += `     - æ˜¾ç¤º: ${bottomStyles.display}\n`;
          info += `     - ä½ç½®: ${bottomStyles.position}\n`;
          info += `     - é«˜åº¦: ${bottomStyles.height}\n`;
          info += `     - é€æ˜åº¦: ${bottomStyles.opacity}\n`;
          info += `     - z-index: ${bottomStyles.zIndex}\n`;
          info += `     - èƒŒæ™¯: ${bottomStyles.background.substring(0, 50)}...\n`;
        } else {
          info += '  âŒ æœªæ‰¾åˆ°åº•éƒ¨é®ç½©\n';
        }
        
        info += '\n';
      });
      
      debugInfo.textContent = info;
      console.log(info);
    }
    
    // åˆ‡æ¢é®ç½©æ˜¾ç¤º
    function toggleMasks() {
      const pickers = document.querySelectorAll('ldesign-picker');
      pickers.forEach(picker => {
        const currentValue = picker.getAttribute('show-mask');
        picker.setAttribute('show-mask', currentValue === 'false' ? 'true' : 'false');
      });
      
      console.log('é®ç½©æ˜¾ç¤ºçŠ¶æ€å·²åˆ‡æ¢');
    }
    
    // ç›‘å¬æ»‘å—å˜åŒ–
    document.getElementById('maskOpacity').addEventListener('input', (e) => {
      document.getElementById('opacityValue').textContent = e.target.value;
    });
    
    document.getElementById('maskHeight').addEventListener('input', (e) => {
      document.getElementById('heightValue').textContent = `${e.target.value}%`;
    });
    
    // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥
    window.addEventListener('load', () => {
      setTimeout(() => {
        console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œè‡ªåŠ¨æ£€æŸ¥é®ç½©...');
        inspectMasks();
      }, 500);
    });
  </script>
</body>
</html>