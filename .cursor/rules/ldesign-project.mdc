---
alwaysApply: true
description: LDesign è®¾è®¡ç³»ç»Ÿé¡¹ç›®å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ
---

# LDesign è®¾è®¡ç³»ç»Ÿå¼€å‘è§„èŒƒ

## é¡¹ç›®æ¦‚è¿°

LDesign æ˜¯ä¸€ä¸ªåŸºäº pnpm workspace çš„ç°ä»£åŒ–è®¾è®¡ç³»ç»Ÿ monorepo é¡¹ç›®ï¼Œæä¾›ä¸°å¯Œçš„ç»„ä»¶åº“ã€å·¥å…·å’ŒåŸºç¡€è®¾æ–½ã€‚

### æ ¸å¿ƒç‰¹æ€§
- ğŸš€ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**: TypeScript 5.7+ / Vue 3 / React 18
- ğŸ“¦ **Monorepo æ¶æ„**: pnpm workspace ç®¡ç†
- ğŸ¯ **å¤šæ¡†æ¶æ”¯æŒ**: Vue, React, Web Components
- âš¡ **é«˜æ€§èƒ½æ„å»º**: Vite + Rollup
- ğŸ”§ **å®Œæ•´å·¥å…·é“¾**: ESLint, Prettier, Vitest, Playwright

## é¡¹ç›®ç»“æ„

### æ ¸å¿ƒç›®å½•ç»“æ„

```
ldesign/
â”œâ”€â”€ packages/          # æ ¸å¿ƒåŸºç¡€åŒ…
â”‚   â”œâ”€â”€ api/          # API é€šä¿¡å±‚
â”‚   â”œâ”€â”€ cache/        # ç¼“å­˜ç®¡ç†
â”‚   â”œâ”€â”€ color/        # é¢œè‰²å·¥å…·
â”‚   â”œâ”€â”€ crypto/       # åŠ å¯†å·¥å…·
â”‚   â”œâ”€â”€ device/       # è®¾å¤‡æ£€æµ‹
â”‚   â”œâ”€â”€ engine/       # æ ¸å¿ƒå¼•æ“
â”‚   â”œâ”€â”€ http/         # HTTP å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ i18n/         # å›½é™…åŒ–
â”‚   â”œâ”€â”€ router/       # è·¯ç”±ç®¡ç†
â”‚   â”œâ”€â”€ shared/       # å…±äº«å·¥å…·
â”‚   â”œâ”€â”€ size/         # å°ºå¯¸è®¡ç®—
â”‚   â”œâ”€â”€ store/        # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ template/     # æ¨¡æ¿å¼•æ“
â”œâ”€â”€ libraries/        # ç»„ä»¶åº“ï¼ˆ20+ ä¸ªç‹¬ç«‹åº“ï¼‰
â”‚   â”œâ”€â”€ 3d-viewer/   # 3D æŸ¥çœ‹å™¨
â”‚   â”œâ”€â”€ chart/       # å›¾è¡¨ç»„ä»¶
â”‚   â”œâ”€â”€ code-editor/ # ä»£ç ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ cropper/     # å›¾ç‰‡è£å‰ª
â”‚   â”œâ”€â”€ datepicker/  # æ—¥æœŸé€‰æ‹©å™¨
â”‚   â”œâ”€â”€ editor/      # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ excel/       # Excel æ“ä½œ
â”‚   â”œâ”€â”€ flowchart/   # æµç¨‹å›¾
â”‚   â”œâ”€â”€ form/        # è¡¨å•ç»„ä»¶
â”‚   â”œâ”€â”€ grid/        # ç½‘æ ¼å¸ƒå±€
â”‚   â””â”€â”€ ...          # å…¶ä»– 10+ ä¸ªåº“
â”œâ”€â”€ tools/           # å¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ builder/     # æ„å»ºå·¥å…·
â”‚   â”œâ”€â”€ cli/         # å‘½ä»¤è¡Œå·¥å…·
â”‚   â”œâ”€â”€ kit/         # å¼€å‘å¥—ä»¶
â”‚   â””â”€â”€ launcher/    # å¯åŠ¨å™¨
â”œâ”€â”€ apps/            # åº”ç”¨ç¨‹åº
â”‚   â””â”€â”€ app/         # ç¤ºä¾‹åº”ç”¨
â””â”€â”€ scripts/         # è„šæœ¬å·¥å…·
```

å…³é”®æ–‡ä»¶ï¼š
- [package.json](mdc:package.json) - æ ¹é¡¹ç›®é…ç½®
- [pnpm-workspace.yaml](mdc:pnpm-workspace.yaml) - Workspace é…ç½®
- [tsconfig.json](mdc:tsconfig.json) - TypeScript é…ç½®
- [eslint.config.js](mdc:eslint.config.js) - ESLint é…ç½®

## å¼€å‘è§„èŒƒ

### 1. TypeScript è§„èŒƒ

#### ç±»å‹å®šä¹‰
```typescript
// âœ… æ¨èï¼šå§‹ç»ˆæ˜¾å¼å£°æ˜ç±»å‹
interface ComponentProps {
  title: string
  size?: 'small' | 'medium' | 'large'
  onClose?: () => void
}

// âœ… æ¨èï¼šä½¿ç”¨ç±»å‹åˆ«åç®€åŒ–å¤æ‚ç±»å‹
type AsyncResult<T> = Promise<T | null>

// âŒ é¿å…ï¼šè¿‡åº¦ä½¿ç”¨ any
// const data: any = {}

// âœ… æ¨èï¼šä½¿ç”¨ unknown æˆ–å…·ä½“ç±»å‹
const data: unknown = {}
```

#### é…ç½®è¦ç‚¹
- **Target**: ES2020
- **Module**: ESNext  
- **Strict Mode**: å¯ç”¨ï¼ˆä½† noImplicitAny å’Œ strictNullChecks è®¾ä¸º falseï¼‰
- **Path Alias**: 
  - `@/*` â†’ `./src/*`
  - `@ldesign/*` â†’ `./packages/*/src`

### 2. Vue å¼€å‘è§„èŒƒ

#### ç»„ä»¶ç»“æ„
```vue
<script setup lang="ts">
// âœ… æ¨èï¼šä½¿ç”¨ Composition API + <script setup>
import { ref, computed, onMounted } from 'vue'

interface Props {
  modelValue: string
  disabled?: boolean
}

const props = defineProps<Props>()
const emit = defineEmits<{
  'update:modelValue': [value: string]
  'change': [value: string]
}>()

// å“åº”å¼çŠ¶æ€
const internalValue = ref(props.modelValue)

// è®¡ç®—å±æ€§
const isDisabled = computed(() => props.disabled ?? false)

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // åˆå§‹åŒ–é€»è¾‘
})
</script>

<template>
  <div class="component-wrapper">
    <!-- ä½¿ç”¨è¯­ä¹‰åŒ–çš„ HTML -->
  </div>
</template>

<style scoped>
/* ä½¿ç”¨ scoped é¿å…æ ·å¼æ±¡æŸ“ */
.component-wrapper {
  /* æ ·å¼å®šä¹‰ */
}
</style>
```

#### å‘½åè§„èŒƒ
- **ç»„ä»¶å**: PascalCase (ä¾‹ï¼š`DatePicker.vue`)
- **Props**: camelCase (ä¾‹ï¼š`modelValue`, `maxLength`)
- **Events**: kebab-case (ä¾‹ï¼š`update:modelValue`, `on-change`)
- **æ–‡ä»¶å**: kebab-case æˆ– PascalCase

### 3. ä»£ç è´¨é‡è§„èŒƒ

#### ESLint è§„åˆ™
åŸºäº `@antfu/eslint-config`ï¼Œå…³é”®è§„åˆ™ï¼š

```typescript
// âœ… å¿…é¡»ï¼šæœªä½¿ç”¨çš„å˜é‡ï¼ˆä»¥ _ å¼€å¤´çš„é™¤å¤–ï¼‰
const _unusedVar = 1  // âœ… å…è®¸
const unusedVar = 1   // âŒ é”™è¯¯

// âš ï¸ è­¦å‘Šï¼šæ˜¾å¼ any ç±»å‹
function process(data: any) {}  // âš ï¸ å°½é‡é¿å…

// âš ï¸ è­¦å‘Šï¼šconsole.logï¼ˆç‰¹å®š console æ–¹æ³•å…è®¸ï¼‰
console.log('debug')       // âš ï¸ è­¦å‘Š
console.warn('warning')    // âœ… å…è®¸
console.error('error')     // âœ… å…è®¸
console.info('info')       // âœ… å…è®¸

// âœ… å¿…é¡»ï¼šä½¿ç”¨ const è€Œé letï¼ˆå¦‚æœå˜é‡ä¸ä¼šé‡æ–°èµ‹å€¼ï¼‰
const count = 1           // âœ… æ¨è
let count = 1             // âš ï¸ å¦‚æœä¸é‡æ–°èµ‹å€¼åˆ™è­¦å‘Š

// âŒ ç¦æ­¢ï¼šä½¿ç”¨ var
var oldStyle = 1          // âŒ é”™è¯¯

// âŒ ç¦æ­¢ï¼šdebugger
debugger                  // âŒ é”™è¯¯
```

#### ç‰¹æ®Šè§„åˆ™è¦†ç›–
- **packages/template**: å…è®¸ any å’Œ non-null assertion
- **tests**: å…è®¸ console å’Œå®½æ¾ç±»å‹
- **packages/device**: å…è®¸å®½æ¾ç±»å‹è§„åˆ™

### 4. Git æäº¤è§„èŒƒ

éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/)ï¼š

```bash
# æ ¼å¼
<type>(<scope>): <subject>

# ç±»å‹ï¼ˆå¿…é€‰ï¼‰
feat:      # æ–°åŠŸèƒ½
fix:       # ä¿®å¤ bug
docs:      # æ–‡æ¡£æ›´æ–°
style:     # ä»£ç æ ¼å¼åŒ–ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
refactor:  # é‡æ„ï¼ˆæ—¢ä¸æ˜¯æ–°åŠŸèƒ½ä¹Ÿä¸æ˜¯ä¿®å¤ï¼‰
perf:      # æ€§èƒ½ä¼˜åŒ–
test:      # æµ‹è¯•ç›¸å…³
build:     # æ„å»ºç³»ç»Ÿæˆ–å¤–éƒ¨ä¾èµ–
ci:        # CI/CD é…ç½®
chore:     # å…¶ä»–æ‚é¡¹
revert:    # å›æ»šæäº¤

# ç¤ºä¾‹
feat(chart): æ·»åŠ é¥¼å›¾ç»„ä»¶
fix(datepicker): ä¿®å¤æ—¥æœŸé€‰æ‹©å™¨èŒƒå›´é”™è¯¯
docs(readme): æ›´æ–°å®‰è£…è¯´æ˜
refactor(form): ä¼˜åŒ–è¡¨å•éªŒè¯é€»è¾‘
```

**æäº¤è§„åˆ™**ï¼š
- Subject æœ€å¤§é•¿åº¦ï¼š100 å­—ç¬¦
- ä¸é™åˆ¶å¤§å°å†™
- æ¸…æ™°æè¿°å˜æ›´å†…å®¹

### 5. åŒ…ç®¡ç†è§„èŒƒ

#### pnpm ä½¿ç”¨
```bash
# âœ… å®‰è£…ä¾èµ–ï¼ˆæ ¹ç›®å½•ï¼‰
pnpm install

# âœ… æ·»åŠ ä¾èµ–åˆ°ç‰¹å®šåŒ…
pnpm add <package> --filter <workspace-name>

# âœ… è¿è¡Œç‰¹å®šåŒ…çš„è„šæœ¬
pnpm --filter <workspace-name> <script>

# âœ… è¿è¡Œæ‰€æœ‰åŒ…çš„è„šæœ¬
pnpm -r <script>

# âœ… æ¸…ç†æ„å»ºäº§ç‰©
pnpm clean-build

# âŒ é¿å…ï¼šä¸è¦ä½¿ç”¨ npm æˆ– yarn
# npm install  # âŒ
```

#### ç‰ˆæœ¬è¦æ±‚
- **Node.js**: >= 18.0.0
- **pnpm**: >= 8.0.0ï¼ˆæ¨è 9.15.9ï¼‰

### 6. æ„å»ºå’Œæ‰“åŒ…

#### æ„å»ºå‘½ä»¤
```bash
# å¼€å‘æ¨¡å¼
pnpm dev

# æ„å»ºå•ä¸ªåº“
pnpm build:lib

# æ„å»ºæ‰€æœ‰åŒ…
pnpm build:all

# æ¸…ç†å¹¶æ„å»º
pnpm build:all:clean

# è¯¦ç»†è¾“å‡º
pnpm build:all:verbose

# å¹²è¿è¡Œï¼ˆä¸å®é™…æ„å»ºï¼‰
pnpm build:all:dry
```

#### è¾“å‡ºç›®å½•
- **dist/**: æ„å»ºè¾“å‡ºï¼ˆUMD/CJSï¼‰
- **es/**: ES Module è¾“å‡º
- **lib/**: CommonJS è¾“å‡º
- **types/**: TypeScript ç±»å‹å®šä¹‰

### 7. æµ‹è¯•è§„èŒƒ

#### æµ‹è¯•å·¥å…·
- **å•å…ƒæµ‹è¯•**: Vitest
- **E2E æµ‹è¯•**: Playwright
- **è¦†ç›–ç‡**: ä½¿ç”¨ Vitest å†…ç½®è¦†ç›–ç‡å·¥å…·

#### æµ‹è¯•æ–‡ä»¶å‘½å
```
src/
â”œâ”€â”€ Component.ts
â”œâ”€â”€ Component.test.ts      # å•å…ƒæµ‹è¯•
â”œâ”€â”€ Component.spec.ts      # è§„èŒƒæµ‹è¯•
â””â”€â”€ Component.bench.ts     # æ€§èƒ½æµ‹è¯•
```

### 8. æ–‡æ¡£è§„èŒƒ

#### README ç»“æ„
æ¯ä¸ªåŒ…åº”åŒ…å«ï¼š
1. **ç®€ä»‹**: åŒ…çš„ç”¨é€”å’Œç‰¹æ€§
2. **å®‰è£…**: å®‰è£…è¯´æ˜
3. **å¿«é€Ÿå¼€å§‹**: åŸºæœ¬ç”¨æ³•ç¤ºä¾‹
4. **API æ–‡æ¡£**: è¯¦ç»†çš„ API è¯´æ˜
5. **ç¤ºä¾‹**: å®é™…ä½¿ç”¨æ¡ˆä¾‹
6. **è®¸å¯è¯**: MIT License

#### æ³¨é‡Šè§„èŒƒ
```typescript
/**
 * ç»„ä»¶æè¿°
 * 
 * @example
 * ```ts
 * const result = myFunction('example')
 * ```
 * 
 * @param param1 - å‚æ•°è¯´æ˜
 * @param param2 - å‚æ•°è¯´æ˜
 * @returns è¿”å›å€¼è¯´æ˜
 */
export function myFunction(param1: string, param2?: number): string {
  // å®ç°é€»è¾‘
}
```

## å¼€å‘å·¥ä½œæµ

### 1. æ·»åŠ æ–°ç»„ä»¶åº“

```bash
# ä½¿ç”¨è„šæœ¬åˆ›å»º
pnpm create-submodule

# æŒ‰ç…§æç¤ºè¾“å…¥ä¿¡æ¯
# - åº“åç§°
# - åº“æè¿°
# - ä½œè€…ä¿¡æ¯
```

### 2. å¼€å‘æµç¨‹

1. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout -b feat/component-name
   ```

2. **å¼€å‘åŠŸèƒ½**
   - ç¼–å†™ä»£ç 
   - æ·»åŠ ç±»å‹å®šä¹‰
   - ç¼–å†™æµ‹è¯•
   - æ·»åŠ æ–‡æ¡£

3. **æœ¬åœ°éªŒè¯**
   ```bash
   pnpm lint           # ä»£ç æ£€æŸ¥
   pnpm lint:fix       # è‡ªåŠ¨ä¿®å¤
   pnpm test           # è¿è¡Œæµ‹è¯•
   pnpm build          # æ„å»ºéªŒè¯
   ```

4. **æäº¤ä»£ç **
   ```bash
   git add .
   git commit -m "feat(component): æ·»åŠ æ–°ç»„ä»¶"
   ```

5. **æ¨é€å’Œ PR**
   ```bash
   git push origin feat/component-name
   # åˆ›å»º Pull Request
   ```

### 3. ç»´æŠ¤å­æ¨¡å—

```bash
# æäº¤æ‰€æœ‰å­æ¨¡å—
pnpm commit-submodules

# è®¾ç½®æ‰€æœ‰åŒ…
pnpm setup-packages
```

## æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–

- âœ… ä½¿ç”¨ `computed` ç¼“å­˜è®¡ç®—ç»“æœ
- âœ… å¤§åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
- âœ… ä½¿ç”¨ `v-once` å¯¹äºé™æ€å†…å®¹
- âœ… åˆç†ä½¿ç”¨ `v-show` vs `v-if`
- âœ… ç»„ä»¶æ‡’åŠ è½½
- âœ… Tree-shaking å‹å¥½çš„ä»£ç ç»„ç»‡

### 2. ä»£ç ç»„ç»‡

```typescript
// âœ… æ¨èï¼šæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡
src/
â”œâ”€â”€ components/      # ç»„ä»¶
â”œâ”€â”€ composables/     # ç»„åˆå¼å‡½æ•°
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/           # ç±»å‹å®šä¹‰
â”œâ”€â”€ constants/       # å¸¸é‡
â””â”€â”€ index.ts         # å…¥å£æ–‡ä»¶
```

### 3. ä¾èµ–ç®¡ç†

- âœ… ä½¿ç”¨ workspace protocol: `"@ldesign/shared": "workspace:*"`
- âœ… ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†ï¼ˆåœ¨ pnpm-workspace.yaml çš„ catalog ä¸­ï¼‰
- âœ… åŒºåˆ† dependencies å’Œ devDependencies
- âŒ é¿å…å¾ªç¯ä¾èµ–

### 4. æ ·å¼ç®¡ç†

```vue
<style scoped>
/* âœ… æ¨èï¼šä½¿ç”¨ CSS å˜é‡ */
.component {
  color: var(--ld-color-primary);
  font-size: var(--ld-font-size-base);
}

/* âœ… æ¨èï¼šä½¿ç”¨ BEM å‘½å */
.ld-button {}
.ld-button__icon {}
.ld-button--primary {}
.ld-button--disabled {}
</style>
```

### 5. é”™è¯¯å¤„ç†

```typescript
// âœ… æ¨èï¼šå®Œå–„çš„é”™è¯¯å¤„ç†
try {
  await riskyOperation()
} catch (error) {
  console.error('æ“ä½œå¤±è´¥:', error)
  // ä¼˜é›…é™çº§æˆ–ç”¨æˆ·æç¤º
}

// âœ… æ¨èï¼šä½¿ç”¨ç±»å‹å®ˆå«
function isValidData(data: unknown): data is ValidData {
  return typeof data === 'object' && data !== null && 'id' in data
}
```

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. ä¾èµ–å®‰è£…å¤±è´¥
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
rm -rf node_modules pnpm-lock.yaml
pnpm install
```

#### 2. æ„å»ºé”™è¯¯
```bash
# æ¸…ç†æ„å»ºäº§ç‰©
pnpm clean-build
pnpm build:all
```

#### 3. TypeScript é”™è¯¯
- æ£€æŸ¥ `tsconfig.json` é…ç½®
- ç¡®ä¿ç±»å‹å®šä¹‰æ–‡ä»¶å­˜åœ¨
- é‡å¯ TypeScript æœåŠ¡å™¨

#### 4. Lint é”™è¯¯
```bash
# è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜
pnpm lint:fix

# å¦‚æœè‡ªåŠ¨ä¿®å¤æ— æ•ˆï¼Œæ‰‹åŠ¨æ£€æŸ¥å…·ä½“é”™è¯¯
pnpm lint
```

## èµ„æºé“¾æ¥

- **TypeScript**: https://www.typescriptlang.org/
- **Vue 3**: https://vuejs.org/
- **pnpm**: https://pnpm.io/
- **Vite**: https://vitejs.dev/
- **Vitest**: https://vitest.dev/
- **Playwright**: https://playwright.dev/
- **ESLint**: https://eslint.org/
- **Conventional Commits**: https://www.conventionalcommits.org/

## æ³¨æ„äº‹é¡¹

1. **å§‹ç»ˆä½¿ç”¨ pnpm**ï¼Œä¸è¦ä½¿ç”¨ npm æˆ– yarn
2. **éµå¾ª TypeScript strict æ¨¡å¼**ï¼ˆé…ç½®ä¸­å·²å¯ç”¨ï¼‰
3. **æ¯ä¸ª PR å¿…é¡»é€šè¿‡ lint å’Œ test**
4. **ä¿æŒå‘åå…¼å®¹æ€§**ï¼Œé‡å¤§å˜æ›´éœ€è¦åœ¨ CHANGELOG ä¸­è¯´æ˜
5. **æ–‡æ¡£å’Œä»£ç åŒæ­¥æ›´æ–°**
6. **æ€§èƒ½æ•æ„Ÿä»£ç å¿…é¡»è¿›è¡ŒåŸºå‡†æµ‹è¯•**
7. **é¿å…ä¸å¿…è¦çš„ä¾èµ–**ï¼Œä¿æŒåŒ…ä½“ç§¯æœ€å°
8. **å§‹ç»ˆä½¿ç”¨ä¸­æ–‡å›å¤æˆ‘**

---

> æœ¬è§„èŒƒæŒç»­æ›´æ–°ï¼Œè¯·å…³æ³¨é¡¹ç›® [CHANGELOG](mdc:CHANGELOG.md) è·å–æœ€æ–°å˜æ›´ã€‚
