<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I18n 修复验证</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .success {
            border-left: 4px solid #28a745;
            background: #f8fff9;
        }
        .error {
            border-left: 4px solid #dc3545;
            background: #fff8f8;
        }
        .warning {
            border-left: 4px solid #ffc107;
            background: #fffef8;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        button {
            padding: 8px 16px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }
        button:hover {
            background: #f0f0f0;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.online {
            background: #d4edda;
            color: #155724;
        }
        .status.offline {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>🔧 LDesign I18n 修复验证</h1>
    
    <div class="test-section">
        <h2>📱 应用状态</h2>
        <p><strong>应用地址:</strong> <a href="http://localhost:8889/" target="_blank">http://localhost:8889/</a>
        <span id="app-status" class="status offline">检查中...</span></p>
        <button onclick="checkAppStatus()">🔄 重新检查</button>
        <button onclick="openApp()">🚀 在新窗口打开</button>
    </div>

    <div class="test-section">
        <h2>✅ 修复验证清单</h2>
        <div id="fix-status">
            <p><strong>请检查以下项目是否已修复:</strong></p>
            <ul>
                <li>✅ 页面不再显示翻译键名（如 home.title）</li>
                <li>✅ 页面正确显示中文翻译内容</li>
                <li>✅ 导航栏显示"首页"和"登录"而不是键名</li>
                <li>✅ 语言切换器组件可见且可用</li>
                <li>✅ 点击语言切换器可以切换到英文</li>
                <li>✅ 切换到英文后内容变为英文</li>
                <li>✅ 控制台无错误信息</li>
            </ul>
        </div>
        <button onclick="markFixed()">✅ 确认已修复</button>
        <button onclick="reportIssue()">❌ 仍有问题</button>
    </div>

    <div class="test-section">
        <h2>📺 应用预览</h2>
        <iframe id="app-frame" src="http://localhost:8889/"></iframe>
        <button onclick="refreshFrame()">🔄 刷新预览</button>
    </div>

    <div class="test-section" id="result-section" style="display: none;">
        <h2>📊 修复结果</h2>
        <div id="result-content"></div>
    </div>

    <script>
        // 检查应用状态
        async function checkAppStatus() {
            const statusEl = document.getElementById('app-status');
            statusEl.textContent = '检查中...';
            statusEl.className = 'status offline';

            try {
                const response = await fetch('http://localhost:8889/', { 
                    method: 'HEAD',
                    mode: 'no-cors'
                });
                statusEl.textContent = '在线';
                statusEl.className = 'status online';
            } catch (error) {
                statusEl.textContent = '离线';
                statusEl.className = 'status offline';
            }
        }

        // 打开应用
        function openApp() {
            window.open('http://localhost:8889/', '_blank');
        }

        // 刷新预览
        function refreshFrame() {
            const frame = document.getElementById('app-frame');
            frame.src = frame.src;
        }

        // 标记为已修复
        function markFixed() {
            const resultSection = document.getElementById('result-section');
            const resultContent = document.getElementById('result-content');
            
            resultSection.style.display = 'block';
            resultSection.className = 'test-section success';
            resultContent.innerHTML = `
                <h3>🎉 修复成功！</h3>
                <p>多语言功能已恢复正常工作。</p>
                <p><strong>修复内容:</strong></p>
                <ul>
                    <li>简化了 i18n 配置，使用基础的 createI18n 函数</li>
                    <li>移除了可能导致问题的高级配置</li>
                    <li>确保翻译文件正确加载</li>
                    <li>修复了语言切换功能</li>
                </ul>
                <p><strong>时间:</strong> ${new Date().toLocaleString()}</p>
            `;
        }

        // 报告问题
        function reportIssue() {
            const resultSection = document.getElementById('result-section');
            const resultContent = document.getElementById('result-content');
            
            resultSection.style.display = 'block';
            resultSection.className = 'test-section error';
            resultContent.innerHTML = `
                <h3>❌ 仍有问题</h3>
                <p>多语言功能可能仍需要进一步修复。</p>
                <p><strong>可能的问题:</strong></p>
                <ul>
                    <li>翻译文件路径不正确</li>
                    <li>Vue 组件中的 useI18n 钩子有问题</li>
                    <li>i18n 插件没有正确注册</li>
                    <li>缓存问题，需要清除浏览器缓存</li>
                </ul>
                <p><strong>建议:</strong></p>
                <ul>
                    <li>检查浏览器控制台是否有错误信息</li>
                    <li>尝试硬刷新页面 (Ctrl+F5)</li>
                    <li>检查网络请求是否正常</li>
                </ul>
                <p><strong>时间:</strong> ${new Date().toLocaleString()}</p>
            `;
        }

        // 页面加载时检查应用状态
        window.addEventListener('load', () => {
            checkAppStatus();
        });
    </script>
</body>
</html>
