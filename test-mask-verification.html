<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picker é®ç½©æ•ˆæœéªŒè¯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            margin-bottom: 30px;
            color: #333;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .test-card h3 {
            margin-bottom: 15px;
            color: #444;
            font-size: 16px;
        }
        
        .test-card .description {
            color: #666;
            font-size: 13px;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .picker-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            padding: 20px;
            background: #fafafa;
            border-radius: 8px;
            position: relative;
        }
        
        .picker-wrapper.dark {
            background: #1a1a1a;
        }
        
        .picker-wrapper.gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .picker-wrapper.image {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><rect width="100" height="100" fill="%23f0f0f0"/><rect x="0" y="0" width="50" height="50" fill="%23e0e0e0"/><rect x="50" y="50" width="50" height="50" fill="%23e0e0e0"/></svg>');
            background-size: 20px 20px;
        }
        
        .controls {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .controls h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 14px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-size: 13px;
        }
        
        .control-group input[type="range"] {
            width: 100%;
        }
        
        .control-group input[type="color"] {
            width: 60px;
            height: 30px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .control-group .value {
            display: inline-block;
            margin-left: 10px;
            color: #666;
            font-size: 12px;
            font-family: monospace;
        }
        
        .debug-panel {
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
        }
        
        .debug-panel h4 {
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .debug-info {
            background: white;
            padding: 10px;
            border-radius: 4px;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        button {
            padding: 8px 16px;
            background: #1d4ed8;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #1e40af;
        }
        
        button.secondary {
            background: #6b7280;
        }
        
        button.secondary:hover {
            background: #4b5563;
        }
        
        .mask-preview {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .mask-preview h4 {
            margin-bottom: 10px;
            font-size: 13px;
            color: #555;
        }
        
        .mask-visual {
            width: 100%;
            height: 150px;
            border-radius: 6px;
            position: relative;
            background: #f9fafb;
            overflow: hidden;
        }
        
        .mask-visual-content {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            padding: 10px;
            font-size: 12px;
            color: #666;
        }
        
        .mask-visual-overlay {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-indicator.success {
            background: #10b981;
        }
        
        .status-indicator.warning {
            background: #f59e0b;
        }
        
        .status-indicator.error {
            background: #ef4444;
        }
        
        .tips {
            margin-top: 30px;
            padding: 20px;
            background: #fef3c7;
            border-radius: 8px;
            border: 1px solid #fcd34d;
        }
        
        .tips h3 {
            margin-bottom: 10px;
            color: #92400e;
            font-size: 16px;
        }
        
        .tips ul {
            margin-left: 20px;
            color: #78350f;
            font-size: 14px;
            line-height: 1.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ Picker é®ç½©æ•ˆæœéªŒè¯</h1>
        
        <div class="test-grid">
            <!-- åŸºç¡€é®ç½©æµ‹è¯• -->
            <div class="test-card">
                <h3>ğŸ“¦ åŸºç¡€é®ç½©æ•ˆæœ</h3>
                <p class="description">æ ‡å‡†é…ç½®ä¸‹çš„é®ç½©æ¸å˜æ•ˆæœï¼Œåº”è¯¥åœ¨é¡¶éƒ¨å’Œåº•éƒ¨æ˜¾ç¤ºæ¸éšæ•ˆæœ</p>
                <div class="picker-wrapper">
                    <ldesign-picker 
                        id="picker-basic"
                        value="item3"
                        options='[
                            {"value": "item1", "label": "é€‰é¡¹ 1"},
                            {"value": "item2", "label": "é€‰é¡¹ 2"},
                            {"value": "item3", "label": "é€‰é¡¹ 3"},
                            {"value": "item4", "label": "é€‰é¡¹ 4"},
                            {"value": "item5", "label": "é€‰é¡¹ 5"},
                            {"value": "item6", "label": "é€‰é¡¹ 6"},
                            {"value": "item7", "label": "é€‰é¡¹ 7"}
                        ]'
                        visible-items="5"
                    ></ldesign-picker>
                </div>
                <div class="mask-preview">
                    <h4>é®ç½©æ•ˆæœé¢„è§ˆ</h4>
                    <div class="mask-visual">
                        <div class="mask-visual-content">
                            <div>é¡¶éƒ¨æ¸éšåŒºåŸŸ</div>
                            <div>â†‘</div>
                            <div>å¯è§å†…å®¹åŒºåŸŸ</div>
                            <div>â†“</div>
                            <div>åº•éƒ¨æ¸éšåŒºåŸŸ</div>
                        </div>
                        <div class="mask-visual-overlay" style="
                            background: white;
                            -webkit-mask-image: linear-gradient(
                                to bottom,
                                transparent 0%,
                                transparent 5%,
                                black 20%,
                                black 80%,
                                transparent 95%,
                                transparent 100%
                            );
                            mask-image: linear-gradient(
                                to bottom,
                                transparent 0%,
                                transparent 5%,
                                black 20%,
                                black 80%,
                                transparent 95%,
                                transparent 100%
                            );
                        "></div>
                    </div>
                </div>
            </div>
            
            <!-- æš—è‰²ä¸»é¢˜é®ç½© -->
            <div class="test-card">
                <h3>ğŸŒ™ æš—è‰²ä¸»é¢˜é®ç½©</h3>
                <p class="description">æš—è‰²èƒŒæ™¯ä¸‹çš„é®ç½©æ•ˆæœï¼Œé®ç½©åº”ä¸èƒŒæ™¯è‰²åŒ¹é…</p>
                <div class="picker-wrapper dark">
                    <ldesign-picker 
                        id="picker-dark"
                        theme="dark"
                        value="item3"
                        options='[
                            {"value": "item1", "label": "Dark 1"},
                            {"value": "item2", "label": "Dark 2"},
                            {"value": "item3", "label": "Dark 3"},
                            {"value": "item4", "label": "Dark 4"},
                            {"value": "item5", "label": "Dark 5"},
                            {"value": "item6", "label": "Dark 6"},
                            {"value": "item7", "label": "Dark 7"}
                        ]'
                        visible-items="5"
                    ></ldesign-picker>
                </div>
            </div>
            
            <!-- 3Dæ•ˆæœé®ç½© -->
            <div class="test-card">
                <h3>ğŸ­ 3Dæ•ˆæœé®ç½©</h3>
                <p class="description">å¯ç”¨3Dé€è§†æ•ˆæœæ—¶çš„é®ç½©è¡¨ç°</p>
                <div class="picker-wrapper">
                    <ldesign-picker 
                        id="picker-3d"
                        enable3d="true"
                        value="item3"
                        options='[
                            {"value": "item1", "label": "3D Item 1"},
                            {"value": "item2", "label": "3D Item 2"},
                            {"value": "item3", "label": "3D Item 3"},
                            {"value": "item4", "label": "3D Item 4"},
                            {"value": "item5", "label": "3D Item 5"}
                        ]'
                        visible-items="3"
                    ></ldesign-picker>
                </div>
            </div>
            
            <!-- å¤§é‡é€‰é¡¹é®ç½© -->
            <div class="test-card">
                <h3>ğŸ“š å¤§é‡é€‰é¡¹é®ç½©</h3>
                <p class="description">é€‰é¡¹è¾ƒå¤šæ—¶çš„é®ç½©æ•ˆæœ</p>
                <div class="picker-wrapper">
                    <ldesign-picker 
                        id="picker-many"
                        value="option10"
                        visible-items="7"
                    ></ldesign-picker>
                </div>
            </div>
            
            <!-- æ¸å˜èƒŒæ™¯é®ç½© -->
            <div class="test-card">
                <h3>ğŸŒˆ æ¸å˜èƒŒæ™¯é®ç½©</h3>
                <p class="description">åœ¨æ¸å˜èƒŒæ™¯ä¸Šçš„é®ç½©æ•ˆæœ</p>
                <div class="picker-wrapper gradient">
                    <ldesign-picker 
                        id="picker-gradient"
                        value="item3"
                        options='[
                            {"value": "item1", "label": "å½©è™¹ 1"},
                            {"value": "item2", "label": "å½©è™¹ 2"},
                            {"value": "item3", "label": "å½©è™¹ 3"},
                            {"value": "item4", "label": "å½©è™¹ 4"},
                            {"value": "item5", "label": "å½©è™¹ 5"}
                        ]'
                        visible-items="3"
                        style="--ldesign-picker-bg: rgba(255, 255, 255, 0.95);"
                    ></ldesign-picker>
                </div>
            </div>
            
            <!-- è‡ªå®šä¹‰é®ç½©æ ·å¼ -->
            <div class="test-card">
                <h3>ğŸ¨ è‡ªå®šä¹‰é®ç½©æ ·å¼</h3>
                <p class="description">é€šè¿‡CSSå˜é‡è‡ªå®šä¹‰é®ç½©æ•ˆæœ</p>
                <div class="picker-wrapper">
                    <ldesign-picker 
                        id="picker-custom"
                        value="item3"
                        options='[
                            {"value": "item1", "label": "Custom 1"},
                            {"value": "item2", "label": "Custom 2"},
                            {"value": "item3", "label": "Custom 3"},
                            {"value": "item4", "label": "Custom 4"},
                            {"value": "item5", "label": "Custom 5"}
                        ]'
                        visible-items="5"
                        style="
                            --ldesign-picker-bg: #e8f5e9;
                            --ldesign-picker-active-color: #2e7d32;
                            --ldesign-picker-border: #81c784;
                        "
                    ></ldesign-picker>
                </div>
            </div>
        </div>
        
        <!-- åŠ¨æ€æ§åˆ¶é¢æ¿ -->
        <div class="controls">
            <h3>ğŸ”§ åŠ¨æ€é®ç½©æ§åˆ¶</h3>
            
            <div class="control-group">
                <label>é€‰æ‹©æµ‹è¯•ç»„ä»¶:</label>
                <select id="targetPicker" onchange="updateTarget()">
                    <option value="picker-basic">åŸºç¡€é®ç½©</option>
                    <option value="picker-dark">æš—è‰²ä¸»é¢˜</option>
                    <option value="picker-3d">3Dæ•ˆæœ</option>
                    <option value="picker-many">å¤§é‡é€‰é¡¹</option>
                    <option value="picker-gradient">æ¸å˜èƒŒæ™¯</option>
                    <option value="picker-custom">è‡ªå®šä¹‰æ ·å¼</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>é®ç½©æ¸å˜èµ·å§‹ä½ç½®: <span class="value" id="gradientStart">5%</span></label>
                <input type="range" id="maskGradientStart" min="0" max="30" value="5" oninput="updateMaskGradient()">
            </div>
            
            <div class="control-group">
                <label>é®ç½©æ¸å˜ç»“æŸä½ç½®: <span class="value" id="gradientEnd">20%</span></label>
                <input type="range" id="maskGradientEnd" min="10" max="50" value="20" oninput="updateMaskGradient()">
            </div>
            
            <div class="control-group">
                <label>èƒŒæ™¯è‰²:</label>
                <input type="color" id="bgColor" value="#ffffff" oninput="updateBackgroundColor()">
                <span class="value" id="bgColorValue">#ffffff</span>
            </div>
            
            <div class="button-group">
                <button onclick="inspectMask()">ğŸ” æ£€æŸ¥é®ç½©å…ƒç´ </button>
                <button onclick="toggleMask()" class="secondary">ğŸ‘ï¸ åˆ‡æ¢é®ç½©æ˜¾ç¤º</button>
                <button onclick="resetStyles()" class="secondary">ğŸ”„ é‡ç½®æ ·å¼</button>
            </div>
        </div>
        
        <!-- è°ƒè¯•é¢æ¿ -->
        <div class="debug-panel">
            <h4>ğŸ› è°ƒè¯•ä¿¡æ¯</h4>
            <div class="debug-info" id="debugInfo">
                ç­‰å¾…æ£€æŸ¥...
            </div>
        </div>
        
        <!-- æç¤ºä¿¡æ¯ -->
        <div class="tips">
            <h3>ğŸ’¡ éªŒè¯è¦ç‚¹</h3>
            <ul>
                <li>é®ç½©åº”è¯¥åœ¨åˆ—è¡¨çš„é¡¶éƒ¨å’Œåº•éƒ¨åˆ›å»ºæ¸éšæ•ˆæœ</li>
                <li>é®ç½©é¢œè‰²åº”è¯¥ä¸èƒŒæ™¯è‰²åŒ¹é…ï¼Œå®ç°è‡ªç„¶çš„æ·¡å‡ºæ•ˆæœ</li>
                <li>æ»šåŠ¨æ—¶ï¼Œé¡¹ç›®åº”è¯¥åœ¨è¿›å…¥/ç¦»å¼€é®ç½©åŒºåŸŸæ—¶é€æ¸æ˜¾ç¤º/éšè—</li>
                <li>3Dæ•ˆæœä¸‹ï¼Œé®ç½©åº”è¯¥æ­£ç¡®è¦†ç›–é€è§†å˜æ¢çš„å…ƒç´ </li>
                <li>æš—è‰²ä¸»é¢˜ä¸‹ï¼Œé®ç½©åº”è¯¥ä½¿ç”¨ç›¸åº”çš„æš—è‰²æ¸å˜</li>
                <li>é®ç½©ä¸åº”è¯¥å½±å“äº¤äº’ï¼Œpointer-events åº”è¯¥è®¾ç½®ä¸º none</li>
            </ul>
        </div>
    </div>
    
    <!-- å¼•å…¥ç»„ä»¶ -->
    <script type="module" src="./packages/webcomponent/dist/ldesign.es.js"></script>
    
    <script>
        // ç”Ÿæˆå¤§é‡é€‰é¡¹
        window.addEventListener('DOMContentLoaded', () => {
            const manyPicker = document.getElementById('picker-many');
            const manyOptions = [];
            for (let i = 1; i <= 30; i++) {
                manyOptions.push({
                    value: `option${i}`,
                    label: `é€‰é¡¹ ${i.toString().padStart(2, '0')}`
                });
            }
            manyPicker.setAttribute('options', JSON.stringify(manyOptions));
        });
        
        let currentTarget = 'picker-basic';
        
        function updateTarget() {
            currentTarget = document.getElementById('targetPicker').value;
            inspectMask();
        }
        
        function updateMaskGradient() {
            const start = document.getElementById('maskGradientStart').value;
            const end = document.getElementById('maskGradientEnd').value;
            
            document.getElementById('gradientStart').textContent = start + '%';
            document.getElementById('gradientEnd').textContent = end + '%';
            
            const picker = document.getElementById(currentTarget);
            if (!picker || !picker.shadowRoot) return;
            
            const mask = picker.shadowRoot.querySelector('.ldesign-picker__mask');
            if (mask) {
                const gradient = `linear-gradient(
                    to bottom,
                    transparent 0%,
                    transparent ${start}%,
                    black ${end}%,
                    black ${100 - end}%,
                    transparent ${100 - start}%,
                    transparent 100%
                )`;
                
                mask.style.webkitMaskImage = gradient;
                mask.style.maskImage = gradient;
                
                updateDebugInfo();
            }
        }
        
        function updateBackgroundColor() {
            const color = document.getElementById('bgColor').value;
            document.getElementById('bgColorValue').textContent = color;
            
            const picker = document.getElementById(currentTarget);
            if (picker) {
                picker.style.setProperty('--ldesign-picker-bg', color);
                updateDebugInfo();
            }
        }
        
        function inspectMask() {
            const picker = document.getElementById(currentTarget);
            if (!picker || !picker.shadowRoot) {
                document.getElementById('debugInfo').textContent = 'âš ï¸ æœªæ‰¾åˆ°ç»„ä»¶æˆ– Shadow DOM';
                return;
            }
            
            const mask = picker.shadowRoot.querySelector('.ldesign-picker__mask');
            if (!mask) {
                document.getElementById('debugInfo').textContent = 'âŒ æœªæ‰¾åˆ°é®ç½©å…ƒç´  .ldesign-picker__mask';
                return;
            }
            
            const styles = window.getComputedStyle(mask);
            const debugInfo = {
                'å…ƒç´ çŠ¶æ€': 'âœ… é®ç½©å…ƒç´ å­˜åœ¨',
                'ä½ç½®': styles.position,
                'z-index': styles.zIndex,
                'é«˜åº¦': styles.height,
                'èƒŒæ™¯è‰²': styles.backgroundColor,
                'mask-image': styles.maskImage || styles.webkitMaskImage || 'æœªè®¾ç½®',
                'pointer-events': styles.pointerEvents,
                'display': styles.display,
                'visibility': styles.visibility,
                'opacity': styles.opacity,
                'è¾¹ç•Œ': `top: ${styles.top}, left: ${styles.left}, right: ${styles.right}`,
                'CSSå˜é‡ (--ldesign-picker-bg)': getComputedStyle(picker).getPropertyValue('--ldesign-picker-bg') || 'æœªå®šä¹‰'
            };
            
            let output = '';
            for (const [key, value] of Object.entries(debugInfo)) {
                output += `${key}: ${value}\n`;
            }
            
            document.getElementById('debugInfo').textContent = output;
        }
        
        function toggleMask() {
            const picker = document.getElementById(currentTarget);
            if (!picker || !picker.shadowRoot) return;
            
            const mask = picker.shadowRoot.querySelector('.ldesign-picker__mask');
            if (mask) {
                const currentDisplay = mask.style.display;
                mask.style.display = currentDisplay === 'none' ? '' : 'none';
                
                updateDebugInfo();
            }
        }
        
        function resetStyles() {
            const picker = document.getElementById(currentTarget);
            if (!picker) return;
            
            // ç§»é™¤å†…è”æ ·å¼
            picker.removeAttribute('style');
            
            // é‡ç½®æ§ä»¶
            document.getElementById('maskGradientStart').value = 5;
            document.getElementById('maskGradientEnd').value = 20;
            document.getElementById('bgColor').value = '#ffffff';
            
            document.getElementById('gradientStart').textContent = '5%';
            document.getElementById('gradientEnd').textContent = '20%';
            document.getElementById('bgColorValue').textContent = '#ffffff';
            
            if (picker.shadowRoot) {
                const mask = picker.shadowRoot.querySelector('.ldesign-picker__mask');
                if (mask) {
                    mask.removeAttribute('style');
                }
            }
            
            updateDebugInfo();
        }
        
        function updateDebugInfo() {
            setTimeout(inspectMask, 100);
        }
        
        // åˆå§‹æ£€æŸ¥
        setTimeout(inspectMask, 1000);
    </script>
</body>
</html>