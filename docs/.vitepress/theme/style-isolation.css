/**
 * 高级样式隔离配置
 * 解决 VitePress 与 Stencil 组件的深层样式冲突
 */

/* 1. 全局重置 - 防止 VitePress 样式继承到 Web Components */
:root {
  /* 为 Stencil 组件定义独立的 CSS 变量空间 */
  --ld-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  --ld-font-size-base: 14px;
  --ld-line-height-base: 1.5;
}

/* 2. Shadow DOM 样式隔离增强 */
ld-button,
ld-input,
ld-card,
ld-popup,
ld-popconfirm {
  /* 完全重置所有可能的样式继承 */
  all: initial;
  
  /* 重新设置基础显示属性 */
  display: inline-block;
  box-sizing: border-box;
  
  /* 确保字体不被 VitePress 覆盖 */
  font-family: var(--ld-font-family);
  font-size: var(--ld-font-size-base);
  line-height: var(--ld-line-height-base);
  
  /* 防止 CSS 变量污染 */
  color: initial;
  background: initial;
  border: initial;
  margin: 0;
  padding: 0;
  
  /* 确保正确的渲染上下文 */
  position: relative;
  vertical-align: baseline;
}

/* 3. 特殊组件的显示模式调整 */
ld-card {
  display: block;
  width: 100%;
  max-width: 100%;
}

ld-input {
  display: inline-flex;
  vertical-align: middle;
}

/* 4. 防止 VitePress 的内容样式渗透到 Shadow DOM */
.vp-doc *:is(ld-button, ld-input, ld-card, ld-popup, ld-popconfirm) {
  all: initial !important;
}

.vp-doc *:is(ld-button, ld-input, ld-card, ld-popup, ld-popconfirm) * {
  all: unset !important;
}

/* 5. 确保伪元素不被 VitePress 样式影响 */
ld-button::before,
ld-button::after,
ld-input::before,
ld-input::after,
ld-card::before,
ld-card::after {
  all: initial;
  content: none;
}

/* 6. 阻止 VitePress 的 CSS 选择器影响组件 */
.vp-doc h1 ld-button,
.vp-doc h2 ld-button,
.vp-doc h3 ld-button,
.vp-doc h4 ld-button,
.vp-doc h5 ld-button,
.vp-doc h6 ld-button,
.vp-doc p ld-button,
.vp-doc div ld-button,
.vp-doc span ld-button {
  all: initial;
  display: inline-block;
  font-family: var(--ld-font-family);
}

/* 7. 组件间距控制 */
.demo-block ld-button:not(:last-child) {
  margin-right: 8px;
}

.demo-block ld-card:not(:last-child) {
  margin-bottom: 16px;
}

/* 8. 确保 Shadow DOM 边界 */
ld-button,
ld-input,
ld-card,
ld-popup,
ld-popconfirm {
  /* 创建新的层叠上下文 */
  isolation: isolate;
  
  /* 确保事件处理正确 */
  pointer-events: auto;
  
  /* 防止被父容器的 CSS 影响 */
  contain: style layout;
}

/* 9. 弹出层组件的特殊处理 */
ld-popup,
ld-popconfirm {
  z-index: 10000;
  position: absolute;
}

/* 10. 响应式设计支持 */
@media (max-width: 768px) {
  .demo-block ld-button {
    margin-right: 4px;
    margin-bottom: 8px;
  }
  
  .demo-block ld-card {
    margin-bottom: 12px;
  }
}

/* 11. 深色模式适配 */
.dark ld-button,
.dark ld-input,
.dark ld-card,
.dark ld-popup,
.dark ld-popconfirm {
  /* 确保在深色模式下组件不被 VitePress 主题影响 */
  color-scheme: initial;
}

/* 12. 处理可能的焦点样式冲突 */
ld-button:focus,
ld-input:focus {
  outline: none; /* 让组件内部处理焦点样式 */
}

/* 13. 确保组件的 slot 内容不受影响 */
ld-button slot,
ld-input slot,
ld-card slot {
  all: initial;
  display: contents;
}