<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picker è¾¹ç•Œæµ‹è¯• - ä¿®å¤ç‰ˆ</title>
    <script type="module" src="./packages/webcomponent/dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
    <link rel="stylesheet" href="./packages/webcomponent/dist/ldesign-webcomponent/ldesign-webcomponent.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            margin-top: 0;
            color: #333;
            font-size: 28px;
            text-align: center;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .test-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }
        
        .test-title {
            font-weight: 600;
            margin-bottom: 20px;
            color: #495057;
            text-align: center;
        }
        
        .picker-wrapper {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            background: #e7f5ff;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
        }
        
        .status code {
            background: #1c7ed6;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            line-height: 1.8;
        }
        
        .instructions h2 {
            margin-top: 0;
            color: #856404;
            font-size: 18px;
        }
        
        .instructions ul {
            margin: 10px 0;
            padding-left: 25px;
        }
        
        .instructions li {
            margin: 8px 0;
        }
        
        .test-controls {
            margin-top: 20px;
            text-align: center;
        }
        
        .test-btn {
            padding: 10px 20px;
            margin: 0 5px;
            border: none;
            border-radius: 6px;
            background: #339af0;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .test-btn:hover {
            background: #228be6;
        }
        
        .test-btn.danger {
            background: #f03e3e;
        }
        
        .test-btn.danger:hover {
            background: #e03131;
        }
        
        .log-output {
            margin-top: 20px;
            padding: 15px;
            background: #f1f3f5;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
            min-height: 80px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Picker ç»„ä»¶è¾¹ç•Œæµ‹è¯•</h1>
        
        <div class="instructions">
            <h2>âš ï¸ æµ‹è¯•è¯´æ˜</h2>
            <ul>
                <li><strong>æµ‹è¯•ç›®æ ‡ï¼š</strong>éªŒè¯é€‰æ‹©å™¨åœ¨è¾¹ç•Œä½ç½®çš„è¡Œä¸º</li>
                <li><strong>é¢„æœŸè¡Œä¸ºï¼š</strong>
                    <ul>
                        <li>ç¬¬ä¸€é¡¹å±…ä¸­åï¼Œå‘ä¸Šæ»šåŠ¨åº”è¯¥å®Œå…¨åœæ­¢</li>
                        <li>æœ€åä¸€é¡¹å±…ä¸­åï¼Œå‘ä¸‹æ»šåŠ¨åº”è¯¥å®Œå…¨åœæ­¢</li>
                        <li>è¾¹ç•Œé¡¹åº”è¯¥ç²¾ç¡®å¯¹é½åˆ°ä¸­å¿ƒæŒ‡ç¤ºå™¨</li>
                    </ul>
                </li>
                <li><strong>æ“ä½œæ–¹å¼ï¼š</strong>ä½¿ç”¨é¼ æ ‡æ»šè½®æˆ–ç‚¹å‡»æµ‹è¯•æŒ‰é’®</li>
            </ul>
        </div>
        
        <div class="test-grid">
            <!-- æµ‹è¯•1ï¼šå°‘é‡é€‰é¡¹ -->
            <div class="test-card">
                <div class="test-title">æµ‹è¯• 1ï¼š5ä¸ªé€‰é¡¹</div>
                <div class="picker-wrapper">
                    <ldesign-picker id="picker1" visible-items="5"></ldesign-picker>
                </div>
                <div class="status">
                    å½“å‰å€¼: <code id="value1">-</code>
                </div>
                <div class="test-controls">
                    <button class="test-btn" onclick="scrollToFirst('picker1')">æ»šåˆ°ç¬¬ä¸€é¡¹</button>
                    <button class="test-btn danger" onclick="scrollToLast('picker1')">æ»šåˆ°æœ€åé¡¹</button>
                </div>
                <div class="log-output" id="log1">æ—¥å¿—è¾“å‡º...</div>
            </div>
            
            <!-- æµ‹è¯•2ï¼šé€‚ä¸­é€‰é¡¹ -->
            <div class="test-card">
                <div class="test-title">æµ‹è¯• 2ï¼š10ä¸ªé€‰é¡¹</div>
                <div class="picker-wrapper">
                    <ldesign-picker id="picker2" visible-items="5"></ldesign-picker>
                </div>
                <div class="status">
                    å½“å‰å€¼: <code id="value2">-</code>
                </div>
                <div class="test-controls">
                    <button class="test-btn" onclick="scrollToFirst('picker2')">æ»šåˆ°ç¬¬ä¸€é¡¹</button>
                    <button class="test-btn danger" onclick="scrollToLast('picker2')">æ»šåˆ°æœ€åé¡¹</button>
                </div>
                <div class="log-output" id="log2">æ—¥å¿—è¾“å‡º...</div>
            </div>
            
            <!-- æµ‹è¯•3ï¼šå¤§é‡é€‰é¡¹ -->
            <div class="test-card">
                <div class="test-title">æµ‹è¯• 3ï¼š30ä¸ªé€‰é¡¹</div>
                <div class="picker-wrapper">
                    <ldesign-picker id="picker3" visible-items="7"></ldesign-picker>
                </div>
                <div class="status">
                    å½“å‰å€¼: <code id="value3">-</code>
                </div>
                <div class="test-controls">
                    <button class="test-btn" onclick="scrollToFirst('picker3')">æ»šåˆ°ç¬¬ä¸€é¡¹</button>
                    <button class="test-btn danger" onclick="scrollToLast('picker3')">æ»šåˆ°æœ€åé¡¹</button>
                </div>
                <div class="log-output" id="log3">æ—¥å¿—è¾“å‡º...</div>
            </div>
        </div>
    </div>

    <script>
        // ç­‰å¾…ç»„ä»¶åŠ è½½
        customElements.whenDefined('ldesign-picker').then(() => {
            initializePickers();
        });
        
        function initializePickers() {
            // åˆå§‹åŒ–ç¬¬1ä¸ªé€‰æ‹©å™¨
            const picker1 = document.getElementById('picker1');
            const options1 = Array.from({length: 5}, (_, i) => ({
                value: `v${i+1}`,
                label: `é€‰é¡¹ ${i+1}`
            }));
            picker1.options = options1;
            picker1.value = 'v3';
            
            // åˆå§‹åŒ–ç¬¬2ä¸ªé€‰æ‹©å™¨
            const picker2 = document.getElementById('picker2');
            const options2 = Array.from({length: 10}, (_, i) => ({
                value: `v${i+1}`,
                label: `é€‰é¡¹ ${String(i+1).padStart(2, '0')}`
            }));
            picker2.options = options2;
            picker2.value = 'v5';
            
            // åˆå§‹åŒ–ç¬¬3ä¸ªé€‰æ‹©å™¨
            const picker3 = document.getElementById('picker3');
            const options3 = Array.from({length: 30}, (_, i) => ({
                value: `v${i+1}`,
                label: `Item ${String(i+1).padStart(2, '0')}`
            }));
            picker3.options = options3;
            picker3.value = 'v15';
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners('picker1', 'value1', 'log1', options1);
            setupEventListeners('picker2', 'value2', 'log2', options2);
            setupEventListeners('picker3', 'value3', 'log3', options3);
            
            console.log('âœ… æ‰€æœ‰Pickerç»„ä»¶å·²åˆå§‹åŒ–');
        }
        
        function setupEventListeners(pickerId, valueId, logId, options) {
            const picker = document.getElementById(pickerId);
            const valueDisplay = document.getElementById(valueId);
            const logDisplay = document.getElementById(logId);
            
            let eventCount = 0;
            
            // ç›‘å¬ change äº‹ä»¶
            picker.addEventListener('ldesignChange', (e) => {
                const opt = options.find(o => o.value === e.detail.value);
                valueDisplay.textContent = opt ? opt.label : 'æœªé€‰æ‹©';
                logDisplay.textContent = `[${++eventCount}] å€¼å˜æ›´: ${opt?.label || 'æœªçŸ¥'}`;
            });
            
            // ç›‘å¬ pick äº‹ä»¶ï¼ˆæ»šåŠ¨è¿‡ç¨‹ï¼‰
            picker.addEventListener('ldesignPick', (e) => {
                const opt = options.find(o => o.value === e.detail.value);
                const trigger = e.detail?.context?.trigger;
                logDisplay.textContent = `[${++eventCount}] ${trigger}: ${opt?.label || 'æœªçŸ¥'}`;
            });
            
            // åˆå§‹åŒ–æ˜¾ç¤º
            const currentOpt = options.find(o => o.value === picker.value);
            valueDisplay.textContent = currentOpt ? currentOpt.label : 'æœªé€‰æ‹©';
        }
        
        // æµ‹è¯•å‡½æ•°ï¼šæ»šåŠ¨åˆ°ç¬¬ä¸€é¡¹
        function scrollToFirst(pickerId) {
            const picker = document.getElementById(pickerId);
            const container = picker.querySelector('.ldesign-picker__picker');
            const logDisplay = document.getElementById(pickerId.replace('picker', 'log'));
            
            if (!container) {
                logDisplay.textContent = 'âŒ æ‰¾ä¸åˆ°å®¹å™¨';
                return;
            }
            
            logDisplay.textContent = 'â¬†ï¸ è¿ç»­å‘ä¸Šæ»šåŠ¨æµ‹è¯•...';
            
            // è¿ç»­å‘é€å‘ä¸Šæ»šåŠ¨äº‹ä»¶
            let count = 0;
            const interval = setInterval(() => {
                const wheelEvent = new WheelEvent('wheel', {
                    deltaY: -120, // è´Ÿå€¼ = å‘ä¸Šæ»šåŠ¨
                    bubbles: true,
                    cancelable: true
                });
                container.dispatchEvent(wheelEvent);
                
                count++;
                if (count >= 20) {
                    clearInterval(interval);
                    logDisplay.textContent += ' å®Œæˆï¼å¦‚æœæ­£å¸¸ï¼Œåº”è¯¥åœåœ¨ç¬¬ä¸€é¡¹ã€‚';
                }
            }, 100);
        }
        
        // æµ‹è¯•å‡½æ•°ï¼šæ»šåŠ¨åˆ°æœ€åä¸€é¡¹
        function scrollToLast(pickerId) {
            const picker = document.getElementById(pickerId);
            const container = picker.querySelector('.ldesign-picker__picker');
            const logDisplay = document.getElementById(pickerId.replace('picker', 'log'));
            
            if (!container) {
                logDisplay.textContent = 'âŒ æ‰¾ä¸åˆ°å®¹å™¨';
                return;
            }
            
            logDisplay.textContent = 'â¬‡ï¸ è¿ç»­å‘ä¸‹æ»šåŠ¨æµ‹è¯•...';
            
            // è¿ç»­å‘é€å‘ä¸‹æ»šåŠ¨äº‹ä»¶
            let count = 0;
            const interval = setInterval(() => {
                const wheelEvent = new WheelEvent('wheel', {
                    deltaY: 120, // æ­£å€¼ = å‘ä¸‹æ»šåŠ¨
                    bubbles: true,
                    cancelable: true
                });
                container.dispatchEvent(wheelEvent);
                
                count++;
                if (count >= 30) {
                    clearInterval(interval);
                    logDisplay.textContent += ' å®Œæˆï¼å¦‚æœæ­£å¸¸ï¼Œåº”è¯¥åœåœ¨æœ€åä¸€é¡¹ã€‚';
                }
            }, 100);
        }
    </script>
</body>
</html>