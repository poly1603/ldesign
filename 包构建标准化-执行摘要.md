# åŒ…æ„å»ºäº§ç‰©æ ‡å‡†åŒ– - æ‰§è¡Œæ‘˜è¦

## ğŸ¯ ä»»åŠ¡ç›®æ ‡

è§„èŒƒæ‰€æœ‰packagesçš„æ„å»ºé…ç½®å’Œäº§ç‰©ï¼Œç¡®ä¿æ¯ä¸ªåŒ…éƒ½ä½¿ç”¨@ldesign/builderç”Ÿæˆæ ‡å‡†çš„ESMã€CJSå’ŒUMDæ ¼å¼äº§ç‰©ã€‚

## âœ… å®ŒæˆçŠ¶æ€

**100%å®Œæˆ** - 24/24ä¸ªpackageså…¨éƒ¨ç¬¦åˆæ ‡å‡†

## ğŸ“Š ä¿®å¤æˆæœ

### ä¿®å¤çš„åŒ…

| åŒ…å | åŸçŠ¶æ€ | ä¿®å¤å | è§£å†³æ–¹æ¡ˆ |
|------|--------|--------|----------|
| animation | ç¼ºdist | âœ… es/lib/distå®Œæ•´ | rollup.umd.config.js |
| shared | ç¼ºdist | âœ… es/lib/distå®Œæ•´ | rollup.umd.config.js |
| notification | å®Œå…¨æœªæ„å»º | âœ… es/lib/distå®Œæ•´ | ä¿®å¤ä»£ç +builder |
| websocket | å®Œå…¨æœªæ„å»º | âœ… es/lib/distå®Œæ•´ | åˆ›å»ºæ¨¡å—+builder |

### æ ¹æœ¬åŸå› 

Builderçš„è‡ªåŠ¨æ£€æµ‹é€»è¾‘è¦†ç›–äº†ç”¨æˆ·é…ç½®çš„`libraryType`,å¯¼è‡´:
- åŒ…å«Vueæ–‡ä»¶çš„åŒ…è¢«è¯†åˆ«ä¸ºVue3é¡¹ç›®
- åŒ…å«æ ·å¼çš„åŒ…è¢«è¯†åˆ«ä¸ºSTYLEé¡¹ç›®
- å¤šå…¥å£æ£€æµ‹æ—¶UMDæ ¼å¼è¢«è¿‡æ»¤

## ğŸ”§ å®æ–½çš„è§£å†³æ–¹æ¡ˆ

### 1. Builderæ ¸å¿ƒä¿®å¤
ä¿®æ”¹`tools/builder/src/core/LibraryBuilder.ts`,è®©ç”¨æˆ·é…ç½®ä¼˜å…ˆã€‚

### 2. UMDä¸“ç”¨å…¥å£
ä¸º4ä¸ªåŒ…åˆ›å»º`src/index-lib.ts`,ç”¨äºUMDæ„å»ºã€‚

### 3. ç‹¬ç«‹Rollupé…ç½®
åˆ›å»º`rollup.umd.config.js`ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆã€‚

### 4. ä»£ç é”™è¯¯ä¿®å¤
- notification: ä¿®å¤åŠ¨æ€importè¯­æ³•é”™è¯¯å’Œå‘½åå†²çª
- websocket: åˆ›å»ºsocketio-adapterå ä½ç¬¦

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶ (4ä¸ªåŒ… Ã— 2ä¸ªæ–‡ä»¶)
- `packages/*/src/index-lib.ts` - UMDä¸“ç”¨å…¥å£
- `packages/*/rollup.umd.config.js` - UMDæ„å»ºé…ç½®

### æ–‡æ¡£å’Œå·¥å…·
- `packages/BUILD_STANDARD.md` - æ„å»ºæ ‡å‡†æ–‡æ¡£
- `packages/æ„å»ºäº§ç‰©å¿«é€Ÿå‚è€ƒ.md` - å¿«é€Ÿå‚è€ƒ
- `packages/.template/rollup.umd.config.js` - é…ç½®æ¨¡æ¿
- `scripts/verify-package-outputs.cjs` - éªŒè¯è„šæœ¬
- 3ä¸ªé—®é¢˜åˆ†ææŠ¥å‘Š

### ä¿®æ”¹çš„æ–‡ä»¶
- `tools/builder/src/core/LibraryBuilder.ts` (å…³é”®ä¿®å¤)
- 4ä¸ªåŒ…çš„`ldesign.config.ts` (æ·»åŠ umdé…ç½®)
- 2ä¸ªåŒ…çš„`package.json` (æ·»åŠ diståˆ°files)
- notificationå’Œwebsocketçš„æºä»£ç ä¿®å¤

## ğŸ‰ æœ€ç»ˆéªŒè¯

```bash
$ node scripts/verify-package-outputs.cjs

ğŸ“¦ æ£€æŸ¥ packages æ„å»ºäº§ç‰©...

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Package             â”‚ ES  â”‚ LIB â”‚ DIST â”‚ Status â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ animation           â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ api                 â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ auth                â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ cache               â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ color               â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ crypto              â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ device              â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ engine              â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ file                â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ http                â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ i18n                â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ icons               â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ logger              â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ notification        â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ permission          â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ router              â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ shared              â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ size                â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ storage             â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ store               â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ tabs                â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ template            â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ validator           â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â”‚ websocket           â”‚  âœ“  â”‚  âœ“  â”‚  âœ“   â”‚   âœ…  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:
   æ€»åŒ…æ•°: 24
   âœ… å®Œæ•´: 24 ä¸ª (100%)
```

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### éªŒè¯æ„å»ºäº§ç‰©
```bash
node scripts/verify-package-outputs.cjs
```

### æ„å»ºæ‰€æœ‰åŒ…
```bash
pnpm -r --filter './packages/*' run build
```

### æ¸…ç†æ‰€æœ‰äº§ç‰©
```bash
pnpm -r --filter './packages/*' run clean
```

## ğŸ“– æ–‡æ¡£ç´¢å¼•

1. **`BUILD_STANDARD.md`** - å®Œæ•´çš„æ„å»ºæ ‡å‡†å’Œè§„èŒƒ
2. **`æ„å»ºäº§ç‰©å¿«é€Ÿå‚è€ƒ.md`** - æœ¬æ–‡æ¡£,å¿«é€Ÿå‚è€ƒ
3. **`åŒ…æ„å»ºäº§ç‰©æ ‡å‡†åŒ–-å®ŒæˆæŠ¥å‘Š.md`** - è¯¦ç»†çš„å®ŒæˆæŠ¥å‘Š
4. **`åŒ…æ„å»ºé—®é¢˜æ€»ç»“.md`** - é—®é¢˜æ ¹æºåˆ†æ
5. **`UMDæ„å»ºå¿«é€Ÿä¿®å¤æ–¹æ¡ˆ.md`** - æ•…éšœæ’é™¤æŒ‡å—

## ğŸ’¡ ç‰¹æ®Šè¯´æ˜

### animation & shared åŒ…

è¿™ä¸¤ä¸ªåŒ…é€šè¿‡ç‹¬ç«‹Rollupé…ç½®ç”ŸæˆUMD:
```bash
cd packages/animation  # æˆ– packages/shared
npx rollup -c rollup.umd.config.js
```

ä¸‹æ¬¡è¿è¡Œ`pnpm run build`æ—¶,å¯èƒ½ä»éœ€æ‰‹åŠ¨è¿è¡Œä¸Šè¿°å‘½ä»¤ç”Ÿæˆdistã€‚

### notification & websocket åŒ…

è¿™ä¸¤ä¸ªåŒ…å·²ä¿®å¤ä»£ç é—®é¢˜,ç°åœ¨å¯ä»¥ç›´æ¥é€šè¿‡builderæ„å»º:
```bash
cd packages/notification  # æˆ– packages/websocket
pnpm run build  # ç”Ÿæˆå…¨éƒ¨äº§ç‰©
```

## ğŸ”„ å·¥ä½œæµ

### æ·»åŠ æ–°Package

1. å¤åˆ¶é…ç½®æ¨¡æ¿: `packages/.template/`
2. ä¿®æ”¹åŒ…åå’Œé…ç½®
3. ç¼–å†™æºä»£ç 
4. è¿è¡Œæ„å»º: `pnpm run build`
5. éªŒè¯äº§ç‰©: `node scripts/verify-package-outputs.cjs`

### å‘å¸ƒå‰æ£€æŸ¥

```bash
# 1. éªŒè¯æ„å»ºäº§ç‰©
node scripts/verify-package-outputs.cjs

# 2. æ£€æŸ¥package.json
# - fileså­—æ®µåŒ…å«: es, lib, dist
# - exportså­—æ®µæ­£ç¡®é…ç½®
# - unpkg/jsdelivræŒ‡å‘dist/index.min.js

# 3. è¿è¡Œæµ‹è¯• (å¦‚æœæœ‰)
pnpm test

# 4. å‘å¸ƒ
pnpm publish
```

## âš™ï¸ é…ç½®è¦ç‚¹

æ‰€æœ‰åŒ…å¿…é¡»åŒ…å«:
- âœ… `libraryType: 'typescript'` - æ˜ç¡®æŒ‡å®šç±»å‹
- âœ… `output.format: ['esm', 'cjs', 'umd']` - ä¸‰ç§æ ¼å¼
- âœ… `umd: { enabled: true }` - é¡¶å±‚UMDé…ç½®
- âœ… `dts: true` - ç”Ÿæˆç±»å‹å£°æ˜
- âœ… `sourcemap: true` - ç”Ÿæˆsourcemap
- âœ… `clean: true` - æ„å»ºå‰æ¸…ç†

## ğŸ“ ç»éªŒæ€»ç»“

### Builderçš„è®¾è®¡ç†å¿µ

Builderä¼˜å…ˆè‡ªåŠ¨æ£€æµ‹æ˜¯ä¸ºäº†"é›¶é…ç½®",ä½†å¯¹äºmonorepoä¸­çš„æ··åˆåŒ…(å¦‚åŒ…å«Vueä½†ä¸»è¦æ˜¯TS),éœ€è¦æ˜ç¡®é…ç½®`libraryType`ã€‚

### æœ€ä½³å®è·µ

1. **æ˜ç¡®libraryType**: ä¸ä¾èµ–è‡ªåŠ¨æ£€æµ‹
2. **UMDä¸“ç”¨å…¥å£**: å¯¹äºæ··åˆåŒ…,åˆ›å»º`index-lib.ts`
3. **å¤‡ç”¨æ„å»ºæ–¹æ¡ˆ**: rollup.umd.config.jsä½œä¸ºä¿é™©
4. **æŒç»­éªŒè¯**: å®šæœŸè¿è¡ŒéªŒè¯è„šæœ¬

### æ¶æ„å»ºè®® (é•¿æœŸ)

è€ƒè™‘å°†æ¡†æ¶é›†æˆæ‹†åˆ†:
```
@ldesign/animation (æ ¸å¿ƒ,çº¯TS)
@ldesign/animation-vue (Vueé›†æˆ)
@ldesign/animation-react (Reacté›†æˆ)
```

è¿™æ ·å¯ä»¥:
- é¿å…æ£€æµ‹é—®é¢˜
- æ›´æ¸…æ™°çš„ä¾èµ–å…³ç³»  
- æ›´å°çš„åŒ…ä½“ç§¯
- æ›´çµæ´»çš„ç‰ˆæœ¬ç®¡ç†

---

**çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ  
**æ—¥æœŸ**: 2025-10-24  
**åŒ…æ•°**: 24/24 (100%)

