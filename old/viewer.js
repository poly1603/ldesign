/*!
 * Viewer.js v1.3.2
 * https://fengyuanchen.github.io/viewerjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2019-01-24T11:01:33.473Z
 */
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.Viewer=a());
}(this,(function(){function z(bM){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){z=function(bN){return typeof bN;};}else{z=function(bN){return bN&&typeof Symbol==="function"&&bN.constructor===Symbol&&bN!==Symbol.prototype?"symbol":typeof bN;};}return z(bM);}function av(bM,bN){if(!(bM instanceof bN)){throw new TypeError("Cannot call a class as a function");
}}function bx(bP,bN){for(var bM=0;bM<bN.length;bM++){var bO=bN[bM];bO.enumerable=bO.enumerable||false;bO.configurable=true;if("value" in bO){bO.writable=true;}Object.defineProperty(bP,bO.key,bO);}}function aY(bO,bM,bN){if(bM){bx(bO.prototype,bM);}if(bN){bx(bO,bN);}return bO;}var M={backdrop:true,button:true,navbar:true,title:true,toolbar:true,className:"",container:"body",filter:null,fullscreen:true,initialViewIndex:0,inline:false,interval:5000,keyboard:true,loading:true,loop:true,minWidth:200,minHeight:100,movable:true,zoomable:true,rotatable:true,scalable:true,toggleOnDblclick:true,tooltip:true,transition:true,zIndex:2015,zIndexInline:0,zoomRatio:0.1,minZoomRatio:0.01,maxZoomRatio:100,url:"src",ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,zoom:null,zoomed:null};
var ad='<div class="viewer-container" touch-action="none"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><div class="viewer-toolbar"></div><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div role="button" class="viewer-button" data-viewer-action="mix"></div><div class="viewer-player"></div></div>';
var d=typeof window!=="undefined";var am=d?window:{};var H=d?"ontouchstart" in am.document.documentElement:false;var bm=d?"PointerEvent" in am:false;var G="viewer";var bu="move";var ai="switch";var y="zoom";var ax="".concat(G,"-active");var by="".concat(G,"-close");var c="".concat(G,"-fade");var bG="".concat(G,"-fixed");
var br="".concat(G,"-fullscreen");var bl="".concat(G,"-fullscreen-exit");var ab="".concat(G,"-hide");var bF="".concat(G,"-hide-md-down");var h="".concat(G,"-hide-sm-down");var aA="".concat(G,"-hide-xs-down");var J="".concat(G,"-in");var aa="".concat(G,"-invisible");var bg="".concat(G,"-loading");var bK="".concat(G,"-move");
var A="".concat(G,"-open");var S="".concat(G,"-show");var bn="".concat(G,"-transition");var s="click";var bz="dblclick";var I="dragstart";var a8="hidden";var ar="hide";var a="keydown";var aB="load";var bc=H?"touchstart":"mousedown";var a9=H?"touchmove":"mousemove";var C=H?"touchend touchcancel":"mouseup";
var bj=bm?"pointerdown":bc;var bp=bm?"pointermove":a9;var bA=bm?"pointerup pointercancel":C;var ac="ready";var aq="resize";var ah="show";var k="shown";var aP="transitionend";var Y="view";var bB="viewed";var aE="wheel";var ae="zoom";var ay="zoomed";var be="".concat(G,"Action");var B=/\s\s*/;var n=["zoom-in","zoom-out","one-to-one","reset","prev","next","rotate-left","rotate-right"];
var bD=["放大","缩小","原始大小","重置","上一张","下一张","向左旋转","向右旋转"];function bd(bM){return typeof bM==="string";}var az=Number.isNaN||am.isNaN;function U(bM){return typeof bM==="number"&&!az(bM);}function aI(bM){return typeof bM==="undefined";}function bI(bM){return z(bM)==="object"&&bM!==null;}var D=Object.prototype.hasOwnProperty;
function o(bO){if(!bI(bO)){return false;}try{var bP=bO.constructor;var bN=bP.prototype;return bP&&bN&&D.call(bN,"isPrototypeOf");}catch(bM){return false;}}function j(bM){return typeof bM==="function";}function af(bO,bP){if(bO&&j(bP)){if(Array.isArray(bO)||U(bO.length)){var bN=bO.length;var bM;for(bM=0;
bM<bN;bM+=1){if(bP.call(bO,bO[bM],bM,bO)===false){break;}}}else{if(bI(bO)){Object.keys(bO).forEach(function(bQ){bP.call(bO,bO[bQ],bQ,bO);});}}}return bO;}var V=Object.assign||function V(bP){for(var bM=arguments.length,bN=new Array(bM>1?bM-1:0),bO=1;bO<bM;bO++){bN[bO-1]=arguments[bO];}if(bI(bP)&&bN.length>0){bN.forEach(function(bQ){if(bI(bQ)){Object.keys(bQ).forEach(function(bR){bP[bR]=bQ[bR];
});}});}return bP;};var e=/^(?:width|height|left|top|marginLeft|marginTop)$/;function L(bM,bO){var bN=bM.style;af(bO,function(bQ,bP){if(e.test(bP)&&U(bQ)){bQ+="px";}bN[bP]=bQ;});}function r(bM,bN){return bM.classList?bM.classList.contains(bN):bM.className.indexOf(bN)>-1;}function q(bM,bO){if(!bO){return;
}if(U(bM.length)){af(bM,function(bP){q(bP,bO);});return;}if(bM.classList){bM.classList.add(bO);return;}var bN=bM.className.trim();if(!bN){bM.className=bO;}else{if(bN.indexOf(bO)<0){bM.className="".concat(bN," ").concat(bO);}}}function aT(bM,bN){if(!bN){return;}if(U(bM.length)){af(bM,function(bO){aT(bO,bN);
});return;}if(bM.classList){bM.classList.remove(bN);return;}if(bM.className.indexOf(bN)>=0){bM.className=bM.className.replace(bN,"");}}function aR(bM,bO,bN){if(!bO){return;}if(U(bM.length)){af(bM,function(bP){aR(bP,bO,bN);});return;}if(bN){q(bM,bO);}else{aT(bM,bO);}}var aZ=/([a-z\d])([A-Z])/g;function bq(bM){return bM.replace(aZ,"$1-$2").toLowerCase();
}function a4(bN,bM){if(bI(bN[bM])){return bN[bM];}if(bN.dataset){return bN.dataset[bM];}return bN.getAttribute("data-".concat(bq(bM)));}function aj(bN,bM,bO){if(bI(bO)){bN[bM]=bO;}else{if(bN.dataset){bN.dataset[bM]=bO;}else{bN.setAttribute("data-".concat(bq(bM)),bO);}}}var aD=function(){var bM=false;
if(d){var bP=false;var bQ=function bQ(){};var bO=Object.defineProperty({},"once",{get:function bN(){bM=true;return bP;},set:function bR(bS){bP=bS;}});am.addEventListener("test",bQ,bO);am.removeEventListener("test",bQ,bO);}return bM;}();function f(bN,bP,bQ){var bM=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};
var bO=bQ;bP.trim().split(B).forEach(function(bS){if(!aD){var bR=bN.listeners;if(bR&&bR[bS]&&bR[bS][bQ]){bO=bR[bS][bQ];delete bR[bS][bQ];if(Object.keys(bR[bS]).length===0){delete bR[bS];}if(Object.keys(bR).length===0){delete bN.listeners;}}}bN.removeEventListener(bS,bO,bM);});}function bi(bO,bP,bQ){var bN=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};
var bM=bQ;bP.trim().split(B).forEach(function(bU){if(bN.once&&!aD){var bR=bO.listeners,bT=bR===void 0?{}:bR;bM=function bS(){delete bT[bU][bQ];bO.removeEventListener(bU,bM,bN);for(var bV=arguments.length,bX=new Array(bV),bW=0;bW<bV;bW++){bX[bW]=arguments[bW];}bQ.apply(bO,bX);};if(!bT[bU]){bT[bU]={};}if(bT[bU][bQ]){bO.removeEventListener(bU,bT[bU][bQ],bN);
}bT[bU][bQ]=bM;bO.listeners=bT;}bO.addEventListener(bU,bM,bN);});}function aK(bM,bN,bP){var bO;if(j(Event)&&j(CustomEvent)){bO=new CustomEvent(bN,{detail:bP,bubbles:true,cancelable:true});}else{bO=document.createEvent("CustomEvent");bO.initCustomEvent(bN,true,true,bP);}return bM.dispatchEvent(bO);}function bH(bM){var bN=bM.getBoundingClientRect();
return{left:bN.left+(window.pageXOffset-document.documentElement.clientLeft),top:bN.top+(window.pageYOffset-document.documentElement.clientTop)};}function E(bR){var bQ=bR.rotate,bP=bR.scaleX,bN=bR.scaleY,bT=bR.translateX,bS=bR.translateY;var bM=[];if(U(bT)&&bT!==0){bM.push("translateX(".concat(bT,"px)"));
}if(U(bS)&&bS!==0){bM.push("translateY(".concat(bS,"px)"));}if(U(bQ)&&bQ!==0){bM.push("rotate(".concat(bQ,"deg)"));}if(U(bP)&&bP!==1){bM.push("scaleX(".concat(bP,")"));}if(U(bN)&&bN!==1){bM.push("scaleY(".concat(bN,")"));}var bO=bM.length?bM.join(" "):"none";return{WebkitTransform:bO,msTransform:bO,transform:bO};
}function bE(bM){return bd(bM)?bM.replace(/^.*\//,"").replace(/[?&#].*$/,""):"";}var bw=am.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(am.navigator.userAgent);function aW(bN,bP){var bO=document.createElement("img");if(bN.naturalWidth&&!bw){bP(bN.naturalWidth,bN.naturalHeight);return bO;
}var bM=document.body||document.documentElement;bO.onload=function(){bP(bO.width,bO.height);if(!bw){bM.removeChild(bO);}};bO.src=bN.src;if(!bw){bO.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;";
bM.appendChild(bO);}return bO;}function Q(bM){switch(bM){case 2:return aA;case 3:return h;case 4:return bF;default:return"";}}function a3(bM){var bO=V({},bM);var bN=[];af(bM,function(bQ,bP){delete bO[bP];af(bO,function(bR){var bT=Math.abs(bQ.startX-bR.startX);var bW=Math.abs(bQ.startY-bR.startY);var bS=Math.abs(bQ.endX-bR.endX);
var bU=Math.abs(bQ.endY-bR.endY);var bY=Math.sqrt(bT*bT+bW*bW);var bX=Math.sqrt(bS*bS+bU*bU);var bV=(bX-bY)/bY;bN.push(bV);});});bN.sort(function(bQ,bP){return Math.abs(bQ)<Math.abs(bP);});return bN[0];}function at(bQ,bP){var bO=bQ.pageX,bN=bQ.pageY;var bM={endX:bO,endY:bN};return bP?bM:V({timeStamp:Date.now(),startX:bO,startY:bN},bM);
}function bh(bM){var bO=0;var bN=0;var bP=0;af(bM,function(bS){var bR=bS.startX,bQ=bS.startY;bO+=bR;bN+=bQ;bP+=1;});bO/=bP;bN/=bP;return{pageX:bO,pageY:bN};}var P={render:function P(){this.initContainer();this.initViewer();this.initList();this.renderViewer();},initContainer:function bf(){this.containerData={width:window.innerWidth,height:window.innerHeight};
},initViewer:function aG(){var bM=this.options,bN=this.parent;var bO;if(bM.inline){bO={width:Math.max(bN.offsetWidth,bM.minWidth),height:Math.max(bN.offsetHeight,bM.minHeight)};this.parentData=bO;}if(this.fulled||!bO){bO=this.containerData;}this.viewerData=V({},bO);},renderViewer:function a6(){if(this.options.inline&&!this.fulled){L(this.viewer,this.viewerData);
}},initList:function bk(){var bQ=this;var bO=this.element,bN=this.options,bP=this.list;var bM=[];af(this.images,function(bU,bS){var bV=bU.src;var bT=bU.alt||bE(bV);var bR=bN.url;if(bd(bR)){bR=bU.getAttribute(bR);}else{if(j(bR)){bR=bR.call(bQ,bU);}}if(bV||bR){bM.push("<li><img"+' src="'.concat(bV||bR,'"')+' role="button" data-viewer-action="view"'+' data-index="'.concat(bS,'"')+' data-original-url="'.concat(bR||bV,'"')+' alt="'.concat(bT,'"')+"></li>");
}});bP.innerHTML=bM.join("");this.items=bP.getElementsByTagName("li");af(this.items,function(bR){var bS=bR.firstElementChild;aj(bS,"filled",true);if(bN.loading){q(bR,bg);}bi(bS,aB,function(bT){if(bN.loading){aT(bR,bg);}bQ.loadImage(bT);},{once:true});});if(bN.transition){bi(bO,bB,function(){q(bP,bn);
},{once:true});}},renderList:function K(bM){var bN=bM||this.index;var bO=this.items[bN].offsetWidth||30;var bP=bO+1;L(this.list,V({width:bP*this.length},E({translateX:(this.viewerData.width-bO)/2-bP*bN})));},resetList:function aX(){var bM=this.list;bM.innerHTML="";aT(bM,bn);L(bM,E({translateX:0}));},initImage:function bv(bR){var bU=this;
var bW=this.options,bQ=this.image,bM=this.viewerData;var bV=this.footer.offsetHeight;var bO=bM.width;var bT=Math.max(bM.height-bV,bV);var bN=this.imageData||{};var bP;this.imageInitializing={abort:function bS(){bP.onload=null;}};bP=aW(bQ,function(bZ,b2){var b1=bZ/b2;var b0=bO;var bY=bT;bU.imageInitializing=false;
if(bT*b1>bO){bY=bO/b1;}else{b0=bT*b1;}b0=Math.min(b0*0.9,bZ);bY=Math.min(bY*0.9,b2);var b3={naturalWidth:bZ,naturalHeight:b2,aspectRatio:b1,ratio:b0/bZ,width:b0,height:bY,left:(bO-b0)/2,top:(bT-bY)/2};var bX=V({},b3);if(bW.rotatable){b3.rotate=bN.rotate||0;bX.rotate=0;}if(bW.scalable){b3.scaleX=bN.scaleX||1;
b3.scaleY=bN.scaleY||1;bX.scaleX=1;bX.scaleY=1;}bU.imageData=b3;bU.initialImageData=bX;if(bR){bR();}});},renderImage:function bt(bM){var bO=this;var bP=this.image,bR=this.imageData;L(bP,V({width:bR.width,height:bR.height,marginLeft:bR.left,marginTop:bR.top},E(bR)));if(bM){if((this.viewing||this.zooming)&&this.options.transition){var bN=function bN(){bO.imageRendering=false;
bM();};this.imageRendering={abort:function bQ(){f(bP,aP,bN);}};bi(bP,aP,bN,{once:true});}else{bM();}}},resetImage:function ag(){if(this.viewing||this.viewed){var bM=this.image;if(this.viewing){this.viewing.abort();}bM.parentNode.removeChild(bM);this.image=null;}}};var bC={bind:function aJ(){var bO=this.options,bP=this.viewer,bN=this.canvas;
var bM=this.element.ownerDocument;bi(bP,s,this.onClick=this.click.bind(this));bi(bP,aE,this.onWheel=this.wheel.bind(this),{passive:false,capture:true});bi(bP,I,this.onDragStart=this.dragstart.bind(this));bi(bN,bj,this.onPointerDown=this.pointerdown.bind(this));bi(bM,bp,this.onPointerMove=this.pointermove.bind(this));
bi(bM,bA,this.onPointerUp=this.pointerup.bind(this));bi(bM,a,this.onKeyDown=this.keydown.bind(this));bi(window,aq,this.onResize=this.resize.bind(this));if(bO.toggleOnDblclick){bi(bN,bz,this.onDblclick=this.dblclick.bind(this));}},unbind:function ba(){var bO=this.options,bP=this.viewer,bN=this.canvas;
var bM=this.element.ownerDocument;f(bP,s,this.onClick);f(bP,aE,this.onWheel,{passive:false,capture:true});f(bP,I,this.onDragStart);f(bN,bj,this.onPointerDown);f(bM,bp,this.onPointerMove);f(bM,bA,this.onPointerUp);f(bM,a,this.onKeyDown);f(window,aq,this.onResize);if(bO.toggleOnDblclick){f(bN,bz,this.onDblclick);
}}};var aS={click:function a2(bN){var bP=bN.target;var bM=this.options,bQ=this.imageData;var bO=a4(bP,be);if(H&&bN.isTrusted&&bP===this.canvas){clearTimeout(this.clickCanvasTimeout);}switch(bO){case"mix":if(this.played){this.stop();}else{if(bM.inline){if(this.fulled){this.exit();}else{this.full();}}else{this.hide();
}}break;case"hide":this.hide();break;case"view":this.view(a4(bP,"index"));break;case"zoom-in":this.zoom(0.1,true);break;case"zoom-out":this.zoom(-0.1,true);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(bM.loop);break;case"play":this.play(bM.fullscreen);
break;case"next":this.next(bM.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-bQ.scaleX||-1);break;case"flip-vertical":this.scaleY(-bQ.scaleY||-1);break;default:if(this.played){this.stop();}}},dblclick:function Z(bM){bM.preventDefault();
if(this.viewed&&bM.target===this.image){if(H&&bM.isTrusted){clearTimeout(this.doubleClickImageTimeout);}this.toggle();}},load:function bb(){var bR=this;if(this.timeout){clearTimeout(this.timeout);this.timeout=false;}var bO=this.element,bN=this.options,bP=this.image,bM=this.index,bQ=this.viewerData;aT(bP,aa);
if(bN.loading){aT(this.canvas,bg);}bP.style.cssText="height:0;"+"margin-left:".concat(bQ.width/2,"px;")+"margin-top:".concat(bQ.height/2,"px;")+"max-width:none!important;position:absolute;width:0;";this.initImage(function(){aR(bP,bK,bN.movable);aR(bP,bn,bN.transition);bR.renderImage(function(){bR.viewed=true;
bR.viewing=false;if(j(bN.viewed)){bi(bO,bB,bN.viewed,{once:true});}aK(bO,bB,{originalImage:bR.images[bM],index:bM,image:bP});});});},loadImage:function u(bP){var bR=bP.target;var bO=bR.parentNode;var bN=bO.offsetWidth||30;var bM=bO.offsetHeight||50;var bQ=!!a4(bR,"filled");aW(bR,function(bT,bW){var bV=bT/bW;
var bU=bN;var bS=bM;if(bM*bV>bN){if(bQ){bU=bM*bV;}else{bS=bN/bV;}}else{if(bQ){bS=bN/bV;}else{bU=bM*bV;}}L(bR,V({width:bU,height:bS},E({translateX:(bN-bU)/2,translateY:(bM-bS)/2})));});},keydown:function a5(bN){var bM=this.options;if(!this.fulled||!bM.keyboard){return;}switch(bN.keyCode||bN.which||bN.charCode){case 27:if(this.played){this.stop();
}else{if(bM.inline){if(this.fulled){this.exit();}}else{this.hide();}}break;case 32:if(this.played){this.stop();}break;case 37:this.prev(bM.loop);break;case 38:bN.preventDefault();this.zoom(bM.zoomRatio,true);break;case 39:this.next(bM.loop);break;case 40:bN.preventDefault();this.zoom(-bM.zoomRatio,true);
break;case 48:case 49:if(bN.ctrlKey){bN.preventDefault();this.toggle();}break;default:}},dragstart:function b(bM){if(bM.target.tagName.toLowerCase()==="img"){bM.preventDefault();}},pointerdown:function ak(bQ){var bN=this.options,bM=this.pointers;var bP=bQ.buttons,bO=bQ.button;if(!this.viewed||this.showing||this.viewing||this.hiding||U(bP)&&bP!==1||U(bO)&&bO!==0||bQ.ctrlKey){return;
}bQ.preventDefault();if(bQ.changedTouches){af(bQ.changedTouches,function(bS){bM[bS.identifier]=at(bS);});}else{bM[bQ.pointerId||0]=at(bQ);}var bR=bN.movable?bu:false;if(Object.keys(bM).length>1){bR=y;}else{if((bQ.pointerType==="touch"||bQ.type==="touchstart")&&this.isSwitchable()){bR=ai;}}if(bN.transition&&(bR===bu||bR===y)){aT(this.image,bn);
}this.action=bR;},pointermove:function aw(bN){var bM=this.pointers,bO=this.action;if(!this.viewed||!bO){return;}bN.preventDefault();if(bN.changedTouches){af(bN.changedTouches,function(bP){V(bM[bP.identifier]||{},at(bP,true));});}else{V(bM[bN.pointerId||0]||{},at(bN,true));}this.change(bN);},pointerup:function x(bP){var bO=this;
var bN=this.options,bQ=this.action,bM=this.pointers;var bR;if(bP.changedTouches){af(bP.changedTouches,function(bS){bR=bM[bS.identifier];delete bM[bS.identifier];});}else{bR=bM[bP.pointerId||0];delete bM[bP.pointerId||0];}if(!bQ){return;}bP.preventDefault();if(bN.transition&&(bQ===bu||bQ===y)){q(this.image,bn);
}this.action=false;if(H&&bQ!==y&&bR&&Date.now()-bR.timeStamp<500){clearTimeout(this.clickCanvasTimeout);clearTimeout(this.doubleClickImageTimeout);if(bN.toggleOnDblclick&&this.viewed&&bP.target===this.image){if(this.imageClicked){this.imageClicked=false;this.doubleClickImageTimeout=setTimeout(function(){aK(bO.image,bz);
},50);}else{this.imageClicked=true;this.doubleClickImageTimeout=setTimeout(function(){bO.imageClicked=false;},500);}}else{this.imageClicked=false;if(bN.backdrop&&bN.backdrop!=="static"&&bP.target===this.canvas){this.clickCanvasTimeout=setTimeout(function(){aK(bO.canvas,s);},50);}}}},resize:function v(){var bM=this;
if(!this.isShown||this.hiding){return;}this.initContainer();this.initViewer();this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){bM.renderImage();});}if(this.played){if(this.options.fullscreen&&this.fulled&&!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)){this.stop();
return;}af(this.player.getElementsByTagName("img"),function(bN){bi(bN,aB,bM.loadImage.bind(bM),{once:true});aK(bN,aB);});}},wheel:function g(bO){var bM=this;if(!this.viewed){return;}bO.preventDefault();if(this.wheeling){return;}this.wheeling=true;setTimeout(function(){bM.wheeling=false;},50);var bN=Number(this.options.zoomRatio)||0.1;
var bP=1;if(bO.deltaY){bP=bO.deltaY>0?1:-1;}else{if(bO.wheelDelta){bP=-bO.wheelDelta/120;}else{if(bO.detail){bP=bO.detail>0?1:-1;}}}this.zoom(-bP*bN,true,bO);}};var ap={show:function aV(){var bM=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bO=this.element,bN=this.options;if(bN.inline||this.showing||this.isShown||this.showing){return this;
}if(!this.ready){this.build();if(this.ready){this.show(bM);}return this;}if(j(bN.show)){bi(bO,ah,bN.show,{once:true});}if(aK(bO,ah)===false||!this.ready){return this;}if(this.hiding){this.transitioning.abort();}this.showing=true;this.open();var bQ=this.viewer;aT(bQ,ab);if(bN.transition&&!bM){var bP=this.shown.bind(this);
this.transitioning={abort:function bR(){f(bQ,aP,bP);aT(bQ,J);}};q(bQ,bn);bQ.offsetWidth;bi(bQ,aP,bP,{once:true});q(bQ,J);}else{q(bQ,J);this.shown();}return this;},hide:function a1(){var bM=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bP=this.element,bN=this.options;if(bN.inline||this.hiding||!(this.isShown||this.showing)){return this;
}if(j(bN.hide)){bi(bP,ar,bN.hide,{once:true});}if(aK(bP,ar)===false){return this;}if(this.showing){this.transitioning.abort();}this.hiding=true;if(this.played){this.stop();}else{if(this.viewing){this.viewing.abort();}}var bR=this.viewer;if(bN.transition&&!bM){var bQ=this.hidden.bind(this);var bO=function bO(){bi(bR,aP,bQ,{once:true});
aT(bR,J);};this.transitioning={abort:function bS(){if(this.viewed){f(this.image,aP,bO);}else{f(bR,aP,bQ);}}};if(this.viewed){bi(this.image,aP,bO,{once:true});this.zoomTo(0,false,false,true);}else{bO();}}else{aT(bR,J);this.hidden();}return this;},view:function aM(){var bT=this;var bU=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.options.initialViewIndex;
bU=Number(bU)||0;if(!this.isShown){this.index=bU;return this.show();}if(this.hiding||this.played||bU<0||bU>=this.length||this.viewed&&bU===this.index){return this;}if(this.viewing){this.viewing.abort();}var bQ=this.element,bZ=this.options,bW=this.title,bN=this.canvas;var bY=this.items[bU];var bR=bY.querySelector("img");
var bM=a4(bR,"originalUrl");var bS=bR.getAttribute("alt");var bO=document.createElement("img");bO.src=bM;bO.alt=bS;if(j(bZ.view)){bi(bQ,Y,bZ.view,{once:true});}if(aK(bQ,Y,{originalImage:this.images[bU],index:bU,image:bO})===false||!this.isShown||this.hiding||this.played){return this;}this.image=bO;aT(this.items[this.index],ax);
q(bY,ax);this.viewed=false;this.index=bU;this.imageData={};q(bO,aa);if(bZ.loading){q(bN,bg);}bN.innerHTML="";bN.appendChild(bO);this.renderList();bW.innerHTML="";var bX=function bX(){var b1=bT.imageData;var b0=Array.isArray(bZ.title)?bZ.title[1]:bZ.title;bW.innerHTML=j(b0)?b0.call(bT,bO,b1):"".concat(bS," (").concat(b1.naturalWidth," \xD7 ").concat(b1.naturalHeight,")");
};var bV;bi(bQ,bB,bX,{once:true});this.viewing={abort:function bP(){f(bQ,bB,bX);if(bO.complete){if(this.imageRendering){this.imageRendering.abort();}else{if(this.imageInitializing){this.imageInitializing.abort();}}}else{f(bO,aB,bV);if(this.timeout){clearTimeout(this.timeout);}}}};if(bO.complete){this.load();
}else{bi(bO,aB,bV=this.load.bind(this),{once:true});if(this.timeout){clearTimeout(this.timeout);}this.timeout=setTimeout(function(){aT(bO,aa);bT.timeout=false;},1000);}return this;},prev:function a7(){var bM=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bN=this.index-1;if(bN<0){bN=bM?this.length-1:0;
}this.view(bN);return this;},next:function W(){var bM=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bO=this.length-1;var bN=this.index+1;if(bN>bO){bN=bM?0:bO;}this.view(bN);return this;},move:function F(bM,bO){var bN=this.imageData;this.moveTo(aI(bM)?bM:bN.left+Number(bM),aI(bO)?bO:bN.top+Number(bO));
return this;},moveTo:function bo(bM){var bP=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bM;var bO=this.imageData;bM=Number(bM);bP=Number(bP);if(this.viewed&&!this.played&&this.options.movable){var bN=false;if(U(bM)){bO.left=bM;bN=true;}if(U(bP)){bO.top=bP;bN=true;}if(bN){this.renderImage();
}}return this;},zoom:function aQ(bO){var bN=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var bM=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var bP=this.imageData;bO=Number(bO);if(bO<0){bO=1/(1-bO);}else{bO=1+bO;}this.zoomTo(bP.width*bO/bP.naturalWidth,bN,bM);return this;
},zoomTo:function aL(bV){var b7=this;var bX=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var b4=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var b2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var bN=this.element,bR=this.options,bZ=this.pointers,b8=this.imageData;
var b5=b8.width,b1=b8.height,bS=b8.left,b0=b8.top,bP=b8.naturalWidth,bO=b8.naturalHeight;bV=Math.max(0,bV);if(U(bV)&&this.viewed&&!this.played&&(b2||bR.zoomable)){if(!b2){var bW=Math.max(0.01,bR.minZoomRatio);var bM=Math.min(100,bR.maxZoomRatio);bV=Math.min(Math.max(bV,bW),bM);}if(b4&&bV>0.95&&bV<1.05){bV=1;
}var bY=bP*bV;var b6=bO*bV;var b3=bY-b5;var bQ=b6-b1;var bT=b5/bP;if(j(bR.zoom)){bi(bN,ae,bR.zoom,{once:true});}if(aK(bN,ae,{ratio:bV,oldRatio:bT,originalEvent:b4})===false){return this;}this.zooming=true;if(b4){var bU=bH(this.viewer);var b9=bZ&&Object.keys(bZ).length?bh(bZ):{pageX:b4.pageX,pageY:b4.pageY};
b8.left-=b3*((b9.pageX-bU.left-bS)/b5);b8.top-=bQ*((b9.pageY-bU.top-b0)/b1);}else{b8.left-=b3/2;b8.top-=bQ/2;}b8.width=bY;b8.height=b6;b8.ratio=bV;this.renderImage(function(){b7.zooming=false;if(j(bR.zoomed)){bi(bN,ay,bR.zoomed,{once:true});}aK(bN,ay,{ratio:bV,oldRatio:bT,originalEvent:b4});});if(bX){this.tooltip();
}}return this;},rotate:function m(bM){this.rotateTo((this.imageData.rotate||0)+Number(bM));return this;},rotateTo:function bL(bM){var bN=this.imageData;bM=Number(bM);if(U(bM)&&this.viewed&&!this.played&&this.options.rotatable){bN.rotate=bM;this.renderImage();}return this;},scaleX:function O(bM){this.scale(bM,this.imageData.scaleY);
return this;},scaleY:function N(bM){this.scale(this.imageData.scaleX,bM);return this;},scale:function aN(bN){var bM=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bN;var bP=this.imageData;bN=Number(bN);bM=Number(bM);if(this.viewed&&!this.played&&this.options.scalable){var bO=false;if(U(bN)){bP.scaleX=bN;
bO=true;}if(U(bM)){bP.scaleY=bM;bO=true;}if(bO){this.renderImage();}}return this;},play:function i(){var bN=this;var bS=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.isShown||this.played){return this;}var bU=this.options,bT=this.player;var bQ=this.loadImage.bind(this);var bP=[];
var bR=0;var bO=0;this.played=true;this.onLoadWhenPlay=bQ;if(bS){this.requestFullscreen();}q(bT,S);af(this.items,function(bX,bW){var bV=bX.querySelector("img");var bY=document.createElement("img");bY.src=a4(bV,"originalUrl");bY.alt=bV.getAttribute("alt");bR+=1;q(bY,c);aR(bY,bn,bU.transition);if(r(bX,ax)){q(bY,J);
bO=bW;}bP.push(bY);bi(bY,aB,bQ,{once:true});bT.appendChild(bY);});if(U(bU.interval)&&bU.interval>0){var bM=function bM(){bN.playing=setTimeout(function(){aT(bP[bO],J);bO+=1;bO=bO<bR?bO:0;q(bP[bO],J);bM();},bU.interval);};if(bR>1){bM();}}return this;},stop:function aF(){var bN=this;if(!this.played){return this;
}var bM=this.player;this.played=false;clearTimeout(this.playing);af(bM.getElementsByTagName("img"),function(bO){f(bO,aB,bN.onLoadWhenPlay);});aT(bM,S);bM.innerHTML="";this.exitFullscreen();return this;},full:function au(){var bN=this;var bM=this.options,bQ=this.viewer,bP=this.image,bO=this.list;if(!this.isShown||this.played||this.fulled||!bM.inline){return this;
}this.fulled=true;this.open();q(this.button,bl);if(bM.transition){aT(bO,bn);if(this.viewed){aT(bP,bn);}}q(bQ,bG);bQ.setAttribute("style","");L(bQ,{zIndex:bM.zIndex});this.initContainer();this.viewerData=V({},this.containerData);this.renderList();if(this.viewed){this.initImage(function(){bN.renderImage(function(){if(bM.transition){setTimeout(function(){q(bP,bn);
q(bO,bn);},0);}});});}return this;},exit:function bJ(){var bM=this;var bN=this.options,bQ=this.viewer,bP=this.image,bO=this.list;if(!this.isShown||this.played||!this.fulled||!bN.inline){return this;}this.fulled=false;this.close();aT(this.button,bl);if(bN.transition){aT(bO,bn);if(this.viewed){aT(bP,bn);
}}aT(bQ,bG);L(bQ,{zIndex:bN.zIndexInline});this.viewerData=V({},this.parentData);this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){bM.renderImage(function(){if(bN.transition){setTimeout(function(){q(bP,bn);q(bO,bn);},0);}});});}return this;},tooltip:function w(){var bM=this;
var bO=this.options,bN=this.tooltipBox,bP=this.imageData;if(!this.viewed||this.played||!bO.tooltip){return this;}bN.textContent="".concat(Math.round(bP.ratio*100),"%");if(!this.tooltipping){if(bO.transition){if(this.fading){aK(bN,aP);}q(bN,S);q(bN,c);q(bN,bn);bN.offsetWidth;q(bN,J);}else{q(bN,S);}}else{clearTimeout(this.tooltipping);
}this.tooltipping=setTimeout(function(){if(bO.transition){bi(bN,aP,function(){aT(bN,S);aT(bN,c);aT(bN,bn);bM.fading=false;},{once:true});aT(bN,J);bM.fading=true;}else{aT(bN,S);}bM.tooltipping=false;},1000);return this;},toggle:function al(){if(this.imageData.ratio===1){this.zoomTo(this.initialImageData.ratio,true);
}else{this.zoomTo(1,true);}return this;},reset:function a0(){if(this.viewed&&!this.played){this.imageData=V({},this.initialImageData);this.renderImage();}return this;},update:function p(){var bQ=this.element,bP=this.options,bR=this.isImg;if(bR&&!bQ.parentNode){return this.destroy();}var bM=[];af(bR?[bQ]:bQ.querySelectorAll("img"),function(bS){if(bP.filter){if(bP.filter(bS)){bM.push(bS);
}}else{bM.push(bS);}});if(!bM.length){return this;}this.images=bM;this.length=bM.length;if(this.ready){var bO=[];af(this.items,function(bU,bT){var bS=bU.querySelector("img");var bV=bM[bT];if(bV){if(bV.src!==bS.src){bO.push(bT);}}else{bO.push(bT);}});L(this.list,{width:"auto"});this.initList();if(this.isShown){if(this.length){if(this.viewed){var bN=bO.indexOf(this.index);
if(bN>=0){this.viewed=false;this.view(Math.max(this.index-(bN+1),0));}else{q(this.items[this.index],ax);}}}else{this.image=null;this.viewed=false;this.index=0;this.imageData={};this.canvas.innerHTML="";this.title.innerHTML="";}}}else{this.build();}return this;},destroy:function l(){var bN=this.element,bM=this.options;
if(!bN[G]){return this;}this.destroyed=true;if(this.ready){if(this.played){this.stop();}if(bM.inline){if(this.fulled){this.exit();}this.unbind();}else{if(this.isShown){if(this.viewing){if(this.imageRendering){this.imageRendering.abort();}else{if(this.imageInitializing){this.imageInitializing.abort();
}}}if(this.hiding){this.transitioning.abort();}this.hidden();}else{if(this.showing){this.transitioning.abort();this.hidden();}}}this.ready=false;this.viewer.parentNode.removeChild(this.viewer);}else{if(bM.inline){if(this.delaying){this.delaying.abort();}else{if(this.initializing){this.initializing.abort();
}}}}if(!bM.inline){f(bN,s,this.onStart);}bN[G]=undefined;return this;}};var ao={open:function aC(){var bM=this.body;q(bM,A);bM.style.paddingRight="".concat(this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0),"px");},close:function X(){var bM=this.body;aT(bM,A);bM.style.paddingRight=this.initialBodyPaddingRight;
},shown:function aU(){var bN=this.element,bM=this.options;this.fulled=true;this.isShown=true;this.render();this.bind();this.showing=false;if(j(bM.shown)){bi(bN,k,bM.shown,{once:true});}if(aK(bN,k)===false){return;}if(this.ready&&this.isShown&&!this.hiding){this.view(this.index);}},hidden:function an(){var bN=this.element,bM=this.options;
this.fulled=false;this.viewed=false;this.isShown=false;this.close();this.unbind();q(this.viewer,ab);this.resetList();this.resetImage();this.hiding=false;if(!this.destroyed){if(j(bM.hidden)){bi(bN,a8,bM.hidden,{once:true});}aK(bN,a8);}},requestFullscreen:function T(){var bM=this.element.ownerDocument;
if(this.fulled&&!(bM.fullscreenElement||bM.webkitFullscreenElement||bM.mozFullScreenElement||bM.msFullscreenElement)){var bN=bM.documentElement;if(bN.requestFullscreen){bN.requestFullscreen();}else{if(bN.webkitRequestFullscreen){bN.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}else{if(bN.mozRequestFullScreen){bN.mozRequestFullScreen();
}else{if(bN.msRequestFullscreen){bN.msRequestFullscreen();}}}}}},exitFullscreen:function t(){var bM=this.element.ownerDocument;if(this.fulled&&(bM.fullscreenElement||bM.webkitFullscreenElement||bM.mozFullScreenElement||bM.msFullscreenElement)){if(bM.exitFullscreen){bM.exitFullscreen();}else{if(bM.webkitExitFullscreen){bM.webkitExitFullscreen();
}else{if(bM.mozCancelFullScreen){bM.mozCancelFullScreen();}else{if(bM.msExitFullscreen){bM.msExitFullscreen();}}}}}},change:function aH(bQ){var bO=this.options,bN=this.pointers;var bR=bN[Object.keys(bN)[0]];var bM=bR.endX-bR.startX;var bS=bR.endY-bR.startY;switch(this.action){case bu:this.move(bM,bS);
break;case y:this.zoom(a3(bN),false,bQ);break;case ai:this.action="switched";var bP=Math.abs(bM);if(bP>1&&bP>Math.abs(bS)){this.pointers={};if(bM>1){this.prev(bO.loop);}else{if(bM<-1){this.next(bO.loop);}}}break;default:}af(bN,function(bT){bT.startX=bT.endX;bT.startY=bT.endY;});},isSwitchable:function bs(){var bN=this.imageData,bM=this.viewerData;
return this.length>1&&bN.left>=0&&bN.top>=0&&bN.width<=bM.width&&bN.height<=bM.height;}};var aO=am.Viewer;var R=function(){function bN(bS){var bR=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};av(this,bN);if(!bS||bS.nodeType!==1){throw new Error("The first argument is required and must be an element.");
}this.element=bS;this.options=V({},M,o(bR)&&bR);this.action=false;this.fading=false;this.fulled=false;this.hiding=false;this.imageClicked=false;this.imageData={};this.index=this.options.initialViewIndex;this.isImg=false;this.isShown=false;this.length=0;this.played=false;this.playing=false;this.pointers={};
this.ready=false;this.showing=false;this.timeout=false;this.tooltipping=false;this.viewed=false;this.viewing=false;this.wheeling=false;this.zooming=false;this.init();}aY(bN,[{key:"init",value:function bP(){var bW=this;var bU=this.element,bZ=this.options;if(bU[G]){return;}bU[G]=this;var bS=bU.tagName.toLowerCase()==="img";
var bY=[];af(bS?[bU]:bU.querySelectorAll("img"),function(b1){if(j(bZ.filter)){if(bZ.filter.call(bW,b1)){bY.push(b1);}}else{bY.push(b1);}});this.isImg=bS;this.length=bY.length;this.images=bY;var b0=bU.ownerDocument;var bV=b0.body||b0.documentElement;this.body=bV;this.scrollbarWidth=window.innerWidth-b0.documentElement.clientWidth;
this.initialBodyPaddingRight=window.getComputedStyle(bV).paddingRight;if(aI(document.createElement(G).style.transition)){bZ.transition=false;}if(bZ.inline){var bX=0;var bR=function bR(){bX+=1;if(bX===bW.length){var b1;bW.initializing=false;bW.delaying={abort:function b2(){clearTimeout(b1);}};b1=setTimeout(function(){bW.delaying=false;
bW.build();},0);}};this.initializing={abort:function bT(){af(bY,function(b1){if(!b1.complete){f(b1,aB,bR);}});}};af(bY,function(b1){if(b1.complete){bR();}else{bi(b1,aB,bR,{once:true});}});}else{bi(bU,s,this.onStart=function(b1){var b2=b1.target;if(b2.tagName.toLowerCase()==="img"&&(!j(bZ.filter)||bZ.filter.call(bW,b2))){bW.view(bW.images.indexOf(b2));
}});}}},{key:"build",value:function bO(){if(this.ready){return;}var bW=this.element,b7=this.options;var b5=bW.parentNode;var b6=document.createElement("div");b6.innerHTML=ad;var bY=b6.querySelector(".".concat(G,"-container"));var b3=bY.querySelector(".".concat(G,"-title"));var b4=bY.querySelector(".".concat(G,"-toolbar"));
var bT=bY.querySelector(".".concat(G,"-navbar"));var bX=bY.querySelector(".".concat(G,"-button"));var bU=bY.querySelector(".".concat(G,"-canvas"));this.parent=b5;this.viewer=bY;this.title=b3;this.toolbar=b4;this.navbar=bT;this.button=bX;this.canvas=bU;this.footer=bY.querySelector(".".concat(G,"-footer"));
this.tooltipBox=bY.querySelector(".".concat(G,"-tooltip"));this.player=bY.querySelector(".".concat(G,"-player"));this.list=bY.querySelector(".".concat(G,"-list"));q(b3,!b7.title?ab:Q(Array.isArray(b7.title)?b7.title[0]:b7.title));q(bT,!b7.navbar?ab:Q(b7.navbar));aR(bX,ab,!b7.button);if(b7.backdrop){q(bY,"".concat(G,"-backdrop"));
if(!b7.inline&&b7.backdrop!=="static"){aj(bU,be,"hide");}}if(bd(b7.className)&&b7.className){b7.className.split(B).forEach(function(b8){q(bY,b8);});}if(b7.toolbar){var b1=document.createElement("ul");var bS=o(b7.toolbar);var bV=n.slice(0,3);var bZ=n.slice(7,9);var b2=n.slice(9);if(!bS){q(b4,Q(b7.toolbar));
}af(bS?b7.toolbar:n,function(cf,cb){var b9=bS&&o(cf);var ca=bS?bq(cb):cf;var b8=b9&&!aI(cf.show)?cf.show:cf;if(!b8||!b7.zoomable&&bV.indexOf(ca)!==-1||!b7.rotatable&&bZ.indexOf(ca)!==-1||!b7.scalable&&b2.indexOf(ca)!==-1){return;}var cc=b9&&!aI(cf.size)?cf.size:cf;var ce=b9&&!aI(cf.click)?cf.click:cf;
var cd=document.createElement("li");cd.setAttribute("role","button");q(cd,"".concat(G,"-").concat(ca));cd.setAttribute("title",bD[n.indexOf(ca)]);if(!j(ce)){aj(cd,be,ca);}if(U(b8)){q(cd,Q(b8));}if(["small","large"].indexOf(cc)!==-1){q(cd,"".concat(G,"-").concat(cc));}else{if(ca==="play"){q(cd,"".concat(G,"-large"));
}}if(j(ce)){bi(cd,s,ce);}b1.appendChild(cd);});b4.appendChild(b1);}else{q(b4,ab);}if(!b7.rotatable){var b0=b4.querySelectorAll('li[class*="rotate"]');q(b0,aa);af(b0,function(b8){b4.appendChild(b8);});}if(b7.inline){q(bX,br);L(bY,{zIndex:b7.zIndexInline});if(window.getComputedStyle(b5).position==="static"){L(b5,{position:"relative"});
}b5.insertBefore(bY,bW.nextSibling);}else{q(bX,by);q(bY,bG);q(bY,c);q(bY,ab);L(bY,{zIndex:b7.zIndex});var bR=b7.container;if(bd(bR)){bR=bW.ownerDocument.querySelector(bR);}if(!bR){bR=this.body;}bR.appendChild(bY);}if(b7.inline){this.render();this.bind();this.isShown=true;}this.ready=true;if(j(b7.ready)){bi(bW,ac,b7.ready,{once:true});
}if(aK(bW,ac)===false){this.ready=false;return;}if(this.ready&&b7.inline){this.view(this.index);}}}],[{key:"noConflict",value:function bM(){window.Viewer=aO;return bN;}},{key:"setDefaults",value:function bQ(bR){V(M,o(bR)&&bR);}}]);return bN;}();V(R.prototype,P,bC,aS,ap,ao);return R;})));