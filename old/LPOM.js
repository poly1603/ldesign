var LPOM={};LPOM.API={};function onchangedata(a){var b=a;if(a.target||a.srcElement){b=a.target||a.srcElement;}b.style.overflow="hidden";b.style.height="auto";b.style.height=parseInt(b.scrollHeight)+10+"px";}LPOM.API.getCodeValue=function(e,a,c){if(LPOM.API.checkIsNotNull(a)&&LPOM.API.checkIsNotNull(c)){var b=LEAP.getCodeValue(c);
if(b!=null){for(var d=0;d<b.length;d++){if(b[d].codeid==a){return b[d].codevalue;}}}}};LPOM.API.getSearchParameters=function(j){var e=new SearchParameters();e.setName(j.tablename);if(undefined!=j.par){var g=j.par.metaData;var f=j.par.result;if(g.length==0||f.length==0||g.length!=f.length){return null;
}for(var b=0;b<f.length;b++){var k=11;var d=null;var a=typeof(f[b])=="string"?f[b]:f[b]+"";if(a.indexOf("&")>-1){d=a.split("&");k=d[1];}a=(d==null)?a:d[0];e.addParameter(g[b],a,k);}}if(LPOM.API.checkIsNotNull(j.fields)){var c=j.fields.split(",");if(c&&c.length>0){for(var b=0;b<c.length;b++){e.addField(c[b]);
}}}if(undefined!=j.order){e.setOrder(j.order);}if(undefined!=j.extendQuery){e.setExtendQuery(j.extendQuery);}if(undefined!=j.distinct){e.distinct=j.distinct;}e.pageSize=999;if(!e.pageNum){e.pageNum=1;}var h=LEAP.request("beanSearch",{par:e});return h;};LPOM.API.getSearchData=function(a){var b=LPOM.API.getSearchParameters(a);
var c=null;if(b){c=LEAP.convertResult(b);}return c;};LPOM.API.checkDate=function(c,a){if(LPOM.API.checkIsNotNull(c)&&LPOM.API.checkIsNotNull(a)){var b=new DateUtil();try{if(b.buildDate(c)<=b.buildDate(a)){return true;}}finally{c=a=b=null;}}return false;};LPOM.API.compareDate=function(c,d){var b=c.split(/[- :]/);
var f=d.split(/[- :]/);var e=parseInt(b[0]+b[1]+b[2]+b[3]+b[4]);var a=parseInt(f[0]+f[1]+f[2]+f[3]+f[4]);if(a>=e){return true;}else{return false;}};LPOM.API.checkIsNotNull=function(a){if(typeof(a)=="undefined"||null===a||""===a){return false;}return true;};LPOM.API.setPageData=function(a,e){if(LPOM.API.checkIsNotNull(e)&&LPOM.API.checkIsNotNull(e.__cacheMD)&&e.__cacheMD.size()>0){var d=e.__cacheMD.keys;
if(LPOM.API.checkIsNotNull(a)){for(var c in d){var b=c.substring(4,c.length);var f=a[b];if(!LPOM.API.checkIsNotNull(f)){continue;}e.md(b).setValue(f);}}else{for(var c in d){var b=c.substring(4,c.length);e.md(b).setValue(null);}}}};LPOM.API.setHTMLData=function(a,h){if(LPOM.API.checkIsNotNull(a)&&LPOM.API.checkIsNotNull(h)&&LPOM.API.checkIsNotNull(h.__cacheMD)&&h.__cacheMD.size()>0){var g=h.__cacheMD.keys;
if(g){for(var e in a){var d="key_"+e;if(g[d]){var f=g[d].getAttribute("code");var c=null;if(f){c=LPOM.API.getCodeValue(h,a[e],f);}var b=g[d].getAttribute("mdtype");if("date"===b){a[e]=a[e].substring(0,10);}g[d].innerHTML=c?c:a[e];}}}}};LPOM.API.pageUIChange=function(f){if(!LPOM.API.checkIsNotNull(f)){return;
}var d=LEAP.getElement("th[tpo][instance="+f.instance+"]");if(null==d||typeof(d)=="undefined"){return;}var a=d.getAttribute("tpo");if(null==a){return;}var c=a.split("|");if(null==c||c.length==0){return;}if(!f.getParentModule()||!f.getParentModule().getParentModule()){return;}var b=f.getParentModule().getParentModule();
if("view"==f.getParentModule().pageMode||(true==b.isworkflow&&null!=b.workflow&&"审批"==b.workflow.getStepName())){for(var e=0;e<c.length;e++){if(c[e].indexof("查看")>-1){d.setAttribute("tpo",c[e]);break;}}f.ut("btn_add").hide();}else{f.ut("btn_add").show();}};LPOM.API.setFieldProperty=function(k,c){if(null==k||!LPOM.API.checkIsNotNull(c)||!LPOM.API.checkIsNotNull(k.md)){return null;
}var h=LEAP.getElement("[_linkmd="+k.md+"]","[instance="+c.instance+"]");if(null==h){return null;}var f=c.getMD(k.md);if(null==f){return null;}if(LPOM.API.checkIsNotNull(k.notnull)){var a=f.getAttribute("check");if(a){if(a.indexOf("notnull:"+k.notnull)<0&&a.indexOf("notnull:"+(!k.notnull))<0){a+=",notnull:"+k.notnull;
}else{if(a.indexOf("notnull:"+(!k.notnull))>-1){a=a.replaceall("notnull:"+(!k.notnull),"notnull:"+k.notnull);}}LEAP.check.setCheck(f,a);var b=LEAP.getElement("font",h);if(b){b.style.display=(true==k.notnull)?"inline":"none";}}else{LEAP.check.setCheck(f,"notnull:true");}}if(LPOM.API.checkIsNotNull(k.readonly)){var j=f.getAttribute("ct");
if(k.readonly){if("date"==j){f.setAttribute("readOnly","1");var g=LEAP.getElements("input",f);if(g&&g.length>0){for(var d=0;d<g.length;d++){g[d].setAttribute("readOnly",k.readonly);}}var e=LEAP.getElement("div[ctf=date_show]",f);if(e){e.style.display="none";}}else{f.setAttribute("readOnly",k.readonly);
}}else{f.removeAttribute("readOnly");if("date"==j){var g=LEAP.getElements("input",f);if(g&&g.length>0){for(var d=0;d<g.length;d++){g[d].removeAttribute("readOnly");}}var e=LEAP.getElement("div[ctf=date_show]",f);if(e){e.style.display="inline";}}}}};LPOM.API.autoAddHight=function(u){var m=0;var c=0;var l=0;
if(!u.getParentModule()||!u.getParentModule().getParentModule()){return;}var d=u.getParentModule().getParentModule();var o=null;var n=0;if(d.getUT("loadTab")){o=d.getUT("loadTab").style.height;var a=parseInt(o)<0?0:parseInt(o);n=a;if(!u.getParentModule().loadTabHeight){u.getParentModule().loadTabHeight=a;
}else{a=u.getParentModule().loadTabHeight;}var s=u.getElement("[instance="+u.instance+"]");if(!s){return;}var f=LEAP.getElements("[linmodule2_row]",s);if(f&&f.length>0){for(var q=0;q<f.length;q++){var b=f[q].scrollHeight;if(q==f.length-1){l+=parseInt(b)<0?0:parseInt(b);}else{c+=parseInt(b)<0?0:parseInt(b);
}}}var k=null;if("search"==s.getAttribute("moduletype")){var h=u.getElement("div[class='lg_p2_bt_top lgresultpanel_table']",s);if(h){var r=u.getElement("table",h);if(r.scrollHeight!=0){k=r.scrollHeight;}}}else{var r=u.getElement("table",s);if(r&&r.scrollHeight!=0){k=r.scrollHeight;}else{var g=u.getElement("div[class=lg_p2_bt_top]",s);
if(!g){return;}k=g.style.height;}u.getParentModule().afterTabHeight=k;}var p=LPOM.API.checkIsNotNull(k)?(parseInt(k)<0?0:parseInt(k)):0;if(0==p){if("search"!=s.getAttribute("moduletype")){var e=u.getParentModule().afterTabHeight;if(e){var j=parseInt(e)<0?0:parseInt(e)+100;d.getUT("loadTab").style.height=j+"px";
}}return;}if(f){n=(p>n)?p+100:(parseInt(o)<0?0:parseInt(o));m=p+l+50;while(m<a||m<=n){m+=50;}}else{var t=130;if("search"==s.getAttribute("moduletype")){if(n==a){if(2*n<p){p+=t;}else{if(n<p){p+=(p-n)+t;}else{if((n-p)>t){p=n;}else{if((n-p)<50){p=n+(n-p)+t;}else{p=n+(n-p);}}}}m=p;}else{if(n<a){m=a;}else{m=p+t;
}}}else{m=p+t;}}d.getUT("loadTab").style.height=m+"px";}};LPOM.API.autoProvHight=function(e){var a=0;var c=0;if(!e.getParentModule()||!e.getParentModule().getParentModule()){return;}var d=e.getParentModule().getParentModule();var b=null;if(d.getUT("loadTab")){b=d.getUT("loadTab").style.height;fheight=parseInt(b)<0?0:parseInt(b);
if(!e.getParentModule().loadTabHeight){e.getParentModule().loadTabHeight=fheight;}else{d.getUT("loadTab").style.height=e.getParentModule().loadTabHeight+"px";}}};LPOM.API.showTable=function(a,g,f,h,e){if(!LPOM.API.checkIsNotNull(a)||!LPOM.API.checkIsNotNull(g)||!LPOM.API.checkIsNotNull(e)){return;}if(null==f||f.length==0){return;
}this._rowSpan={};for(var c=0;c<f.length;c++){LPOM.API.addRow(a,g,f[c],h,e);}if(this._rowSpan){for(var b in this._rowSpan){var d=this._rowSpan[b];LPOM.API.rowSpan(g,0,g.rows.length,d);}}};LPOM.API.addRow=function(h,p,q,m,v){if(!LPOM.API.checkIsNotNull(h)||!LPOM.API.checkIsNotNull(p)||!LPOM.API.checkIsNotNull(v)){return;
}var c=h.getElementsByTagName("th");if(null==c){return;}var f=p.insertRow();if(f){for(var n=0;n<c.length;n++){var s=c[n].getAttribute("md");if(s){var a=f.insertCell(n);var k=c[n].getAttribute("cellclick");var t=c[n].getAttribute("textalign");var g=c[n].getAttribute("code");var b=null;var d=c[n].getAttribute("mdtype");
var l=c[n].getAttribute("_rowSpan");if("true"==l){this._rowSpan[s]=n;}for(var u in q){if(u===s){if(g){b=LPOM.API.getCodeValue(v,q[s],g);}if(d&&"date"===d){q[s]=q[s].substring(0,10);}var i=LPOM.API.checkIsNotNull(b)?b:q[s];var r=(i.length>11)?i.substring(0,11)+"...":i;if(k&&"true"===k){var o=document.createElement("span");
o.title=i;o.innerHTML=r;o.style.cursor="pointer";o.style.color="#1e88e5";if(m&&m.clickfn){var e="";if(m.param){e=JSON.stringify(m.param);}o.setAttribute("onclick",m.clickfn+"("+e+")");}a.appendChild(o);}else{a.style.textAlign=LPOM.API.checkIsNotNull(t)?t:"center";a.title=i;a.innerHTML=r;}break;}}}}}};
LPOM.API.rowSpan=function(b,d,c,e){if(e>=b.rows[d].cells.length){return;}for(var f=d;f<c;f++){if(f+1==c){break;}var a=b.rows[d].cells.length-b.rows[f+1].cells.length;if(b.rows[d].cells[e].innerHTML==b.rows[f+1].cells[e-a].innerHTML){b.rows[f+1].removeChild(b.rows[f+1].cells[e-a]);b.rows[d].cells[e].rowSpan=(b.rows[d].cells[e].rowSpan|0)+1;
}else{d=f+1;}}};LPOM.API.clearTable=function(d,c){var a=d.getElementsByTagName("tr");if(a.length>0){for(var b=0;b<a.length;){d.deleteRow(0);}}};LPOM.API.clearTable_row=function(b,e,d){if(!LPOM.API.checkIsNotNull(b)||!LPOM.API.checkIsNotNull(e)){return;}if(e.children&&e.children.length>0){if(e.children.length>1){for(var c=1;
c<e.children.length;){e.deleteRow(c);}}var a=b.getElementsByTagName("th");if(null==a){return;}for(var c=0;c<a.length;c++){e.children[0].cells[c].innerHTML="";}}};LPOM.API.getPercentVal=function(b,a){if(LPOM.API.checkIsNotNull(b)&&LPOM.API.checkIsNotNull(a)&&0!=a&&0!=b){return(Math.round((b/a)*10000)/100+"%");
}return"0%";};LPOM.API.getOrgData=function(){var a=LEAP.request("lpom_getUpperLevelOrgInfoWithPar");if(null==a){a={id:LEAP.userInfo.orgid,cnname:LEAP.userInfo.orgCNName,syscode:LEAP.userInfo.orgsyscode};}return a;};LPOM.API.getRealNum=function(b,a){if(b&&a){b=parseFloat(b).toFixed(a).toString();while(b.substr(-1)=="0"){b=b.substr(0,b.length-1);
}if(b.substr(-1)=="."){b=b.substr(0,b.length-1);}}return parseFloat(b);};