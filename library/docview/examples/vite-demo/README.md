# LDesign DocView - Vite æ¼”ç¤ºé¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Vite + JavaScript æ„å»ºçš„ LDesign DocView åº“æ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Web åº”ç”¨ä¸­é›†æˆæ–‡æ¡£é¢„è§ˆå’Œç¼–è¾‘åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“„ **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ Word (.docx)ã€Excel (.xlsx)ã€PowerPoint (.pptx) æ–‡æ¡£
- ğŸ‘€ **å®æ—¶é¢„è§ˆ**: å³æ—¶é¢„è§ˆæ–‡æ¡£å†…å®¹
- âœï¸ **åœ¨çº¿ç¼–è¾‘**: æ”¯æŒæ–‡æ¡£å†…å®¹çš„åœ¨çº¿ç¼–è¾‘
- ğŸ’¾ **ä¿å­˜ä¸‹è½½**: æ”¯æŒæ–‡æ¡£ä¿å­˜å’Œä¸‹è½½
- ğŸ–¨ï¸ **æ‰“å°åŠŸèƒ½**: æ”¯æŒæ–‡æ¡£æ‰“å°
- ğŸ“± **å“åº”å¼è®¾è®¡**: é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- ğŸ¨ **ç°ä»£ UI**: ç¾è§‚çš„ç”¨æˆ·ç•Œé¢è®¾è®¡

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
# æˆ–
pnpm install
# æˆ–
yarn install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
# æˆ–
pnpm run dev
# æˆ–
yarn dev
```

åº”ç”¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨ã€‚

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
# æˆ–
pnpm run build
# æˆ–
yarn build
```

### é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬

```bash
npm run preview
# æˆ–
pnpm run preview
# æˆ–
yarn preview
```

## ä½¿ç”¨è¯´æ˜

### ä¸Šä¼ æ–‡æ¡£

1. ç‚¹å‡»"é€‰æ‹©æ–‡æ¡£"æŒ‰é’®é€‰æ‹©æœ¬åœ°æ–‡ä»¶
2. æˆ–è€…ç›´æ¥æ‹–æ‹½æ–‡ä»¶åˆ°æŸ¥çœ‹å™¨åŒºåŸŸ
3. æ”¯æŒçš„æ ¼å¼ï¼š.docxã€.xlsxã€.pptx

### ç¤ºä¾‹æ–‡ä»¶

ç‚¹å‡»ç¤ºä¾‹æ–‡ä»¶æŒ‰é’®å¯ä»¥å¿«é€ŸåŠ è½½æ¼”ç¤ºå†…å®¹ï¼š
- **Word ç¤ºä¾‹**: å±•ç¤ºæ–‡æœ¬æ ¼å¼åŒ–ã€è¡¨æ ¼ç­‰åŠŸèƒ½
- **Excel ç¤ºä¾‹**: å±•ç¤ºè¡¨æ ¼æ•°æ®æ˜¾ç¤º
- **PPT ç¤ºä¾‹**: å±•ç¤ºå¹»ç¯ç‰‡å¯¼èˆªåŠŸèƒ½

### ç¼–è¾‘åŠŸèƒ½

1. å‹¾é€‰"å¯ç”¨ç¼–è¾‘"é€‰é¡¹
2. åœ¨æ–‡æ¡£å†…å®¹åŒºåŸŸç›´æ¥ç¼–è¾‘
3. ä¿®æ”¹ä¼šå®æ—¶ä¿å­˜åˆ°å†…å­˜ä¸­

### å·¥å…·æ 

- **ä¿å­˜**: ä¿å­˜å½“å‰æ–‡æ¡£å†…å®¹
- **ä¸‹è½½**: ä¸‹è½½æ–‡æ¡£æ–‡ä»¶
- **æ‰“å°**: æ‰“å°æ–‡æ¡£å†…å®¹

## æŠ€æœ¯æ ˆ

- **æ„å»ºå·¥å…·**: Vite 5.x
- **è¯­è¨€**: JavaScript (ES6+)
- **æ ·å¼**: CSS3 + CSS Variables
- **æ–‡æ¡£å¤„ç†**: 
  - mammoth.js (Word æ–‡æ¡£)
  - xlsx.js (Excel æ–‡æ¡£)
  - JSZip (PowerPoint æ–‡æ¡£)

## é¡¹ç›®ç»“æ„

```
vite-demo/
â”œâ”€â”€ public/                 # é™æ€èµ„æº
â”‚   â””â”€â”€ favicon.svg        # ç½‘ç«™å›¾æ ‡
â”œâ”€â”€ src/                   # æºä»£ç 
â”‚   â”œâ”€â”€ styles/           # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ main.css      # ä¸»æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ main.js           # ä¸» JavaScript æ–‡ä»¶
â”‚   â””â”€â”€ mock-docview.js   # æ¨¡æ‹Ÿçš„ DocView åº“
â”œâ”€â”€ index.html            # HTML å…¥å£æ–‡ä»¶
â”œâ”€â”€ package.json          # é¡¹ç›®é…ç½®
â”œâ”€â”€ vite.config.js        # Vite é…ç½®
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜
```

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### æ–‡æ¡£åŠ è½½

```javascript
const viewer = new DocumentViewer({
  container: '#documentViewer',
  editable: true,
  toolbar: { show: true },
  callbacks: {
    onLoad: (info) => console.log('æ–‡æ¡£åŠ è½½å®Œæˆ', info),
    onError: (error) => console.error('åŠ è½½å¤±è´¥', error)
  }
})

await viewer.loadDocument(file)
```

### ç¼–è¾‘æ¨¡å¼

```javascript
// å¯ç”¨ç¼–è¾‘
viewer.setEditable(true)

// è·å–å†…å®¹
const content = viewer.getContent()

// ä¿å­˜æ–‡æ¡£
const blob = await viewer.save()
```

## æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶æ ¼å¼**: ç›®å‰æ”¯æŒç°ä»£ Office æ ¼å¼ (.docx, .xlsx, .pptx)
2. **æ–‡ä»¶å¤§å°**: å»ºè®®å•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡ 50MB
3. **æµè§ˆå™¨å…¼å®¹**: æ”¯æŒç°ä»£æµè§ˆå™¨ (Chrome 80+, Firefox 75+, Safari 13+)
4. **ç¼–è¾‘é™åˆ¶**: ç¼–è¾‘åŠŸèƒ½ä¸»è¦æ”¯æŒæ–‡æœ¬å†…å®¹ï¼Œå¤æ‚æ ¼å¼å¯èƒ½ä¸¢å¤±

## å¼€å‘è¯´æ˜

è¿™ä¸ªæ¼”ç¤ºé¡¹ç›®ä½¿ç”¨äº†æ¨¡æ‹Ÿçš„ DocumentViewer ç±» (`mock-docview.js`)ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­åº”è¯¥ï¼š

1. å®‰è£…å®Œæ•´çš„ `@ldesign/docview` åŒ…
2. æ›¿æ¢å¯¼å…¥è¯­å¥ï¼š
   ```javascript
   // æ›¿æ¢
   import { DocumentViewer } from './mock-docview.js'
   
   // ä¸º
   import { DocumentViewer } from '@ldesign/docview'
   ```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
