<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›¾ç‰‡ç¼–è¾‘åŠŸèƒ½æµ‹è¯•</title>
  <link rel="stylesheet" href="./dist/editor.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    h1 {
      margin-top: 0;
      color: #333;
    }
    
    .instructions {
      background: #e8f4fd;
      border-left: 4px solid #2196F3;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    
    .instructions h3 {
      margin-top: 0;
      color: #1976D2;
    }
    
    .instructions ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    
    .instructions li {
      margin: 5px 0;
    }
    
    .editor-container {
      min-height: 400px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .test-buttons {
      margin: 20px 0;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    button {
      padding: 8px 16px;
      background: #2196F3;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    
    button:hover {
      background: #1976D2;
    }
    
    .console-output {
      background: #f0f0f0;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 10px;
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 12px;
    }
    
    .console-output .log-entry {
      margin: 2px 0;
    }
    
    .console-output .log-info {
      color: #2196F3;
    }
    
    .console-output .log-success {
      color: #4CAF50;
    }
    
    .console-output .log-warning {
      color: #FF9800;
    }
    
    .console-output .log-error {
      color: #F44336;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ–¼ï¸ å›¾ç‰‡ç¼–è¾‘åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="instructions">
      <h3>ä½¿ç”¨è¯´æ˜ï¼š</h3>
      <ul>
        <li><strong>ç‚¹å‡»å›¾ç‰‡</strong>ï¼šé€‰ä¸­å›¾ç‰‡å¹¶æ˜¾ç¤ºè°ƒæ•´å¤§å°çš„æ‰‹æŸ„</li>
        <li><strong>æ‹–åŠ¨æ‰‹æŸ„</strong>ï¼šè°ƒæ•´å›¾ç‰‡å°ºå¯¸ï¼ˆè§’ç‚¹ä¿æŒæ¯”ä¾‹ï¼Œè¾¹ç¼˜è‡ªç”±è°ƒæ•´ï¼‰</li>
        <li><strong>å³é”®ç‚¹å‡»å›¾ç‰‡</strong>ï¼šæ‰“å¼€åŠŸèƒ½èœå•</li>
        <li><strong>åŒå‡»å›¾ç‰‡</strong>ï¼šæ‰“å¼€å±æ€§å¯¹è¯æ¡†</li>
      </ul>
      <h3>å³é”®èœå•åŠŸèƒ½ï¼š</h3>
      <ul>
        <li>ğŸ¨ <strong>æ»¤é•œæ•ˆæœ</strong>ï¼šé»‘ç™½ã€å¤å¤ã€æ¨¡ç³Šã€å¢äº®ã€å¯¹æ¯”åº¦ã€åè‰²</li>
        <li>ğŸ“ <strong>å°ºå¯¸è°ƒæ•´</strong>ï¼šé¢„è®¾å°ºå¯¸æˆ–è‡ªå®šä¹‰å¤§å°</li>
        <li>â†”ï¸ <strong>å¯¹é½æ–¹å¼</strong>ï¼šå·¦å¯¹é½ã€å±…ä¸­ã€å³å¯¹é½</li>
        <li>ğŸ“ <strong>æ–‡å­—ç¯ç»•</strong>ï¼šæ— ç¯ç»•ã€å·¦ä¾§ç¯ç»•ã€å³ä¾§ç¯ç»•</li>
        <li>ğŸ–¼ï¸ <strong>è¾¹æ¡†æ ·å¼</strong>ï¼šç»†è¾¹æ¡†ã€ä¸­ç­‰ã€ç²—è¾¹æ¡†ã€åœ†è§’</li>
        <li>ğŸŒ‘ <strong>é˜´å½±æ•ˆæœ</strong>ï¼šå°ã€ä¸­ã€å¤§é˜´å½±</li>
      </ul>
    </div>
    
    <div class="test-buttons">
      <button onclick="insertTestImage()">æ’å…¥æµ‹è¯•å›¾ç‰‡</button>
      <button onclick="insertRandomImage()">æ’å…¥éšæœºå›¾ç‰‡</button>
      <button onclick="insertMultipleImages()">æ’å…¥å¤šå¼ å›¾ç‰‡</button>
      <button onclick="clearEditor()">æ¸…ç©ºç¼–è¾‘å™¨</button>
      <button onclick="checkPluginStatus()">æ£€æŸ¥æ’ä»¶çŠ¶æ€</button>
      <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
    </div>
    
    <div id="editor" class="editor-container"></div>
    
    <div id="console" class="console-output">
      <div class="log-entry log-info">æ§åˆ¶å°è¾“å‡º...</div>
    </div>
  </div>

  <script type="module">
    // å¯¼å…¥ç¼–è¾‘å™¨
    import { Editor } from './dist/editor.es.js';
    
    // æ—¥å¿—è¾“å‡ºå‡½æ•°
    function log(message, type = 'info') {
      const consoleDiv = document.getElementById('console');
      const entry = document.createElement('div');
      entry.className = `log-entry log-${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      consoleDiv.appendChild(entry);
      consoleDiv.scrollTop = consoleDiv.scrollHeight;
      
      // åŒæ—¶è¾“å‡ºåˆ°æµè§ˆå™¨æ§åˆ¶å°
      console.log(message);
    }
    
    // æ¸…ç©ºæ§åˆ¶å°
    window.clearConsole = function() {
      document.getElementById('console').innerHTML = '<div class="log-entry log-info">æ§åˆ¶å°å·²æ¸…ç©º</div>';
    };
    
    // åˆå§‹åŒ–ç¼–è¾‘å™¨
    log('æ­£åœ¨åˆå§‹åŒ–ç¼–è¾‘å™¨...', 'info');
    
    const editor = new Editor({
      element: '#editor',
      placeholder: 'å¼€å§‹è¾“å…¥å†…å®¹ï¼Œæˆ–ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ’å…¥å›¾ç‰‡...',
      autofocus: false,
      plugins: 'all',
      content: '<p>æ¬¢è¿ä½¿ç”¨å›¾ç‰‡ç¼–è¾‘åŠŸèƒ½ï¼è¯·ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ’å…¥å›¾ç‰‡è¿›è¡Œæµ‹è¯•ã€‚</p>'
    });
    
    // å°†ç¼–è¾‘å™¨å®ä¾‹æš´éœ²åˆ°å…¨å±€
    window.editor = editor;
    
    log('ç¼–è¾‘å™¨åˆå§‹åŒ–å®Œæˆ', 'success');
    
    // ç›‘å¬ç¼–è¾‘å™¨äº‹ä»¶
    const editorElement = document.querySelector('#editor .ldesign-editor-content');
    
    if (editorElement) {
      // ç›‘å¬ç‚¹å‡»äº‹ä»¶
      editorElement.addEventListener('click', (e) => {
        if (e.target.tagName === 'IMG') {
          log(`ç‚¹å‡»äº†å›¾ç‰‡: ${e.target.src.substring(0, 50)}...`, 'info');
        }
      });
      
      // ç›‘å¬å³é”®äº‹ä»¶
      editorElement.addEventListener('contextmenu', (e) => {
        if (e.target.tagName === 'IMG') {
          log(`å³é”®ç‚¹å‡»å›¾ç‰‡: ${e.target.src.substring(0, 50)}...`, 'info');
        }
      });
      
      // ç›‘å¬åŒå‡»äº‹ä»¶
      editorElement.addEventListener('dblclick', (e) => {
        if (e.target.tagName === 'IMG') {
          log(`åŒå‡»äº†å›¾ç‰‡: ${e.target.src.substring(0, 50)}...`, 'info');
        }
      });
    }
    
    // æ’å…¥æµ‹è¯•å›¾ç‰‡
    window.insertTestImage = function() {
      const html = `<img src="https://picsum.photos/400/300" alt="æµ‹è¯•å›¾ç‰‡" title="è¿™æ˜¯ä¸€å¼ æµ‹è¯•å›¾ç‰‡">`;
      editor.insertHTML(html);
      log('å·²æ’å…¥æµ‹è¯•å›¾ç‰‡', 'success');
    };
    
    // æ’å…¥éšæœºå›¾ç‰‡
    window.insertRandomImage = function() {
      const width = 300 + Math.floor(Math.random() * 200);
      const height = 200 + Math.floor(Math.random() * 200);
      const html = `<img src="https://picsum.photos/${width}/${height}?random=${Date.now()}" alt="éšæœºå›¾ç‰‡">`;
      editor.insertHTML(html);
      log(`å·²æ’å…¥éšæœºå›¾ç‰‡ (${width}x${height})`, 'success');
    };
    
    // æ’å…¥å¤šå¼ å›¾ç‰‡
    window.insertMultipleImages = function() {
      const html = `
        <p>ä»¥ä¸‹æ˜¯å¤šå¼ ä¸åŒæ ·å¼çš„å›¾ç‰‡ï¼š</p>
        <img src="https://picsum.photos/300/200?random=1" alt="å›¾ç‰‡1" style="margin: 10px;">
        <img src="https://picsum.photos/250/250?random=2" alt="å›¾ç‰‡2" style="margin: 10px; border: 2px solid blue;">
        <img src="https://picsum.photos/350/200?random=3" alt="å›¾ç‰‡3" style="margin: 10px; filter: grayscale(100%);">
      `;
      editor.insertHTML(html);
      log('å·²æ’å…¥å¤šå¼ å›¾ç‰‡', 'success');
    };
    
    // æ¸…ç©ºç¼–è¾‘å™¨
    window.clearEditor = function() {
      editor.setContent('<p>ç¼–è¾‘å™¨å†…å®¹å·²æ¸…ç©º</p>');
      log('ç¼–è¾‘å™¨å·²æ¸…ç©º', 'warning');
    };
    
    // æ£€æŸ¥æ’ä»¶çŠ¶æ€
    window.checkPluginStatus = function() {
      log('æ£€æŸ¥æ’ä»¶çŠ¶æ€...', 'info');
      
      // æ£€æŸ¥æ’ä»¶ç®¡ç†å™¨
      if (editor.plugins) {
        const allPlugins = editor.plugins.getAll();
        log(`å·²åŠ è½½ ${allPlugins.length} ä¸ªæ’ä»¶`, 'success');
        
        // æŸ¥æ‰¾ç‰¹å®šæ’ä»¶
        const imageResizePlugin = editor.plugins.get('imageResize');
        const mediaContextMenuPlugin = editor.plugins.get('MediaContextMenu');
        
        if (imageResizePlugin) {
          log('âœ“ ImageResizePlugin å·²åŠ è½½', 'success');
        } else {
          log('âœ— ImageResizePlugin æœªæ‰¾åˆ°', 'error');
        }
        
        if (mediaContextMenuPlugin) {
          log('âœ“ MediaContextMenuPlugin å·²åŠ è½½', 'success');
        } else {
          log('âœ— MediaContextMenuPlugin æœªæ‰¾åˆ°', 'error');
        }
        
        // åˆ—å‡ºæ‰€æœ‰æ’ä»¶åç§°
        allPlugins.forEach(plugin => {
          log(`  - ${plugin.name}`, 'info');
        });
      } else {
        log('æ’ä»¶ç®¡ç†å™¨ä¸å¯ç”¨', 'error');
      }
      
      // æ£€æŸ¥å‘½ä»¤
      const commands = editor.commands.getCommands();
      log(`å·²æ³¨å†Œ ${Object.keys(commands).length} ä¸ªå‘½ä»¤`, 'info');
      
      // æ£€æŸ¥åª’ä½“ç›¸å…³å‘½ä»¤
      if (commands.insertImage) {
        log('âœ“ insertImage å‘½ä»¤å·²æ³¨å†Œ', 'success');
      }
      if (commands.insertVideo) {
        log('âœ“ insertVideo å‘½ä»¤å·²æ³¨å†Œ', 'success');
      }
      if (commands.insertAudio) {
        log('âœ“ insertAudio å‘½ä»¤å·²æ³¨å†Œ', 'success');
      }
    };
    
    // åˆå§‹çŠ¶æ€æ£€æŸ¥
    setTimeout(() => {
      checkPluginStatus();
    }, 1000);
  </script>
</body>
</html>