<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>图片编辑功能测试 - LDesign Editor</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, -apple-system, BlinkMacSystemFont, 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    h1 {
      font-size: 2rem;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .subtitle {
      font-size: 1.1rem;
      opacity: 0.95;
      margin-bottom: 20px;
    }
    
    .features {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin-top: 20px;
    }
    
    .feature-badge {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .toolbar {
      background: #f8fafc;
      padding: 20px;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }
    
    .btn-group {
      display: flex;
      gap: 8px;
      align-items: center;
      padding: 0 10px;
      border-right: 1px solid #cbd5e1;
    }
    
    .btn-group:last-child {
      border-right: none;
    }
    
    .btn-group-label {
      font-size: 0.85rem;
      color: #64748b;
      font-weight: 500;
      margin-right: 5px;
    }
    
    button {
      background: white;
      border: 1px solid #cbd5e1;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #475569;
      font-weight: 500;
    }
    
    button:hover {
      background: #f1f5f9;
      border-color: #94a3b8;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.primary {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      color: white;
      border: none;
    }
    
    button.primary:hover {
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
    }
    
    .editor-wrapper {
      padding: 30px;
      min-height: 500px;
    }
    
    #editor {
      min-height: 400px;
      max-height: 600px;
      overflow-y: auto;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 20px;
      font-size: 16px;
      line-height: 1.6;
      background: white;
      transition: border-color 0.3s;
    }
    
    #editor:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .help-panel {
      background: #f8fafc;
      padding: 20px 30px;
      border-top: 1px solid #e2e8f0;
    }
    
    .help-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .help-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .help-section {
      background: white;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #e2e8f0;
    }
    
    .help-section h3 {
      font-size: 0.95rem;
      color: #3b82f6;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .help-list {
      list-style: none;
      font-size: 0.9rem;
      color: #64748b;
      line-height: 1.8;
    }
    
    .help-list li {
      padding-left: 20px;
      position: relative;
    }
    
    .help-list li:before {
      content: '✓';
      position: absolute;
      left: 0;
      color: #10b981;
      font-weight: bold;
    }
    
    .shortcut {
      background: #f1f5f9;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.85rem;
      color: #475569;
      margin-left: 5px;
    }
    
    .status-bar {
      background: #1e293b;
      color: white;
      padding: 10px 30px;
      font-size: 0.85rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .status-indicator {
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* 确保图片相关的样式正确 */
    #editor img {
      max-width: 100%;
      cursor: pointer;
      display: inline-block;
      margin: 10px;
    }

    /* 移除悬停效果 */
    #editor img:hover {
      /* 不添加任何悬停样式 */
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🖼️ 图片编辑功能测试</h1>
      <p class="subtitle">点击图片调整大小 • 右键打开功能菜单 • 双击编辑属性</p>
      <div class="features">
        <div class="feature-badge">
          <span>📏</span> 拖动调整大小
        </div>
        <div class="feature-badge">
          <span>🎨</span> 滤镜效果
        </div>
        <div class="feature-badge">
          <span>📝</span> 文字环绕
        </div>
        <div class="feature-badge">
          <span>🖼️</span> 边框样式
        </div>
        <div class="feature-badge">
          <span>🌑</span> 阴影效果
        </div>
        <div class="feature-badge">
          <span>⚙️</span> 图片属性
        </div>
      </div>
    </div>
    
    <div class="toolbar">
      <div class="btn-group">
        <span class="btn-group-label">插入媒体:</span>
        <button onclick="insertImage()">
          <span>🖼️</span> 插入图片
        </button>
        <button onclick="insertVideo()">
          <span>🎬</span> 插入视频
        </button>
        <button onclick="insertAudio()">
          <span>🎵</span> 插入音频
        </button>
      </div>
      
      <div class="btn-group">
        <span class="btn-group-label">示例图片:</span>
        <button onclick="insertSampleImage('nature')">
          <span>🏔️</span> 风景
        </button>
        <button onclick="insertSampleImage('tech')">
          <span>💻</span> 科技
        </button>
        <button onclick="insertSampleImage('abstract')">
          <span>🎨</span> 抽象
        </button>
      </div>
      
      <div class="btn-group">
        <span class="btn-group-label">快速操作:</span>
        <button onclick="clearEditor()">
          <span>🗑️</span> 清空
        </button>
        <button onclick="addSampleContent()">
          <span>📄</span> 示例内容
        </button>
      </div>
    </div>
    
    <div class="editor-wrapper">
      <div id="editor" contenteditable="true">
        <p>欢迎使用图片编辑功能！请点击上方按钮插入图片，或直接粘贴图片到编辑器中。</p>
        <p>插入图片后，您可以：</p>
        <ul>
          <li><strong>单击图片</strong> - 显示调整大小手柄，拖动角点或边缘调整尺寸</li>
          <li><strong>右键点击图片</strong> - 打开功能菜单，设置滤镜、文字环绕、边框等</li>
          <li><strong>双击图片</strong> - 打开属性对话框，编辑标题、替代文本等</li>
        </ul>
      </div>
    </div>
    
    <div class="help-panel">
      <h2 class="help-title">
        <span>💡</span> 功能说明
      </h2>
      <div class="help-grid">
        <div class="help-section">
          <h3><span>🖱️</span> 调整大小</h3>
          <ul class="help-list">
            <li>单击图片显示8个调整手柄</li>
            <li>拖动角点等比例缩放</li>
            <li>拖动边缘自由调整宽高</li>
            <li>实时显示当前尺寸</li>
            <li>按<span class="shortcut">ESC</span>取消调整</li>
          </ul>
        </div>
        
        <div class="help-section">
          <h3><span>🎨</span> 滤镜效果</h3>
          <ul class="help-list">
            <li>黑白、复古、模糊效果</li>
            <li>亮度、对比度调整</li>
            <li>反色特效</li>
            <li>可组合多种滤镜</li>
            <li>一键清除所有滤镜</li>
          </ul>
        </div>
        
        <div class="help-section">
          <h3><span>📐</span> 布局样式</h3>
          <ul class="help-list">
            <li>左对齐、居中、右对齐</li>
            <li>文字环绕（左侧/右侧）</li>
            <li>边框样式（细/中/粗/圆角）</li>
            <li>阴影效果（小/中/大）</li>
            <li>自定义尺寸设置</li>
          </ul>
        </div>
        
        <div class="help-section">
          <h3><span>⌨️</span> 快捷键</h3>
          <ul class="help-list">
            <li><span class="shortcut">Alt+Enter</span> 图片属性</li>
            <li><span class="shortcut">Ctrl+C</span> 复制图片</li>
            <li><span class="shortcut">Ctrl+S</span> 保存图片</li>
            <li><span class="shortcut">Delete</span> 删除图片</li>
            <li><span class="shortcut">ESC</span> 取消操作</li>
          </ul>
        </div>
      </div>
    </div>
    
    <div class="status-bar">
      <div class="status-item">
        <span class="status-indicator"></span>
        <span>编辑器就绪</span>
      </div>
      <div class="status-item">
        <span id="imageCount">图片: 0</span> | 
        <span id="lastAction" style="margin-left: 10px;">等待操作...</span>
      </div>
    </div>
  </div>

  <!-- 引入编辑器脚本 -->
  <script type="module">
    import { Editor } from '../dist/editor.es.js';
    
    // 初始化编辑器
    const editor = new Editor({
      element: '#editor',
      placeholder: '开始输入内容...',
      autofocus: false,
      plugins: 'all' // 使用所有插件
    });
    
    window.editor = editor;
    
    // 插入图片函数
    window.insertImage = function() {
      const url = prompt('请输入图片URL:', 'https://picsum.photos/400/300?random=' + Date.now());
      if (url) {
        editor.execute('insertImage', url);
        updateStatus('插入了一张图片');
        updateImageCount();
      }
    };
    
    // 插入视频函数
    window.insertVideo = function() {
      const url = prompt('请输入视频URL:', 'https://www.w3schools.com/html/mov_bbb.mp4');
      if (url) {
        editor.execute('insertVideo', url);
        updateStatus('插入了一个视频');
      }
    };
    
    // 插入音频函数
    window.insertAudio = function() {
      const url = prompt('请输入音频URL:', 'https://www.w3schools.com/html/horse.mp3');
      if (url) {
        editor.execute('insertAudio', url);
        updateStatus('插入了一个音频');
      }
    };
    
    // 插入示例图片
    window.insertSampleImage = function(type) {
      const images = {
        nature: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=400&fit=crop',
        tech: 'https://images.unsplash.com/photo-1518770660439-4636190af475?w=600&h=400&fit=crop',
        abstract: 'https://images.unsplash.com/photo-1557683316-973673baf926?w=600&h=400&fit=crop'
      };
      
      const url = images[type] || images.nature;
      const img = `<img src="${url}" alt="${type} image" title="示例${type}图片" style="max-width: 500px;">`;
      editor.insertHTML(img);
      updateStatus(`插入了${type}示例图片`);
      updateImageCount();
    };
    
    // 清空编辑器
    window.clearEditor = function() {
      if (confirm('确定要清空编辑器内容吗？')) {
        editor.setContent('<p>编辑器已清空，请重新开始。</p>');
        updateStatus('清空了编辑器');
        updateImageCount();
      }
    };
    
    // 添加示例内容
    window.addSampleContent = function() {
      const content = `
        <h2>图片编辑功能演示</h2>
        <p>这里是一些示例内容，包含了不同样式的图片展示：</p>
        
        <h3>1. 左浮动图片</h3>
        <img src="https://picsum.photos/300/200?random=1" 
             alt="左浮动示例" 
             title="左侧文字环绕效果"
             style="float: left; margin: 0 20px 20px 0; border-radius: 8px;">
        <p>这是一段文字，展示了图片左浮动时的文字环绕效果。当图片设置为左浮动后，文字会自动环绕在图片的右侧和下方。这种布局方式常用于文章配图，可以让内容更加生动有趣。你可以右键点击图片，选择不同的环绕方式。</p>
        <p style="clear: both;"></p>
        
        <h3>2. 居中图片带边框</h3>
        <div style="text-align: center;">
          <img src="https://picsum.photos/400/250?random=2" 
               alt="居中示例" 
               title="居中显示的图片"
               style="border: 3px solid #3b82f6; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        </div>
        
        <h3>3. 带滤镜效果的图片</h3>
        <p>下面的图片应用了不同的滤镜效果：</p>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
          <img src="https://picsum.photos/200/200?random=3" 
               alt="黑白滤镜" 
               title="黑白效果"
               style="filter: grayscale(100%);">
          <img src="https://picsum.photos/200/200?random=4" 
               alt="复古滤镜" 
               title="复古效果"
               style="filter: sepia(100%);">
          <img src="https://picsum.photos/200/200?random=5" 
               alt="高对比度" 
               title="高对比度"
               style="filter: contrast(1.5);">
        </div>
        
        <p>💡 <strong>提示：</strong>试试点击、右键或双击这些图片来体验不同的编辑功能！</p>
      `;
      
      editor.insertHTML(content);
      updateStatus('添加了示例内容');
      updateImageCount();
    };
    
    // 更新状态栏
    function updateStatus(action) {
      document.getElementById('lastAction').textContent = action;
    }
    
    // 更新图片数量
    function updateImageCount() {
      const images = document.querySelectorAll('#editor img');
      document.getElementById('imageCount').textContent = `图片: ${images.length}`;
    }
    
    // 监听编辑器变化
    const editorElement = document.getElementById('editor');
    editorElement.addEventListener('input', () => {
      updateImageCount();
    });
    
    // 监听图片操作
    editorElement.addEventListener('click', (e) => {
      if (e.target.tagName === 'IMG') {
        updateStatus('选中了图片 - 可以调整大小');
      }
    });
    
    editorElement.addEventListener('contextmenu', (e) => {
      if (e.target.tagName === 'IMG') {
        updateStatus('打开了图片菜单');
      }
    });
    
    editorElement.addEventListener('dblclick', (e) => {
      if (e.target.tagName === 'IMG') {
        updateStatus('打开了图片属性对话框');
      }
    });
    
    // 初始化
    updateImageCount();
    console.log('图片编辑功能测试页面已加载');
  </script>
</body>
</html>