<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Table Editor Demo</title>
  <link rel="stylesheet" href="../dist/style.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    .demo-section {
      margin-bottom: 40px;
    }

    .demo-section h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.5rem;
      border-bottom: 2px solid #667eea;
      padding-bottom: 5px;
    }

    .demo-section p {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .editor-container {
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 20px;
      transition: border-color 0.3s ease;
    }

    .editor-container:focus-within {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .toolbar {
      background: #f8f9fa;
      border-bottom: 1px solid #e1e5e9;
      padding: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .toolbar-group {
      display: flex;
      gap: 5px;
      align-items: center;
    }

    .toolbar-separator {
      width: 1px;
      height: 24px;
      background: #dee2e6;
      margin: 0 10px;
    }

    .toolbar-button {
      background: #667eea;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .toolbar-button:hover {
      background: #5a67d8;
      transform: translateY(-1px);
    }

    .toolbar-button:disabled {
      background: #cbd5e0;
      cursor: not-allowed;
      transform: none;
    }

    .toolbar-select {
      border: 1px solid #ced4da;
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 14px;
      background: white;
      cursor: pointer;
    }

    .editor-content {
      min-height: 400px;
      padding: 20px;
      font-size: 16px;
      line-height: 1.6;
      color: #333;
    }

    .instructions {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 0 8px 8px 0;
    }

    .instructions h3 {
      color: #667eea;
      margin-bottom: 10px;
    }

    .instructions ul {
      margin-left: 20px;
    }

    .instructions li {
      margin-bottom: 5px;
      color: #666;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .feature-card {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      border: 1px solid #e1e5e9;
    }

    .feature-card h3 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 1.2rem;
    }

    .feature-card ul {
      list-style: none;
      padding: 0;
    }

    .feature-card li {
      padding: 5px 0;
      color: #666;
      position: relative;
      padding-left: 20px;
    }

    .feature-card li::before {
      content: '‚úì';
      position: absolute;
      left: 0;
      color: #28a745;
      font-weight: bold;
    }

    @media (max-width: 768px) {
      .content {
        padding: 20px;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .toolbar {
        flex-direction: column;
        align-items: stretch;
      }
      
      .toolbar-group {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìä Advanced Table Editor</h1>
      <p>Experience powerful table editing with cell merging, styling, and advanced operations</p>
    </div>

    <div class="content">
      <!-- Instructions -->
      <div class="instructions">
        <h3>üéØ How to Use the Table Editor</h3>
        <ul>
          <li><strong>Create Table:</strong> Click "Insert Table" or press Ctrl+Shift+T</li>
          <li><strong>Navigate:</strong> Use Tab/Shift+Tab to move between cells</li>
          <li><strong>Table Controls:</strong> Right-click on table or press F2 for context menu</li>
          <li><strong>Arrow Navigation:</strong> Use Ctrl+Arrow keys to navigate cells</li>
          <li><strong>Add Row:</strong> Press Ctrl+Enter to add row below</li>
          <li><strong>Delete Table:</strong> Press Ctrl+Shift+Delete</li>
        </ul>
      </div>

      <!-- Main Editor Demo -->
      <div class="demo-section">
        <h2>üéØ Interactive Table Editor</h2>
        <p>Create and edit tables with advanced features like cell merging, styling, and column width adjustment.</p>
        
        <div class="editor-container">
          <div class="toolbar" id="table-toolbar">
            <div class="toolbar-group">
              <button class="toolbar-button" id="insert-table">
                üìä Insert Table
              </button>
              <button class="toolbar-button" id="insert-row-above">
                ‚¨ÜÔ∏è Row Above
              </button>
              <button class="toolbar-button" id="insert-row-below">
                ‚¨áÔ∏è Row Below
              </button>
              <button class="toolbar-button" id="delete-row">
                üóëÔ∏è Delete Row
              </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
              <button class="toolbar-button" id="insert-col-left">
                ‚¨ÖÔ∏è Col Left
              </button>
              <button class="toolbar-button" id="insert-col-right">
                ‚û°Ô∏è Col Right
              </button>
              <button class="toolbar-button" id="delete-col">
                üóëÔ∏è Delete Col
              </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
              <button class="toolbar-button" id="merge-cells">
                üîó Merge Cells
              </button>
              <button class="toolbar-button" id="split-cell">
                ‚úÇÔ∏è Split Cell
              </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
              <button class="toolbar-button" id="align-left">
                ‚¨ÖÔ∏è Left
              </button>
              <button class="toolbar-button" id="align-center">
                ‚ÜîÔ∏è Center
              </button>
              <button class="toolbar-button" id="align-right">
                ‚û°Ô∏è Right
              </button>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
              <select class="toolbar-select" id="column-width">
                <option value="">Column Width</option>
                <option value="100px">100px</option>
                <option value="150px">150px</option>
                <option value="200px">200px</option>
                <option value="25%">25%</option>
                <option value="50%">50%</option>
                <option value="auto">Auto</option>
              </select>
            </div>
            
            <div class="toolbar-separator"></div>
            
            <div class="toolbar-group">
              <button class="toolbar-button" id="delete-table">
                üóëÔ∏è Delete Table
              </button>
            </div>
          </div>
          
          <div id="table-editor" class="editor-content"></div>
        </div>
      </div>

      <!-- Features Overview -->
      <div class="demo-section">
        <h2>‚ú® Advanced Table Features</h2>
        <div class="feature-grid">
          <div class="feature-card">
            <h3>üìä Table Creation</h3>
            <ul>
              <li>Custom row and column count</li>
              <li>Optional header row</li>
              <li>Configurable table width</li>
              <li>Custom CSS classes</li>
              <li>Keyboard shortcut support</li>
            </ul>
          </div>
          
          <div class="feature-card">
            <h3>üîß Table Manipulation</h3>
            <ul>
              <li>Insert/delete rows and columns</li>
              <li>Tab navigation between cells</li>
              <li>Arrow key navigation</li>
              <li>Auto-expand on Tab at end</li>
              <li>Context menu operations</li>
            </ul>
          </div>
          
          <div class="feature-card">
            <h3>üé® Cell Operations</h3>
            <ul>
              <li>Merge and split cells</li>
              <li>Cell alignment (left/center/right)</li>
              <li>Background and text colors</li>
              <li>Bold and italic formatting</li>
              <li>Custom cell classes</li>
            </ul>
          </div>
          
          <div class="feature-card">
            <h3>üìè Advanced Styling</h3>
            <ul>
              <li>Column width adjustment</li>
              <li>Border style customization</li>
              <li>Border color and width</li>
              <li>Table-wide styling</li>
              <li>Dark theme support</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { 
      EnhancedEditor,
      TableFormattingPlugin,
      Delta
    } from '../dist/index.js';

    // Create editor with table plugin
    const editor = new EnhancedEditor('#table-editor', {
      placeholder: 'Click "Insert Table" to create your first table, or start typing...',
      theme: 'default'
    });

    const tablePlugin = new TableFormattingPlugin();
    editor.addPlugin(tablePlugin);

    // Set initial content with example
    const initialContent = new Delta()
      .insert('Advanced Table Editor Demo üìä\n', { header: 1 })
      .insert('\nThis editor demonstrates advanced table editing capabilities:\n\n')
      .insert('‚Ä¢ Cell merging and splitting\n')
      .insert('‚Ä¢ Column width adjustment\n')
      .insert('‚Ä¢ Cell alignment and styling\n')
      .insert('‚Ä¢ Keyboard navigation\n')
      .insert('‚Ä¢ Context menu operations\n\n')
      .insert('Try creating a table below! üëá\n\n');

    editor.setContents(initialContent);

    // Toolbar button handlers
    const buttons = {
      'insert-table': () => tablePlugin.commands['insert-table'].execute(editor),
      'insert-row-above': () => tablePlugin.commands['insert-table-row'].execute(editor, 'above'),
      'insert-row-below': () => tablePlugin.commands['insert-table-row'].execute(editor, 'below'),
      'delete-row': () => tablePlugin.commands['delete-table-row'].execute(editor),
      'insert-col-left': () => tablePlugin.commands['insert-table-column'].execute(editor, 'left'),
      'insert-col-right': () => tablePlugin.commands['insert-table-column'].execute(editor, 'right'),
      'delete-col': () => tablePlugin.commands['delete-table-column'].execute(editor),
      'merge-cells': () => tablePlugin.commands['merge-table-cells'].execute(editor),
      'split-cell': () => tablePlugin.commands['split-table-cell'].execute(editor),
      'align-left': () => tablePlugin.commands['set-cell-alignment'].execute(editor, 'left'),
      'align-center': () => tablePlugin.commands['set-cell-alignment'].execute(editor, 'center'),
      'align-right': () => tablePlugin.commands['set-cell-alignment'].execute(editor, 'right'),
      'delete-table': () => tablePlugin.commands['delete-table'].execute(editor)
    };

    // Attach button event listeners
    Object.entries(buttons).forEach(([id, handler]) => {
      const button = document.getElementById(id);
      if (button) {
        button.addEventListener('click', (e) => {
          e.preventDefault();
          handler();
        });
      }
    });

    // Column width selector
    const columnWidthSelect = document.getElementById('column-width');
    columnWidthSelect.addEventListener('change', (e) => {
      const width = e.target.value;
      if (width) {
        tablePlugin.commands['set-column-width'].execute(editor, width);
        e.target.value = ''; // Reset selection
      }
    });

    // Update button states based on editor state
    function updateButtonStates() {
      Object.entries(buttons).forEach(([id, _]) => {
        const button = document.getElementById(id);
        const command = tablePlugin.commands[id.replace(/-/g, '-').replace(/([A-Z])/g, '-$1').toLowerCase()];
        
        if (button && command) {
          button.disabled = !command.canExecute(editor);
        }
      });
    }

    // Update button states on selection change
    editor.on('selection-change', updateButtonStates);
    editor.on('text-change', updateButtonStates);

    // Initial button state update
    updateButtonStates();

    console.log('Advanced Table Editor initialized successfully!');
  </script>
</body>
</html>
