<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Emoji Picker Test - LDesign Editor</title>
  <style>
    body {
      margin: 0;
      padding: 40px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f3f4f6;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    h1 {
      color: #1f2937;
      margin-bottom: 10px;
      font-size: 24px;
    }
    .description {
      color: #6b7280;
      margin-bottom: 30px;
      line-height: 1.6;
    }
    #editor-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      overflow: hidden;
    }
    .status {
      margin-top: 20px;
      padding: 12px;
      background: #fef3c7;
      border: 1px solid #fcd34d;
      border-radius: 6px;
      color: #92400e;
      font-size: 14px;
    }
    .success {
      background: #d1fae5;
      border-color: #34d399;
      color: #065f46;
    }
    .error {
      background: #fee2e2;
      border-color: #f87171;
      color: #991b1b;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¨ è¡¨æƒ…é€‰æ‹©å™¨æµ‹è¯•</h1>
    <div class="description">
      ç‚¹å‡»å·¥å…·æ ä¸­çš„è¡¨æƒ…å›¾æ ‡ ğŸ˜Š æ‰“å¼€è¡¨æƒ…é€‰æ‹©å™¨ã€‚é€‰æ‹©å™¨ä¼šåœ¨æŒ‰é’®ä¸‹æ–¹æ˜¾ç¤ºï¼ŒåŒ…å«å¤šä¸ªåˆ†ç±»çš„è¡¨æƒ…ä¾›é€‰æ‹©ã€‚
    </div>
    
    <div id="editor-container"></div>
    
    <div id="status" class="status">
      æ­£åœ¨åŠ è½½ç¼–è¾‘å™¨...
    </div>
  </div>

  <script type="module">
    const status = document.getElementById('status');
    
    try {
      // åŠ¨æ€å¯¼å…¥ç¼–è¾‘å™¨æ¨¡å—
      const module = await import('./dist/index.js').catch(() => import('./src/index.ts'));
      const { Editor } = module;
      
      // åˆ›å»ºç¼–è¾‘å™¨å®ä¾‹
      const editor = new Editor({
        element: '#editor-container',
        content: `
          <h2>æ¬¢è¿ä½¿ç”¨ LDesign Editor! ğŸ˜Š</h2>
          <p>è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ”¯æŒï¼š</p>
          <ul>
            <li>ä¸°å¯Œçš„æ–‡æœ¬æ ¼å¼åŒ–é€‰é¡¹</li>
            <li>è¡¨æƒ…ç¬¦å·æ’å…¥ - ç‚¹å‡»å·¥å…·æ çš„è¡¨æƒ…æŒ‰é’®è¯•è¯•ï¼</li>
            <li>å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰åª’ä½“æ’å…¥</li>
            <li>è¡¨æ ¼ç¼–è¾‘</li>
            <li>ä»£ç å—é«˜äº®</li>
          </ul>
          <p>ç°åœ¨è¯•è¯•ç‚¹å‡»å·¥å…·æ çš„è¡¨æƒ…æŒ‰é’®ï¼Œæ’å…¥ä¸€äº›æœ‰è¶£çš„è¡¨æƒ…å§ï¼</p>
        `,
        placeholder: 'å¼€å§‹è¾“å…¥...',
        autofocus: true,
        toolbar: true,
        plugins: undefined // ä½¿ç”¨æ‰€æœ‰é»˜è®¤æ’ä»¶ï¼ŒåŒ…æ‹¬ EmojiPlugin
      });
      
      // ç›‘å¬ç¼–è¾‘å™¨äº‹ä»¶
      editor.on('ready', () => {
        console.log('Editor ready!');
        status.textContent = 'âœ… ç¼–è¾‘å™¨åŠ è½½æˆåŠŸï¼ç‚¹å‡»å·¥å…·æ çš„è¡¨æƒ…æŒ‰é’®å¼€å§‹æµ‹è¯•ã€‚';
        status.className = 'status success';
      });
      
      editor.on('update', () => {
        console.log('Content updated');
      });
      
      // æš´éœ²åˆ°å…¨å±€ä»¥ä¾¿è°ƒè¯•
      window.editor = editor;
      
      // æ£€æŸ¥æ’ä»¶æ˜¯å¦åŠ è½½
      setTimeout(() => {
        const plugins = editor.plugins.getAll();
        const emojiPlugin = plugins.find(p => p.name === 'emoji');
        
        if (emojiPlugin) {
          console.log('âœ… EmojiPlugin loaded successfully:', emojiPlugin);
        } else {
          console.error('âŒ EmojiPlugin not found!');
          status.textContent = 'âš ï¸ è¡¨æƒ…æ’ä»¶æœªæ­£ç¡®åŠ è½½ï¼Œè¯·æ£€æŸ¥é…ç½®ã€‚';
          status.className = 'status error';
        }
        
        // æ£€æŸ¥å‘½ä»¤æ˜¯å¦æ³¨å†Œ
        const commands = editor.commands.getCommands();
        if (commands.includes('insertEmoji')) {
          console.log('âœ… insertEmoji command registered');
        } else {
          console.error('âŒ insertEmoji command not registered');
        }
      }, 1000);
      
    } catch (error) {
      console.error('Failed to load editor:', error);
      status.textContent = `âŒ åŠ è½½å¤±è´¥: ${error.message}`;
      status.className = 'status error';
    }
  </script>
</body>
</html>