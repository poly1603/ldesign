<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal PDF Viewer - Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
            padding: 20px;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .demo-header {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 40px;
            animation: fadeIn 1s ease;
        }
        
        .demo-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .demo-header p {
            font-size: 1.1em;
            color: #6c757d;
        }
        
        .demo-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            animation: slideUp 0.8s ease;
        }
        
        .demo-section h2 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .viewer-container {
            height: 700px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }
        
        .demo-controls {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .demo-btn {
            padding: 10px 20px;
            background: #4a90e2;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .demo-btn:hover {
            background: #357abd;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.25);
        }
        
        .demo-btn:active {
            transform: translateY(0);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: center;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }
        
        .feature-card:hover {
            background: white;
            border-color: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .feature-card .icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .feature-card h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .feature-card p {
            color: #666;
            font-size: 14px;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .code-block pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }
        
        .tab.active {
            color: #4a90e2;
            border-bottom-color: #4a90e2;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .sample-list {
            list-style: none;
            padding: 0;
        }
        
        .sample-list li {
            padding: 10px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sample-list li:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        /* Loading and Error states */
        .pdf-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
            gap: 20px;
        }
        
        .pdf-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e0e0e0;
            border-top-color: #4a90e2;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .pdf-error {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #f44336;
            font-size: 16px;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>üéØ Universal PDF Viewer</h1>
            <p>A beautiful, feature-rich PDF viewer that works with any framework</p>
        </div>

        <!-- Main Demo Section -->
        <div class="demo-section">
            <h2>üìÑ Live Demo</h2>
            
            <div class="demo-controls">
                <button class="demo-btn" onclick="loadSamplePDF()">Load Sample PDF</button>
                <button class="demo-btn" onclick="openLocalFile()">Open Local File</button>
                <button class="demo-btn" onclick="toggleTheme()">Toggle Theme</button>
                <button class="demo-btn" onclick="viewer.fitToWidth()">Fit to Width</button>
                <button class="demo-btn" onclick="viewer.fitToHeight()">Fit to Height</button>
                <button class="demo-btn" onclick="viewer.print()">Print</button>
            </div>
            
            <div id="pdfViewer" class="viewer-container"></div>
        </div>

        <!-- Features Section -->
        <div class="demo-section">
            <h2>‚ú® Features</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="icon">üìñ</div>
                    <h3>Page Navigation</h3>
                    <p>Easy navigation through pages with keyboard shortcuts</p>
                </div>
                <div class="feature-card">
                    <div class="icon">üîç</div>
                    <h3>Zoom & Search</h3>
                    <p>Powerful zoom controls and text search functionality</p>
                </div>
                <div class="feature-card">
                    <div class="icon">üé®</div>
                    <h3>Theme Support</h3>
                    <p>Beautiful light and dark themes with smooth transitions</p>
                </div>
                <div class="feature-card">
                    <div class="icon">üì±</div>
                    <h3>Responsive</h3>
                    <p>Works perfectly on desktop, tablet, and mobile devices</p>
                </div>
                <div class="feature-card">
                    <div class="icon">‚ö°</div>
                    <h3>Fast Rendering</h3>
                    <p>Optimized performance with PDF.js rendering engine</p>
                </div>
                <div class="feature-card">
                    <div class="icon">üîß</div>
                    <h3>Customizable</h3>
                    <p>Highly customizable toolbar and UI components</p>
                </div>
            </div>
        </div>

        <!-- Usage Examples -->
        <div class="demo-section">
            <h2>üíª Usage Examples</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('vanilla')">Vanilla JS</button>
                <button class="tab" onclick="showTab('react')">React</button>
                <button class="tab" onclick="showTab('vue')">Vue</button>
                <button class="tab" onclick="showTab('angular')">Angular</button>
            </div>
            
            <div id="vanilla" class="tab-content active">
                <div class="code-block">
                    <pre>// Import the library
import UniversalPDFViewer from 'universal-pdf-viewer';

// Initialize the viewer
const viewer = new UniversalPDFViewer({
    container: '#pdfViewer',
    pdfUrl: 'path/to/your.pdf',
    theme: 'light',
    enableToolbar: true,
    enableSearch: true,
    enablePrint: true,
    defaultScale: 1.0
});

// Listen to events
viewer.on('pageChanged', ({ currentPage, totalPages }) => {
    console.log(`Page ${currentPage} of ${totalPages}`);
});

// Control programmatically
viewer.nextPage();
viewer.zoomIn();
viewer.search('keyword');</pre>
                </div>
            </div>
            
            <div id="react" class="tab-content">
                <div class="code-block">
                    <pre>import React from 'react';
import { PDFViewer } from 'universal-pdf-viewer/react';

function App() {
    const handlePageChange = (page, total) => {
        console.log(`Page ${page} of ${total}`);
    };

    return (
        &lt;PDFViewer
            pdfUrl="path/to/your.pdf"
            enableToolbar={true}
            enableSearch={true}
            theme="light"
            onPageChange={handlePageChange}
            style={{ height: '600px' }}
        /&gt;
    );
}

export default App;</pre>
                </div>
            </div>
            
            <div id="vue" class="tab-content">
                <div class="code-block">
                    <pre>&lt;template&gt;
    &lt;PDFViewer
        ref="pdfViewer"
        :pdf-url="pdfUrl"
        :enable-toolbar="true"
        :enable-search="true"
        theme="light"
        @page-change="onPageChange"
        height="600px"
    /&gt;
&lt;/template&gt;

&lt;script&gt;
import { PDFViewer } from 'universal-pdf-viewer/vue';

export default {
    components: { PDFViewer },
    data() {
        return {
            pdfUrl: 'path/to/your.pdf'
        };
    },
    methods: {
        onPageChange({ currentPage, totalPages }) {
            console.log(`Page ${currentPage} of ${totalPages}`);
        }
    }
};
&lt;/script&gt;</pre>
                </div>
            </div>
            
            <div id="angular" class="tab-content">
                <div class="code-block">
                    <pre>// app.module.ts
import { PDFViewerModule } from 'universal-pdf-viewer/angular';

@NgModule({
    imports: [PDFViewerModule]
})
export class AppModule { }

// app.component.ts
@Component({
    template: `
        &lt;pdf-viewer
            [pdfUrl]="pdfUrl"
            [enableToolbar]="true"
            [enableSearch]="true"
            theme="light"
            (pageChange)="onPageChange($event)"
        &gt;&lt;/pdf-viewer&gt;
    `
})
export class AppComponent {
    pdfUrl = 'path/to/your.pdf';
    
    onPageChange(event: any) {
        console.log(`Page ${event.currentPage} of ${event.totalPages}`);
    }
}</pre>
                </div>
            </div>
        </div>

        <!-- API Reference -->
        <div class="demo-section">
            <h2>üìö API Methods</h2>
            <ul class="sample-list">
                <li onclick="viewer.nextPage()">‚û°Ô∏è <strong>nextPage()</strong> - Navigate to next page</li>
                <li onclick="viewer.previousPage()">‚¨ÖÔ∏è <strong>previousPage()</strong> - Navigate to previous page</li>
                <li onclick="viewer.goToPage(1)">üìÑ <strong>goToPage(n)</strong> - Jump to specific page</li>
                <li onclick="viewer.zoomIn()">üîç+ <strong>zoomIn()</strong> - Increase zoom level</li>
                <li onclick="viewer.zoomOut()">üîç- <strong>zoomOut()</strong> - Decrease zoom level</li>
                <li onclick="viewer.setScale(1.5)">üìè <strong>setScale(n)</strong> - Set specific zoom scale</li>
                <li onclick="viewer.rotateClockwise()">üîÑ <strong>rotate()</strong> - Rotate the document</li>
                <li onclick="viewer.print()">üñ®Ô∏è <strong>print()</strong> - Print the document</li>
                <li onclick="viewer.download()">‚¨áÔ∏è <strong>download()</strong> - Download the PDF</li>
            </ul>
        </div>
    </div>

    <!-- Include PDF.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        window.pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    
    <!-- Include the built PDF Viewer Plugin with Clean Styles -->
    <link rel="stylesheet" href="./src/styles/pdf-viewer.css">
    
    <script>
        // Enhanced PDF Viewer Implementation
        class EnhancedPDFViewer {
            constructor(options) {
                this.container = document.querySelector(options.container);
                this.pdfDoc = null;
                this.pageNum = 1;
                this.scale = 1.0;
                this.pageMode = 'single'; // 'single' or 'continuous'
                this.init();
            }
        
            init() {
                // Create viewer structure
                this.container.innerHTML = `
                    <div class="pdf-viewer" data-theme="light" data-page-mode="single">
                        <div class="pdf-toolbar">
                            <div class="pdf-toolbar-section">
                                <button class="pdf-toolbar-button" onclick="viewer.toggleSidebar()" title="Toggle Sidebar">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="3" y1="12" x2="21" y2="12"></line>
                                        <line x1="3" y1="6" x2="21" y2="6"></line>
                                        <line x1="3" y1="18" x2="21" y2="18"></line>
                                    </svg>
                                </button>
                                <div class="pdf-page-navigation">
                                    <button class="pdf-toolbar-button" onclick="viewer.previousPage()">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="15 18 9 12 15 6"></polyline>
                                        </svg>
                                    </button>
                                    <input type="number" class="pdf-page-input" id="pageNum" value="1" min="1">
                                    <span class="pdf-page-label">/ <span id="totalPages">0</span></span>
                                    <button class="pdf-toolbar-button" onclick="viewer.nextPage()">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="9 18 15 12 9 6"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="pdf-toolbar-section">
                                <div class="pdf-zoom-controls">
                                    <button class="pdf-toolbar-button" onclick="viewer.zoomOut()">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <path d="m21 21-4.35-4.35"></path>
                                            <line x1="8" y1="11" x2="14" y2="11"></line>
                                        </svg>
                                    </button>
                                    <select class="pdf-scale-select" id="scaleSelect">
                                        <option value="0.5">50%</option>
                                        <option value="0.75">75%</option>
                                        <option value="1" selected>100%</option>
                                        <option value="1.25">125%</option>
                                        <option value="1.5">150%</option>
                                        <option value="2">200%</option>
                                    </select>
                                    <button class="pdf-toolbar-button" onclick="viewer.zoomIn()">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <path d="m21 21-4.35-4.35"></path>
                                            <line x1="11" y1="8" x2="11" y2="14"></line>
                                            <line x1="8" y1="11" x2="14" y2="11"></line>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="pdf-toolbar-section">
                                <button class="pdf-toolbar-button" onclick="viewer.togglePageMode()" title="Toggle Page Mode">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
                                    </svg>
                                </button>
                                <button class="pdf-toolbar-button" onclick="openLocalFile()" title="Open File">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"></path>
                                    </svg>
                                </button>
                                <button class="pdf-toolbar-button" onclick="loadSamplePDF()" title="Load Sample">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                </button>
                                <button class="pdf-toolbar-button" onclick="viewer.print()" title="Print">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                        <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
                                        <rect x="6" y="14" width="12" height="8"></rect>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        
                        <div class="pdf-sidebar">
                            <div class="pdf-sidebar-tabs">
                                <button class="pdf-sidebar-tab active">Thumbnails</button>
                                <button class="pdf-sidebar-tab">Bookmarks</button>
                            </div>
                            <div class="pdf-sidebar-content">
                                <div class="pdf-thumbnails-panel" id="thumbnails">
                                    <!-- Thumbnails will be generated here -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="pdf-canvas-container">
                            <!-- Canvas will be added dynamically -->
                        </div>
                    </div>
                `;
                
                // Setup event listeners
                document.getElementById('pageNum').addEventListener('change', (e) => {
                    this.goToPage(parseInt(e.target.value));
                });
                
                document.getElementById('scaleSelect').addEventListener('change', (e) => {
                    this.setScale(parseFloat(e.target.value));
                });
            }
        
            async loadPDF(url) {
                try {
                    // Show loading state
                    const container = document.querySelector('.pdf-canvas-container');
                    container.innerHTML = '<div class="pdf-loading"><div class="pdf-spinner"></div><div>Loading PDF...</div></div>';
                    
                    this.pdfDoc = await pdfjsLib.getDocument(url).promise;
                    
                    // Update total pages immediately after loading
                    const totalPagesElement = document.getElementById('totalPages');
                    if (totalPagesElement) {
                        totalPagesElement.textContent = this.pdfDoc.numPages;
                    }
                    
                    const pageNumInput = document.getElementById('pageNum');
                    if (pageNumInput) {
                        pageNumInput.max = this.pdfDoc.numPages;
                    }
                    
                    // Reset to first page
                    this.pageNum = 1;
                    
                    await this.renderPage(this.pageNum);
                    await this.generateThumbnails();
                } catch (error) {
                    console.error('Error loading PDF:', error);
                    const container = document.querySelector('.pdf-canvas-container');
                    container.innerHTML = '<div class="pdf-error">Failed to load PDF. Please try again.</div>';
                }
            }
            
            async renderPage(num) {
                if (!this.pdfDoc) return;
                
                if (this.pageMode === 'continuous') {
                    await this.renderAllPages();
                    this.scrollToPage(num);
                } else {
                    // Single page mode
                    const container = document.querySelector('.pdf-canvas-container');
                    container.innerHTML = '';
                    
                    // Reset container styles for single page mode
                    container.style.display = 'flex';
                    container.style.flexDirection = 'row';
                    container.style.alignItems = 'center';
                    container.style.justifyContent = 'center';
                    container.style.gap = '';
                    container.style.padding = '20px';
                    container.style.overflowY = 'auto';
                    
                    const canvas = document.createElement('canvas');
                    canvas.className = 'pdf-canvas';
                    canvas.style.boxShadow = '0 4px 16px rgba(0, 0, 0, 0.1)';
                    canvas.style.background = 'white';
                    canvas.style.borderRadius = '4px';
                    container.appendChild(canvas);
                    
                    const page = await this.pdfDoc.getPage(num);
                    const viewport = page.getViewport({scale: this.scale});
                    
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    const ctx = canvas.getContext('2d');
                    await page.render({
                        canvasContext: ctx,
                        viewport: viewport
                    }).promise;
                    
                    document.getElementById('pageNum').value = num;
                }
            }
            
            async renderAllPages() {
                const container = document.querySelector('.pdf-canvas-container');
                container.innerHTML = '';
                
                // Set container styles for vertical scrolling
                container.style.display = 'flex';
                container.style.flexDirection = 'column';
                container.style.alignItems = 'center';
                container.style.gap = '20px';
                container.style.padding = '20px';
                container.style.overflowY = 'auto';
                
                for (let i = 1; i <= this.pdfDoc.numPages; i++) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'pdf-page-wrapper';
                    wrapper.dataset.pageNumber = i;
                    wrapper.style.background = 'white';
                    wrapper.style.borderRadius = '4px';
                    wrapper.style.boxShadow = '0 4px 16px rgba(0, 0, 0, 0.1)';
                    wrapper.style.marginBottom = '20px';
                    
                    const canvas = document.createElement('canvas');
                    canvas.className = 'pdf-canvas';
                    canvas.style.display = 'block';
                    
                    wrapper.appendChild(canvas);
                    container.appendChild(wrapper);
                    
                    const page = await this.pdfDoc.getPage(i);
                    const viewport = page.getViewport({scale: this.scale});
                    
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    const ctx = canvas.getContext('2d');
                    await page.render({
                        canvasContext: ctx,
                        viewport: viewport
                    }).promise;
                }
                
                // Setup scroll listener
                container.addEventListener('scroll', () => this.handleScroll());
            }
            
            handleScroll() {
                clearTimeout(this.scrollTimeout);
                this.scrollTimeout = setTimeout(() => {
                    const container = document.querySelector('.pdf-canvas-container');
                    const pages = container.querySelectorAll('.pdf-page-wrapper');
                    const containerRect = container.getBoundingClientRect();
                    
                    // Find the page that's most visible in the viewport
                    for (let i = 0; i < pages.length; i++) {
                        const rect = pages[i].getBoundingClientRect();
                        // Check if page is visible in the container
                        const pageTop = rect.top - containerRect.top;
                        const pageBottom = rect.bottom - containerRect.top;
                        const containerHeight = containerRect.height;
                        
                        // If page is visible in the top half of the container
                        if (pageTop < containerHeight / 2 && pageBottom > 0) {
                            this.pageNum = i + 1;
                            document.getElementById('pageNum').value = this.pageNum;
                            this.updateThumbnails();
                            
                            // Scroll thumbnail into view
                            const thumbnailItem = document.querySelectorAll('.pdf-thumbnail-item')[i];
                            if (thumbnailItem) {
                                thumbnailItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                            break;
                        }
                    }
                }, 100);
            }
            
            scrollToPage(num) {
                const page = document.querySelector(`[data-page-number="${num}"]`);
                if (page) {
                    page.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
            
            async generateThumbnails() {
                if (!this.pdfDoc) return;
                
                const container = document.getElementById('thumbnails');
                container.innerHTML = '';
                
                // Generate thumbnails for all pages (or limit to 100 for large PDFs)
                const maxThumbnails = Math.min(this.pdfDoc.numPages, 100);
                for (let i = 1; i <= maxThumbnails; i++) {
                    const item = document.createElement('div');
                    item.className = 'pdf-thumbnail-item';
                    if (i === this.pageNum) item.classList.add('active');
                    
                    const canvas = document.createElement('canvas');
                    canvas.className = 'pdf-thumbnail-canvas';
                    
                    const label = document.createElement('div');
                    label.className = 'pdf-thumbnail-label';
                    label.textContent = `Page ${i}`;
                    
                    item.appendChild(canvas);
                    item.appendChild(label);
                    container.appendChild(item);
                    
                    item.onclick = () => this.goToPage(i);
                    
                    // Render thumbnail
                    const page = await this.pdfDoc.getPage(i);
                    const viewport = page.getViewport({scale: 0.2});
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;
                    
                    const ctx = canvas.getContext('2d');
                    await page.render({
                        canvasContext: ctx,
                        viewport: viewport
                    }).promise;
                }
            }
            
            goToPage(num) {
                if (!this.pdfDoc) return;
                
                if (num >= 1 && num <= this.pdfDoc.numPages) {
                    this.pageNum = num;
                    
                    if (this.pageMode === 'continuous') {
                        this.scrollToPage(num);
                    } else {
                        this.renderPage(num);
                    }
                    
                    this.updateThumbnails();
                }
            }
            
            updateThumbnails() {
                document.querySelectorAll('.pdf-thumbnail-item').forEach((el, i) => {
                    el.classList.toggle('active', i + 1 === this.pageNum);
                });
            }
            
            nextPage() {
                if (this.pdfDoc && this.pageNum < this.pdfDoc.numPages) {
                    this.goToPage(this.pageNum + 1);
                }
            }
            
            previousPage() {
                if (this.pdfDoc && this.pageNum > 1) {
                    this.goToPage(this.pageNum - 1);
                }
            }
            
            setScale(scale) {
                this.scale = scale;
                if (this.pdfDoc) {
                    if (this.pageMode === 'continuous') {
                        // Save current page before re-render
                        const currentPage = this.pageNum;
                        this.renderAllPages().then(() => {
                            // Restore scroll position to current page
                            this.scrollToPage(currentPage);
                        });
                    } else {
                        this.renderPage(this.pageNum);
                    }
                }
            }
            
            zoomIn() {
                if (!this.pdfDoc) return;
                this.setScale(Math.min(this.scale * 1.2, 3));
                document.getElementById('scaleSelect').value = this.scale.toFixed(2);
            }
            
            zoomOut() {
                if (!this.pdfDoc) return;
                this.setScale(Math.max(this.scale / 1.2, 0.3));
                document.getElementById('scaleSelect').value = this.scale.toFixed(2);
            }
            
            toggleSidebar() {
                document.querySelector('.pdf-sidebar').classList.toggle('hidden');
            }
            
            togglePageMode() {
                this.pageMode = this.pageMode === 'single' ? 'continuous' : 'single';
                const viewer = document.querySelector('.pdf-viewer');
                viewer.setAttribute('data-page-mode', this.pageMode);
                
                if (this.pdfDoc) {
                    this.renderPage(this.pageNum);
                }
            }
            
            print() {
                if (this.pdfDoc) {
                    window.print();
                }
            }
            
            async openLocalFile() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.pdf';
                input.onchange = async (e) => {
                    const file = e.target.files[0];
                    if (file && file.type === 'application/pdf') {
                        const fileReader = new FileReader();
                        fileReader.onload = async () => {
                            const typedarray = new Uint8Array(fileReader.result);
                            await this.loadPDF(typedarray);
                        };
                        fileReader.readAsArrayBuffer(file);
                    }
                };
                input.click();
            }
        }
        
        
        // Set PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        // Sample PDFs
        const samplePDFs = [
            { name: 'PDF.js Sample', url: 'https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/examples/learning/helloworld.pdf' },
            { name: 'Sample Document', url: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' }
        ];
        
        let viewer;
        
        // Initialize on load
        window.addEventListener('DOMContentLoaded', function() {
            viewer = new EnhancedPDFViewer({
                container: '#pdfViewer'
            });
            window.viewer = viewer;
            
            // Auto load sample
            setTimeout(() => {
                loadSamplePDF();
            }, 500);
        });
        
        function loadSamplePDF() {
            if (viewer && samplePDFs[0]) {
                viewer.loadPDF(samplePDFs[0].url);
            }
        }
        
        function openLocalFile() {
            if (viewer) {
                viewer.openLocalFile();
            }
        }
        
        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetTab = document.getElementById(tabName);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }
    </script>
</body>
</html>