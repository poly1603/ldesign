/**
 * @ldesign/cropper 动画样式
 * 
 * 定义各种动画效果和过渡动画
 */

// ============================================================================
// 基础动画关键帧
// ============================================================================

// 旋转动画
@keyframes lcropper-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

// 淡入动画
@keyframes lcropper-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

// 淡出动画
@keyframes lcropper-fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

// 滑入动画
@keyframes lcropper-slide-in {
  from {
    transform: translateY(-10px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

// 滑出动画
@keyframes lcropper-slide-out {
  from {
    transform: translateY(0);
    opacity: 1;
  }
  to {
    transform: translateY(-10px);
    opacity: 0;
  }
}

// 脉冲动画
@keyframes lcropper-pulse {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.7;
    transform: scale(1.05);
  }
}

// 弹跳动画
@keyframes lcropper-bounce {
  0%, 20%, 53%, 80%, 100% {
    transform: translate3d(0, 0, 0);
  }
  40%, 43% {
    transform: translate3d(0, -8px, 0);
  }
  70% {
    transform: translate3d(0, -4px, 0);
  }
  90% {
    transform: translate3d(0, -2px, 0);
  }
}

// 摇摆动画
@keyframes lcropper-shake {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-2px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(2px);
  }
}

// 缩放进入动画
@keyframes lcropper-scale-in {
  from {
    opacity: 0;
    transform: scale(0.8);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

// 缩放退出动画
@keyframes lcropper-scale-out {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.8);
  }
}

// 翻转动画
@keyframes lcropper-flip {
  0% {
    transform: perspective(400px) rotateY(0);
  }
  40% {
    transform: perspective(400px) translateZ(150px) rotateY(170deg);
  }
  50% {
    transform: perspective(400px) translateZ(150px) rotateY(190deg) scale(1);
  }
  80% {
    transform: perspective(400px) rotateY(360deg) scale(0.95);
  }
  100% {
    transform: perspective(400px) scale(1);
  }
}

// 呼吸动画
@keyframes lcropper-breathe {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.02);
  }
}

// ============================================================================
// 组件动画类
// ============================================================================

// 裁剪器容器动画
.lcropper {
  // 初始化动画
  &.lcropper-animate-init {
    animation: lcropper-fade-in 0.5s ease-out;
  }
  
  // 销毁动画
  &.lcropper-animate-destroy {
    animation: lcropper-fade-out 0.3s ease-in;
  }
}

// 裁剪区域动画
.lcropper-crop-area {
  // 创建动画
  &.lcropper-animate-create {
    animation: lcropper-scale-in 0.3s ease-out;
  }
  
  // 删除动画
  &.lcropper-animate-remove {
    animation: lcropper-scale-out 0.3s ease-in;
  }
  
  // 重置动画
  &.lcropper-animate-reset {
    animation: lcropper-bounce 0.6s ease-out;
  }
  
  // 错误动画
  &.lcropper-animate-error {
    animation: lcropper-shake 0.5s ease-in-out;
  }
  
  // 活跃动画
  &.lcropper-animate-active {
    animation: lcropper-pulse 2s ease-in-out infinite;
  }
}

// 控制点动画
.lcropper-control-point {
  // 出现动画
  &.lcropper-animate-appear {
    animation: lcropper-scale-in 0.2s ease-out;
  }
  
  // 消失动画
  &.lcropper-animate-disappear {
    animation: lcropper-scale-out 0.2s ease-in;
  }
  
  // 提示动画
  &.lcropper-animate-hint {
    animation: lcropper-pulse 1s ease-in-out 3;
  }
  
  // 激活动画
  &.lcropper-animate-activate {
    animation: lcropper-bounce 0.4s ease-out;
  }
}

// 工具栏动画
.lcropper-toolbar {
  // 滑入动画
  &.lcropper-animate-slide-in {
    animation: lcropper-slide-in 0.3s ease-out;
  }
  
  // 滑出动画
  &.lcropper-animate-slide-out {
    animation: lcropper-slide-out 0.3s ease-in;
  }
  
  // 淡入动画
  &.lcropper-animate-fade-in {
    animation: lcropper-fade-in 0.3s ease-out;
  }
  
  // 淡出动画
  &.lcropper-animate-fade-out {
    animation: lcropper-fade-out 0.3s ease-in;
  }
}

// 按钮动画
.lcropper-button {
  // 点击动画
  &.lcropper-animate-click {
    animation: lcropper-scale-in 0.1s ease-out;
  }
  
  // 加载动画
  &.lcropper-animate-loading {
    .lcropper-button-icon {
      animation: lcropper-spin 1s linear infinite;
    }
  }
  
  // 成功动画
  &.lcropper-animate-success {
    animation: lcropper-bounce 0.5s ease-out;
  }
  
  // 错误动画
  &.lcropper-animate-error {
    animation: lcropper-shake 0.3s ease-in-out;
  }
}

// 面板动画
.lcropper-panel {
  // 展开动画
  &.lcropper-animate-expand {
    animation: lcropper-scale-in 0.3s ease-out;
  }
  
  // 收起动画
  &.lcropper-animate-collapse {
    animation: lcropper-scale-out 0.3s ease-in;
  }
  
  // 翻转动画
  &.lcropper-animate-flip {
    animation: lcropper-flip 0.6s ease-in-out;
  }
}

// 工具提示动画
.lcropper-tooltip {
  // 显示动画
  &.lcropper-animate-show {
    animation: lcropper-fade-in 0.2s ease-out;
  }
  
  // 隐藏动画
  &.lcropper-animate-hide {
    animation: lcropper-fade-out 0.2s ease-in;
  }
}

// ============================================================================
// 交互动画
// ============================================================================

// 悬停动画
.lcropper-hover-lift {
  transition: transform var(--lcropper-transition-fast), box-shadow var(--lcropper-transition-fast);
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: var(--ldesign-shadow-2);
  }
}

// 悬停缩放
.lcropper-hover-scale {
  transition: transform var(--lcropper-transition-fast);
  
  &:hover {
    transform: scale(1.05);
  }
}

// 悬停旋转
.lcropper-hover-rotate {
  transition: transform var(--lcropper-transition-fast);
  
  &:hover {
    transform: rotate(5deg);
  }
}

// 点击波纹效果
.lcropper-ripple {
  position: relative;
  overflow: hidden;
  
  &::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.3s ease-out, height 0.3s ease-out;
  }
  
  &:active::before {
    width: 200px;
    height: 200px;
  }
}

// ============================================================================
// 状态过渡动画
// ============================================================================

// 加载状态过渡
.lcropper-loading-transition {
  transition: opacity var(--lcropper-transition-normal), filter var(--lcropper-transition-normal);
  
  &.lcropper-loading {
    opacity: 0.7;
    filter: blur(1px);
  }
}

// 禁用状态过渡
.lcropper-disabled-transition {
  transition: opacity var(--lcropper-transition-normal), filter var(--lcropper-transition-normal);
  
  &.lcropper-disabled {
    opacity: 0.6;
    filter: grayscale(50%);
  }
}

// 错误状态过渡
.lcropper-error-transition {
  transition: border-color var(--lcropper-transition-fast), box-shadow var(--lcropper-transition-fast);
  
  &.lcropper-error {
    border-color: var(--ldesign-error-color);
    box-shadow: 0 0 0 2px var(--ldesign-error-color-2);
  }
}

// ============================================================================
// 性能优化动画
// ============================================================================

// 硬件加速动画
.lcropper-gpu-accelerated {
  transform: translateZ(0);
  will-change: transform;
}

// 复合层动画
.lcropper-composite-layer {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

// 优化的变换动画
.lcropper-optimized-transform {
  will-change: transform;
  
  &.lcropper-animating {
    will-change: transform;
  }
  
  &:not(.lcropper-animating) {
    will-change: auto;
  }
}

// ============================================================================
// 响应式动画
// ============================================================================

// 移动端动画优化
.mobile-only({
  // 减少动画复杂度
  .lcropper-crop-area,
  .lcropper-control-point,
  .lcropper-toolbar {
    animation-duration: 0.2s !important;
  }
  
  // 简化悬停效果
  .lcropper-hover-lift:hover {
    transform: none;
  }
  
  .lcropper-hover-scale:hover {
    transform: scale(1.02);
  }
});

// ============================================================================
// 可访问性动画控制
// ============================================================================

// 减少动画偏好
@media (prefers-reduced-motion: reduce) {
  .lcropper {
    // 禁用所有动画
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
    
    // 保留必要的过渡效果
    .lcropper-button,
    .lcropper-input {
      transition: background-color 0.1s ease, border-color 0.1s ease;
    }
  }
}

// 高对比度模式下的动画调整
@media (prefers-contrast: high) {
  .lcropper {
    // 增强动画对比度
    .lcropper-pulse {
      animation-name: lcropper-pulse-high-contrast;
    }
  }
  
  @keyframes lcropper-pulse-high-contrast {
    0%, 100% {
      opacity: 1;
      transform: scale(1);
      border-width: 2px;
    }
    50% {
      opacity: 0.8;
      transform: scale(1.1);
      border-width: 3px;
    }
  }
}

// ============================================================================
// 动画工具类
// ============================================================================

// 暂停动画
.lcropper-animation-paused {
  animation-play-state: paused !important;
}

// 动画延迟
.lcropper-animation-delay-1 { animation-delay: 0.1s; }
.lcropper-animation-delay-2 { animation-delay: 0.2s; }
.lcropper-animation-delay-3 { animation-delay: 0.3s; }
.lcropper-animation-delay-4 { animation-delay: 0.4s; }
.lcropper-animation-delay-5 { animation-delay: 0.5s; }

// 动画速度
.lcropper-animation-fast { animation-duration: 0.1s; }
.lcropper-animation-normal { animation-duration: 0.3s; }
.lcropper-animation-slow { animation-duration: 0.5s; }

// 动画重复
.lcropper-animation-infinite { animation-iteration-count: infinite; }
.lcropper-animation-once { animation-iteration-count: 1; }

// 动画填充模式
.lcropper-animation-forwards { animation-fill-mode: forwards; }
.lcropper-animation-backwards { animation-fill-mode: backwards; }
.lcropper-animation-both { animation-fill-mode: both; }
