/**
 * @ldesign/cropper 样式混合器
 * 
 * 提供可重用的样式混合器和工具函数
 */

// ============================================================================
// 响应式混合器
// ============================================================================

// 移动端优先的媒体查询
.mobile-first(@rules) {
  @rules();
}

.tablet-up(@rules) {
  @media (min-width: @breakpoint-sm) {
    @rules();
  }
}

.desktop-up(@rules) {
  @media (min-width: @breakpoint-md) {
    @rules();
  }
}

.large-desktop-up(@rules) {
  @media (min-width: @breakpoint-lg) {
    @rules();
  }
}

// 移动端专用
.mobile-only(@rules) {
  @media (max-width: (@breakpoint-sm - 1px)) {
    @rules();
  }
}

// 平板端专用
.tablet-only(@rules) {
  @media (min-width: @breakpoint-sm) and (max-width: (@breakpoint-md - 1px)) {
    @rules();
  }
}

// 桌面端专用
.desktop-only(@rules) {
  @media (min-width: @breakpoint-md) {
    @rules();
  }
}

// ============================================================================
// 布局混合器
// ============================================================================

// Flexbox 居中
.flex-center() {
  display: flex;
  align-items: center;
  justify-content: center;
}

// Flexbox 垂直居中
.flex-center-vertical() {
  display: flex;
  align-items: center;
}

// Flexbox 水平居中
.flex-center-horizontal() {
  display: flex;
  justify-content: center;
}

// 绝对定位居中
.absolute-center() {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

// 填满父容器
.fill-parent() {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

// 清除浮动
.clearfix() {
  &::after {
    content: '';
    display: table;
    clear: both;
  }
}

// ============================================================================
// 视觉效果混合器
// ============================================================================

// 阴影效果
.shadow(@level: 1) when (@level = 1) {
  box-shadow: var(--ldesign-shadow-1);
}

.shadow(@level: 1) when (@level = 2) {
  box-shadow: var(--ldesign-shadow-2);
}

.shadow(@level: 1) when (@level = 3) {
  box-shadow: var(--ldesign-shadow-3);
}

// 边框圆角
.border-radius(@radius: var(--ls-border-radius-base)) {
  border-radius: @radius;
}

// 渐变背景
.gradient-bg(@start-color, @end-color, @direction: to bottom) {
  background: linear-gradient(@direction, @start-color, @end-color);
}

// 毛玻璃效果
.glass-effect(@blur: 10px, @opacity: 0.8) {
  backdrop-filter: blur(@blur);
  background-color: rgba(255, 255, 255, @opacity);
}

// ============================================================================
// 交互状态混合器
// ============================================================================

// 悬停效果
.hover-effect(@property: opacity, @value: 0.8, @duration: @transition-fast) {
  transition: @property @duration;
  
  &:hover {
    @{property}: @value;
  }
}

// 按钮状态
.button-states(@bg-color, @text-color: #ffffff) {
  background-color: @bg-color;
  color: @text-color;
  border: 1px solid @bg-color;
  transition: all @transition-fast;
  
  &:hover {
    background-color: lighten(@bg-color, 5%);
    border-color: lighten(@bg-color, 5%);
  }
  
  &:active {
    background-color: darken(@bg-color, 5%);
    border-color: darken(@bg-color, 5%);
    transform: translateY(1px);
  }
  
  &:disabled {
    background-color: var(--ldesign-gray-color-3);
    border-color: var(--ldesign-gray-color-3);
    color: var(--ldesign-text-color-disabled);
    cursor: not-allowed;
    transform: none;
  }
}

// 焦点状态
.focus-ring(@color: var(--ldesign-brand-color)) {
  &:focus-visible {
    outline: 2px solid @color;
    outline-offset: 2px;
  }
}

// ============================================================================
// 动画混合器
// ============================================================================

// 淡入动画
.fade-in(@duration: @transition-normal, @delay: 0s) {
  animation: lcropper-fade-in @duration ease-out @delay;
}

// 滑入动画
.slide-in(@duration: @transition-normal, @delay: 0s) {
  animation: lcropper-slide-in @duration ease-out @delay;
}

// 脉冲动画
.pulse(@duration: 2s) {
  animation: lcropper-pulse @duration ease-in-out infinite;
}

// 旋转动画
.spin(@duration: 1s) {
  animation: lcropper-spin @duration linear infinite;
}

// 缩放动画
.scale(@scale: 1.05, @duration: @transition-fast) {
  transition: transform @duration;
  
  &:hover {
    transform: scale(@scale);
  }
}

// ============================================================================
// 文本混合器
// ============================================================================

// 文本截断
.text-ellipsis() {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

// 多行文本截断
.text-ellipsis-multiline(@lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: @lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// 文本选择禁用
.no-select() {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

// ============================================================================
// 控制点混合器
// ============================================================================

// 基础控制点样式
.control-point-base(@size: var(--lcropper-control-point-size)) {
  position: absolute;
  width: @size;
  height: @size;
  background-color: var(--lcropper-control-point-bg);
  border: var(--lcropper-control-point-border-width) solid var(--lcropper-control-point-border);
  border-radius: 50%;
  box-shadow: var(--lcropper-control-point-shadow);
  cursor: pointer;
  transition: all @transition-fast;
  z-index: var(--lcropper-z-control-points);
  
  &:hover {
    background-color: var(--lcropper-control-point-hover-bg);
    transform: scale(1.1);
  }
  
  &:active {
    background-color: var(--lcropper-control-point-active-bg);
    transform: scale(0.95);
  }
  
  .focus-ring();
}

// 角落控制点
.corner-control-point() {
  .control-point-base();
  
  &::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 6px;
    height: 6px;
    background-color: var(--lcropper-control-point-border);
    border-radius: 50%;
    transform: translate(-50%, -50%);
  }
}

// 边缘控制点
.edge-control-point() {
  .control-point-base();
  border-radius: 2px;
  
  &::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 8px;
    height: 2px;
    background-color: var(--lcropper-control-point-border);
    border-radius: 1px;
    transform: translate(-50%, -50%);
  }
}

// 旋转控制点
.rotation-control-point() {
  .control-point-base();
  
  &::before {
    content: '↻';
    position: absolute;
    top: 50%;
    left: 50%;
    font-size: 10px;
    color: var(--lcropper-control-point-border);
    transform: translate(-50%, -50%);
  }
}

// ============================================================================
// 工具栏混合器
// ============================================================================

// 工具栏基础样式
.toolbar-base() {
  display: flex;
  align-items: center;
  gap: var(--lcropper-toolbar-gap);
  padding: var(--lcropper-toolbar-padding);
  background-color: var(--lcropper-toolbar-bg);
  border: 1px solid var(--lcropper-toolbar-border);
  border-radius: var(--ls-border-radius-base);
  box-shadow: var(--lcropper-toolbar-shadow);
  z-index: var(--lcropper-z-toolbar);
}

// 工具栏按钮
.toolbar-button() {
  display: flex;
  align-items: center;
  justify-content: center;
  height: var(--lcropper-button-height);
  padding: var(--lcropper-button-padding);
  background-color: transparent;
  border: 1px solid transparent;
  border-radius: var(--lcropper-button-radius);
  font-size: var(--lcropper-button-font-size);
  color: var(--ldesign-text-color-primary);
  cursor: pointer;
  transition: all @transition-fast;
  
  &:hover {
    background-color: var(--ldesign-bg-color-component-hover);
    border-color: var(--ldesign-border-color-hover);
  }
  
  &:active {
    background-color: var(--ldesign-bg-color-component-active);
    transform: translateY(1px);
  }
  
  &.active {
    background-color: var(--ldesign-brand-color);
    border-color: var(--ldesign-brand-color);
    color: #ffffff;
  }
  
  &:disabled {
    background-color: var(--ldesign-bg-color-component-disabled);
    color: var(--ldesign-text-color-disabled);
    cursor: not-allowed;
    transform: none;
  }
  
  .focus-ring();
}

// ============================================================================
// 实用工具混合器
// ============================================================================

// 隐藏元素（保持可访问性）
.sr-only() {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

// 重置按钮样式
.reset-button() {
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  font: inherit;
  color: inherit;
  cursor: pointer;
  outline: none;
}

// 重置列表样式
.reset-list() {
  list-style: none;
  padding: 0;
  margin: 0;
}

// 滚动条样式
.custom-scrollbar(@width: 8px, @track-color: var(--ldesign-gray-color-2), @thumb-color: var(--ldesign-gray-color-5)) {
  &::-webkit-scrollbar {
    width: @width;
    height: @width;
  }
  
  &::-webkit-scrollbar-track {
    background: @track-color;
    border-radius: @width / 2;
  }
  
  &::-webkit-scrollbar-thumb {
    background: @thumb-color;
    border-radius: @width / 2;
    
    &:hover {
      background: darken(@thumb-color, 10%);
    }
  }
}
