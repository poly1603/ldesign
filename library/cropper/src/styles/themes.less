/**
 * @ldesign/cropper ä¸»é¢˜æ ·å¼
 * 
 * å®šä¹‰ä¸åŒä¸»é¢˜çš„æ ·å¼å˜ä½“
 */

// ============================================================================
// æµ…è‰²ä¸»é¢˜ï¼ˆé»˜è®¤ï¼‰
// ============================================================================

.lcropper-theme-light,
.lcropper:not([class*="lcropper-theme-"]) {
  // å®¹å™¨é¢œè‰²
  --lcropper-container-bg: var(--ldesign-bg-color-container);
  --lcropper-container-border: var(--ldesign-border-color);
  --lcropper-container-shadow: var(--ldesign-shadow-1);
  
  // ç”»å¸ƒé¢œè‰²
  --lcropper-canvas-bg: #f8f9fa;
  --lcropper-canvas-border: var(--ldesign-border-level-2-color);
  
  // è£å‰ªåŒºåŸŸé¢œè‰²
  --lcropper-crop-area-border: var(--ldesign-brand-color);
  --lcropper-crop-area-bg: rgba(114, 46, 209, 0.1);
  
  // é®ç½©é¢œè‰²
  --lcropper-mask-bg: rgba(0, 0, 0, 0.5);
  
  // æ§åˆ¶ç‚¹é¢œè‰²
  --lcropper-control-point-bg: var(--ldesign-brand-color);
  --lcropper-control-point-border: #ffffff;
  --lcropper-control-point-shadow: var(--ldesign-shadow-2);
  
  // å·¥å…·æ é¢œè‰²
  --lcropper-toolbar-bg: var(--ldesign-bg-color-component);
  --lcropper-toolbar-border: var(--ldesign-border-color);
  --lcropper-toolbar-shadow: var(--ldesign-shadow-1);
  
  // ç½‘æ ¼å’Œå‚è€ƒçº¿é¢œè‰²
  --lcropper-grid-color: rgba(255, 255, 255, 0.5);
  --lcropper-guide-color: var(--ldesign-brand-color);
  
  // æ–‡æœ¬é¢œè‰²
  color: var(--ldesign-text-color-primary);
}

// ============================================================================
// æ·±è‰²ä¸»é¢˜
// ============================================================================

.lcropper-theme-dark {
  // å®¹å™¨é¢œè‰²
  --lcropper-container-bg: #1a1a1a;
  --lcropper-container-border: #404040;
  --lcropper-container-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  
  // ç”»å¸ƒé¢œè‰²
  --lcropper-canvas-bg: #2a2a2a;
  --lcropper-canvas-border: #505050;
  
  // è£å‰ªåŒºåŸŸé¢œè‰²
  --lcropper-crop-area-border: var(--ldesign-brand-color);
  --lcropper-crop-area-bg: rgba(114, 46, 209, 0.2);
  
  // é®ç½©é¢œè‰²
  --lcropper-mask-bg: rgba(0, 0, 0, 0.7);
  
  // æ§åˆ¶ç‚¹é¢œè‰²
  --lcropper-control-point-bg: var(--ldesign-brand-color);
  --lcropper-control-point-border: #ffffff;
  --lcropper-control-point-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
  
  // å·¥å…·æ é¢œè‰²
  --lcropper-toolbar-bg: #2a2a2a;
  --lcropper-toolbar-border: #404040;
  --lcropper-toolbar-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  
  // ç½‘æ ¼å’Œå‚è€ƒçº¿é¢œè‰²
  --lcropper-grid-color: rgba(255, 255, 255, 0.3);
  --lcropper-guide-color: var(--ldesign-brand-color);
  
  // æ–‡æœ¬é¢œè‰²
  color: var(--ldesign-font-white-1);
  
  // æ·±è‰²ä¸»é¢˜ç‰¹æ®Šæ ·å¼
  .lcropper-viewport {
    background-color: var(--lcropper-canvas-bg);
    background-image: 
      linear-gradient(45deg, #333 25%, transparent 25%),
      linear-gradient(-45deg, #333 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #333 75%),
      linear-gradient(-45deg, transparent 75%, #333 75%);
  }
  
  .lcropper-button {
    &.lcropper-button-ghost {
      color: var(--ldesign-font-white-1);
      
      &:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }
    }
  }
  
  .lcropper-input {
    background-color: #2a2a2a;
    border-color: #404040;
    color: var(--ldesign-font-white-1);
    
    &::placeholder {
      color: var(--ldesign-font-white-3);
    }
  }
  
  .lcropper-panel {
    background-color: #2a2a2a;
    border-color: #404040;
  }
  
  .lcropper-tooltip {
    background-color: rgba(255, 255, 255, 0.9);
    color: #000000;
    
    &::before {
      border-top-color: rgba(255, 255, 255, 0.9);
    }
  }
}

// ============================================================================
// é«˜å¯¹æ¯”åº¦ä¸»é¢˜
// ============================================================================

.lcropper-theme-high-contrast {
  // å®¹å™¨é¢œè‰²
  --lcropper-container-bg: #000000;
  --lcropper-container-border: #ffffff;
  --lcropper-container-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
  
  // ç”»å¸ƒé¢œè‰²
  --lcropper-canvas-bg: #000000;
  --lcropper-canvas-border: #ffffff;
  
  // è£å‰ªåŒºåŸŸé¢œè‰²
  --lcropper-crop-area-border: #ffffff;
  --lcropper-crop-area-bg: rgba(255, 255, 255, 0.1);
  
  // é®ç½©é¢œè‰²
  --lcropper-mask-bg: rgba(0, 0, 0, 0.8);
  
  // æ§åˆ¶ç‚¹é¢œè‰²
  --lcropper-control-point-bg: #ffffff;
  --lcropper-control-point-border: #000000;
  --lcropper-control-point-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
  
  // å·¥å…·æ é¢œè‰²
  --lcropper-toolbar-bg: #000000;
  --lcropper-toolbar-border: #ffffff;
  --lcropper-toolbar-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
  
  // ç½‘æ ¼å’Œå‚è€ƒçº¿é¢œè‰²
  --lcropper-grid-color: #ffffff;
  --lcropper-guide-color: #ffffff;
  
  // æ–‡æœ¬é¢œè‰²
  color: #ffffff;
  
  // é«˜å¯¹æ¯”åº¦ä¸»é¢˜ç‰¹æ®Šæ ·å¼
  .lcropper-viewport {
    background-color: #000000;
    background-image: 
      linear-gradient(45deg, #333 25%, transparent 25%),
      linear-gradient(-45deg, #333 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #333 75%),
      linear-gradient(-45deg, transparent 75%, #333 75%);
  }
  
  .lcropper-button {
    border-width: 2px;
    
    &.lcropper-button-primary {
      background-color: #ffffff;
      color: #000000;
      border-color: #ffffff;
      
      &:hover {
        background-color: #cccccc;
        border-color: #cccccc;
      }
    }
    
    &.lcropper-button-ghost {
      color: #ffffff;
      border-color: #ffffff;
      
      &:hover {
        background-color: #ffffff;
        color: #000000;
      }
    }
  }
  
  .lcropper-input {
    background-color: #000000;
    border-color: #ffffff;
    border-width: 2px;
    color: #ffffff;
    
    &::placeholder {
      color: #cccccc;
    }
    
    &:focus {
      box-shadow: 0 0 0 3px #ffffff;
    }
  }
  
  .lcropper-panel {
    background-color: #000000;
    border-color: #ffffff;
    border-width: 2px;
  }
  
  .lcropper-control-point {
    border-width: 3px;
    
    &::before {
      color: #000000;
    }
  }
  
  .lcropper-crop-area {
    border-width: 3px;
  }
  
  .lcropper-tooltip {
    background-color: #ffffff;
    color: #000000;
    border: 2px solid #000000;
    
    &::before {
      border-top-color: #ffffff;
    }
  }
}

// ============================================================================
// è‡ªå®šä¹‰ä¸»é¢˜æ”¯æŒ
// ============================================================================

.lcropper[data-theme] {
  // é€šè¿‡CSSè‡ªå®šä¹‰å±æ€§æ”¯æŒåŠ¨æ€ä¸»é¢˜
  --lcropper-container-bg: var(--custom-container-bg, var(--ldesign-bg-color-container));
  --lcropper-container-border: var(--custom-container-border, var(--ldesign-border-color));
  --lcropper-crop-area-border: var(--custom-crop-border, var(--ldesign-brand-color));
  --lcropper-control-point-bg: var(--custom-control-bg, var(--ldesign-brand-color));
  --lcropper-toolbar-bg: var(--custom-toolbar-bg, var(--ldesign-bg-color-component));
}

// ============================================================================
// ä¸»é¢˜åˆ‡æ¢åŠ¨ç”»
// ============================================================================

.lcropper {
  // ä¸»é¢˜åˆ‡æ¢æ—¶çš„å¹³æ»‘è¿‡æ¸¡
  transition: 
    background-color var(--lcropper-transition-normal),
    border-color var(--lcropper-transition-normal),
    color var(--lcropper-transition-normal);
  
  .lcropper-canvas,
  .lcropper-crop-area,
  .lcropper-control-point,
  .lcropper-toolbar,
  .lcropper-button,
  .lcropper-input,
  .lcropper-panel {
    transition: 
      background-color var(--lcropper-transition-normal),
      border-color var(--lcropper-transition-normal),
      color var(--lcropper-transition-normal),
      box-shadow var(--lcropper-transition-normal);
  }
}

// ============================================================================
// ç³»ç»Ÿä¸»é¢˜æ£€æµ‹
// ============================================================================

// è‡ªåŠ¨è·Ÿéšç³»ç»Ÿä¸»é¢˜
.lcropper-theme-auto {
  // é»˜è®¤ä½¿ç”¨æµ…è‰²ä¸»é¢˜
  .lcropper-theme-light();
  
  // ç³»ç»Ÿæ·±è‰²æ¨¡å¼æ—¶ä½¿ç”¨æ·±è‰²ä¸»é¢˜
  @media (prefers-color-scheme: dark) {
    .lcropper-theme-dark();
  }
}

// ============================================================================
// ä¸»é¢˜å·¥å…·ç±»
// ============================================================================

// ä¸»é¢˜åˆ‡æ¢å™¨
.lcropper-theme-switcher {
  display: flex;
  align-items: center;
  gap: var(--ls-spacing-xs);
  padding: var(--ls-padding-xs);
  background-color: var(--ldesign-bg-color-component);
  border: 1px solid var(--ldesign-border-color);
  border-radius: var(--ls-border-radius-base);
  
  .lcropper-theme-option {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border: 1px solid transparent;
    border-radius: var(--ls-border-radius-sm);
    cursor: pointer;
    transition: all var(--lcropper-transition-fast);
    
    &:hover {
      border-color: var(--ldesign-border-color-hover);
    }
    
    &.lcropper-theme-active {
      border-color: var(--ldesign-brand-color);
      background-color: var(--ldesign-brand-color-focus);
    }
    
    // ä¸»é¢˜é¢„è§ˆå›¾æ ‡
    &.lcropper-theme-light::before {
      content: 'â˜€ï¸';
    }
    
    &.lcropper-theme-dark::before {
      content: 'ğŸŒ™';
    }
    
    &.lcropper-theme-high-contrast::before {
      content: 'âš«';
    }
    
    &.lcropper-theme-auto::before {
      content: 'ğŸ”„';
    }
  }
}

// ============================================================================
// ä¸»é¢˜å˜é‡è¦†ç›–
// ============================================================================

// å…è®¸é€šè¿‡CSSå˜é‡è¦†ç›–ä¸»é¢˜é¢œè‰²
.lcropper {
  // ä¸»è‰²è°ƒè¦†ç›–
  &[style*="--theme-primary"] {
    --ldesign-brand-color: var(--theme-primary);
    --lcropper-crop-area-border: var(--theme-primary);
    --lcropper-control-point-bg: var(--theme-primary);
    --lcropper-guide-color: var(--theme-primary);
  }
  
  // èƒŒæ™¯è‰²è¦†ç›–
  &[style*="--theme-background"] {
    --lcropper-container-bg: var(--theme-background);
    --lcropper-canvas-bg: var(--theme-background);
    --lcropper-toolbar-bg: var(--theme-background);
  }
  
  // è¾¹æ¡†è‰²è¦†ç›–
  &[style*="--theme-border"] {
    --lcropper-container-border: var(--theme-border);
    --lcropper-canvas-border: var(--theme-border);
    --lcropper-toolbar-border: var(--theme-border);
  }
}

// ============================================================================
// å‡å°‘åŠ¨ç”»åå¥½
// ============================================================================

@media (prefers-reduced-motion: reduce) {
  .lcropper {
    transition: none !important;
    
    * {
      transition: none !important;
    }
  }
}
