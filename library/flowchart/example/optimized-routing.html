<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¼˜åŒ–åçš„æ™ºèƒ½è¿çº¿ç³»ç»Ÿ</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(to right, #667eea, #764ba2);
      color: white;
      padding: 20px;
      text-align: center;
    }
    
    h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
    }
    
    .description {
      margin-top: 8px;
      opacity: 0.9;
      font-size: 14px;
    }
    
    .controls {
      padding: 16px;
      background: #f8f9fa;
      border-bottom: 1px solid #e9ecef;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    
    button {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 500;
    }
    
    .btn-primary {
      background: #667eea;
      color: white;
    }
    
    .btn-primary:hover {
      background: #5a67d8;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
    }
    
    .btn-secondary {
      background: white;
      color: #333;
      border: 1px solid #dee2e6;
    }
    
    .btn-secondary:hover {
      background: #f8f9fa;
    }
    
    #flowchart {
      height: 600px;
      background: #fafbfc;
      background-image: 
        linear-gradient(#e8ecef 1px, transparent 1px),
        linear-gradient(90deg, #e8ecef 1px, transparent 1px);
      background-size: 20px 20px;
    }
    
    .info-panel {
      padding: 16px;
      background: #e7f3ff;
      border-left: 4px solid #2196f3;
      margin: 16px;
      border-radius: 4px;
      font-size: 14px;
      line-height: 1.6;
    }
    
    .feature-list {
      list-style: none;
      padding: 0;
      margin: 12px 0 0 0;
    }
    
    .feature-list li {
      padding: 4px 0;
      color: #0066cc;
    }
    
    .feature-list li:before {
      content: "âœ“ ";
      color: #4caf50;
      font-weight: bold;
      margin-right: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ¯ æ™ºèƒ½è¿çº¿ç³»ç»Ÿ - ç»†èŠ‚ä¼˜åŒ–ç‰ˆ</h1>
      <div class="description">å±•ç¤ºä¼˜åŒ–åçš„è¿çº¿ç»†èŠ‚ï¼šè±å½¢é¡¶ç‚¹è¿æ¥ã€å¹³è¡Œçº¿åˆ†ç¦»ã€æ™ºèƒ½è·¯ç”±</div>
    </div>
    
    <div class="info-panel">
      <strong>ä¼˜åŒ–ç»†èŠ‚ï¼š</strong>
      <ul class="feature-list">
        <li>éƒ¨é—¨ä¸»ç®¡å®¡æ‰¹åˆ°é‡‘é¢åˆ¤æ–­ï¼šè¿çº¿åˆ°è±å½¢çš„é¡¶éƒ¨è§’</li>
        <li>å®¡æ‰¹æ‹’ç»å’Œæ€»ç»ç†å®¡æ‰¹ï¼šåŒå‘è¿çº¿è‡ªåŠ¨åˆ†ç¦»ï¼Œé¿å…é‡å </li>
        <li>è±å½¢èŠ‚ç‚¹ï¼šå››ä¸ªé¡¶ç‚¹ä½œä¸ºè¿æ¥ç‚¹ï¼Œæ™ºèƒ½é€‰æ‹©æœ€ä½³è¿æ¥è§’åº¦</li>
        <li>åœ†è§’ä¼˜åŒ–ï¼šæ‰€æœ‰è½¬è§’å¹³æ»‘å¤„ç†ï¼Œæå‡è§†è§‰æ•ˆæœ</li>
      </ul>
    </div>
    
    <div class="controls">
      <button class="btn-primary" onclick="loadApprovalFlow()">åŠ è½½å®¡æ‰¹æµç¨‹</button>
      <button class="btn-primary" onclick="loadComplexFlow()">å¤æ‚è¿çº¿æµ‹è¯•</button>
      <button class="btn-secondary" onclick="toggleGrid()">åˆ‡æ¢ç½‘æ ¼</button>
      <button class="btn-secondary" onclick="resetView()">é‡ç½®è§†å›¾</button>
    </div>
    
    <div id="flowchart"></div>
  </div>
  
  <script src="../dist/flowchart.js"></script>
  <script>
    let flowChart;
    let showGrid = true;
    
    function initFlowChart() {
      flowChart = new FlowChart.FlowChart({
        container: document.getElementById('flowchart'),
        enableZoom: true,
        enablePan: true,
        enableNodeDrag: true,
        autoLayout: false,
        zoom: {
          initialScale: 1,
          minScale: 0.5,
          maxScale: 2,
          centerOnInit: true
        }
      });
      
      // é»˜è®¤åŠ è½½å®¡æ‰¹æµç¨‹
      loadApprovalFlow();
    }
    
    function loadApprovalFlow() {
      flowChart.clear();
      
      // æ·»åŠ èŠ‚ç‚¹ - ç²¾ç¡®å®šä½å±•ç¤ºä¼˜åŒ–æ•ˆæœ
      const nodes = [
        { id: 'start', type: 'start', label: 'æäº¤ç”³è¯·', position: { x: 400, y: 50 } },
        { id: 'manager', type: 'approval', label: 'éƒ¨é—¨ä¸»ç®¡å®¡æ‰¹', position: { x: 400, y: 150 } },
        { id: 'amount_check', type: 'condition', label: 'é‡‘é¢åˆ¤æ–­', position: { x: 400, y: 280 } },
        { id: 'small_amount', type: 'process', label: 'å°é¢æŠ¥é”€', position: { x: 250, y: 400 } },
        { id: 'reject', type: 'end', label: 'å®¡æ‰¹æ‹’ç»', position: { x: 600, y: 280 } },
        { id: 'finance', type: 'process', label: 'è´¢åŠ¡å®¡æ ¸', position: { x: 250, y: 520 } },
        { id: 'gm', type: 'approval', label: 'æ€»ç»ç†å®¡æ‰¹', position: { x: 600, y: 520 } },
        { id: 'approved', type: 'end', label: 'å®¡æ‰¹é€šè¿‡', position: { x: 400, y: 650 } }
      ];
      
      nodes.forEach(node => {
        flowChart.addNode({ ...node, manualPosition: true });
      });
      
      // æ·»åŠ è¿çº¿ - å±•ç¤ºä¼˜åŒ–åçš„è¿çº¿æ•ˆæœ
      const edges = [
        { id: 'e1', source: 'start', target: 'manager', label: 'æäº¤' },
        { id: 'e2', source: 'manager', target: 'amount_check', label: 'åŒæ„' }, // è¿™æ¡çº¿ä¼šè¿åˆ°è±å½¢é¡¶éƒ¨
        { id: 'e3', source: 'manager', target: 'reject', label: 'æ‹’ç»' },
        { id: 'e4', source: 'amount_check', target: 'small_amount', label: '<10ä¸‡' },
        { id: 'e5', source: 'small_amount', target: 'finance' },
        { id: 'e6', source: 'amount_check', target: 'finance', label: 'å®¡æ ¸ä¸é€šè¿‡' },
        { id: 'e7', source: 'finance', target: 'approved', label: 'æ‰¹å‡†' },
        { id: 'e8', source: 'reject', target: 'gm', label: 'ä¸æ‰¹å‡†' }, // è¿™æ¡çº¿å’Œä¸‹é¢çš„çº¿ä¼šåˆ†ç¦»
        { id: 'e9', source: 'gm', target: 'reject', label: 'é€€å›' }, // åå‘è¿çº¿ï¼Œä¼šè‡ªåŠ¨åˆ†ç¦»
        { id: 'e10', source: 'gm', target: 'approved', label: 'åŒæ„' },
        { id: 'e11', source: 'amount_check', target: 'gm', label: '>=10ä¸‡' }
      ];
      
      edges.forEach(edge => {
        flowChart.addEdge({
          ...edge,
          style: {
            type: 'polyline',
            strokeColor: '#667eea',
            strokeWidth: 2,
            radius: 10
          }
        });
      });
      
      flowChart.render();
    }
    
    function loadComplexFlow() {
      flowChart.clear();
      
      // åˆ›å»ºä¸€ä¸ªæ›´å¤æ‚çš„æµç¨‹æ¥æµ‹è¯•å„ç§è¿çº¿åœºæ™¯
      const nodes = [
        { id: 'center', type: 'condition', label: 'æ ¸å¿ƒåˆ¤æ–­', position: { x: 400, y: 300 } },
        { id: 'top', type: 'process', label: 'é¡¶éƒ¨å¤„ç†', position: { x: 400, y: 150 } },
        { id: 'right', type: 'process', label: 'å³ä¾§å¤„ç†', position: { x: 550, y: 300 } },
        { id: 'bottom', type: 'process', label: 'åº•éƒ¨å¤„ç†', position: { x: 400, y: 450 } },
        { id: 'left', type: 'process', label: 'å·¦ä¾§å¤„ç†', position: { x: 250, y: 300 } },
        { id: 'diamond2', type: 'condition', label: 'äºŒæ¬¡åˆ¤æ–­', position: { x: 550, y: 150 } },
        { id: 'end1', type: 'end', label: 'ç»“æŸ1', position: { x: 700, y: 150 } },
        { id: 'end2', type: 'end', label: 'ç»“æŸ2', position: { x: 700, y: 300 } }
      ];
      
      nodes.forEach(node => {
        flowChart.addNode({ ...node, manualPosition: true });
      });
      
      // æ·»åŠ å„ç§è§’åº¦çš„è¿çº¿
      const edges = [
        // ä»è±å½¢çš„å››ä¸ªæ–¹å‘å‡ºå‘
        { id: 'e1', source: 'center', target: 'top', label: 'å‘ä¸Š' },
        { id: 'e2', source: 'center', target: 'right', label: 'å‘å³' },
        { id: 'e3', source: 'center', target: 'bottom', label: 'å‘ä¸‹' },
        { id: 'e4', source: 'center', target: 'left', label: 'å‘å·¦' },
        
        // äº¤å‰è¿çº¿
        { id: 'e5', source: 'top', target: 'diamond2' },
        { id: 'e6', source: 'diamond2', target: 'end1', label: 'æ˜¯' },
        { id: 'e7', source: 'diamond2', target: 'center', label: 'å¦' },
        
        // å¹³è¡Œè¿çº¿æµ‹è¯•
        { id: 'e8', source: 'right', target: 'end2' },
        { id: 'e9', source: 'end2', target: 'right', label: 'è¿”å›' },
        
        // ç¯å½¢è¿æ¥
        { id: 'e10', source: 'bottom', target: 'left' },
        { id: 'e11', source: 'left', target: 'top' },
        { id: 'e12', source: 'top', target: 'right' },
        { id: 'e13', source: 'right', target: 'bottom' }
      ];
      
      edges.forEach(edge => {
        flowChart.addEdge({
          ...edge,
          style: {
            type: 'polyline',
            strokeColor: edge.id === 'e9' ? '#e53e3e' : '#667eea',
            strokeWidth: 2,
            radius: 12
          }
        });
      });
      
      flowChart.render();
    }
    
    function toggleGrid() {
      showGrid = !showGrid;
      const chart = document.getElementById('flowchart');
      if (showGrid) {
        chart.style.backgroundImage = 
          'linear-gradient(#e8ecef 1px, transparent 1px), ' +
          'linear-gradient(90deg, #e8ecef 1px, transparent 1px)';
      } else {
        chart.style.backgroundImage = 'none';
      }
    }
    
    function resetView() {
      if (flowChart) {
        const renderer = flowChart.getRenderer();
        if (renderer && renderer.resetZoom) {
          renderer.resetZoom();
        }
        flowChart.render();
      }
    }
    
    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', initFlowChart);
  </script>
</body>
</html>