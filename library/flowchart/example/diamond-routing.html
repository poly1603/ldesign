<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è±å½¢èŠ‚ç‚¹æ™ºèƒ½è·¯ç”±æµ‹è¯•</title>
  <style>
    body {
      font-family: 'Microsoft YaHei', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f7f8fa;
    }
    
    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 24px;
    }
    
    .description {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.6;
    }
    
    .container {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
    }
    
    #flowchart {
      width: 100%;
      height: 600px;
      border: 1px solid #e8e8e8;
      border-radius: 4px;
      background: #fafafa;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    button {
      padding: 8px 16px;
      background: #1890ff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }
    
    button:hover {
      background: #40a9ff;
    }
    
    button:active {
      background: #096dd9;
    }
    
    button.secondary {
      background: #f0f2f5;
      color: #333;
    }
    
    button.secondary:hover {
      background: #e6e8eb;
    }
    
    .info {
      padding: 12px;
      background: #e6f7ff;
      border: 1px solid #91d5ff;
      border-radius: 4px;
      color: #0050b3;
      margin-bottom: 15px;
    }
    
    .legend {
      display: flex;
      gap: 20px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #e8e8e8;
      font-size: 13px;
      color: #666;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .legend-icon {
      width: 24px;
      height: 16px;
    }
  </style>
</head>
<body>
  <h1>ğŸ”· è±å½¢èŠ‚ç‚¹æ™ºèƒ½è·¯ç”±æ¼”ç¤º</h1>
  <div class="description">
    å±•ç¤ºä¼˜åŒ–åçš„è±å½¢èŠ‚ç‚¹è¿çº¿ç³»ç»Ÿï¼Œç¡®ä¿æ¯ä¸ªè§’åªæœ‰ä¸€æ¡çº¿ï¼Œå¹¶ä½¿ç”¨æ™ºèƒ½æŠ˜çº¿è·¯ç”±ã€‚
  </div>
  
  <div class="container">
    <div class="info">
      ğŸ’¡ <strong>ç‰¹æ€§è¯´æ˜ï¼š</strong>è±å½¢èŠ‚ç‚¹çš„å››ä¸ªé¡¶ç‚¹ä½œä¸ºè¿æ¥ç‚¹ï¼Œæ ¹æ®ç›¸å¯¹ä½ç½®æ™ºèƒ½é€‰æ‹©æœ€ä½³è¿æ¥è·¯å¾„ã€‚é¿å…äº†å¤šæ¡çº¿è¿æ¥åˆ°åŒä¸€ä¸ªè§’çš„é—®é¢˜ã€‚
    </div>
    
    <div class="controls">
      <button onclick="loadExample1()">ç¤ºä¾‹1: å®¡æ‰¹æµç¨‹</button>
      <button onclick="loadExample2()">ç¤ºä¾‹2: å¤æ‚åˆ¤æ–­</button>
      <button onclick="loadExample3()">ç¤ºä¾‹3: å¤šé‡æ¡ä»¶</button>
      <button onclick="toggleAnimation()" class="secondary">åˆ‡æ¢åŠ¨ç”»</button>
      <button onclick="resetView()" class="secondary">é‡ç½®è§†å›¾</button>
    </div>
    
    <div id="flowchart"></div>
    
    <div class="legend">
      <div class="legend-item">
        <svg class="legend-icon" viewBox="0 0 24 16">
          <rect x="2" y="4" width="20" height="8" rx="2" fill="#e6f7ff" stroke="#1890ff"/>
        </svg>
        <span>æ™®é€šèŠ‚ç‚¹</span>
      </div>
      <div class="legend-item">
        <svg class="legend-icon" viewBox="0 0 24 16">
          <path d="M12 2 L22 8 L12 14 L2 8 Z" fill="#fff6e6" stroke="#fa8c16"/>
        </svg>
        <span>æ¡ä»¶èŠ‚ç‚¹ï¼ˆè±å½¢ï¼‰</span>
      </div>
      <div class="legend-item">
        <svg class="legend-icon" viewBox="0 0 24 16">
          <path d="M2 8 L22 8" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <polygon points="0 0, 10 3, 0 6" fill="#666"/>
            </marker>
          </defs>
        </svg>
        <span>æ™ºèƒ½æŠ˜çº¿è¿æ¥</span>
      </div>
    </div>
  </div>
  
  <script src="../dist/flowchart.js"></script>
  <script>
    let flowChart;
    let animationEnabled = true;
    
    // åˆå§‹åŒ–æµç¨‹å›¾
    function initFlowChart() {
      flowChart = new FlowChart.FlowChart({
        container: document.getElementById('flowchart'),
        enableZoom: true,
        enablePan: true,
        enableNodeDrag: true,
        autoLayout: false, // ä½¿ç”¨æ‰‹åŠ¨å¸ƒå±€ä»¥ç²¾ç¡®æ§åˆ¶ä½ç½®
        zoom: {
          initialScale: 1,
          minScale: 0.5,
          maxScale: 2,
          centerOnInit: true
        }
      });
      
      // é»˜è®¤åŠ è½½ç¤ºä¾‹1
      loadExample1();
    }
    
    // ç¤ºä¾‹1: å®¡æ‰¹æµç¨‹
    function loadExample1() {
      flowChart.clear();
      
      // æ·»åŠ èŠ‚ç‚¹
      flowChart.addNode({
        id: 'start',
        type: 'start',
        label: 'é€€å›ä¿®æ”¹',
        position: { x: 400, y: 50 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'manager',
        type: 'approval',
        label: 'éƒ¨é—¨ä¸»ç®¡å®¡æ‰¹',
        position: { x: 400, y: 150 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'condition1',
        type: 'condition',
        label: 'é‡‘é¢åˆ¤æ–­',
        position: { x: 200, y: 280 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'small-amount',
        type: 'process',
        label: 'å°é¢æŠ¥é”€',
        position: { x: 100, y: 400 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'reject',
        type: 'end',
        label: 'å®¡æ‰¹æ‹’ç»',
        position: { x: 600, y: 280 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'finance',
        type: 'approval',
        label: 'è´¢åŠ¡å®¡æ ¸',
        position: { x: 200, y: 520 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'gm-approval',
        type: 'approval',
        label: 'æ€»ç»ç†å®¡æ‰¹',
        position: { x: 600, y: 520 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'approved',
        type: 'end',
        label: 'å®¡æ‰¹é€šè¿‡',
        position: { x: 400, y: 650 },
        manualPosition: true
      });
      
      // æ·»åŠ è¿çº¿
      flowChart.addEdge({
        id: 'e1',
        source: 'start',
        target: 'manager',
        label: 'é€€å›ä¿®æ”¹'
      });
      
      flowChart.addEdge({
        id: 'e2',
        source: 'manager',
        target: 'condition1',
        label: 'åŒæ„'
      });
      
      flowChart.addEdge({
        id: 'e3',
        source: 'manager',
        target: 'reject',
        label: 'æ‹’ç»'
      });
      
      flowChart.addEdge({
        id: 'e4',
        source: 'condition1',
        target: 'small-amount',
        label: 'å°é¢æŠ¥é”€'
      });
      
      flowChart.addEdge({
        id: 'e5',
        source: 'small-amount',
        target: 'finance'
      });
      
      flowChart.addEdge({
        id: 'e6',
        source: 'condition1',
        target: 'finance',
        label: 'å®¡æ ¸ä¸é€šè¿‡'
      });
      
      flowChart.addEdge({
        id: 'e7',
        source: 'finance',
        target: 'approved',
        label: 'æ‰¹å‡†'
      });
      
      flowChart.addEdge({
        id: 'e8',
        source: 'reject',
        target: 'gm-approval',
        label: 'ä¸æ‰¹å‡†'
      });
      
      flowChart.addEdge({
        id: 'e9',
        source: 'gm-approval',
        target: 'approved'
      });
      
      flowChart.render();
    }
    
    // ç¤ºä¾‹2: å¤æ‚åˆ¤æ–­æµç¨‹
    function loadExample2() {
      flowChart.clear();
      
      // æ·»åŠ èŠ‚ç‚¹
      flowChart.addNode({
        id: 'input',
        type: 'start',
        label: 'ç”¨æˆ·è¾“å…¥',
        position: { x: 400, y: 50 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'validate',
        type: 'process',
        label: 'æ•°æ®éªŒè¯',
        position: { x: 400, y: 150 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'check1',
        type: 'condition',
        label: 'æ ¼å¼æ£€æŸ¥',
        position: { x: 400, y: 280 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'format-error',
        type: 'process',
        label: 'æ ¼å¼é”™è¯¯å¤„ç†',
        position: { x: 200, y: 380 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'check2',
        type: 'condition',
        label: 'æƒé™æ£€æŸ¥',
        position: { x: 600, y: 380 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'permission-denied',
        type: 'end',
        label: 'æƒé™ä¸è¶³',
        position: { x: 750, y: 480 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'process-data',
        type: 'process',
        label: 'å¤„ç†æ•°æ®',
        position: { x: 400, y: 480 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'check3',
        type: 'condition',
        label: 'ç»“æœéªŒè¯',
        position: { x: 400, y: 580 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'success',
        type: 'end',
        label: 'å¤„ç†æˆåŠŸ',
        position: { x: 250, y: 680 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'retry',
        type: 'process',
        label: 'é‡è¯•å¤„ç†',
        position: { x: 550, y: 680 },
        manualPosition: true
      });
      
      // æ·»åŠ è¿çº¿
      flowChart.addEdge({
        id: 'e1',
        source: 'input',
        target: 'validate'
      });
      
      flowChart.addEdge({
        id: 'e2',
        source: 'validate',
        target: 'check1'
      });
      
      flowChart.addEdge({
        id: 'e3',
        source: 'check1',
        target: 'format-error',
        label: 'æ ¼å¼é”™è¯¯'
      });
      
      flowChart.addEdge({
        id: 'e4',
        source: 'check1',
        target: 'check2',
        label: 'æ ¼å¼æ­£ç¡®'
      });
      
      flowChart.addEdge({
        id: 'e5',
        source: 'format-error',
        target: 'validate',
        label: 'ä¿®æ­£åé‡è¯•'
      });
      
      flowChart.addEdge({
        id: 'e6',
        source: 'check2',
        target: 'permission-denied',
        label: 'æ— æƒé™'
      });
      
      flowChart.addEdge({
        id: 'e7',
        source: 'check2',
        target: 'process-data',
        label: 'æœ‰æƒé™'
      });
      
      flowChart.addEdge({
        id: 'e8',
        source: 'process-data',
        target: 'check3'
      });
      
      flowChart.addEdge({
        id: 'e9',
        source: 'check3',
        target: 'success',
        label: 'éªŒè¯é€šè¿‡'
      });
      
      flowChart.addEdge({
        id: 'e10',
        source: 'check3',
        target: 'retry',
        label: 'éœ€è¦é‡è¯•'
      });
      
      flowChart.addEdge({
        id: 'e11',
        source: 'retry',
        target: 'process-data'
      });
      
      flowChart.render();
    }
    
    // ç¤ºä¾‹3: å¤šé‡æ¡ä»¶åˆ¤æ–­
    function loadExample3() {
      flowChart.clear();
      
      // ä¸­å¿ƒè±å½¢èŠ‚ç‚¹
      flowChart.addNode({
        id: 'center',
        type: 'condition',
        label: 'å¤šé‡åˆ¤æ–­',
        position: { x: 400, y: 300 },
        manualPosition: true
      });
      
      // å››å‘¨çš„èŠ‚ç‚¹
      flowChart.addNode({
        id: 'top',
        type: 'process',
        label: 'æ¡ä»¶Aå¤„ç†',
        position: { x: 400, y: 150 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'right',
        type: 'process',
        label: 'æ¡ä»¶Bå¤„ç†',
        position: { x: 600, y: 300 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'bottom',
        type: 'process',
        label: 'æ¡ä»¶Cå¤„ç†',
        position: { x: 400, y: 450 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'left',
        type: 'process',
        label: 'æ¡ä»¶Då¤„ç†',
        position: { x: 200, y: 300 },
        manualPosition: true
      });
      
      // ç¬¬äºŒå±‚è±å½¢
      flowChart.addNode({
        id: 'diamond2',
        type: 'condition',
        label: 'äºŒæ¬¡åˆ¤æ–­',
        position: { x: 600, y: 150 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'result1',
        type: 'end',
        label: 'ç»“æœ1',
        position: { x: 750, y: 150 },
        manualPosition: true
      });
      
      flowChart.addNode({
        id: 'result2',
        type: 'end',
        label: 'ç»“æœ2',
        position: { x: 600, y: 50 },
        manualPosition: true
      });
      
      // æ·»åŠ è¿çº¿ - å±•ç¤ºè±å½¢çš„å››ä¸ªæ–¹å‘è¿æ¥
      flowChart.addEdge({
        id: 'e1',
        source: 'center',
        target: 'top',
        label: 'A'
      });
      
      flowChart.addEdge({
        id: 'e2',
        source: 'center',
        target: 'right',
        label: 'B'
      });
      
      flowChart.addEdge({
        id: 'e3',
        source: 'center',
        target: 'bottom',
        label: 'C'
      });
      
      flowChart.addEdge({
        id: 'e4',
        source: 'center',
        target: 'left',
        label: 'D'
      });
      
      // ä»topèŠ‚ç‚¹åˆ°ç¬¬äºŒä¸ªè±å½¢
      flowChart.addEdge({
        id: 'e5',
        source: 'top',
        target: 'diamond2'
      });
      
      // ç¬¬äºŒä¸ªè±å½¢çš„è¾“å‡º
      flowChart.addEdge({
        id: 'e6',
        source: 'diamond2',
        target: 'result1',
        label: 'æ˜¯'
      });
      
      flowChart.addEdge({
        id: 'e7',
        source: 'diamond2',
        target: 'result2',
        label: 'å¦'
      });
      
      // å…¶ä»–èŠ‚ç‚¹çš„å›ç¯
      flowChart.addEdge({
        id: 'e8',
        source: 'right',
        target: 'bottom'
      });
      
      flowChart.addEdge({
        id: 'e9',
        source: 'bottom',
        target: 'left'
      });
      
      flowChart.addEdge({
        id: 'e10',
        source: 'left',
        target: 'top'
      });
      
      flowChart.render();
    }
    
    // åˆ‡æ¢åŠ¨ç”»
    function toggleAnimation() {
      animationEnabled = !animationEnabled;
      // è¿™é‡Œå¯ä»¥æ·»åŠ åŠ¨ç”»åˆ‡æ¢çš„é€»è¾‘
      console.log('åŠ¨ç”»çŠ¶æ€:', animationEnabled ? 'å¼€å¯' : 'å…³é—­');
    }
    
    // é‡ç½®è§†å›¾
    function resetView() {
      if (flowChart) {
        const renderer = flowChart.getRenderer();
        if (renderer && renderer.resetZoom) {
          renderer.resetZoom();
        }
        flowChart.render();
      }
    }
    
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', initFlowChart);
  </script>
</body>
</html>